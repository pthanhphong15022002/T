<codx-views #view service="BP" assemblyName="ERM.Business.BP" entityName="BP_Processes" className="ProcessesBusiness"
  method="GetListPersionsByOwnerAsync" [views]="views" [dataObj]="dataObj" [autoLoad]="true"
  idField="recID">
</codx-views>

<ng-template #itemViewList let-data>
  <tr class="has-action-menu">
    <td class="rowphoto">
      <div class="padding">
        <div class="d-flex flex-column w-100">
          <div class="fw-bold lh-base mb-2 line-clamp">{{ data.processName }}</div>
          <div class="d-flex flex-wrap justify-content-between">
            <div class="d-flex align-items-center">
              <div class="d-flex me-3">
                <span class="icon-server text-dark icon-14 me-1"></span>
                <span class="">{{ data.phases }}</span>
              </div>
              <div class="d-flex me-3">
                <span class="icon-format_list_numbered text-danger icon-16 me-1"></span>
                <span class="">{{ data.activities }}</span>
              </div>
              <div class="d-flex me-3">
                <span class="icon-attach_file text-primary icon-16 me-1"></span>
                <span class=" ">{{ data.attachments }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </td>
    <td class="rowphoto">
      <div class="padding justify-content-start">
        <codx-temp-full cardCss="card-template" [imageId]="data.objectID" imageObjType="AD_Users" [titleTmp]="titleTmp"
          [desc]="convertHtmlAgency(data.positionName)" [desc2]="data.groupID" [dataItem]="data">
        </codx-temp-full>
      </div>
    </td>
    <td class="rowphoto">
      <div #createdOn class="padding">
        {{
        data.createdOn | formatvalue
        : view.formModel
        : "createdOn"
        : createdOn
        : "Processes"
        : "grvProcesses"
        | async
        }}
      </div>
    </td>
    <td class="rowphoto">
      <div class="padding">
        <div class="dropdown ms-2" [ngbPopover]="popDetail" placement="left" #empPopover="ngbPopover" [openDelay]="500"
          (mouseenter)="toggleContent(empPopover, data)" (mouseleave)="toggleContent(empPopover, null)">
          <button class="btn" type="button" id="dropdownShowDescription" data-toggle="dropdown" aria-haspopup="true"
            aria-expanded="false">
            <div class="d-flex">
              <span class="icon-assignment icon-16 text-gray-600 me-1"></span>
            </div>
          </button>
        </div>
      </div>
    </td>
    <td class="rowphoto">
      <div class="padding">
        <div *ngIf="data.memo" class="" [class.dropdown-customv2]="data.memo" [ngbPopover]="popDetailMemo" #p="ngbPopover"
        [openDelay]="500" (mouseenter)="PopoverDetail(p, data)" (mouseleave)="PopoverDetail(p, null)"
        placement="bottom right top" autoClose="outside">
        <div class="line-clamp" [innerHTML]="data.memo" #memo>

        </div>
      </div>
      </div>
    </td>
    <td class="rowphoto">
      <div class="padding">
        <codx-vll [name]="'VL003'" [value]="data?.approveStatus" [showText]="true" [showBgColor]="true"
        class="badge badge-light badge-square badge-md fs-7 p-2">
      </codx-vll>
      </div>
    </td>
    <td class="rowphoto">
      <div *ngIf="(data.approveStatus !='5' || data.approveStatus !='4') && data.approvedBy != userID">
        <button class="btn btn-primary" (click)="permission(data, '3')">
          <codx-label default="Xét duyệt"></codx-label>
        </button>
        <codx-mfunc [formModel]="view.formModel" (clickMF)="clickMF($event, data)" [isBookMark]="true" [dataItem]="data"
          [type]="'hover'" (changeDataMF)="changeDataMF($event, data)">
        </codx-mfunc>
      </div>

    </td>
  </tr>


</ng-template>

<ng-template #titleTmp let-data>
  <div class="text-dark fw-bolder line-clamp line-clamp-1 me-2">
    {{ data.objectName }}
  </div>
</ng-template>

<ng-template #popDetailMemo>
  <div>
    <ng-container>
      <div class="d-flex flex-column w-100">
        <div class="text-gray-800 " [innerHTML]="popoverDetail?.memo">
        </div>
      </div>
    </ng-container>
  </div>

</ng-template>

<ng-template #popDetail>
  <ng-container *ngFor="let item of lstPermissions; index as i">
    <div class="d-flex justify-content-between align-items-center checkbox-item mb-4">
      {{item}}
    </div>
  </ng-container>
</ng-template>


<!--Header-->
<ng-template #itemProcessName >
  <div class="padding">
    <codx-label fiedName="ProcessName" formName="AprPermissions" gridViewName="grvAprPermissions"
      default="Tên qui trình">
    </codx-label>
  </div>
</ng-template>

<ng-template #itemOwner >
  <div class="padding">
    <codx-label fiedName="Petitioner" formName="AprPermissions" gridViewName="grvAprPermissions"
      default="Người yêu cầu">
    </codx-label>
  </div>
</ng-template>

<ng-template #itemCreatedOn >
  <div class="padding">
    <codx-label fiedName="RequestDate" formName="AprPermissions" gridViewName="grvAprPermissions"
      default="Ngày yêu cầu">
    </codx-label>
  </div>
</ng-template>

<ng-template #itemPermissions >
  <div class="padding">
    <codx-label fiedName="Permission" formName="AprPermissions" gridViewName="grvAprPermissions" default="Quyền">
    </codx-label>
  </div>
</ng-template>

<ng-template #itemDescription >
  <div class="padding">
    <codx-label fiedName="Description" formName="AprPermissions" gridViewName="grvAprPermissions" default="Ghi chú">
    </codx-label>
  </div>
</ng-template>

<ng-template #itemStatus let-data>
  <div >
    <codx-label fiedName="ApproveStatus" formName="AprPermissions" gridViewName="grvAprPermissions"
      default="Trạng thái">
    </codx-label>
  </div>
</ng-template>
