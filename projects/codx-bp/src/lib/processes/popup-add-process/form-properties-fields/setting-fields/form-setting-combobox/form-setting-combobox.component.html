<codx-form
  #formTable
  [headerText]="titleAction"
  [body]="body"
  [footer]="footer"
  [dialog]="dialog"
></codx-form>
<ng-template #body>
  <div class="form-group">
    <codx-label
      [default]="
        data?.fieldType == 'Title' ? 'Tên biểu mẫu' : 'Tên ô nhập liệu'
      "
      [formName]="'DynamicForms'"
      [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
      [name]="'lblTitle'"
    ></codx-label>
    <codx-input
      type="text"
      field="title"
      [crrValue]="data?.title ?? ''"
      (valueChange)="valueChange($event)"
    ></codx-input>
  </div>
  <div class="form-group">
    <codx-label
      [formName]="'DynamicForms'"
      [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
      [name]="'lblDescription'"
      default="Hiển thị chuỗi gợi ý khi chưa có dữ liệu"
    ></codx-label>
    <codx-input
      field="description"
      type="text"
      [crrValue]="data?.description ?? ''"
      (valueChange)="valueChange($event)"
    ></codx-input>
  </div>
  <div class="form-group row">
    <div class="col-4">
      <codx-label
        [formName]="'DynamicForms'"
        [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
        [name]="'lblRefType'"
        default="Chọn danh sách từ hệ thống"
      ></codx-label>
      <codx-input
        field="refType"
        type="combobox"
        refValue=""
        [crrValue]="data?.refType ?? ''"
        (valueChange)="valueChange($event)"
      ></codx-input>
    </div>
    <div class="col-4">
      <codx-label
        [formName]="'DynamicForms'"
        [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
        [name]="'lblRefValue'"
        default="Chọn bảng dữ liệu liên kết"
      ></codx-label>
      <codx-input
        field="refValue"
        type="combobox"
        refValue=""
        [crrValue]="data?.refValue ?? ''"
        (valueChange)="valueChange($event)"
      ></codx-input>
    </div>
    <div class="col-4 d-flex align-items-center" style="margin-top: 20px">
      <codx-input
        field="multiselect"
        [crrValue]="data?.multiselect"
        type="switch"
        (valueChange)="valueChange($event)"
      ></codx-input>
      <codx-label
        name="lblMultiselect"
        [formName]="'DynamicForms'"
        [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
        default="Chọn nhiều giá trị"
        class="ms-1"
      ></codx-label>
    </div>
  </div>
  <div class="form-group">
    <codx-label
      name="lblFilter"
      [formName]="'DynamicForms'"
      [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
      default="Điều kiện lọc dữ liệu"
    ></codx-label>
    <div class="row mb-2">
      <div class="col-11">
        <codx-input
          field="filter"
          [crrValue]="filter"
          type="text"
          (valueChange)="valueChange($event)"
        ></codx-input>
      </div>
      <div class="col-1 d-flex align-items-center">
        <button
          type="button"
          class="btn btn-icon btn-active-light-primary my-1"
        >
          <span
            [inlineSVG]="'./assets/themes/sys/default/img/header_fillter.svg'"
            class="svg-icon svg-icon-1 icon-16"
          ></span>
        </button>
      </div>
    </div>
    <div class="col-11">
      <table class="table">
        <thead class="thead-light">
          <tr class="fw-bold">
            <th scope="col-4 d-flex justify-content-center align-items-center">
              <codx-label
                default="Tên trường dữ liệu"
                name="lblFNameTable"
                [formName]="'DynamicForms'"
                [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
              ></codx-label>
            </th>
            <th scope="col-2 d-flex justify-content-center align-items-center">
              <codx-label
                default="Hiển thị"
                name="lblShowTable"
                [formName]="'DynamicForms'"
                [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
              ></codx-label>
            </th>
            <th scope="col-2 d-flex justify-content-center align-items-center">
              <codx-label
                default="Lưu"
                name="lblSaveTable"
                [formName]="'DynamicForms'"
                [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
              ></codx-label>
            </th>
            <th scope="col-2 d-flex justify-content-center align-items-center">
              <codx-label
                default="Lọc"
                name="lblFilterTable"
                [formName]="'DynamicForms'"
                [gridViewName]="'grvDynamicFormsTitle' + data?.fieldType"
              ></codx-label>
            </th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngIf="lstDatas?.length > 0">
            <tr *ngFor="let item of lstDatas; index as i">
              <td scope="row" style="border: none; padding: 0;">
                <ejs-combobox
                  #cbx
                  class="w-100 custom-combobox"
                  [dataSource]="lstGrids"
                  [fields]="fields"
                  [value]="item?.headerText"
                  [allowFiltering]="false"
                  (change)="cbxContact($event, i)"
                  (focus)="onComboBoxFocus($event, 'cbx', cbx)"
                >
                </ejs-combobox>
              </td>
              <td>
                <codx-input
                  field="allowShow"
                  type="checkbox"
                  [crrValue]="item?.allowShow ?? false"
                  (valueChange)="valueChangeCheckBox($event, i)"
                ></codx-input>
              </td>
              <td>
                <codx-input
                  field="allowSave"
                  type="checkbox"
                  [crrValue]="item?.allowSave ?? false"
                  (valueChange)="valueChangeCheckBox($event, i)"
                ></codx-input>
              </td>
              <td>
                <codx-input
                  field="allowFilter"
                  type="checkbox"
                  [crrValue]="item?.allowFilter ?? false"
                  (valueChange)="valueChangeCheckBox($event, i)"
                ></codx-input>
              </td>
            </tr>
          </ng-container>
          <tr>
            <td scope="row" style="border: none; padding: 0;">
              <ejs-combobox
                #cbxNew
                class="w-100 custom-combobox"
                [dataSource]="lstGrids"
                [fields]="fields"
                [value]="datas?.fieldName ?? ''"
                [allowFiltering]="false"
                [placeholder]="'Chọn trường nhập liệu'"
                (change)="cbxContact($event, -1)"
                (focus)="onComboBoxFocus($event, 'cbxNew', cbxNew)"
              >
              </ejs-combobox>
            </td>
            <td>
              <codx-input
                #allowShowNew
                field="allowShow"
                type="checkbox"
                [crrValue]="datas?.allowShow ?? false"
                (valueChange)="valueChangeCheckBox($event, -1)"
              ></codx-input>
            </td>
            <td>
              <codx-input
                #allowSaveNew
                field="allowSave"
                type="checkbox"
                [crrValue]="datas?.allowSave ?? false"
                (valueChange)="valueChangeCheckBox($event, -1)"
              ></codx-input>
            </td>
            <td>
              <codx-input
                #allowFilterNew
                field="allowFilter"
                type="checkbox"
                [crrValue]="datas?.allowFilter ?? false"
                (valueChange)="valueChangeCheckBox($event, -1)"
              ></codx-input>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</ng-template>
<ng-template #footer>
  <div class="d-flex justify-content-end">
    <button type="button" class="btn btn-primary" (click)="onSave()">
      <codx-label
        name="lblSuscess"
        [formModel]="dialog.formModel"
        default="Đồng ý"
      ></codx-label>
    </button>
  </div>
</ng-template>
