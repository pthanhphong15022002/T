<!-- <div class="p-5 h-100 w-100" cdkDropListGroup>
  <div class="d-flex flex-column" *ngFor="let item of lstFields">
    <div cdkDropList (cdkDropListDropped)="drop($event)">
      <div
        cdkDrag
        [cdkDragData]="item"
        class="mb-5"
        *ngIf="item?.controlType == 'F'"
        (click)="clickData(item)"
      >
        <div class="d-flex align-items-center h2-title mb-2">
          <div *ngIf="item?.title != null && item?.title?.trim() != ''">
            {{ item?.title }}
          </div>
        </div>
        <div class="text-gray-500">
          <div *ngIf="item?.note != null && item?.note?.trim() != ''">
            {{ item?.note }}
          </div>
        </div>
      </div>
      <ng-container *ngIf="countData > 0; else empty">
        <div cdkDropList (cdkDropListDropped)="drop($event)">
          <div
            class="form-group"
            (click)="clickData(item)"
            *ngIf="item?.controlType != 'F'"
          >
            <div
              class="d-flex justify-content-between align-content-center mb-2"
            >
              <div class="d-flex justify-content-start mb-2">
                <span
                  class="cursor-pointer icon-16 icon-drag_indicator me-2"
                ></span>
                <span class="text-dark fw-bold">{{ item?.title }}</span>
                <span class="text-danger ms-2" *ngIf="item?.isRequired">*</span>
              </div>
              <div class="d-flex justify-content-end">
                <ng-container *ngIf="item?.controlType == 'YesNo'">
                  <codx-input
                    [field]="item?.fieldName"
                    type="switch"
                    *ngIf="item?.dataType == 's'"
                    [showSpinButton]="false"
                    [crrValue]="item?.dataFormat ?? false"
                    [disabled]="true"
                  ></codx-input>
                  <div *ngIf="item?.dataType == 'c'">
                    <codx-input
                      id="yes"
                      name="{{ item?.recID }} {{ item.fieldName }}"
                      class="test-check me-3"
                      type="radio"
                      label="Yes"
                      field="yes"
                      [checked]="item?.dataFormat ?? false"
                      [disabled]="true"
                    ></codx-input>
                    <codx-input
                      id="no"
                      name="{{ item?.recID }}{{ item.fieldName }}"
                      class="test-check"
                      type="radio"
                      label="No"
                      field="no"
                      [checked]="!item?.dataFormat ?? false"
                      [disabled]="true"
                    ></codx-input>
                  </div>
                  <codx-input
                    [field]="item?.fieldName"
                    *ngIf="item?.dataType == 'checkbox'"
                    type="checkbox"
                    [showSpinButton]="false"
                    [crrValue]="item?.dataFormat || false"
                    [disabled]="true"
                  ></codx-input>
                </ng-container>
                <div
                  *ngIf="item?.controlType == 'User' && item?.dataType == 'P'"
                >
                  <button
                    type="button"
                    class="btn btn-sm btn-icon btn-light-primary"
                    (click)="openPopup()"
                  >
                    <span class="icon-person_add_alt_1 icon-16"></span>
                  </button>
                  <ng-container *ngIf="isPopupUserCbb">
                    <codx-combobox-popup
                      [comboboxName]="'Users'"
                      [field]="'cbbUser'"
                      [multiple]="item.multiselect ?? false"
                      [width]="700"
                      [height]="600"
                      [value]=""
                      [formModel]="formModel"
                      (clickSave)="valueChangePop($event)"
                    >
                    </codx-combobox-popup>
                  </ng-container>
                </div>
              </div>
            </div>

            <codx-input
              *ngIf="
                item?.controlType == 'Text' ||
                item?.controlType == 'Phone' ||
                item?.controlType == 'Email' ||
                item?.controlType == 'Address' ||
                item?.controlType == 'Expression'
              "
              [field]="item?.fieldName"
              type="text"
              [require]="item?.isRequired"
              [placeholder]="item?.note || ''"
              [crrValue]="item?.dataFormat ?? ''"
              [disabled]="true"
            ></codx-input>
            <ng-container
              *ngIf="item?.controlType == 'ValueList'"
              [ngTemplateOutlet]="tempValueList"
              [ngTemplateOutletContext]="{ $implicit: item }"
            >
            </ng-container>
            <codx-input
              *ngIf="item?.controlType == 'Combobox'"
              [field]="item?.fieldName"
              [type]="'combobox'"
              [refValue]="item?.refValue"
              [require]="item?.isRequired"
              [placeholder]="item?.note || ''"
              [crrValue]="item?.dataFormat ?? ''"
              [disabled]="true"
            ></codx-input>
            <codx-input
              [field]="item?.fieldName"
              *ngIf="item?.controlType == 'Datetime'"
              type="datetime"
              [format]="item?.dataType"
              [placeholder]="item?.note || ''"
              [crrValue]="item?.dataFormat ?? ''"
              [disabled]="true"
            ></codx-input>
            <codx-input
              [field]="item?.fieldName"
              *ngIf="item?.controlType == 'Number'"
              type="number"
              [showSpinButton]="false"
              [placeholder]="item?.note || ''"
              [crrValue]="item?.dataFormat ?? ''"
              [disabled]="true"
            ></codx-input>
            <ng-container
              *ngIf="item?.controlType == 'User' && item?.dataType == 'd'"
            >
              <codx-input
                [field]="item?.fieldName"
                type="combobox"
                [showSpinButton]="false"
                [multiple]="item?.multiselect"
                [refValue]="'Users'"
                [placeholder]="item?.note || ''"
                [crrValue]="item?.dataFormat ?? ''"
                [disabled]="true"
              ></codx-input>
              <span *ngIf="item.dataType == 'popup'" class="ms-2">
                <button
                  type="button"
                  class="btn btn-icon btn-light-primary"
                  [disabled]="true"
                >
                  <span class="icon-group_add icon-16"></span>
                </button>
              </span>
            </ng-container>
            <ng-container *ngIf="item?.controlType == 'Rank'">
              <div class="ratio-slider">
                <div class="icons-container">
                  <div
                    *ngFor="
                      let i of createRangeArray(
                        item?.rank?.minValue,
                        item?.rank?.maxValue
                      )
                    "
                  >
                    <div
                      [ngClass]="
                        item?.rank?.type == '2' ? item?.rank?.icon : 'icon'
                      "
                      [ngbTooltip]="item?.rank?.type == '2' ? i : null"
                      [attr.data-value]="i"
                      [ngStyle]="
                        item?.rank?.type == '2'
                          ? { color: item?.rank?.color, 'font-size': '20px' }
                          : ''
                      "
                    >
                      {{ item?.rank?.type == "1" ? i : "" }}
                    </div>
                  </div>
                </div>
                <input
                  type="range"
                  id="ratio"
                  [min]="item?.rank?.minValue"
                  [max]="item?.rank?.maxValue"
                  step="1"
                  [value]="item?.dataFormat || '0'"
                  [disabled]="true"
                />
              </div>
            </ng-container>
            <ng-container *ngIf="item?.controlType == 'Progress'">
              <div class="ratio-slider mt-5">
                <div class="icons-container progresspg">
                  <div [attr.data-value]="0">0%</div>
                  <div [attr.data-value]="100">100%</div>
                </div>
                <div
                  class="h-10px position-relative bg-gray-200 rounded-4 w-100"
                >
                  <div
                    class="rounded-4 h-10px"
                    [style.background-color]="item.rank?.color"
                    role="progressbar"
                    [style.width]="'50%'"
                    aria-valuenow="50"
                    aria-valuemin="0"
                    aria-valuemax="100"
                  ></div>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div> -->

<ng-container [ngSwitch]="subItem.controlType">
  <ng-container *ngSwitchCase="'Text'">
    <ng-container
      *ngTemplateOutlet="text; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'ValueList'">
    <ng-container
      *ngTemplateOutlet="valueList; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Combobox'">
    <ng-container
      *ngTemplateOutlet="combobox; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Datetime'">
    <ng-container
      *ngTemplateOutlet="datetime; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Attachment'">
    <ng-container
      *ngTemplateOutlet="attachment; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Number'">
    <ng-container
      *ngTemplateOutlet="text; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'YesNo'">
    <ng-container
      *ngTemplateOutlet="yesno; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'User'">
    <ng-container
      *ngTemplateOutlet="valueList; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Share'">
    <ng-container
      *ngTemplateOutlet="share; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Rank'">
    <ng-container
      *ngTemplateOutlet="rank; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Table'">
    <ng-container
      *ngTemplateOutlet="tables; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Progress'">
    <ng-container
      *ngTemplateOutlet="progress; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Email'">
    <ng-container
      *ngTemplateOutlet="text; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Address'">
    <ng-container
      *ngTemplateOutlet="text; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Expression'">
    <ng-container
      *ngTemplateOutlet="text; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchCase="'Phone'">
    <ng-container
      *ngTemplateOutlet="text; context: { $implicit: subItem }"
    ></ng-container>
  </ng-container>
  <ng-container *ngSwitchDefault>...</ng-container>
</ng-container>

<!-- Văn bản || Số -->
<ng-template #text let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ data.title }}</span>
    </div>
    <codx-input
      class="w-100 border mt-2 px-4 py-3 rd-3px"
      [field]="data?.fieldName"
      type="text"
      [require]="data?.isRequired"
      [placeholder]="data?.note || ''"
      [crrValue]="data?.dataFormat ?? ''"
      [disabled]="true"
    ></codx-input>
  </div>
</ng-template>

<!-- Danh sách || User-->
<ng-template #valueList let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>

    <div *ngIf="data?.controlType == 'ValueList'" class="mt-2">
      <lib-format-valuelist [item]="data"></lib-format-valuelist>
    </div>
    <div *ngIf="data?.controlType == 'User'">
      <div *ngIf="data?.dataType == 'P'">
        <button
          type="button"
          class="btn btn-sm btn-icon btn-light-primary d-flex align-items-center justify-content-between w-100 border mt-2 px-4 py-3 rd-3px"
          (click)="openPopup()"
        >
          <span class="icon-person_add_alt_1 icon-16"></span>
        </button>
        <ng-container *ngIf="isPopupUserCbb">
          <codx-combobox-popup
            [comboboxName]="'Users'"
            [field]="'cbbUser'"
            [multiple]="data.multiselect ?? false"
            [width]="700"
            [height]="600"
            [value]=""
            [formModel]="formModel"
            (clickSave)="valueChangePop($event)"
          >
          </codx-combobox-popup>
        </ng-container>
      </div>
    </div>
  </div>
</ng-template>

<!-- Combobox -->
<ng-template #combobox let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div
      class="d-flex align-items-center justify-content-between w-100 border mt-2 px-4 py-3 rd-3px"
    >
      <span class="text-muted text-truncate mw-55px">Câu trả lời</span>
      <i class="icon-i-plus-square text-dark"></i>
    </div>
  </div>
</ng-template>

<!-- DateTime -->
<ng-template #datetime let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <codx-input
      class="d-flex align-items-center justify-content-between w-100 border mt-2 px-4 py-3 rd-3px"
      [field]="data?.fieldName"
      type="datetime"
      [format]="data?.dataType"
      [placeholder]="data?.note || ''"
      [crrValue]="data?.dataFormat ?? ''"
      [disabled]="true"
    ></codx-input>
  </div>
</ng-template>

<!-- attachment -->
<ng-template #attachment let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div
      class="d-flex align-items-center justify-content-between w-100 border-dotted mt-2 px-4 py-8 rd-5px bd-w-2px bg-item-lightest bc-item-lighter"
    >
      <div class="d-flex flex-column">
        <span class="fw-bold">Chọn 1 file từ máy của bạn</span>
        <span class="text-muted">Kéo thả tài liệu vào đây</span>
      </div>
      <div
        class="d-flex align-items-center justify-content-between rounded bg-primary py-3 px-5"
      >
        <span class="text-white">Chọn tập tin</span>
        <img
          src="../../assets/themes/sys/default/img/BrowseLocal.svg"
          class="text-white ms-6"
        />
        <img
          src="../../assets/themes/sys/default/img/BrowseCoDX.svg"
          class="img-attachment-codx ms-3"
        />
      </div>
    </div>
  </div>
</ng-template>

<!-- yesno -->
<ng-template #yesno let-data>
  <div
    class="d-flex align-items-center justify-content-between w-100 form-switch ps-0"
  >
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <codx-input
      [field]="data?.fieldName"
      type="switch"
      *ngIf="data?.dataType == 's'"
      [showSpinButton]="false"
      [crrValue]="data?.dataFormat ?? false"
      [disabled]="true"
    ></codx-input>
    <div *ngIf="data?.dataType == 'c'">
      <codx-input
        id="yes"
        name="{{ data?.recID }} {{ data.fieldName }}"
        class="test-check me-3"
        type="radio"
        label="Yes"
        field="yes"
        [checked]="data?.dataFormat ?? false"
        [disabled]="true"
      ></codx-input>
      <codx-input
        id="no"
        name="{{ data?.recID }}{{ data.fieldName }}"
        class="test-check"
        type="radio"
        label="No"
        field="no"
        [checked]="!data?.dataFormat ?? false"
        [disabled]="true"
      ></codx-input>
    </div>
    <codx-input
      [field]="data?.fieldName"
      *ngIf="data?.dataType == 'checkbox'"
      type="checkbox"
      [showSpinButton]="false"
      [crrValue]="data?.dataFormat || false"
      [disabled]="true"
    ></codx-input>
  </div>
</ng-template>

<!-- Share -->
<ng-template #share let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div
      class="d-flex align-items-center justify-content-between w-100 border mt-2 px-4 py-3 rd-3px"
    >
      <span class="text-muted text-truncate mw-55px">Câu trả lời</span>
      <i class="icon-person_add_alt_1 text-primary"></i>
    </div>
  </div>
</ng-template>

<!-- Rank -->
<ng-template #rank let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div
      class="mt-2"
    >
      <div class="ratio-slider">
        <div class="icons-container">
          <div
            *ngFor="
              let i of createRangeArray(
                data?.rank?.minValue,
                data?.rank?.maxValue
              )
            "
          >
            <div
              [ngClass]="data?.rank?.type == '2' ? data?.rank?.icon : 'icon'"
              [ngbTooltip]="data?.rank?.type == '2' ? i : null"
              [attr.data-value]="i"
              [ngStyle]="
                data?.rank?.type == '2'
                  ? { color: data?.rank?.color, 'font-size': '20px' }
                  : ''
              "
            >
              {{ data?.rank?.type == "1" ? i : "" }}
            </div>
          </div>
        </div>
        <input
          type="range"
          id="ratio"
          [min]="data?.rank?.minValue"
          [max]="data?.rank?.maxValue"
          step="1"
          [value]="data?.dataFormat || '0'"
          [disabled]="true"
        />
      </div>
    </div>
  </div>
</ng-template>

<!-- Table -->
<ng-template #tables let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <table class="table table-bordered mt-2">
      <thead>
        <tr>
          <th scope="col">#</th>
          <th scope="col">First</th>
          <th scope="col">Last</th>
          <th scope="col">Handle</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">1</th>
          <td>Mark</td>
          <td>Otto</td>
          <td>@mdo</td>
        </tr>
        <tr>
          <th scope="row">2</th>
          <td>Jacob</td>
          <td>Thornton</td>
          <td>@fat</td>
        </tr>
        <tr>
          <th scope="row">3</th>
          <td colspan="2">Larry the Bird</td>
          <td>@twitter</td>
        </tr>
      </tbody>
    </table>
  </div>
</ng-template>

<!-- Progress -->
<ng-template #progress let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div class="ratio-slider mt-5">
      <div class="icons-container progresspg">
        <div [attr.data-value]="0">0%</div>
        <div [attr.data-value]="100">100%</div>
      </div>
      <div class="h-10px position-relative bg-gray-200 rounded-4 w-100">
        <div
          class="rounded-4 h-10px"
          [style.background-color]="data?.rank?.color"
          role="progressbar"
          [style.width]="'50%'"
          aria-valuenow="50"
          aria-valuemin="0"
          aria-valuemax="100"
        ></div>
      </div>
    </div>
  </div>
</ng-template>

<!-- Email -->
<ng-template #email let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div class="d-flex align-items-center justify-content-between w-100">
      <codx-input
        class="border mt-2 px-4 py-3 rd-3px"
        [field]="data?.fieldName"
        type="text"
        [require]="data?.isRequired"
        [placeholder]="data?.note || ''"
        [crrValue]="data?.dataFormat ?? ''"
        [disabled]="true"
      ></codx-input>
      <i class="icon-email text-dark"></i>
    </div>
  </div>
</ng-template>

<!-- Address -->
<ng-template #address let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div class="d-flex align-items-center justify-content-between w-100">
      <codx-input
        class="border mt-2 px-4 py-3 rd-3px"
        [field]="data?.fieldName"
        type="text"
        [require]="data?.isRequired"
        [placeholder]="data?.note || ''"
        [crrValue]="data?.dataFormat ?? ''"
        [disabled]="true"
      ></codx-input>
      <i class="icon-location_on text-dark"></i>
    </div>
  </div>
</ng-template>

<!-- Expression -->
<ng-template #expression let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div class="d-flex align-items-center justify-content-between w-100">
      <codx-input
        class="border mt-2 px-4 py-3 rd-3px"
        [field]="data?.fieldName"
        type="text"
        [require]="data?.isRequired"
        [placeholder]="data?.note || ''"
        [crrValue]="data?.dataFormat ?? ''"
        [disabled]="true"
      ></codx-input>
      <i class="icon-calculate text-dark"></i>
    </div>
  </div>
</ng-template>

<!-- Phone -->
<ng-template #phone let-data>
  <div class="d-flex flex-column w-100">
    <div class="d-flex align-items-center" *ngIf="isShowTextHeader">
      <i class="icon-grid_round me-2 cursor-move" cdkDragHandle></i>
      <span class="fw-bold">{{ subItem.title }}</span>
    </div>
    <div class="d-flex align-items-center justify-content-between w-100">
      <codx-input
        class="border mt-2 px-4 py-3 rd-3px"
        [field]="data?.fieldName"
        type="text"
        [require]="data?.isRequired"
        [placeholder]="data?.note || ''"
        [crrValue]="data?.dataFormat ?? ''"
        [disabled]="true"
      ></codx-input>
      <i class="icon-settings_phone text-dark"></i>
    </div>
  </div>
</ng-template>

<ng-template #tempValueList let-item>
  <lib-format-valuelist [item]="item"></lib-format-valuelist>
</ng-template>

<ng-template #empty>
  <div class="empty-data">
    <div class="container h-100">
      <div class="list-empty card card-flush h-100">
        <div class="d-flex flex-column flex-center justify-content-center">
          <img
            src="../assets/themes/sys/default/img/DataEmpty.svg"
            class="w-200px"
          />
          <div class="fs-5 text-dark fw-bold mt-2 text-center">
            {{ "BP011" | mssg | async }}
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
