<div class="page-questions pt-5" id="page-questions">
  <div class="d-flex w-100 justify-content-center">
    <div class="d-flex flex-column">
      <div class="box">
        <ng-container *ngIf="survey?.stop ;else elseStop">
          <div class="card-survey">
            <div class="control-section inplace-editor-control-section form-lafyout">
              <div class="content-wrapper b-t">
                <form id="formSession" class="form-horizontal example-box">
                  <div class="ms-6 title-des-index0 mb-5">
                    <span
                      *ngIf="itemSession.question"
                      [innerHTML]="itemSession.question"
                    ></span>
                    <span class="mt-5" *ngIf="!itemSession.question">Mẫu không có tiêu đề</span>
                    <div class="fs-6 mt-5">Khảo sát đã đóng.</div>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </ng-container>
        <ng-template #elseStop>
          <ng-container *ngIf="!isSent ;else tmpIsSent">
            <div *ngIf="itemSession">
              <div class="card-survey" [id]="'card-survey-' + itemSession.seqNo">
                <div
                  class="control-section inplace-editor-control-section form-lafyout"
                  id="inplace-editor-control"
                >
                  <div
                    [ngClass]="
                      itemSession.active
                        ? 'content-wrapper b-t b-l-session'
                        : 'content-wrapper b-t'
                    "
                  >
                    <form
                      id="formSession"
                      class="form-horizontal example-box"
                      *ngIf="itemSession.seqNo == 0"
                    >
                      <ng-container #body>
                        <ng-container
                          *ngTemplateOutlet="
                            template_card_session_index_0;
                            context: {
                              itemSession: itemSessionFirst
                            }
                          "
                        ></ng-container>
                      </ng-container>
                    </form>
                    <div *ngIf="itemSession.seqNo > 0">
                      <ng-container #body>
                        <form id="formSession" class="form-horizontal example-box">
                          <ng-container
                            *ngTemplateOutlet="
                              template_card_session_index_0;
                              context: {
                                itemSession: itemSessionFirst
                              }
                            "
                          ></ng-container>
                        </form>
                        <div class="formSession2 d-flex align-items-center b-t-index">
                          <span
                            *ngIf="itemSession.question"
                            style="color: white"
                            [innerHTML]="itemSession.question"
                          ></span>
                          <span *ngIf="!itemSession.question" style="color: white">
                            {{"Mẫu không có tiêu đề"}}</span>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </div>
              </div>
              <div class="list example-boundary">
                <div *ngFor="let itemQuestion of itemSession.children ; let i = index">
                  <div
                    class="card-survey"
                    [ngClass]="i==0?'div-f-c':''"
                    [id]="'card-survey-question-' + itemQuestion.recID"
                  >
                    <div
                      class="col-lg-8 control-section inplace-editor-control-section form-layout"
                      id="inplace-editor-control"
                    >
                      <div
                        [ngClass]="
                          itemQuestion.active
                            ? 'content-wrapper b-l'
                            : 'content-wrapper'
                        "
                      >
                        <form [id]="'formId'+itemQuestion.recID" class="formId form-horizontal example-box card-survey-question">
                          <ng-container #body>
                            <div *ngIf="itemQuestion.category == 'Q'">
                              <div *ngIf="!itemQuestion.showAnswer">
                                <ng-container
                                  *ngTemplateOutlet="
                                    template_card_question;
                                    context: {
                                      itemSession: itemSession,
                                      itemQuestion: itemQuestion
                                    }
                                  "
                                ></ng-container>
                              </div>
                              <div *ngIf="itemQuestion.showAnswer">
                                <ng-container
                                  *ngTemplateOutlet="
                                    template_card_question_showAnswer;
                                    context: {
                                      itemSession: itemSession,
                                      itemQuestion: itemQuestion
                                    }
                                  "
                                ></ng-container>
                              </div>
                            </div>
                            <div
                              *ngIf="
                                itemQuestion.category == 'P' ||
                                itemQuestion.category == 'V'
                              "
                              class="ms-6"
                            >
                              <ng-container
                                *ngTemplateOutlet="
                                  template_card_image_video;
                                  context: {
                                    itemSession: itemSession,
                                    itemQuestion: itemQuestion
                                  }
                                "
                              ></ng-container>
                            </div>
                            <div *ngIf="itemQuestion.category == 'T'" class="ms-6">
                              <ng-container
                                *ngTemplateOutlet="
                                  template_card_title;
                                  context: {
                                    itemSession: itemSession,
                                    itemQuestion: itemQuestion
                                  }
                                "
                              ></ng-container>
                            </div>
                          </ng-container>
                          <ng-container
                            #footer
                            *ngIf="
                              (itemQuestion?.active &&
                                !itemQuestion?.showAnswer &&
                                itemQuestion.category == 'Q') ||
                              itemQuestion.category == 'R' ||
                              itemQuestion.category == 'O2' ||
                              itemQuestion.category == 'C2'
                            "
                          >
                            <hr />
                            <div class="row pt-6 ps-3 pe-3 pb-3">
                              <div
                                class="col-md-8 d-flex justify-content-start pointer"
                              >
                                <span
                                  class="icon-check-correct icon-24 primary"
                                  ngbPopover="Đáp án và điểm"
                                  triggers="mouseenter:mouseleave"
                                  placement="bottom"
                                  [autoClose]="'outside'"
                                ></span>
                                &nbsp;
                                <codx-label
                                  fiedName="Answer"
                                  default="Đáp án"
                                  class="primary"
                                  [formModel]="formModel"
                                ></codx-label>
                                <span>
                                  &nbsp; (&nbsp; {{ itemQuestion.scores }} &nbsp;
                                  <codx-label
                                    fiedName="Scores"
                                    default="điểm"
                                    class=""
                                    [formModel]="formModel"
                                  ></codx-label>
                                  )
                                </span>
                              </div>
                              <div class="col-md-4 d-flex justify-content-end">
                                <span
                                  class="icon-content_copy icon-24 pd-10 btn btn-icon btn-active-light-primary position-relative"
                                ></span>
                                <span
                                  class="icon-delete_outline icon-24 pd-10 btn btn-icon btn-active-light-primary position-relative"
                                ></span>
                                <span class="split"></span>
                                <codx-label
                                  fiedName=""
                                  default="Bắt buộc"
                                  class="pd-10"
                                ></codx-label>
                                <codx-input
                                  type="switch"
                                  class="pd-t-10"
                                  [crrValue]="itemQuestion.mandatory"
                                ></codx-input>
                                <div ngbDropdown class="dropdown" container="body">
                                  <a
                                    href="javascript:void(0)"
                                    class="btn btn-clean btn-hover-light-primary btn-sm btn-icon"
                                    ngbDropdownToggle
                                    id="dropdownMenuButton1"
                                    aria-expanded="false"
                                  >
                                    <span
                                      class="icon-more_vert icon-24 pd-10 btn btn-icon btn-active-light-primary position-relative"
                                    >
                                    </span>
                                  </a>
                                  <ul
                                    ngbDropdownMenu
                                    aria-labelledby="dropdownMenuButton1"
                                    class="MF"
                                  >
                                    <li>
                                      <a
                                        ngbDropdownItem
                                        href="javascript:void(0)"
                                        class="mt-30px"
                                      >
                                        <div class="d-flex">
                                          <span
                                            *ngIf="itemQuestion?.hideComment"
                                            class="icon-check icon-24 ps-6 pe-6"
                                          ></span>
                                          <codx-label
                                            fiedName="formatAlignLeft"
                                            default="Mô tả"
                                          ></codx-label>
                                        </div>
                                      </a>
                                    </li>
                                  </ul>
                                </div>
                              </div>
                            </div>
                          </ng-container>
                          <div
                            #footer_active_showAnswer
                            *ngIf="itemQuestion?.active && itemQuestion?.showAnswer"
                          >
                            <hr />
                            <div class="d-flex justify-content-end pe-6 pb-6 pt-6">
                              <button type="button" class="btn btn-primary">
                                <codx-label
                                  fiedName="Done"
                                  default="Xong"
                                ></codx-label>
                              </button>
                            </div>
                          </div>
                          <div [id]="'formError'+itemQuestion.recID" class="formError">
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-flex justify-content-start mb-5" #footer>
                <button
                  *ngIf="itemSession.seqNo > 0"
                  type="button"
                  class="btn btn-submit-white text-purple me-6"
                  (click)="continue(itemSession.seqNo - 1)"
                >
                  <codx-label fiedName="Back" default="Quay lại" class="text-bolder"></codx-label>
                </button>
                <button
                  *ngIf="itemSession.seqNo != questions.length - 1"
                  type="button"
                  class="btn btn-submit-white text-purple"
                  (click)="continue(itemSession.seqNo + 1)"
                >
                  <codx-label fiedName="lblContinue" default="Tiếp" class="text-bolder" formName="fmReview"></codx-label>
                </button>
                <button
                  *ngIf="itemSession.seqNo == questions.length - 1"
                  type="button"
                  class="btn btn-submit text-white"
                  (click)="onSubmit()"
                >
                  <codx-label fiedName="Sumbit" default="Gửi"></codx-label>
                </button>
              </div>
            </div>
          </ng-container>
        </ng-template>
      </div>
    </div>
  </div>
</div>

<ng-template #tmpIsSent>
  <div class="card-survey">
    <div class="control-section inplace-editor-control-section form-lafyout">
      <div class="content-wrapper b-t">
        <form id="formSession" class="form-horizontal example-box">
          <div class="ms-6 title-des-index0 mb-5">
            <span
              *ngIf="itemSession.question"
              [innerHTML]="itemSession.question"
            ></span>
            <span class="mt-5" *ngIf="!itemSession.question">Mẫu không có tiêu đề</span>
            <div class="fs-6 mt-5">Câu trả lời của bạn đã được ghi lại.</div>
          </div>
        </form>
      </div>
    </div>
  </div>
</ng-template>

<ng-template
  #tempIconAnswers
  let-seqNoSession="seqNoSession"
  let-itemQuestion="itemQuestion"
  let-itemAnswer="itemAnswer"
>
  <div>
    <span *ngIf="itemQuestion.answerType == 'L' && itemAnswer" class="pd-t-7"
      >{{ itemAnswer?.seqNo + 1 }}.</span
    >
    <span *ngIf="itemQuestion.answerType == 'L' && !itemAnswer" class="pd-t-7"
      >{{
        questions[seqNoSession].children[itemQuestion.seqNo].answers.length + 1
      }}.</span
    >
  </div>
</ng-template>

<ng-template
  #tempAnswers
  let-seqNoSession="seqNoSession"
  let-itemQuestion="itemQuestion"
  let-itemAnswer="itemAnswer"
>
  <div class="e-input-group" *ngIf="itemQuestion.answerType == 'O'">
    <codx-input
      *ngIf="!itemAnswer.other"
      type="radio"
      labelPosition="After"
      [disabled]="false"
      class="test-check"
      [name]="seqNoSession+itemQuestion?.recID"
      [label]="itemAnswer.answer"
      field="O"
      [crrValue]="itemAnswer.answer"
      (valueChange)="valueChange($event, itemSession, itemQuestion, itemAnswer)"
    ></codx-input>
    <div class="d-flex align-items-center " *ngIf="itemAnswer.other">
      <codx-input
        type="radio"
        labelPosition="After"
        [disabled]="false"
        class="test-check"
        [name]="seqNoSession+itemQuestion?.recID"
        [label]="'Mục khác:'"
        field="O"
        [checked]="itemAnswer.choose"
        (valueChange)="
          valueChange($event, itemSession, itemQuestion, itemAnswer)
        "
        [style.width]="'125px'"
      ></codx-input>
      <codx-input
        type="text"
        class="border-0 h-20px"
        [crrValue]="itemAnswer.answer"
        field="O"
        (valueChange)="
          valueChange($event, itemSession, itemQuestion, itemAnswer)
        "
        [ngClass]="'w-100'"
      >
      </codx-input>
    </div>
  </div>
  <div class="e-input-group" *ngIf="itemQuestion.answerType == 'C'">
    <codx-input
      type="checkbox"
      labelPosition="After"
      [disabled]="false"
      class="test-check"
      [label]="itemAnswer.answer"
      field="C"
     
      (valueChange)="valueChange($event, itemSession, itemQuestion, itemAnswer)"
    ></codx-input>
  </div>
  <div
    class="e-input-group w-200px"
    *ngIf="itemQuestion.answerType == 'T'"
  >
    <!-- <input #input
      class="e-input"
      type="text"
      (focus)="focusIn($event.target)"
      (blur)="focusOut($event.target)"
      [value]="itemAnswer.answer"
      (change)="valueChange(input, itemSession, itemQuestion, itemAnswer, 'T')"
    /> -->
    <codx-input
      type="text"
      class="border-0"
      [crrValue]="getValue(seqNoSession, itemQuestion.seqNo, itemAnswer.seqNo)"
      field="T"
      (valueChange)="valueChange($event, itemSession, itemQuestion, itemAnswer)"
    >
    </codx-input>
  </div>
  <div
    class="e-input-group long-text me-8"
    *ngIf="itemQuestion.answerType == 'T2'"
  >
    <codx-input
      format="ed2"
      [class]="'border-0'"
      type="textarea"
      class="test-textarea"
      ngDefaultControl
      rows="auto"
      [crrValue]="getValue(seqNoSession, itemQuestion.seqNo, itemAnswer.seqNo)"
      field="T2"
      (valueChange)="valueChange($event, itemSession, itemQuestion, itemAnswer)"
    >
    </codx-input>
  </div>
  <div *ngIf="itemQuestion.answerType == 'R'">
    <table>
      <tr>
        <th scope="col">
          <span>{{ "1" }}</span>
        </th>
        <th scope="col">
          <span>{{ "2" }}</span>
        </th>
        <th scope="col">
          <span>{{ "3" }}</span>
        </th>
        <th scope="col">
          <span>{{ "4" }}</span>
        </th>
        <th scope="col">
          <span>{{ "5" }}</span>
        </th>
      </tr>
      <tr>
        <th scope="col">
          <codx-input
            type="radio"
            [disabled]="false"
            class="test-check"
            name="group"
          ></codx-input>
        </th>
        <th scope="col">
          <codx-input
            type="radio"
            [disabled]="false"
            class="test-check"
            name="group"
          ></codx-input>
        </th>
        <th scope="col">
          <codx-input
            type="radio"
            [disabled]="false"
            class="test-check"
            name="group"
          ></codx-input>
        </th>
        <th scope="col">
          <codx-input
            type="radio"
            [disabled]="false"
            class="test-check"
            name="group"
          ></codx-input>
        </th>
        <th scope="col">
          <codx-input
            type="radio"
            [disabled]="false"
            class="test-check"
            name="group"
          ></codx-input>
        </th>
      </tr>
    </table>
  </div>
  <div class="ms-6" *ngIf="itemQuestion.answerType == 'D'">
    <codx-input
      type="datetime"
      format="d"
      class="test-datetime"
      [crrValue]="getValue(seqNoSession, itemQuestion.seqNo, itemAnswer.seqNo)"
      field="D"
      (valueChange)="valueChange($event, itemSession, itemQuestion, itemAnswer)"
    ></codx-input>
  </div>
  <div class="d-flex ms-6" *ngIf="itemQuestion.answerType == 'H'">
    <codx-input
      type="datetime"
      format="t"
      class="test-datetime"
      [crrValue]="getValue(seqNoSession, itemQuestion.seqNo, itemAnswer.seqNo)"
      field="H"
      (valueChange)="valueChange($event, itemSession, itemQuestion, itemAnswer)"
    ></codx-input>
  </div>
</ng-template>

<ng-template
  #tempAnswers_showAnswer
  let-seqNoSession="seqNoSession"
  let-itemQuestion="itemQuestion"
  let-itemAnswer="itemAnswer"
>
  <div class="d-flex pb-8">
    <div
      [ngClass]="
        input_check?.value ? 'e-input-group bg-active' : 'e-input-group'
      "
      *ngIf="
        itemQuestion.answerType == 'O' ||
        itemQuestion.answerType == 'C' ||
        itemQuestion.answerType == 'L'
      "
    >
      <codx-input
        #input_check
        id="input_check{{ itemAnswer.seqNo }}"
        class="check-circle"
        [checked]="itemAnswer?.check"
        [label]="itemAnswer.answer"
        type="checkbox"
        field="check"
      >
      </codx-input>
    </div>
    <div
      class="e-input-group short-text"
      *ngIf="itemQuestion.answerType == 'T'"
    >
      <input
        class="e-input"
        type="text"
        placeholder="Văn bản câu trả lời ngắn"
        (focus)="focusIn($event.target)"
        (blur)="focusOut($event.target)"
        [disabled]="false"
      />
    </div>
    <div
      class="e-input-group long-text"
      *ngIf="itemQuestion.answerType == 'T2'"
    >
      <input
        class="e-input"
        type="text"
        placeholder="Văn bản câu trả lời dài"
        (focus)="focusIn($event.target)"
        (blur)="focusOut($event.target)"
        [disabled]="false"
      />
    </div>
    <div class="e-input-group date-time" *ngIf="itemQuestion.answerType == 'D'">
      <input
        class="e-input"
        type="text"
        placeholder="Ngày, tháng, năm"
        (focus)="focusIn($event.target)"
        (blur)="focusOut($event.target)"
        [disabled]="true"
      />
    </div>
    <div class="e-input-group date-time" *ngIf="itemQuestion.answerType == 'H'">
      <input
        class="e-input"
        type="text"
        placeholder="Giờ"
        (focus)="focusIn($event.target)"
        (blur)="focusOut($event.target)"
        [disabled]="true"
      />
    </div>
    <div *ngIf="itemQuestion.answerType == 'R'"></div>
    <ng-container #iconRight> </ng-container>
  </div>
</ng-template>

<ng-template
  #template_card_question
  let-itemSession="itemSession"
  let-itemQuestion="itemQuestion"
>
  <div class="d-flex w-100">
    <div #header class="w-100">
      <div class="form-group question w-100 mt-3 ms-6">
        <div
          class="d-flex align-items-center"
          [ngClass]="
            itemQuestion?.active ? 'title-des title-des-hover' : 'title-des'
          "
        >
          <span
            *ngIf="itemQuestion.question"
            [innerHTML]="itemQuestion.question"
          ></span>
          <span *ngIf="!itemQuestion.question">{{ "Câu hỏi" }}</span>
          <span *ngIf="itemQuestion.mandatory" class="text-danger ms-2">*</span>
        </div>
      </div>
      <div class="form-group question w-100" *ngIf="itemQuestion.hideComment">
        <div class="title-des">
          <span
            *ngIf="itemQuestion.comment"
            [innerHTML]="itemQuestion.comment"
          ></span>
          <span *ngIf="!itemQuestion.comment">{{ "Mô tả" }}</span>
        </div>
      </div>
    </div>
    <ng-container #questionMF *ngIf="itemQuestion?.active">
      <span class="icon-image icon-26 pointer"></span>
    </ng-container>
  </div>
  <div #contentByImage *ngIf="itemQuestion?.qPicture && lstEditIV.length > 0">
    <div *ngFor="let item of lstEditIV">
      <div
        class="w-100 min-h-253px mb-6"
        *ngIf="item.objectID == itemQuestion.recID"
      >
        <!-- [ngClass]="
            itemQuestion?.alignCenterImg
              ? 'position-relative w-100 d-flex justify-content-center'
              : itemQuestion?.alignRightImg
              ? 'position-relative w-100 d-flex justify-content-end'
              : 'position-relative w-100 d-flex'
          " -->
        <div class="position-relative w-100 d-flex justify-content-center bg-q-img px-6">
          <img [src]="getSrcImage(item)" />
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="(itemQuestion.answerType == 'O2' || itemQuestion.answerType == 'C2') ; else tmpL">
    <table>
      <tr>
        <th scope="col" class="w-20"></th>
        <th
          *ngFor="let itemC of filterDataColumn(itemQuestion.answers)"
          scope="col"
        >
          <span>{{ itemC.answer }}</span>
        </th>
      </tr>
      <tr *ngFor="let itemR of filterDataRow(itemQuestion.answers)">
        <td>
          {{ itemR.answer }}
        </td>
        <td *ngFor="let itemC of filterDataColumn(itemQuestion.answers)">
          <codx-input
            *ngIf="itemQuestion.answerType == 'O2'"
            type="radio"
            labelPosition="After"
            [disabled]="false"
            class="test-check"
            name="group"
          ></codx-input>
          <codx-input
            *ngIf="itemQuestion.answerType == 'C2'"
            class="check-circle"
            type="checkbox"
            field="check"
          >
          </codx-input>
        </td>
      </tr>
    </table>
  </div>
  <ng-template #tmpL>
    <ng-container *ngIf="itemQuestion.answerType == 'L' ; else tmpO">
      <!-- //(change)="valueChange($event.target.value, itemSession, itemQuestion, item)" -->
      <select class="form-select w-200px ms-6 rounded" aria-label="Default select example" (change)="valueChange( $event, itemSession, itemQuestion, $event.target.value)"> 
        <option selected >Chọn</option>
        <option *ngFor="let item of itemQuestion.answers" [value]="item.answer">{{item.answer}}</option>
      </select>
    </ng-container>
  </ng-template>
  <ng-template #tmpO>
    <div class="list answer ms-6">
      <div class="box" *ngFor="let itemAnswer of itemQuestion.answers">
        <div class="has-action-menu">
          <div class="d-flex">
            <div class="d-flex size-input py-2">
              <ng-container
                *ngTemplateOutlet="
                  tempIconAnswers;
                  context: {
                    seqNoSession: itemSession.seqNo,
                    itemQuestion: itemQuestion,
                    itemAnswer: itemAnswer
                  }
                "
              ></ng-container>
              <ng-container
                *ngTemplateOutlet="
                  tempAnswers;
                  context: {
                    seqNoSession: itemSession.seqNo,
                    itemQuestion: itemQuestion,
                    itemAnswer: itemAnswer
                  }
                "
              ></ng-container>
            </div>
          </div>
          <div #imageInlineAnswer *ngIf="itemAnswer.hasPicture">
            <div *ngFor="let item of lstEditIV" class="ms-12 mt-3">
              <div
                *ngIf="item.objectID == itemAnswer.recID"
                class="position-relative has-action-menu"
              >
                <img
                  class="w-100px border-gray"
                  [src]="getSrcImage(item)"
                  alt=""
                />
                <span
                  class="icon-close icon-20 icon-MF-image-outside-answer action-menu pointer"
                ></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</ng-template>

<ng-template
  #template_card_question_showAnswer
  let-itemSession="itemSession"
  let-itemQuestion="itemQuestion"
>
  <div class="pb-6">
    <div #header class="d-flex pb-6">
      <span class="icon-check-correct icon-24 ps-6 pe-3"></span>
      <codx-label
        class="fs-18px"
        fiedName="ChooseAnswer"
        default="Chọn câu trả lời chính xác:"
      ></codx-label>
    </div>
    <hr />
    <div class="d-flex pt-6">
      <div #content class="form-group ps-3 w-540px">
        <div [ngClass]="'title-des'">
          <span *ngIf="itemQuestion.question">{{ itemQuestion.question }}</span>
          <span *ngIf="!itemQuestion.question">{{ "Câu hỏi" }}</span>
        </div>
      </div>
      <div class="justify-content-center align-items-center d-flex">
        <div class="h-50px w-95px">
          <codx-input
            type="number"
            onkeypress="event.charCode >= 48 && event.charCode <= 57"
            field="scores"
            class="form-control"
            [crrValue]="itemQuestion.scores"
            placeholder="0"
          >
          </codx-input>
        </div>
        <codx-label fiedName="Scores" default="điểm" class="ps-3"></codx-label>
      </div>
    </div>
  </div>
  <div #contentByImage *ngIf="itemQuestion?.qPicture">
    <div *ngFor="let item of lstEditIV">
      <div class="w-100" *ngIf="item.objectID == itemQuestion.recID">
        <div
          [ngClass]="
            itemQuestion?.alignCenterImg
              ? 'position-relative w-100 d-flex justify-content-center'
              : itemQuestion?.alignRightImg
              ? 'position-relative w-100 d-flex justify-content-end'
              : 'position-relative w-100 d-flex'
          "
        >
          <img [src]="getSrcImage(item)" />
        </div>
      </div>
    </div>
  </div>
  <div
    *ngIf="
      (itemQuestion.answerType == 'O2' || itemQuestion.answerType == 'C2') &&
      itemQuestion?.active
    "
    class="w-700 pt-6 ps-6"
  ></div>

  <div
    *ngIf="
      (itemQuestion.answerType == 'O2' || itemQuestion.answerType == 'C2') &&
      !itemQuestion?.active
    "
  >
    <table>
      <tr>
        <th scope="col" class="w-20"></th>
        <th
          *ngFor="let itemC of filterDataColumn(itemQuestion.answers)"
          scope="col"
        >
          <span>{{ itemC.answer }}</span>
        </th>
      </tr>
      <tr *ngFor="let itemR of filterDataRow(itemQuestion.answers)">
        <td>
          {{ itemR.answer }}
        </td>
        <td *ngFor="let itemC of filterDataColumn(itemQuestion.answers)">
          <span
            class="icon-radio_button_unchecked icon-radio ms-6"
            *ngIf="itemQuestion.answerType == 'O2'"
          ></span>
          <span
            class="icon-check_box_outline_blank"
            *ngIf="itemQuestion.answerType == 'C2'"
          ></span>
        </td>
      </tr>
    </table>
  </div>
  <div
    *ngIf="itemQuestion.answerType != 'O2' || itemQuestion.answerType != 'C2'"
    class="list answer ps-8 pt-3 pb-6"
  >
    <div *ngFor="let itemAnswer of itemQuestion.answers">
      <ng-container
        *ngTemplateOutlet="
          tempAnswers_showAnswer;
          context: {
            seqNoSession: itemSession.seqNo,
            itemQuestion: itemQuestion,
            itemAnswer: itemAnswer
          }
        "
      ></ng-container>
      <div #imageInlineAnswer *ngIf="itemAnswer.hasPicture">
        <div *ngFor="let item of lstEditIV">
          <img
            class="w-100px"
            [src]="getSrcImage(item)"
            alt=""
            *ngIf="item.objectID == itemAnswer.recID"
          />
        </div>
      </div>
    </div>
    <div
      class="d-flex size-input-other"
      *ngIf="
        (itemQuestion?.active && itemQuestion.answerType == 'O') ||
        itemQuestion.answerType == 'C'
      "
    ></div>
  </div>
</ng-template>

<ng-template
  #template_card_image_video
  let-itemSession="itemSession"
  let-itemQuestion="itemQuestion"
>
  <div class="d-flex">
    <div class="form-group question w-100">
      <div class="title-des d-flex">
        <span>{{ "Câu hỏi hình ảnh video" }}</span>
      </div>
    </div>
  </div>
  <ng-container #editImage>
    <div class="position-relative">
      <div
        class="row mt-2 justify-content-between pd-10"
        *ngIf="
          lstEditIV.length > 0 && !itemQuestion.url && !itemQuestion.videoID
        "
      >
        <ng-container *ngFor="let data of lstEditIV">
          <div
            class="col-5 my-2 m-w-100"
            *ngIf="data.objectID == itemQuestion.recID"
          >
            <div class="w-150">
              <ng-container *ngIf="data.referType == REFER_TYPE.IMAGE">
                <ng-container
                  *ngIf="data.recID || data.objectID; else imageSrc"
                >
                  <codx-img
                    [objectId]="data.objectID"
                    [objectType]="functionList.entityName"
                    [width]="150"
                    cssClass="pic"
                    imageType="square"
                    referType="image"
                  >
                  </codx-img>
                </ng-container>
                <ng-template #imageSrc>
                  <img [src]="data.avatar || data.data" alt="" />
                </ng-template>
              </ng-container>
              <ng-container *ngIf="data.referType == REFER_TYPE.VIDEO">
                <video #video controls class="w-100 rounded h-auto">
                  <source [src]="data?.srcVideo" type="video/mp4" />
                </video>
              </ng-container>
            </div>
          </div>
        </ng-container>
      </div>
      <div *ngIf="itemQuestion.url && itemQuestion.videoID">
        <iframe
          width="100%"
          height="380"
          [src]="itemQuestion.url"
          frameborder="0"
          allowfullscreen
        ></iframe>
      </div>
    </div>
  </ng-container>
</ng-template>

<ng-template
  #template_card_title
  let-itemSession="itemSession"
  let-itemQuestion="itemQuestion"
>
  <div class="d-flex">
    <div class="form-group question w-100">
      <div class="title-des d-flex">
        <span *ngIf="itemQuestion.question">{{ itemQuestion.question }}</span>
        <span *ngIf="!itemQuestion.question">{{ "Câu hỏi" }}</span>
      </div>
    </div>
  </div>
  <div class="form-group question">
    <div class="title-des">
      <span *ngIf="itemQuestion.comment">{{ itemQuestion.comment }}</span>
      <span *ngIf="!itemQuestion.comment">{{ "Mô tả (không bắt buộc)" }}</span>
    </div>
  </div>
</ng-template>

<ng-template #template_card_session_index_0 let-itemSession="itemSession">
  <div class="d-flex">
    <div class="ms-6">
      <div
        [ngClass]="itemSession.seqNo == 0 ? 'title-des-index0' : 'title-des'"
      >
        <span
          *ngIf="itemSession.question"
          [innerHTML]="itemSession.question"
        ></span>
        <span *ngIf="!itemSession.question">{{ "Mẫu không có tiêu đề" }}</span>
      </div>
    </div>
  </div>
  <div class="form-group ms-6">
    <div class="title-des">
      <span
        *ngIf="itemSession.comment"
        [innerHTML]="itemSession.comment"
      ></span>
     
    </div>
  </div>
  <div class="d-flex align-items-center mt-3 border-top py-3">
    <span class="ms-6 icon-i-eye-slash icon-24"></span>
    <span class="ms-3">{{ user?.email ? user?.email : "Guest" }}</span>
  </div>
</ng-template>

<ng-template #template_card_session let-itemSession="itemSession">
  <div class="ms-6 w-100">
    <div class="d-flex w-100">
      <div class="form-group question w-100" style="margin-top: -50px">
        <div class="title-des d-flex">
          <span
            *ngIf="itemSession.question"
            style="color: white"
            [innerHTML]="itemSession.question"
          ></span>
          <span *ngIf="!itemSession.question" style="color: white">{{
            "Mẫu không có tiêu đề"
          }}</span>
        </div>
      </div>
    </div>
    <div class="form-group question">
      <div class="title-des">
        <span
          *ngIf="itemSession.comment"
          [innerHTML]="itemSession.comment"
        ></span>
      </div>
    </div>
  </div>
</ng-template>

