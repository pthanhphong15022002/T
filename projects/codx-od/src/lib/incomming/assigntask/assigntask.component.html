<div class="card w-100 h-100 rounded-0 border-0">
    <div class="card-header pe-5">
        <div class="card-title">
            <div class="d-flex flex-column">
                <h2 class="m-0">Giao việc</h2>
                <div class="text-gray-400 fs-7"></div>
            </div>
        </div>
        <div class="card-toolbar">
            <button type="button" class="btn btn-sm btn-icon btn-active-color-primary h-40px w-40px me-n6"
                id="kt_engage_demos_close" (click)="close()">
                <span class="icon-close icon-18"></span>
            </button>
        </div>
    </div>
    <div class="card-body">
        <div class="request-to">
            <div class="d-flex justify-content-between mb-2 p-2">
                <div class="d-flex align-items-center flex-grow-1">
                    <div class="w-100px">Người giao việc:</div>
                    <div class="d-flex align-items-center me-2 mail-user">
                        <div class="symbol symbol-20px symbol-circle me-2">
                            <codx-img #image [objectId]="user.userID"></codx-img>
                        </div>
                        <div class="text-dark-75">{{user.userName}}</div>
                    </div>
                </div>

                <!-- <div class="d-flex align-items-center flex-grow-1">
                    <div class="w-110px fw-bold">Người giao việc:</div>                                        
                    <codx-input
                        style="width:90%"
                        [refValue]="gridViewSetup['Owner']['referedValue']"
                        type="combobox"                      
                        (valueChange)="changeValueChangeFrom($event)"
                        [multiple]="true"
                    >
                    </codx-input>    
                </div> -->
            </div>
            <div class="d-flex justify-content-between p-2">
                <div class="d-flex align-items-center justify-content-start flex-grow-1">
                    <div class="w-100px fw-bold">Giao cho:</div>
                    <div class="d-flex align-items-center w-100">
                        <!-- <div ngbDropdown class="dropdown u-list-item" *ngFor="let item of lstUser">
                            <div class="d-flex align-items-center flex-grow-1">                            
                                <div class="d-flex align-items-center me-2">
                                    <div class="symbol symbol-35px symbol-circle me-2">
                                        <codx-img #image [objectId]="item"></codx-img>
                                        <span class="symbol-20px symbol-badge badge badge-circle bg-success top-100 start-100 text-white">A</span>
                                    </div>
                                    <div class="d-flex flex-column">
                                        <div class="text-dark">{{item}}</div>
                                        <div class="text-gray-600 fs-7">Phân tích nghiệp vụ</div>
                                    </div>
                                </div>
                                <div class="div-action-menu-2">
                                    <div class="action-menu d-flex">
                                      <div class="action-content d-flex align-items-center">
                                        <a class="action-item" *ngFor="let item of this.roles">
                                          <div class="d-flex align-items-center btn-tooltip" >
                                            <span class="badge badge-circle badge-light me-1 fs-7" [style.color]="item.textColor">{{item.value}}</span>
                                            <span class="tooltiptext">{{item.text}}</span>
                                          </div>
                                        </a>
                                      </div>
                                    </div>
                                  </div>
                            </div>
                            <od-assignSubMenu></od-assignSubMenu>  
                        </div>  -->
                        <codx-input [refValue]="gridViewSetup!=null?gridViewSetup['Owner']['referedValue']:null"
                            placeholder="Chọn tài khoản" type="combobox" style="width:100%"
                            (valueChange)="changeValueChangeTo($event)">
                        </codx-input>
                    </div>

                    <!-- <div class="d-flex justify-content-between border-bottom" >
                        <div ngbDropdown class="dropdown">
                            <div ngbDropdownToggle id="dropdownMenuButton1"
                                aria-expanded="false">
                                <div class="d-flex align-items-center flex-grow-1">                            
                                    <div class="d-flex align-items-center me-2">
                                        <div class="symbol symbol-20px symbol-circle me-2">
                                            <codx-img #image objectId="ADMIN"></codx-img>
                                        </div>
                                        <div class="d-flex flex-column">
                                            <div class="text-dark">Trần Hoàng Nam</div>
                                            <div class="text-gray-600 fs-7">Phân tích nghiệp vụ</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <od-assignSubMenu></od-assignSubMenu>                          
                        </div> 
                    </div>                                   -->
                </div>

                <span class="btn btn-icon btn-light-primary">
                    <span class="icon-connection-point icon-18"></span>
                </span>
            </div>
        </div>
        <div class="d-flex justify-content-end me-2">
            <!-- <codx-input type="valuelist" refValue="TM001"           
                placeholder="" style="width:100%">  
            </codx-input> -->
            <ng-container *ngIf="this.roles != null">
                <div *ngFor="let item of this.roles">
                    <div class="d-flex align-items-center ms-4" [style.backgroundColor]="item.color">
                        <span class="symbol  badge badge-circle-20px badge-light  me-1 fs-9"
                            [style.color]="item.textColor">{{item.value}}</span>
                        <div class="fs-8 text-gray-500">{{item.text}}</div>
                    </div>
                </div>
            </ng-container>
            <!-- <div class="d-flex align-items-center ms-4">
                <codx-img #image objectId="ADMIN" class="w-15px h-15px r-5px"></codx-img>
                <div class="fs-7 text-gray-500">Chịu trách nhiệm</div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <codx-img #image objectId="ADMIN" class="w-15px h-15px r-5px"></codx-img>
                <div class="fs-7 text-gray-500">Thực hiện</div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <codx-img #image objectId="ADMIN" class="w-15px h-15px r-5px"></codx-img>
                <div class="fs-7 text-gray-500">Thông báo</div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <codx-img #image objectId="ADMIN" class="w-15px h-15px r-5px"></codx-img>
                <div class="fs-7 text-gray-500">Tư vấn</div>
            </div> -->
        </div>
        <div class="d-flex justify-content-between mb-2 p-2">
            <div class="d-flex align-items-center flex-grow-1">
                <div class="w-100px">Công việc:</div>
                <div class="d-flex align-items-center w-100">
                    <codx-input type="text" style="width:100%" (valueChange)="changeValueSubject($event)"></codx-input>
                </div>
            </div>

            <!-- <div class="d-flex align-items-center flex-grow-1">
                <div class="w-110px fw-bold">Người giao việc:</div>                                        
                <codx-input
                    style="width:90%"
                    [refValue]="gridViewSetup['Owner']['referedValue']"
                    type="combobox"                      
                    (valueChange)="changeValueChangeFrom($event)"
                    [multiple]="true"
                >
                </codx-input>    
            </div> -->
        </div>
        <div class="d-flex justify-content-between  mb-2 p-2">
            <!-- <div class="fw-bold">Công việc:</div>
            <div class="d-flex align-items-center flex-grow-1">
                <input class="form-control borderless" type="text" placeholder="Nhập lý do" />
            </div>
            <div class="dropdown">
                <button class="btn btn-xs btn-secondary d-flex align-items-center border-0 dropdown-toggle height"
                    type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false">
                    <span>Mail mẫu</span>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <a class="dropdown-item">
                        <div class="d-flex flex-column">
                            <span class="text-dark">Cấp quyền xem tài liệu</span>
                            <i class="tex font-size-sm mt-1">Xin cấp quyền full xem tài liệu</i>
                        </div>
                    </a>
                    <div class="subheader-separator subheader-separator-ver mt-1 ms-1 bg-gray-400"></div>
                    <a class="dropdown-item">
                        <span class="text-primary">Thêm mẫu mail</span>
                    </a>
                </div>
            </div> -->
        </div>
        <div class="p-2">
            <codx-attachment #attachment type="center" objectType="WP_Notes" objectId="628c326c590addf224627f42"
                hideBtnSave="1" popup="0" hideFolder="1" hideUploadBtn="1" functionID="WPT03941"
                (fileAdded)="fileAdded($event)"></codx-attachment>
            <codx-thumbnail [files]="data.files"></codx-thumbnail>
        </div>
        <div class="form-group mt-3 p-2">
            <div class="d-flex align-items-center justify-content-between">
                <label>Nội dung chi tiết</label>
                <div class="dropdown">
                    <button class="btn btn-xs btn-secondary d-flex align-items-center border-0 dropdown-toggle"
                        type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">
                        <span>Chon trường dữ liệu</span>
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item">
                            <div class="d-flex flex-column">
                                <span class="text-dark">Cấp quyền xem tài liệu</span>
                                <i class="tex font-size-sm mt-1">Xin cấp quyền full xem tài liệu</i>
                            </div>
                        </a>
                        <div class="subheader-separator subheader-separator-ver mt-1 ms-1 bg-gray-400">
                        </div>
                        <a class="dropdown-item">
                            <span class="text-primary">Thêm mẫu mail</span>
                        </a>
                    </div>
                </div>
            </div>
            <codx-input type="textarea" field="textarea" placeholder="" [crrValue]="''"
                (valueChange)="changeValueDescription($event)">
            </codx-input>
        </div>
        <div class="row p-4">
            <div class="d-flex align-items-center flex-grow-1">
                <div class="w-100px">Thời hạn xử lý</div>
                <codx-input type="datetime" class="test-datetime" field="datetime" placeholder="datetime" dataformat="d"
                    (valueChange)="changeValueFormDate($event)">
                </codx-input>

                <div class="col-6 d-flex align-items-center">
                    <div class="d-flex flex-stack l-30px ms-3">
                        <codx-input #report type="switch" id="switch" [checked]="false" labelPosition="Before"
                            [disabled]="false" class="test-switch" (valueChange)="changeValueReport($event)">
                        </codx-input>
                        <div class="ms-2">Yên cầu báo cáo</div>
                    </div>

                    <div class="d-flex flex-stack l-30px ms-3">
                        <codx-input #email type="switch" id="switch" [checked]="false" labelPosition="Before"
                            [disabled]="false" class="test-switch" (valueChange)="changeValueEmail($event)">
                        </codx-input>
                        <div class="ms-2">Gởi email thông báo</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-footer pt-4">
        <div class="d-flex justify-content-between">
            <div class="d-flex flex-stack">
                <button type="button" class="btn btn-light-primary me-3" (click)="addFile()">
                    <i class="icon-cloud_upload fs-5"></i>Upload file
                </button>
                <codx-input #saveTemplate class="test-switch" type="switch" [checked]="false" [disabled]="false"
                    labelPosition="Before" (valueChange)="changeValueSaveTemplate($event)"></codx-input>
                <div class="ms-2">Lưu làm template</div>
            </div>
            <div class="d-flex">
                <button type="button" class="btn btn-primary" (click)="saveAssignTask()">Lưu</button>
            </div>
        </div>
    </div>
</div>

<codx-attachment #attachment type="center" objectType="TM_Tasks" objectId="628c326c590addf224627f42"
    functionID="WPT03941" (fileAdded)="fileAdded($event)"></codx-attachment>