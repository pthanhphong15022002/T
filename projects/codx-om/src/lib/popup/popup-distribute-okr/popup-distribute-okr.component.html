<codx-form [headerText]="headerText" [dialog]="dialogRef" [bodyCss]="'bg-secondary'" 
[body]="body" *ngIf="isAfterRender">
</codx-form>

<ng-template #body>
    <div class="w-100 h-100 bg-white d-flex flex-column">
    <span class="pt-5 bg-secondary row"></span>
    <!-- <div class="pt-5 pb-2 text-center">
      <codx-label [default]="'Mục tiêu: '+obName" fiedName="titleO" class="fw-bold fs-4"></codx-label>
    </div> -->
    <div class="pt-3 text-center">
      <codx-label [default]="'KR: '+okrName" fiedName="titleKR" class="fw-bold fs-2"></codx-label>
    </div>
    <div class="d-flex justify-content-center">
      <div class="d-flex align-items-center form-group mx-2">
        <codx-input type="radio" name="category" field="category" [checked]="radioKRCheck"
          [crrValue]="radioKRCheck" (valueChange)="valueTypeChange($event)">
        </codx-input>
        <codx-label class="ms-6 mt-6" fiedName="Category" [default]="'Phân bổ thành kết quả chính'">
        </codx-label>
      </div>
      <div class="d-flex align-items-center form-group mx-2">
        <codx-input type="radio" name="category" field="category" [checked]="radioOBCheck"
          [crrValue]="radioOBCheck" (valueChange)="valueTypeChange($event)">
        </codx-input>
        <codx-label class="ms-6 mt-6" fiedName="Category" [default]="'Phân bổ thành mục tiêu'">
        </codx-label>
      </div>
    </div>
    <div class="flex-grow-1 overflow-auto">
      <ejs-tab id="om-tab" class="h-100">
        <e-tabitems>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center position-sticky">
                <span class="fa-solid icon-i-diagram-3-fill me-2"></span>
                <codx-label default="Cơ cấu tổ chức" fiedName="lbltaget" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="mt-2 d-flex flex-column">
                <!--header-->
                <div class="d-flex flex-row">
                  <div class="form-group col-5 text-center">
                    <codx-label name="lbl" class="text-dark" default="Phòng ban"></codx-label>
                  </div>
                  <div class="form-group col-1 text-center">
                    <codx-label name="lbl" class="text-dark" default="% phân bổ"></codx-label>
                  </div>
                  <div class="form-group col-1 text-center">
                    <codx-label name="lbl" class="text-dark" default="Giá trị"></codx-label>
                  </div>
                  <div class="form-group col-1 text-center">
                    <codx-label name="lbl" class="text-dark" default="DVT"></codx-label>
                  </div>
                  <div class="form-group col-4 text-center">
                    <codx-label name="lbl" class="text-dark" default="Tên KR"></codx-label>
                  </div>
                </div>
                <div class="d-flex flex-row  align-items-center">
                  <div class="d-flex justify-content-center align-items-center"
                    style="height:30px;width:30px;background:#3699FF"><span
                      class="icon-home justify-content-center align-items-center text-light"></span></div>
                  <!-- <codx-label name="lbl" [default]="orgUnitTree?.orgUnitName"
                    class="ps-2 fs-5 fw-bolder"></codx-label> -->
                    <span class="ps-2 fs-5 fw-bolder">{{orgUnitTree?.orgUnitName}}</span>
                </div>
                <!--content-->
                <div class="d-flex flex-column" *ngIf=" listDistribute && listDistribute?.length>0">
                  <ng-container class=" flex-grow-1 overflow-auto d-flex flex-column" *ngFor="let item of listDistribute; let i=index;">
                    <div class="my-2 d-flex flex-row justify-content-center" >
                      <div class=" col-4 mx-1 d-flex flex-row ">
                        <div class="d-flex justify-content-center align-items-center" style="height:30px;width:30px"><span
                            class=" icon-check_circle justify-content-center align-items-center text-light" [ngClass]="item.isActive ? 'text-primary' : 'text-muted'" 
                            (click)="disabledChild($event,i)" ></span>
                        </div>  
                        <codx-inplace [type]="'text'" emptyText="" style="width:100%;" [disabled]="true" [ngClass]="item.isActive ? '' : 'disabledCss'" 
                          cssClass=" w-100 px-1 border-bottom border-1 border-secondary rounded-0"
                          [value]="item?.orgUnitName"></codx-inplace>
                      </div>
                      <div class=" col-1  mx-1" [ngClass]="item.isActive ? '' : 'disabledCss'" >
                        <codx-inplace [type]="'number'" emptyText="" (valueChange)="percentChange($event)" [field]="i"
                          cssClass=" px-1 border-bottom border-1 border-secondary rounded-0" [value]="item.distributePct">
                        </codx-inplace>
                      </div>
                      <div class="col-1 mx-1" [ngClass]="item.isActive ? '' : 'disabledCss'" >
                        <codx-inplace [type]="'number'" emptyText="" (valueChange)="valueChange($event)" [field]="i"
                          cssClass=" w-100 px-1 border-bottom border-1 border-secondary rounded-0"
                          [value]="item.distributeValue"> </codx-inplace>
                      </div>
                      <div class="col-1  mx-1" [ngClass]="item.isActive ? '' : 'disabledCss'" >
                        <codx-inplace [type]="'text'" emptyText="" (valueChange)="umidChange($event)" [field]="i"
                          cssClass=" px-1 border-bottom border-1 border-secondary rounded-0" [value]="item.umid">
                        </codx-inplace>
                      </div>
                      <div class=" col-3  mx-1" [ngClass]="item.isActive ? '' : 'disabledCss'" >
                        <codx-inplace [type]="'text'" emptyText="" (valueChange)="nameChange($event)" [field]="i"
                          cssClass=" w-100 px-1 border-bottom border-1 border-secondary rounded-0"
                          [value]="item.okrName"> </codx-inplace>
                      </div>
                    </div>
                  </ng-container>
                </div>
                


              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <span class="fa-solid icon-groups me-2"></span>
                <codx-label default="Cơ cấu báo cáo" fiedName="lbltreetaget" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
             
            </ng-template>
            <ng-template #templateTree let-data>
              <span>{{ data.orgUnitName }}</span>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <span class="fa-solid icon-account_circle me-2"></span>
                <codx-label default="Nhân viên " fiedName="lblmeeting" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>

            </ng-template>
          </e-tabitem>
        </e-tabitems>
      </ejs-tab>
    </div>
    <!--Footer-->
    <div class="pt-5 d-flex justify-content-center">

      <div class="btn-group"> 
        <span type="button" 
          class="me-2 btn d-flex py-2 px-4 btn-sm btn-outline btn-outline-primary btn-active-light-primary  rounded justify-content-center">
          <codx-label name="lblCancel" default="Hủy" class="fw-bold px-3"></codx-label>
        </span>
        <span type="button" (click)="onSaveForm()"
          class="d-flex py-2 px-4 bg-color rounded justify-content-center ">
          <codx-label name="lblSave" class="text-light px-3 fw-bold" default="Lưu" ></codx-label>
        </span>
      </div>
    </div>
  
  </div>
</ng-template>
