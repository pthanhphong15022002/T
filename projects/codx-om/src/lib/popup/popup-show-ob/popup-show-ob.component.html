<codx-form [headerText]="popupTitle" [dialog]="dialogRef" [bodyCss]="'bgEDEDED h-100 pt-5'" [body]="alignKR">
</codx-form>

<ng-template #alignKR>
  <div class="w-100 h-100 bg-white d-flex flex-column">
    <div class="d-flex align-items-center justify-content-end pt-5 me-5">
      <div class="d-flex align-items-center">
        <!-- <div class="symbol symbol-30px symbol-circle cursor-pointer me-4">
          <span class="symbol-label bg-om-gray">
            <i class="icon-create"></i>
          </span>
        </div> -->

        <div class="symbol symbol-30px symbol-circle cursor-pointer me-4">
          <span class="symbol-label bg-om-gray">
            <i class="icon-bar_chart"></i>
          </span>
        </div>
        <div class="symbol symbol-30px symbol-circle cursor-pointer me-4 " (click)="editWeight(dataOKR?.recID)">
          <span class="symbol-label bg-om-gray hover-bg-color ">
            <i class="fas fa-balance-scale w-100 h-100 d-flex justify-content-center align-items-center text-dark"></i>
          </span>
        </div>
        <!-- <div class="symbol symbol-30px symbol-circle cursor-pointer me-2">
          <span class="symbol-label bg-om-gray">
            <i class="icon-vertical_align_center text-dark"></i>
          </span>
        </div> -->
        <!-- <codx-dropdown-calendar cssPopup="h-500px w-800px" cssClass="w-100 om-calendar" class="me-4">
        </codx-dropdown-calendar> -->
      <div class="symbol symbol-30px symbol-circle cursor-pointer me-2">
          <span class="mx-2" >
            {{dataOKR?.periodID}}
          </span>
        </div> 
        <div class="symbol symbol-30px symbol-circle cursor-pointer">
          <span class="symbol-label bg-om-gray">
            <i class="fas fa-ellipsis-h"></i>
          </span>
        </div>
      </div>
    </div>
    <div class="pb-2 text-center">      
      <span class="fw-bold fs-2" [innerHTML]="dataOKR?.okrName | formatvalue : okrFM?.obFM : 'okrName' | async"></span>
    </div>
    <div class="flex-grow-1 overflow-auto">
      <ejs-tab id="om-tab" class="h-100">
        <e-tabitems>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center position-sticky">
                <i class="fa-solid fa-bullseye me-2"></i>
                <codx-label default="Tổng quan" fiedName="lblSummary" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="d-flex flex-column container justify-content-center">
                <ng-container class="container">
                  <div class="d-flex flex-row justify-content-start my-3">
                    <div class="d-flex flex-row align-items-center">
                      <div class="bg-danger d-flex rounded-circle justify-content-center align-items-center"
                        style="height: 30px; width: 30px">
                        <i class="icon-history justify-content-center align-items-center text-light"></i>
                      </div>
                      <codx-label name="lbl" default="Hiện trạng" class="ps-2 fs-5 fw-bolder"></codx-label>
                    </div>

                  </div>
                  <div class="d-flex flex-column align-items-center">
                    <!-- Content Dasboard -->
                    <div class="d-flex justify-content-center align-items-center flex-column w-75">
                      <div class="d-flex align-items-center kr-process w-250px min-w-250px ms-3">
                        <div class="h-15px w-100 bg-gray-200 rounded-4">
                          <div class="bg-color rounded-4 h-15px" role="progressbar"
                            [style.width]="dataOKR?.progress + '%'" aria-valuenow="50" aria-valuemin="0"
                            aria-valuemax="100"></div>
                        </div>
                        <div class="process-per position-absolute top-0 fs-8 text-light" style="left: 30%">
                          {{ dataOKR?.progress }}%
                        </div>
                      </div>
                      <div class="row">
                        <div class="">
                          <codx-chart [title]="chartSettings?.title" [legendSettings]="{ visible: false }"
                            [primaryXAxis]="chartSettings?.primaryXAxis" [primaryYAxis]="chartSettings?.primaryYAxis"
                            [seriesSetting]="chartSettings?.seriesSetting" [service]="chartSettings?.service"
                            [assemblyName]="chartSettings?.assembly" [className]="chartSettings?.className"
                            [method]="chartSettings?.method"></codx-chart>
                        </div>
                      </div>

                    </div>
                  </div>

                  <div class="d-flex flex-row justify-content-start my-3">
                    <div class="d-flex flex-row align-items-center">
                      <div class="bg-danger d-flex rounded-circle justify-content-center align-items-center"
                        style="height: 30px; width: 30px">
                        <i class="icon-history justify-content-center align-items-center text-light"></i>
                      </div>
                      <codx-label name="lbl" default="Kết quả chính" class="ps-2 fs-5 fw-bolder"></codx-label>
                    </div>
                  </div>
                  <div class="d-flex  align-items-center flex-column">
                    <div class="pb-2 cursor-pointer has-action-menu w-75" *ngFor="let item of okrChild">
                      <div class="mt-2 d-flex align-items-center align-items-center">
                        <div class="d-flex align-items-start align-items-center col-10">
                          <codx-img [objectId]="item?.createdBy" [objectType]="'AD_Users'"></codx-img>
                          <div class="ms-15">
                            {{ item.okrName }}
                          </div>
                        </div>

                        <i class="ps-5 icon-link me-3"></i>
                      </div>
                      <div class="d-flex align-items-center kr-process w-100 ms-3 my-1 col-8">
                        <div class="ms-10 h-15px w-100 bg-gray-200 rounded-4">
                          <div class="bg-color rounded-4 h-15px" role="progressbar" [style.width]="item.progress + '%'"
                            aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                        <div class="ms-10 text-light process-per position-absolute top-0 fs-8 om-pt-1" [style.left]="
                          (item.progress / 2 > 0 ? item.progress / 2 : 1) + '%'
                        ">
                          {{ item.progress }}%
                        </div>

                        <div class="col-4 d-flex align-items-center">
                          <div class="col-6 d-flex align-items-center" style="
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          ">
                            <span class="ms-5">{{ item.target }}</span>
                            <span class="ms-1">Người</span>
                          </div>
                          <div class="col-6 d-flex align-items-center">
                            <i class="icon-attach_file text-primary me-1"></i>
                            <span class="me-3">{{ item?.attachments }}</span>
                            <i class="icon-chat_bubble_outline text-primary me-1"></i>
                            <span class="me-3">{{ item?.comments }}</span>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>

                </ng-container>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-folder-tree me-2"></i>
                <codx-label default="Liên kết" fiedName="lbltreetaget" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="d-flex justify-content-center">
                <div class="w-75">
                  <!--Filter-->
                  <div class="d-flex align-items-center justify-content-end" #titleOKR>
                    <div class="d-flex align-items-center">
                      <div class="ms-2 me-2" ngbDropdown [container]="'body'">
                        <div role="button"
                          class="d-flex align-items-center border rounded align-items-center p-2 w-90px "
                          (click)="collapeKR(!isCollapsed)" *ngIf="isCollapsed==true">
                          <i class="icon-i-arrows-collapse me-2"></i>
                          <codx-label default="Thu gọn" fiedName="lblCollapse"></codx-label>
                        </div>
                        <div role="button"
                          class="d-flex align-items-center border rounded align-items-center p-2 w-90px"
                          (click)="collapeKR(!isCollapsed)" *ngIf="isCollapsed==false">
                          <i class="icon-i-arrows-expand me-2"></i>
                          <codx-label default="Mở rộng" fiedName="lblExpand"></codx-label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!--Content-->
                  <div class="ms-5 ps-5">
                    <span class="icon-i-signpost-2 text-primary"></span>
                    <codx-label default="Liên kết" class="ps-2 fs-5 fw-bolder" name="lblLink"></codx-label>
                  </div>
                  <div *ngIf="listAlign && listAlign.length>0" class="px-5">
                    <view-okr [dataOKR]="listAlign" [isCollapsedAll]="isCollapsed" [okrFM]="okrFM" [okrVll]="okrVll"></view-okr>
                  </div>
                  <!--Content-->
                  <div class="ms-5 ps-5 pt-5">
                    <span class="icon-i-signpost-2 text-primary"></span>
                    <codx-label default="Phụ thuộc" class="ps-2 fs-5 fw-bolder" name="lblLink" ></codx-label>
                  </div>
                  <div *ngIf="listAssign && listAssign.length>0" class="px-5">
                    <view-okr [dataOKR]="listAssign" [isCollapsedAll]="isCollapsed" [okrFM]="okrFM"  [okrVll]="okrVll"></view-okr>
                  </div>
                    
                  
                  <!--Content-->
                </div>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-list me-2"></i>
                <codx-label default="Công việc" fiedName="lbljob" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="d-flex justify-content-center">
                Công việc
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-regular icon-i-chat me-2"></i>
                <codx-label default="Chia sẻ" fiedName="lblShare" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="d-flex justify-content-center">
                Chia sẻ
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-regular fa-calendar me-2"></i>
                <codx-label default="Họp định kỳ" fiedName="lblmeeting" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <lib-okr-reviews [formModel]="view?.formModel"></lib-okr-reviews>
            </ng-template>
          </e-tabitem>

          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-regular icon-i-chat me-2"></i>
                <codx-label default="Ghi chú" fiedName="lblNote" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="d-flex justify-content-center">
                <div class="w-75 mt-5">
                  <codx-tree-comment [objectID]="dataOKR.recID" [objectType]="formModel?.entityName" [actionType]="'C'"
                    [addNew]="true" [viewIcon]="false" [viewVote]="true" [funcID]="formModel?.funcID">
                  </codx-tree-comment>
                </div>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-clock-rotate-left me-2"></i>
                <codx-label default="Cập nhật" fiedName="lblmeeting" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content> Cập nhật </ng-template>
          </e-tabitem>
        </e-tabitems>
      </ejs-tab>
    </div>
  </div>
</ng-template>

<ng-template>
  <div class="px-10">
    <codx-treeview id="tree" #treeView [itemTemplate]="templateTreeView" [data]="listAssign"
      [enableCheck]="false" idField="recID" parentIdField="parentID" [autoLoad]="false"
      [isOutput]="true" [isLoadChild]="true" (selectionChange)="selectionChange($event)">
    </codx-treeview>


    <ng-template #templateTreeView let-item>
      <!--OB node-->
      <div class="d-flex align-items-center flex-column justify-content-between "
        *ngIf="item?.okrType==obType">

        <hr class="mt-2 w-100">
        <div class="w-100 d-flex justify-content-between">
          <div class="d-flex align-items-center flex-row cursor-pointer w-100">
            <span class="fa-solid fa-bullseye me-3 fs-2 txt-color-0E4C55"></span>
            <span class="ob-kr">{{ item?.okrName }}</span>
            <codx-vll *ngIf="item?.category" [showText]="true" [showBgColor]="true" [name]="'OM012'"
              [value]="item?.category" class="ms-2 badge badge-light badge-md fs-7">
            </codx-vll>
            <codx-vll *ngIf="item?.confidence" [showText]="true" [showBgColor]="true" [name]="'OM013'"
              [value]="item?.confidence" class="badge badge-light badge-md fs-7">
            </codx-vll>
          </div>
          <div class="d-flex align-items-center justify-content-end ">

            <codx-img [objectId]="item?.owner" [objectType]="'AD_Users'"></codx-img>
            <div class="d-flex flex-column align-items-center kr-process w-200px min-w-200px ms-3">
              <span>{{item?.progress}}%</span>
              <div class="h-7px w-100 bg-gray-200 rounded-4">
                <div class="bg-color rounded-4 h-7px" role="progressbar"
                  [style.width]="item?.progress + '%'" aria-valuenow="50" aria-valuemin="0"
                  aria-valuemax="100"></div>
              </div>


            </div>
            <div class="d-flex ms-5">
              <button class="btn btn-icon btn-sm position-relative ms-4">
                <span class="icon-vpn_key icon-20 text-gray-800 text-hover-primary"></span>
                <span
                  class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                  [ngClass]="item?.child && item?.child.length >0 ? 'bg-color': 'bg-gray-300'">{{
                  item?.child? item?.child.length :0 }}</span>
              </button>
              <button class="btn btn-icon btn-sm position-relative ms-4">
                <span class="icon-link icon-20 text-gray-800 text-hover-primary"></span>
                <span
                  class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                  [ngClass]="item?.shares  && item?.shares.length>0 ? 'bg-color': 'bg-gray-300'">{{
                  item?.shares ? item?.shares?.length : 0 }}</span>
              </button>
              <button class="btn btn-icon btn-sm position-relative ms-4">
                <span class="icon-format_list_bulleted icon-20 text-gray-800 text-hover-primary"></span>
                <span
                  class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                  [ngClass]="item?.updates  && item?.updates.length>0 ? 'bg-color': 'bg-gray-300'">{{
                  item?.updates ? item?.updates.length : 0 }}</span>
              </button>
              <button class="btn btn-icon btn-sm position-relative ms-4">
                <span class="icon-chat_bubble_outline icon-20 text-gray-800 text-hover-primary"></span>
                <span
                  class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                  [ngClass]="item?.notes  && item?.notes.length>0 ? 'bg-color': 'bg-gray-300'">{{
                  item?.notes ? item?.notes.length : 0 }}</span>
              </button>
              <!-- <codx-mfunc [formModel]="formModelOB" type="view" [dataItem]="item" class="ms-4"
      (clickMF)="clickMF($event,item)"></codx-mfunc> -->
            </div>
          </div>
        </div>
      </div>

      <!--KR node-->
      <div class="d-flex align-items-center justify-content-between mt-2 "
        *ngIf="item?.okrType==krType">

        <div class="d-flex align-items-center cursor-pointer w-100">
          <div class="rounded-circle p-4px w-h-circle bg-2D3958 fw-bold text-white me-2 text-center">
            KR
          </div>
          <span class="ob-kr"> {{ item?.okrName }} </span>
          <span class="mx-2">|</span>
          <span class="me-2" *ngIf="item?.target"> {{item?.target}} </span>
          
          <span [innerHTML]="item?.umid | formatvalue : formModel : 'UMID' | async"></span>
        </div>
        <div class="d-flex align-items-center justify-content-end ">
          <div class="d-flex flex-column align-items-center kr-process w-200px min-w-200px ms-3">
            <span>{{item?.progress}}%</span>
            <div class="h-7px w-100 bg-gray-200 rounded-4">
              <div class="bg-color rounded-4 h-7px" role="progressbar"
                [style.width]="item?.progress + '%'" aria-valuenow="50" aria-valuemin="0"
                aria-valuemax="100"></div>
            </div>

          </div>
          <div class="d-flex ms-5">
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-vpn_key icon-20 text-gray-800 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs  "
                [ngClass]="item?.child  && item?.child.length>0 ? 'bg-color': 'bg-gray-300'">{{
                item?.child ? item?.child.length : 0 }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-link icon-20 text-gray-800 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs  "
                [ngClass]="item?.shares  && item?.shares.length>0 ? 'bg-color': 'bg-gray-300'">{{
                item?.shares ? item?.shares?.length : 0 }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-format_list_bulleted icon-20 text-gray-800 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                [ngClass]="item?.updates  && item?.updates.length>0 ? 'bg-color': 'bg-gray-300'">{{
                item?.updates ? item?.updates?.length : 0 }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-chat_bubble_outline icon-20 text-gray-800 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                [ngClass]="item?.notes  && item?.notes.length>0 ? 'bg-color': 'bg-gray-300'">{{
                item?.notes ? item?.notes?.length : 0 }}</span>
            </button>
            <!-- <codx-mfunc [formModel]="formModelKR" type="view" [dataItem]="item" class="ms-4"
    (clickMF)="clickKRMF($event,item,false)"></codx-mfunc> -->
          </div>
        </div>
      </div>

      <!--SKR node-->
      <div class="d-flex align-items-center justify-content-between mt-2 ms-3"
        *ngIf="item?.okrType==skrType">
        <div class="d-flex align-items-center cursor-pointer w-100">
          <div
            class="rounded-circle p-4px w-h-circle bg-2D3958 text-white me-2 text-center fs-9 d-flex align-items-center justify-content-between ">
            SKR
          </div>
          <div class="ob-kr">
            {{ item?.okrName }}
          </div>
          <span class="mx-2">|</span>
          <span class="me-2" *ngIf="item?.target"> {{item?.target}} </span>
          
          <span [innerHTML]="item?.umid | formatvalue : formModel : 'UMID' | async"></span>
        </div>
        <div class="d-flex align-items-center justify-content-end ">
          <div class="d-flex flex-column align-items-center kr-process w-200px min-w-200px ms-3">
            <span>{{item?.progress}}%</span>
            <div class="h-7px w-100 bg-gray-200 rounded-4">
              <div class="bg-color rounded-4 h-7px" role="progressbar"
                [style.width]="item?.progress + '%'" aria-valuenow="50" aria-valuemin="0"
                aria-valuemax="100"></div>
            </div>

          </div>
          <div class="d-flex ms-5">
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-vpn_key icon-20 text-gray-300 text-hover-primary"></span>
              <!-- <span class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
      item?.kRs? item?.kRs : 0 }}</span> -->
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-link icon-20 text-gray-800 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                [ngClass]="item?.shares  && item?.shares.length >0 ? 'bg-color': 'bg-gray-300'">{{
                item?.shares ? item?.shares?.length : 0 }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-format_list_bulleted icon-20 text-gray-800 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                [ngClass]="item?.updates  && item?.updates.length>0 ? 'bg-color': 'bg-gray-300'">{{
                item?.updates ? item?.updates?.length : 0 }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-chat_bubble_outline icon-20 text-gray-800 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs "
                [ngClass]="item?.notes  && item?.notes.length>0 ? 'bg-color': 'bg-gray-300'">{{
                item?.notes ? item?.notes?.length : 0 }}</span>
            </button>

          </div>
        </div>
      </div>

    </ng-template>
    <!-- <div *ngFor="let data of listAssign; let i = index">
      <div class="d-flex align-items-center justify-content-between mt-5">
        <div class="d-flex align-items-center cursor-pointer w-100" (click)="getItemOKRAssign(i, data.recID)"
          data-bs-toggle="collapse" [attr.data-target]="'#collapse' + i" aria-expanded="true"
          [attr.aria-controls]="'collapse' + i">
          <div class="rounded-circle cursor-pointer me-3 bg-light w-20px h-18px text-center">
            <i [class]="
                !this.openAccordionAssign[i]
                  ? 'icon-navigate_next'
                  : 'fas fa-angle-down'
              "></i>
          </div>
          <i class="fa-solid fa-bullseye me-3 fs-3 txt-color-0E4C55"></i>
          <span>{{ data.okrName }}</span>
        </div>
        <div class="d-flex align-items-center justify-content-end">
          <codx-img [objectId]="data?.createdBy" [objectType]="'AD_Users'"></codx-img>
          <div class="d-flex align-items-center kr-process w-200px min-w-200px ms-3">
            <div class="h-15px w-100 bg-gray-200 rounded-4">
              <div class="bg-color rounded-4 h-15px" role="progressbar"
                [style.width]="data.progress + '%'" aria-valuenow="50" aria-valuemin="0"
                aria-valuemax="100"></div>
            </div>

            <div class="process-per position-absolute top-0 fs-8" style="left: 72%">
              {{ data.progress }}%
            </div>
            <div class="pic-local" style="left: 77%">
              <span class="icon-language text-primary icon-20"></span>
            </div>
            <div *ngIf="data.confidence" class="pic-face" style="left: 90%">
              <img class="w-18px h-18px" [src]="
                  'assets/themes/wp/default/img/' +
                  (data.confidence == '2'
                    ? 'L1480_4'
                    : 'L1480_3') +
                  '.svg'
                " />
            </div>
          </div>
          <div class="d-flex ms-9">
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <button class="btn btn-icon btn-sm position-relative ms-4" (click)="addKR(data)"> 
              <span class="icon-vpn_key icon-20 text-gray-600 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                data?.child ? data?.child.length : 0
                }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-link icon-20 text-gray-600 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                data?.shares ? data?.shares.length : 0
                }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-format_list_bulleted icon-20 text-gray-600 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                data?.notes ? data?.notes.length : 0
                }}</span>
            </button>
            <button class="btn btn-icon btn-sm position-relative ms-4">
              <span class="icon-chat_bubble_outline icon-20 text-gray-600 text-hover-primary"></span>
              <span
                class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                data?.notes ? data?.notes.length : 0
                }}</span>
            </button>
            <codx-mfunc [formModel]="formModel" type="view" [dataItem]="data" class="ms-4"></codx-mfunc>
          </div>
        </div>
      </div>
      <div [attr.id]="'collapse' + i" class="accordion-collapse collapse"
        [class.show]="openAccordionAssign[i]" [attr.aria-labelledby]="'heading' + i"
        data-bs-parent="#accordionExample">
        <div class="ps-5 mt-2 cursor-pointer w-100 d-flex justify-content-end"
          *ngFor="let item of data?.child">
          <div class="d-flex align-items-center justify-content-between w-95">
            <div class="d-flex align-items-center">
              <div
                class="rounded-circle p-4px w-h-circle bg-2D3958 fw-bold text-white me-1 text-center">
                KR
              </div>
              <div class="ps-3">
                {{ item.okrName }}
              </div>
            </div>
            <div class="d-flex align-items-center justify-content-end">
              <codx-img [objectId]="item?.createdBy" [objectType]="'AD_Users'"></codx-img>
              <div class="d-flex align-items-center kr-process w-200px min-w-200px ms-3">
                <div class="h-15px w-100 bg-gray-200 rounded-4">
                  <div class="bg-color rounded-4 h-15px" role="progressbar"
                    [style.width]="item.progress + '%'" aria-valuenow="50" aria-valuemin="0"
                    aria-valuemax="100"></div>
                </div>
                <div class="process-per position-absolute top-0 fs-8" style="left: 72%">
                  {{ item.progress }}%
                </div>
                <div class="pic-local" style="left: 77%">
                  <span class="icon-language text-primary icon-20"></span>
                </div>
                <div *ngIf="item.confidence" class="pic-face" style="left: 90%">
                  <img class="w-18px h-18px" [src]="
                      'assets/themes/wp/default/img/' +
                      (item.confidence == '2'
                        ? 'L1480_4'
                        : 'L1480_3') +
                      '.svg'
                    " />
                </div>
              </div>
              <div class="d-flex ms-9">
                <button class="btn btn-icon btn-sm position-relative ms-4">
                  <span class="icon-link icon-20 text-gray-600 text-hover-primary"></span>
                  <span
                    class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                    item?.shares ? item?.shares.length : 0
                    }}</span>
                </button>
                <button class="btn btn-icon btn-sm position-relative ms-4">
                  <span
                    class="icon-format_list_bulleted icon-20 text-gray-600 text-hover-primary"></span>
                  <span
                    class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                    item?.notes ? item?.notes.length : 0
                    }}</span>
                </button>
                <button class="btn btn-icon btn-sm position-relative ms-4">
                  <span
                    class="icon-chat_bubble_outline icon-20 text-gray-600 text-hover-primary"></span>
                  <span
                    class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                    item?.notes ? item?.notes.length : 0
                    }}</span>
                </button>
                <button class="btn btn-icon btn-sm position-relative ms-4">
                  <button class="btn btn-icon btn-sm position-relative ms-4" (click)="addKR(item)"> 
                  <span class="icon-attach_file icon-20 text-gray-600 text-hover-primary"></span>
                  <span
                    class="position-absolute top-0 start-100 translate-middle badge badge-circle badge-xs bg-color">{{
                    item.attachments
                    ? item?.attachments.length
                    : 0
                    }}</span>
                </button>
                <codx-mfunc [formModel]="formModel" type="view" [dataItem]="item"
                  class="ms-4"></codx-mfunc>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div> -->
  </div>
</ng-template>