<codx-form #form [body]="body" [footer]="footer" [dialog]="dialogRef" [formModel]="formModel" [formGroup]="fCheckinKR"
  [data]="checkIns"  [showHeader]="false" *ngIf="fCheckinKR && isAfterRender">
  <ng-template #subHeader>
    <div class="d-flex justify-content-center">
      <!-- <codx-label default="Check-in" name="lblCheckin"></codx-label> -->
      
    </div>
  </ng-template>
  <ng-template #body>
    <div class="p-5 h-100">
      <!--Header-->
      <div class="d-flex flex-column justify-content-center align-items-center w-100">
        <span class="fs-2 fw-bold mt-2"> {{headerText}}</span>
        <codx-label [default]="'KR: '+ dataKR?.okrName" class="text-gray-500 mt-2 mb-5 text-center px-20"></codx-label>
        <div class="d-flex align-items-center kr-process w-200px min-w-200px ms-3 mb-5">
          <div class="h-15px w-100 bg-gray-200 rounded-4">
            <div class="bg-primary rounded-4 h-15px position-relative" role="progressbar" [style.width]="(dataKR?.progress + '%')"
              aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">
              <div class="position-absolute top-0 fs-8 text-light" style="left:50%; margin-left: -8px;">{{dataKR?.progress}}%</div>
            </div>
          </div>
          
          <!-- <div class="pic-local" style="left:77%;">
          <span class="icon-language text-primary icon-20"></span>
        </div>
        <div *ngIf="dataKR?.confidence" class="pic-face" style="left:90%;">
          <img class="w-18px h-18px"
            [src]="'assets/themes/wp/default/img/'+(dataKR?.confidence == '2'?'L1480_4':'L1480_3')+'.svg'">
        </div> -->

        </div>
        <!--Body-->
        <div class="d-flex flex-column mt-5 w-100">
          <div class="row">
            <div class="col-4" *ngIf="dataKR?.checkInMode=='1'">
              <codx-label class="fw-bold mb-1" default="Kết quả thực hiện" fiedName="Value" [formModel]="form.formModel"></codx-label>
              <!-- <codx-input [min]="0" [max]="dataKR.checkInMode==1?100:100-dataKR.progress" [showSpinButton]="false" ControlName="value" [formModel]="formModel" [Group]="form.formGroup"></codx-input> -->
              <codx-input type="number"  [min]="0" [max]="100" [showSpinButton]="false" field="cummulated" (valueChange)="valueChange($event)"  [crrValue]="checkIns?.cummulated"></codx-input>
            </div>
            <div class="col-4" *ngIf="dataKR?.checkInMode!='1'">
              <codx-label class="fw-bold mb-1" default="Kết quả thực hiện" fiedName="Value" [formModel]="form.formModel"></codx-label>
              <codx-input type="number" [min]="0" [max]="100-dataKR?.progress" [showSpinButton]="false" field="value"  (valueChange)="valueChange($event)" [crrValue]="checkIns?.value"></codx-input>
            </div>
            <div class="col-4">
              <codx-label class="fw-bold mb-1" default="Tình trạng" fiedName="Status" [formModel]="form.formModel"></codx-label>
              <codx-input ControlName="status" [formModel]="formModel" [Group]="fCheckinKR"></codx-input>
            </div>
          </div>
          <div class="form-group mt-2">
            <codx-label *ngIf="dataKR?.checkInMode=='1'" name="lbl"
              default="(*) Kết quả thực hiện là kết quả sau cùng" class="text-primary"></codx-label>
            <codx-label *ngIf="dataKR?.checkInMode=='2'" name="lbl"
              default="(*) Kết quả thực hiện sẽ được cộng dồn để tính kết quả sau cùng"
              class="text-primary"></codx-label>
          </div>
          <div class="form-group">
            <codx-label default="Ghi chú" fiedName="Comment" [formModel]="form.formModel"></codx-label>
            <codx-input ControlName="comment" [formModel]="formModel" [Group]="fCheckinKR"></codx-input>
          </div>
          <div class="flex-nowrap overflow-auto h-100px">
            <!-- <codx-attachment #attachment [objectType]="'OM_OKRs'" hideBtnSave="1" hideFolder="1"
            hideUploadBtn="1" hideDes="1" hideImageUpload="0" hideImageThumb="0" [functionID]="'OMT01'"
            [objectId]="dataKR?.recID" [allowMultiFile]="0" [idBrowse]="'add'" displayThumb="full"
            (fileAdded)="fileAdded($event)" (fileCount)="fileCount($event)">
          </codx-attachment> -->
          </div>
        </div>
      </div>

    </div>


  </ng-template>

  <ng-template #footer>
    <!--Footer-->
    <div class="d-flex justify-content-between align-items-center">
      <button type="button" (click)="popupUploadFile($event)"
        class="btn btn-light-primary">
        <i class="icon-cloud_upload icon-16 me-1"></i>
        <codx-label fiedName="lblUploadFile" default="Đính kèm" [formModel]="formModel"></codx-label>
      </button>

      <div class="d-flex justify-content-end"> 
        <button type="button" (click)="checkinCancel()"
          class="me-2 btn btn-outline-primary">
          <codx-label name="lblCancel" default="Hủy" [formModel]="formModel"></codx-label>
        </button>
        <button type="button" (click)="checkinSave()"
          class="btn btn-primary">
          <codx-label name="lblSave" default="Lưu" [formModel]="formModel"></codx-label>
        </button>
      </div>
    </div>
    
  </ng-template>
</codx-form>