<codx-views #view [views]="views" (viewChanged)="viewChanged($event)" [autoLoad]="false" [toolbarDisplay]="false" *ngIf="isAfterRender" >
</codx-views>
<ng-template #panelRight>
  <div class="w-100 h-100 bg-white rounded-2 pt-4 px-6 d-flex flex-column">
    <div class="d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center col-3 text-white om-switch-room cursor-pointer">
        <div class="w-100px text-center bgC5C7D0 active py-2 om-rounded-pill-left" *ngIf="funcID!=compFuncID">
          Phòng tôi
        </div>
        <div class="w-100px text-center bgC5C7D0 py-2 om-rounded-pill-right" *ngIf="funcID!=compFuncID">
          Share cho tôi
        </div>
      </div>

      <div class="d-flex  align-items-center justify-content-center w-100">
        <div class="text-center" *ngIf="funcID==compFuncID">
          <span class="fw-bold fs-2">{{compName}}</span>
        </div>
        <div class="text-center" *ngIf="funcID == deptFuncID">
          <span class="fw-bold fs-2">{{deptName}}</span>
        </div>
        <div class="text-center" *ngIf="funcID == orgFuncID">
          <span class="fw-bold fs-2">{{orgName}}</span>
        </div>
        <div class="text-center" *ngIf="funcID == persFuncID">
          <span class="fw-bold fs-2">{{persName}}</span>
        </div>
      </div>

      <div class="d-flex align-items-center justify-content-end col-3">
        <div *ngIf="!planNull" class="symbol symbol-30px symbol-circle cursor-pointer me-2" (click)="addEditOKRPlans(false)" ngbTooltip="Chỉnh sửa bộ mục tiêu" >
          <span class="symbol-label bg-om-gray">
            <i class="icon-create text-dark"></i>
          </span>
        </div>
        <div  *ngIf="!planNull" class="symbol symbol-30px symbol-circle cursor-pointer me-2" (click)="hiddenChartClick(!isHiddenChart)" [ngbTooltip]="isHiddenChart? 'Hiện biểu đồ' :'Ẩn biểu đồ'">
          <span class="symbol-label " [ngClass]="isHiddenChart? 'bg-om-gray' :'bg-color'">
            <i class="icon-bar_chart " [ngClass]="isHiddenChart? 'text-dark' :'text-light'"></i>
          </span>
        </div>
        <codx-dropdown-calendar cssPopup="h-500px w-800px" [value]="date" [selectedType]="'y'" [displayOption]="ops"
          cssClass="w-100 om-calendar" class="me-2" (change)="changeCalendar($event)"></codx-dropdown-calendar>
        <div class="symbol symbol-30px symbol-circle cursor-pointer">
          <span class="symbol-label bg-om-gray">
            <codx-mfunc [formModel]="formModelPlan"  (changeDataMF)="changeDataMF($event)" (clickMF)="clickMF($event)"></codx-mfunc>
          </span>
        </div>
      </div>

    </div>


    <div class="p-om-okr flex-grow-1 bg-body">
      <ejs-tab id="om-tab">
        <e-tabitems>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-bullseye me-2"></i>
                <codx-label default="Mục tiêu" fiedName="lbltaget" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="h-100" *ngIf="!planNull ; else elseOKR">
                <div class="h-100" *ngIf="dataOKR != null">
                    <lib-okr-targets [dataOKRPlans]="dataOKRPlans" [dataOKR]="dataOKR" [formModel]="view?.formModel" [okrFM]="okrFM" [okrVll]="okrVll"  [okrGrv]="okrGrv"
                    [gridView]="gridView" [obFuncID]="obFuncID" [krFuncID]="krFuncID" [skrFuncID]="skrFuncID"
                    [formModelKR]="formModelKR" [formModelOB]="formModelOB" [formModelSKR]="formModelSKR" [groupModel]="groupModel" [curOrgUnitID]="curOrgID"
                    [funcID]="funcID" [isHiddenChart]="isHiddenChart" (getOKRPlanForComponent)="getOKRPlanForComponent($event)" ></lib-okr-targets>


                </div>
              </div>
              <ng-template #elseOKR>
                <div class="w-100 py-10  text-center d-flex flex-row justify-content-center align-item-center">
                  <div class="col-2"></div>
                  <div class=" col-7 pb-10 bg-primary-lighter my-5 text-center d-flex flex-column justify-content-center align-item-center  border border-2 border-primary">

                      <span inlineSVG="./assets/themes/om/default/img/OKRs.svg"></span>
                      <span *ngIf="funcID==compFuncID" [innerHTML]="compPlanNull"></span>
                      <span *ngIf="funcID==deptFuncID" [innerHTML]="deptPlanNull"></span>
                      <span *ngIf="funcID==orgFuncID" [innerHTML]="orgPlanNull"></span>
                      <span *ngIf="funcID==persFuncID" [innerHTML]="persPlanNull"></span>
                      <div class="d-flex justify-content-center">
                        <span type="button" (click)="click({ id: 'btnAddPlan' })"
                          class="w-110px d-flex mt-3 py-2 px-4 bg-color rounded justify-content-center align-items-center">
                          <span class="fa-solid fa-bullseye btn-text-primary text-light me-1"></span>
                          <codx-label class="text-light" fiedName="lbl" default="Tạo bộ mục tiêu"></codx-label>
                        </span>
                      </div>

                  </div>
                  <div class="col-2"></div>
                </div>
              </ng-template>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-folder-tree me-2"></i>
                <codx-label default="Cây mục tiêu" fiedName="lbltreetaget" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="px-25">

                <lib-okr-trees [okrVll]="okrVll" [okrFM]="okrFM" [funcID]="funcID" [dataOKRPlans]="dataOKRPlans" [orgUnitTree]="orgUnitTree"></lib-okr-trees>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-list me-2"></i>
                <codx-label default="Công việc" fiedName="lbljob" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <codx-tasks-share class="tasks-share-content" [funcID]="'OMT014'" [dataValue]="dataOKRPlans.recID" [predicate]="'SessionID==@0'" [showButtonAdd]="true" [showMoreFunc]="true"></codx-tasks-share>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-regular fa-calendar me-2"></i>
                <codx-label default="Họp định kỳ" fiedName="lblmeeting" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div>

                <codx-tmmeetings funcID="OMT017" [dataObj]="refIDMeeting" [projectID]="dataOKRPlans?.recID"></codx-tmmeetings>
              </div>
            </ng-template>
          </e-tabitem>
          <!-- <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-regular fa-square-check me-2"></i>
                <codx-label default="Đánh giá" fiedName="lblmeeting" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content> Đánh giá </ng-template>
          </e-tabitem> -->
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-clock-rotate-left me-2"></i>
                <codx-label default="Cập nhật" fiedName="lblmeeting" class="fw-bold"></codx-label>
              </div>
            </ng-template>
            <ng-template #content> Cập nhật </ng-template>
          </e-tabitem>
        </e-tabitems>
      </ejs-tab>
    </div>
  </div>
</ng-template>
