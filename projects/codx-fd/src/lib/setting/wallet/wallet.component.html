<div class="d-flex flex-row flex-column-fluid page page-detail">
    <div class="content d-flex flex-column flex-column-fluid" id="kt_content">
        <div id="erm_content" class="d-flex flex-column-fluid setting2">
            <div class="container">
                <div class="d-flex">
                    <div class="aside-detail flex-row-auto w-300px">
                        <div class="aside-menu mr-6 mt-5">
                            <ul class="menu-nav">
                                <li class="menu-item" (click)="redirectPage('notificationFedback')">
                                    <a class="menu-link d-flex align-items-center">
                                        <i class="icon-near_me icon-20 mr-2"></i>
                                        <codx-label fiedName="FeedbackMessage" [formName]="functionList?.formName"
                                            [gridViewName]="functionList?.gridViewName" default='Thông điệp phản hồi'>
                                        </codx-label>
                                    </a>
                                </li>
                                <li class="menu-item" (click)="redirectPage('itemCategory')">
                                    <a class="menu-link d-flex align-items-center">
                                        <i class="icon-format_list_bulleted icon-20 mr-2"></i>
                                        <codx-label fiedName="Category" [formName]="functionList?.formName"
                                            [gridViewName]="functionList?.gridViewName" default='Danh mục'>
                                        </codx-label>
                                    </a>
                                </li>
                                <li class="menu-item">
                                    <a class="menu-link d-flex align-items-center">
                                        <i class="icon-account_balance_wallet icon-20 mr-2"></i>
                                        <codx-label name="lblWallet" [formName]="functionList?.formName"
                                            [gridViewName]="functionList?.gridViewName" default='Ví nhân viên'>
                                        </codx-label>
                                    </a>
                                </li>
                                <li class="menu-item" (click)="redirectPage('itemRankDedication')">
                                    <a class="menu-link d-flex align-items-center">
                                        <i class="icon-credit_card icon-20 mr-2"></i>
                                        <codx-label name="lblDedicateRank" [formName]="functionList?.formName"
                                            [gridViewName]="functionList?.gridViewName" default='Hạng cống hiến'>
                                        </codx-label>
                                    </a>
                                </li>
                                <li class="menu-item" (click)="redirectPage('itemStatiscal')">
                                    <a class="menu-link d-flex align-items-center">
                                        <i class="icon-bar_chart icon-20 mr-2"></i>
                                        <codx-label name="lblStatistical" [formName]="functionList?.formName"
                                            [gridViewName]="functionList?.gridViewName" default='Thống kê'>
                                        </codx-label>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <div class="d-flex flex-column flex-grow-1">
                        <div class="list-group">
                            <div class="list-content">
                                <div class="d-flex justify-content-between mb-6">
                                    <span class="icon-arrow_back icon-22 mr-3 text-hover-primary"
                                        (click)="backLocation()"></span>
                                    <div class="fs-3 fw-bold text-dark mb-1 flex-grow-1">
                                        <codx-label fiedName="SettingWallet" [formName]="functionList?.formName"
                                            [gridViewName]="functionList?.gridViewName" default='Cấu hình ví nhân viên'>
                                        </codx-label>
                                    </div>
                                </div>
                                <div class="d-flex align-items-start py-4 border-bottom border-light"
                                    *ngIf="data && data.fieldName == 'ActivedOn'">
                                    <div class="d-flex flex-column flex-grow-1">
                                        <div class="text-dark fw-bold fs-h6">
                                            {{data.title}}
                                        </div>
                                        <div class="text-gray-500">
                                            {{data.description}}
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-center ml-4">
                                        <codx-Input type="select" name="select" class="control-vll" placeholder=""
                                            ngDefaultControl refValue="L1475" field="ActivedOn" [value]="data.ActivedOn"
                                            (valueChange)="changValueListPopup($event)">
                                        </codx-Input>
                                        <span
                                            class="w-20px min-w-20px h-20px ml-3 d-flex justify-content-center"></span>
                                    </div>
                                </div>
                                <div class="fs-4 fw-bold text-dark mb-6 mt-6">
                                    <codx-label fiedName="ManageWallet" [formName]="functionList?.formName"
                                        [gridViewName]="functionList?.gridViewName" default='Quản lý ví'>
                                    </codx-label>
                                </div>
                                <div class="list-setting ml-10">
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'DefaultCoins'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{data.title}}
                                            </div>
                                            <div class="text-gray-500">
                                                <codx-label fiedName="AutoAddCoin" [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName"
                                                    default='Chương trình tự động thêm'>
                                                </codx-label>
                                                {{quantity.DefaultCoins}}
                                                <codx-label fiedName="AutoAddCoin2" [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName"
                                                    default=' xu vào ví người dùng mới'>
                                                </codx-label>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <codx-input type="text" class="form-control w-50px" placeholder="">
                                            </codx-input>
                                            <span class="icon-edit_file text-hover-primary icon-20 ml-3"
                                                (click)="openFormChangeCoin(changeCoin, 'DefaultCoins')"></span>
                                        </div>
                                    </div>

                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'MaxCoinsForEGiftControl'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{data.title}}
                                            </div>
                                            <div class="text-gray-500">
                                                <codx-label fiedName="LimitCoinToVoucher"
                                                    [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName" default='Giới hạn dùng'>
                                                </codx-label>
                                                {{quantity.MaxCoinsForEGift}}
                                                <codx-label fiedName="CoinToVoucher" [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName"
                                                    default=' xu đổi E-voucher'>
                                                </codx-label>
                                                {{quantity?.MaxCoinsForEGiftPeriod|vll:"L1436":"text"|async}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="switch switch-sm ml-3">
                                                <codx-input type="switch" name="checkbox" class="" ngDefaultControl
                                                    field="MaxCoinsForEGiftControl"
                                                    (valueChange)="valueChange($event, null)"
                                                    [checked]="quantity.MaxCoinsForEGiftControl" label="">
                                                </codx-input>
                                            </span>
                                            <span class="icon-edit_file text-hover-primary icon-20 w-20px h-20px ml-3"
                                                (click)="open(content, 2)"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.feildName == 'HasPoints'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                <codx-label fiedName="" [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName" default='Chính sách cộng xu
                                                theo ngày lễ/kỷ niệm'>
                                                </codx-label>
                                            </div>
                                            <div class="text-gray-500">
                                                <codx-label fiedName="" [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName" default='Chương trình tự động cộng xu khi vào ví người
                                                dùng vào những ngày lễ/kỷ niệm như thiết lập'>
                                                </codx-label>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="switch switch-sm ml-3">
                                                <input type="checkbox" checked="checked" name="select" />
                                            </span>
                                            <span class="w-20px h-20px ml-3 d-flex justify-content-center">
                                                <span class="icon-keyboard_arrow_right icon-20"></span>
                                            </span>
                                        </div>
                                    </div>
                                    <div *ngFor=" let item of getItems('1') ;let last = last">
                                        <ng-container
                                            *ngTemplateOutlet="PolicyItem ;context: {data:item,isLast:last  }">
                                        </ng-container>
                                    </div>
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'PolicyCoins'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <!-- Memo -->
                                            <div class="text-dark fw-bold fs-6">
                                                {{listParameter?.PolicyCoins?.memo}}
                                            </div>
                                            <!-- Description -->
                                            <div class="text-gray-500">
                                                {{listParameter?.PolicyCoins?.description}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="icon-keyboard_arrow_right icon-20"
                                                (click)="redirectPageDetailWallet('3')"></span>
                                        </div>
                                    </div>
                                </div>
                                <hr />
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="fs-4 fw-bold text-dark mb-6 mt-6">
                                        <codx-label fiedName="FundManager" [formName]="functionList?.formName"
                                            [gridViewName]="functionList?.gridViewName" default='Quản lý quỹ cho'>
                                        </codx-label>
                                    </div>
                                </div>
                                <div class="list-setting ml-10">
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'ActiveCoCoins'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{data.title}}
                                            </div>
                                            <div class="text-gray-500">
                                                {{data.description}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <!-- <input type="text" class="form-control w-50px"
                                                    [(ngModel)]="data.DefaultCoCoins" placeholder="" /> -->

                                            <span class="switch switch-sm ml-3">
                                                <codx-input type="switch" name="checkbox" class="" ngDefaultControl
                                                    field="ActiveCoCoins" (valueChange)="valueChange($event, null)"
                                                    [checked]="quantity.ActiveCoCoins" label="">
                                                </codx-input>
                                                <!-- [checked]="data.ActiveCoCoins == '1' ? true : false" -->
                                            </span>
                                            <span class="w-20px h-20px ml-3 d-flex justify-content-center"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'DefaultCoCoins'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{data.title}}
                                            </div>
                                            <div class="text-gray-500">
                                                <codx-label fiedName="AutoAddCointToNewUser"
                                                    [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName"
                                                    default='Chương trình tự động thêm '>
                                                </codx-label>
                                                {{quantity.DefaultCoCoins}}
                                                <codx-label fiedName="AutoAddCointToNewUser2"
                                                    [formName]="functionList?.formName"
                                                    [gridViewName]="functionList?.gridViewName"
                                                    default='xu vào quỹ cho người dùng mới'>
                                                </codx-label>
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <codx-input type="text" class="form-control w-50px" disabled
                                                [(ngModel)]="quantity.DefaultCoCoins" placeholder="">
                                            </codx-input>
                                            <span class="icon-edit_file text-hover-primary icon-20 ml-3"
                                                (click)="!disableGroupFund && openFormChangeCoin(changeCoin, 'DefaultCoCoins')"></span>
                                        </div>
                                    </div>

                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'ExchangeRateCoinsControl'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            {{data.title}}
                                            <div class="text-gray-500">
                                                {{'Cho phép đổi 1 xu từ ví nhân viên sang '| lang:
                                                'SettingWallet':'lblAcceptExchangeCoin' |
                                                async}}
                                                {{data.ExchangeRateCoins}}
                                                {{' xu quỹ cho để tặng trên phiếu phản hồi'| lang:
                                                'SettingWallet2':'lblAcceptExchangeCoin' | async}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="switch switch-sm ml-3">
                                                    <codx-input type="switch" name="checkbox" class="" ngDefaultControl
                                                        field="ExchangeRateCoinsControl"
                                                        (valueChange)=" valueChange($event, null)"
                                                        [checked]="quantity.ExchangeRateCoinsControl"
                                                        [disabled]="disableGroupFund" label="">
                                                    </codx-input>
                                            </span>
                                            <span class="icon-edit_file text-hover-primary icon-20 w-20px h-20px ml-3"
                                                (click)="!disableGroupFund && openFormChangeCoin(changeCoin, 'ExchangeRateCoins')"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-start py-4" *ngIf="scheduledTasks_CoCoin">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{'Refresh số dư quỹ cho' | lang: 'SettingWallet':'lblRefreshGive'
                                                |async}}
                                            </div>
                                            <div class="text-gray-500">
                                                {{'Chương trình tự động refresh lại quỹ cho về số quy định theo chu kỳ đã thiết lập' | lang: 'SettingWallet':'lblAutoRefreshSetting'
                                                |async}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="switch switch-sm ml-3">
                                                    <codx-input type="switch" name="checkbox" class="" ngDefaultControl
                                                        field="ResetCoCoinsControl"
                                                        (valueChange)="valueChangePolicyCoin('4')"
                                                        [checked]="!scheduledTasks_CoCoin?.stop" label="">
                                                    </codx-input>
                                            </span>
                                            <span class="icon-edit_file text-hover-primary icon-20 w-20px h-20px ml-3"
                                                (click)="openPopupSettingCycleRun('4')"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'PolicyCoCoins'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{listParameter?.PolicyCoCoins?.memo}}
                                            </div>
                                            <div class="text-gray-500">
                                                {{listParameter?.PolicyCoCoins?.description}}

                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="icon-keyboard_arrow_right icon-20"
                                                (click)="redirectPageDetailWallet('4')"></span>
                                        </div>
                                    </div>
                                </div>
                                <hr />
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="fs-4 fw-bold text-dark mb-6 mt-6">
                                        {{'Quản lý điểm cống hiến' | lang: 'SettingWallet':'lblManagePointDedicate'
                                        |async}}
                                    </div>
                                </div>
                                <div class="list-setting ml-10">
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'DefaultMyKudos'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{data.title}}
                                            </div>
                                            <div class="text-gray-500">
                                                {{'Chương trình tự động thêm ' | lang:
                                                'SettingWallet':'lblProgramAutoAddPoint' |async}}
                                                {{quantity.DefaultMyKudos}}
                                                {{' điểm cống hiến người dùng mới' | lang:
                                                'SettingWallet':'lblProgramAutoAddPoint2' |async}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <cdox-input type="text" class="form-control w-50px" placeholder="">
                                            </cdox-input>
                                            <span class="icon-edit_file text-hover-primary icon-20 ml-3"
                                                (click)="openFormChangeCoin(changeCoin, 'DefaultMyKudos')"></span>
                                        </div>
                                    </div>
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="scheduledTasks_KuDos">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{'Refresh số dư điểm cống hiến' | lang:
                                                'SettingWallet':'lblRefreshBalanceDedicate' |async}}
                                            </div>
                                            <div class="text-gray-500">
                                                {{'Chương trình tự động refresh lại điểm cống hiến về số quy định theo chu kỳ đã thiết lập' | lang: 'SettingWallet':'lblResetMyKudos'
                                                |async}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="switch switch-sm ml-3">
                                                    <codx-input type="switch" name="checkbox" class="" ngDefaultControl
                                                        field="scheduledTasks_KuDos?.recID"
                                                        (valueChange)="valueChangePolicyCoin('5')"
                                                        [checked]="!scheduledTasks_KuDos?.stop" label="">
                                                    </codx-input>
                                            </span>
                                            <span class="icon-edit_file text-hover-primary icon-20 w-20px h-20px ml-3"
                                                (click)="openPopupSettingCycleRun('5')"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="list-setting ml-10">
                                    <div class="d-flex align-items-start py-4 border-bottom border-light"
                                        *ngIf="data && data.fieldName == 'PolicyKudos'">
                                        <div class="d-flex flex-column flex-grow-1">
                                            <div class="text-dark fw-bold fs-6">
                                                {{listParameter?.PolicyKudos?.memo}}
                                            </div>
                                            <div class="text-gray-500">
                                                {{listParameter?.PolicyKudos?.description}}
                                            </div>
                                        </div>
                                        <div class="d-flex align-items-center ml-4">
                                            <span class="icon-keyboard_arrow_right icon-20"
                                                (click)="redirectPageDetailWallet('5')"></span>
                                        </div>
                                    </div>
                                    <div *ngFor=" let data of getItems('2') ;let last = last">
                                        <ng-container
                                            *ngTemplateOutlet="PolicyItem ;context: {data:data,isLast:last  }">
                                        </ng-container>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<ng-template #content let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title">
                {{'Giới hạn xu đổi E-voucher' | lang: 'SettingWallet':'lblLimitCointToVoucher' |async}}
            </h4>
            <button type="button" class="close" aria-label="Close">
                <i class="icon-close icon-20 text-dark text-hover-primary" (click)="modal.dismiss('Cross click')"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group row mt-3">
                <label class="col-3 col-form-label">
                    {{'Số lượng' | lang: 'SettingWallet':'lblQuanlity' |async}}
                </label>
                <div class="col-9">
                    <cdox-input type="number" class="form-control" [(ngModel)]="data.MaxCoinsForEGift"
                        onkeypress="return event.charCode >= 48 && event.charCode <= 57" placeholder="10">
                    </cdox-input>
                </div>
            </div>
            <div class="form-group row mt-3">
                <label class="col-3 col-form-label">
                    {{'Chu kỳ' | lang: 'SettingWallet':'lblCycle' |async}}
                </label>
                <div class="col-9">
                    <codx-input type="select" name="select" class="control-vll" placeholder="" ngDefaultControl
                        refValue="L1436" field="MaxCoinsForEGiftPeriod" [value]="data.MaxCoinsForEGiftPeriod"
                        (valueChange)="changValueListPopup($event)">
                    </codx-input>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="onSavePopupCombobx()">
                {{'Lưu' | lang: 'SettingWallet':'lblSave' |async}}
            </button>
        </div>
    </div>
</ng-template>
<ng-template #PolicyItem let-data="data">
    <div class="d-flex align-items-start py-4">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark fw-bold fs-6">{{data.policyName}}
            </div>
            <div class="text-gray-500">{{data.memo}}</div>
        </div>
        <div class="d-flex align-items-center ml-4">
            <span class="switch switch-sm ml-3">
                <codx-input type="switch" name="checkbox" class="" ngDefaultControl [field]="data.recID"
                    (valueChange)="onSaveStatusPolicy($event, null)" [checked]="data.actived" label="">
                </codx-input>
            </span>
            <span class="w-20px h-20px ml-3 d-flex justify-content-center">
                <span class="icon-keyboard_arrow_right icon-20" style="cursor: pointer;"
                    (click)="data.actived && LoadDetailPolicy(data.category,data.recID)"></span>
            </span>
        </div>
    </div>
</ng-template>
<ng-template #changeCoin let-modal>
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title" id="modal-basic-title" *ngIf="this.fieldUpdateCoin !='DefaultMyKudos'">
                {{'Thay đổi số lượng xu' | lang: 'SettingWallet':'lblLimitCointToVoucher' |async}}
            </h4>
            <h4 class="modal-title" id="modal-basic-title" *ngIf="this.fieldUpdateCoin =='DefaultMyKudos'">
                {{'Thay đổi số dư điểm cống hiến' | lang: 'SettingWallet':'lblLimitCointToVoucher' |async}}
            </h4>
            <button type="button" class="close" aria-label="Close">
                <i class="icon-close icon-20 text-dark text-hover-primary" (click)="emptyObjectUpdate()"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="form-group row mt-3">
                <label class="col-3 col-form-label">
                    {{'Số lượng' | lang: 'SettingWallet':'lblQuanlity' |async}}
                </label>
                <div class="col-9">
                    <codx-input type="number" class="form-control" [(ngModel)]="objectUpdateCoin[this.fieldUpdateCoin]"
                        onkeypress="return event.charCode >= 48 && event.charCode <= 57" placeholder="10">
                    </codx-input>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-primary" (click)="handleSaveParameter()">
                {{'Lưu' | lang: 'SettingWallet':'lblSave' |async}}
            </button>
        </div>
    </div>
</ng-template>
<!-- <lv-setting-cycle #settingCycle [applyFor]="applyFor" [scheduledTasks]="scheduledTasks"
    (onSaveModel)="saveSettingCycleRun()"></lv-setting-cycle> -->