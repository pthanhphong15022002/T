<div class="fs-4 fw-bold text-dark mb-6 mt-6" *ngIf="isShowPolicyCard">
    <codx-label name="lblPolicyCard" [formModel]="formModel" [default]="'Chính sách phiếu'"></codx-label>
</div>
<div class="list-setting ml-10 policyCard">
    <div class="d-flex align-items-start py-4 border-bottom border-light" *ngIf="item.hasOwnProperty('HasPoints')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblGivePoints" [formModel]="formModel" [default]="'Tặng điểm'"></codx-label>
            </div>
            <div class="text-dark-50">
                <codx-label name="lblAllowSendPoints" [formModel]="formModel"
                    [default]="'Cho phép người gửi tặng điểm khi tạo phiếu.'"></codx-label>
            </div>
        </div>
        <div class="ml-4 d-flex justify-content-between">
            <span class="switch switch-sm">
                <codx-input type="switch" class="test-check" field="HasPoints" (valueChange)="valueChangeSwitch($event)"
                    [checked]="item.HasPoints === '1' ? true : false">
                </codx-input>
            </span>
            <span class="w-30px h-20px d-flex justify-content-center"></span>
        </div>
    </div>
    <div class="d-flex align-items-start py-4 border-bottom border-light" *ngIf="item.hasOwnProperty('HasGifts')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblGift" [formModel]="formModel" [default]="'Quà tặng'"></codx-label>
            </div>
            <div class="text-dark-50">
                <codx-label name="lblGiveGiftCreating" [formModel]="formModel"
                    [default]="'Cho phép người gửi tặng quà khi tạo phiếu.'"></codx-label>
            </div>
        </div>
        <div class="ml-4 d-flex align-items-center">
            <span class="switch switch-sm">
                <codx-input type="switch" class="test-check" field="HasGifts" (valueChange)="valueChangeSwitch($event)"
                    [checked]="item.HasGifts === '1' ? true:false" label="">
                </codx-input>
            </span>
            <span class="w-30px h-20px d-flex justify-content-center"></span>
        </div>
    </div>
    <div class="d-flex align-items-start py-4 border-bottom border-light"
        *ngIf="item.hasOwnProperty('ApprovalControl')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblApprovalControl" [formModel]="formModel" [default]="'ApprovalControl'">
                </codx-label>
            </div>
            <div class="text-dark-50">
                <codx-label name="lblApprovalControl2" [formModel]="formModel"
                    [default]="'Kiểm soát thông qua xét duyệt để tính chính sách xu/điểm cống hiến cho phiếu'">
                </codx-label>
            </div>
        </div>
        <div class="d-flex align-items-center ml-4">
            <ng-template #UserGroups let-modal>
                <codx-combobox-popup [comboboxName]="'ApproverGroups'" [field]="'cbbUser'" [multiple]="true"
                    [width]="700" [height]="600" [value]="" [formModel]="formModel"
                    (clickSave)="changeCombobox($event)">
                </codx-combobox-popup>
            </ng-template>

            <div class="d-flex align-items-center">
                <span class="switch switch-sm ml-3">
                    <codx-input type="switch" class="test-check" field="ApprovalControl"
                        (valueChange)="valueChangeSwitch($event)"
                        [checked]="item.ApprovalControl === '1' ? true : false"
                        [disabled]="this.typeCard == '7' ? true : false">
                    </codx-input>
                </span>
                <span class="w-30px h-20px d-flex justify-content-center">
                    <span class="icon-edit text-hover-primary icon-20"
                        (click)="openPopupCbb(UserGroups)"></span>
                </span>
            </div>
        </div>
    </div>
    <div class="d-flex align-items-start py-4 border-bottom border-light" *ngIf="item.hasOwnProperty('MaxSendControl')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblVotingLimit" [formModel]="formModel" [default]="'Giới hạn phiếu cho'"></codx-label>
            </div>
            <div class="text-dark-50">
                {{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                {{item.MaxSends}} {{'phiếu' | lang:'PolicyCard':'lblCoin' | async}}
                {{item?.MaxSendPeriod|vll:"L1435":"text"|async}}
            </div>
        </div>
        <div class="d-flex align-items-center ml-4">
            <span class="switch switch-sm ml-3">
                <codx-input type="switch" class="test-check" field="MaxSendControl"
                    (valueChange)="valueChangeSwitch($event)" [checked]="item.MaxSendControl === '1' ? true : false">
                </codx-input>
            </span>
            <span class="w-30px h-20px d-flex justify-content-center">
                <span class=" icon-edit text-hover-primary icon-20" (click)="open(content, 0)"></span>
            </span>

        </div>
    </div>
    <div class="d-flex align-items-start py-4 border-bottom border-light"
        *ngIf="item.hasOwnProperty('MaxReceiveControl')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblLimitedVouchers" [formModel]="formModel" [default]="'Giới hạn phiếu nhận'">
                </codx-label>
            </div>
            <div class="text-dark-50">
                {{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                {{item.MaxReceives}} {{'phiếu' | lang:'PolicyCard':'lblCoin' | async}}
                {{item?.MaxReceivePeriod|vll:"L1435":"text"|async}}
            </div>
        </div>
        <div class="d-flex align-items-center ml-4">
            <span class="switch switch-sm ml-3">
                <codx-input type="switch" class="test-check" field="MaxReceiveControl"
                    (valueChange)="valueChangeSwitch($event)" [checked]="item.MaxReceiveControl === '1' ? true : false">
                </codx-input>
            </span>
            <span class="w-30px h-20px d-flex justify-content-center">
                <span class="icon-edit text-hover-primary icon-20" (click)="open(content, 1)"></span>
            </span>

        </div>
    </div>
    <div class="d-flex align-items-start py-4 border-bottom border-light"
        *ngIf="item.hasOwnProperty('MaxPointControl')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblCoinLimit" [formModel]="formModel" [default]="'Giới hạn xu cho'"></codx-label>
            </div>
            <div class="text-dark-50">
                {{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                {{item.MaxPoints}} {{'xu' | lang:'PolicyCard':'lblCoin' | async}}
                {{item?.MaxPointPeriod|vll:"L1435":"text"|async}}</div>
        </div>
        <div class="d-flex align-items-center ml-4">
            <span class="switch switch-sm ml-3">
                <codx-input type="switch" class="test-check" field="MaxPointControl"
                    (valueChange)="valueChangeSwitch($event)" [checked]="item.MaxPointControl === '1' ? true:false">
                </codx-input>
            </span>
            <span class="w-30px h-20px d-flex justify-content-center">
                <span class="icon-edit text-hover-primary icon-20" (click)="open(content, 2)"></span>
            </span>

        </div>
    </div>
    <div class="d-flex align-items-start py-4" *ngIf="item.hasOwnProperty('MaxPointPerOnceControl')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblCoinVotesLimit" [formModel]="formModel" [default]="'Giới hạn xu cho/phiếu'">
                </codx-label>
            </div>
            <div class="text-dark-50">{{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                {{item.MaxPointPerOnce}} {{'xu mỗi phiếu' | lang:'PolicyCard':'lblCoinVotes' | async}}
            </div>
        </div>
        <div class="d-flex align-items-center ml-4">
            <span class="switch switch-sm ml-3">
                <codx-input type="switch" class="test-check" field="MaxPointPerOnceControl"
                    (valueChange)="valueChangeSwitch($event)"
                    [checked]="item.MaxPointPerOnceControl === '1' ? true : false">
                </codx-input>
            </span>
            <span class="w-30px h-20px d-flex justify-content-center">
                <span class="icon-edit text-hover-primary icon-20" (click)="open(content, 3)"></span>
            </span>
        </div>
    </div>
    <div class="d-flex align-items-start py-4 border-bottom border-light" *ngIf="item.hasOwnProperty('RuleSelected')">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold font-size-h6">
                <codx-label name="lblInputRulesBehavior" [formModel]="formModel"
                    [default]="'Kiểm soát nhập quy tắc/ hành vi ứng xử'"></codx-label>
            </div>
            <div class="text-dark-50">
                <codx-label name="lblInputRulesBehaviorBallot" [formModel]="formModel"
                    [default]="'Kiểm soát bắt buộc nhập liệu và chọn quy tắc/hành vi ứng xử trên phiếu'"></codx-label>
            </div>
        </div>
        <div class="ml-4">
            <div class="lv-control">
                <codx-input type="valuelist" class="control-vll w-250px" placeholder="" refValue="L1439" field="edit"
                    [crrValue]="item.RuleSelected" (valueChange)="changeValueListRuleSelected($event)">
                </codx-input>
            </div>
        </div>
    </div>
    <div class="d-flex align-items-start py-4 border-bottom border-light"
        *ngIf="item.hasOwnProperty('PolicyControl') && item?.PolicyControl!==''">
        <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold">
                <codx-label name="lblApplyCoinPoint" [formModel]="formModel"
                    [default]="'Áp dụng chính sách tính xu/điểm'">
                </codx-label>
            </div>
            <div class="text-dark-50">
                <codx-label name="lblApplyCoinPoint2" [formModel]="formModel"
                    [default]="'Kiểm soát áp dụng các loại chính sách tính xu/điểm'"></codx-label>
            </div>
        </div>
        <div class="ml-4">
            <div class="lv-control">
                <codx-input type="valuelist" class="control-vll w-250px" placeholder="" [refValue]="valueListNameCoin"
                    field="PolicyControl" [crrValue]="item.PolicyControl" (valueChange)="valueChangValueList($event)">
                </codx-input>
            </div>
        </div>
    </div>
</div>

<ng-template #content let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">{{ modelForm.title }}</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        </button>
    </div>
    <div class="modal-body">
        <div class="row form-group">
            <div class="col-xl-3 col-md-3">
                <codx-label name="lblQuantity" [formModel]="formModel" [default]="'Số lượng'"></codx-label>
            </div>
            <div class="col-xl-9 col-md-9">
                <codx-input [crrValue]="modelForm.quantity" type="number" min="1" class="form-control" [showSpinButton]="false"
                    onkeypress="return event.charCode >= 48 && event.charCode <= 57" placeholder="3"
                    (valueChange)="valueChangeQuantity($event)">
                </codx-input>
            </div>
        </div>

        <div class="row form-group" *ngIf="modelForm.type == 0 || modelForm.type == 1 || modelForm.type == 2">
            <div class="col-xl-3 col-md-3">
                <codx-label name="lblCycle" [formModel]="formModel" [default]="'Chu kỳ'"></codx-label>
            </div>
            <div class="col-xl-9 col-md-9">
                <div class="lv-control">
                    <codx-input type="valuelist" class="control-vll w-338px" placeholder="" refValue="L1435"
                        field="edit" [crrValue]="modelForm.cycle"
                        (valueChange)="changValueListPopup($event,modelForm.type)">
                    </codx-input>
                </div>
            </div>
        </div>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="onSavePopup(modelForm.type)">
            {{'Lưu' | lang:'PolicyCard':'lblSave' | async}}
        </button>
    </div>
</ng-template>