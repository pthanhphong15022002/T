<div class="fs-4 fw-bold text-dark mb-3 mt-9" *ngIf="isShowPolicyCard">
    <codx-label name="lblPolicyCard" [formModel]="formModel" [default]="'Chính sách phiếu'"></codx-label>
</div>
<ng-container *ngIf="data">
    <div class="list-setting ms-10 policyCard" *ngFor="let item of data">
        <div class="d-flex align-items-start py-4 border-bottom border-light" *ngIf="item.fieldName == 'HasPoints'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{item.description}}
                </div>
            </div>
            <div class="ms-4 d-flex justify-content-between">
                <span class="switch switch-sm">
                    <codx-input type="switch" class="test-check" field="HasPoints"
                        (valueChange)="valueChangeSwitch($event)" [checked]="quantity.HasPoints === '1' ? true : false">
                    </codx-input>
                </span>
                <span class="setting-btnright"></span>
            </div>
        </div>
        <div class="d-flex align-items-start py-4 border-bottom border-light" *ngIf="item.fieldName == 'HasGifts'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{item.description}}
                </div>
            </div>
            <div class="ms-4 d-flex align-items-center">
                <span class="switch switch-sm">
                    <codx-input type="switch" class="test-check" field="HasGifts"
                        (valueChange)="valueChangeSwitch($event)" [checked]="quantity.HasGifts === '1' ? true:false"
                        label="">
                    </codx-input>
                </span>
                <span class="setting-btnright"></span>
            </div>
        </div>
        <div class="d-flex align-items-start py-4 border-bottom border-light"
            *ngIf="item.fieldName == 'ApprovalControl'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{item.description}}
                </div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <ng-template #UserGroups let-modal>
                    <codx-combobox-popup [comboboxName]="item.fieldName" [field]="'cbbUser'" [multiple]="true"
                        [width]="700" [height]="600" [value]="" [formModel]="formModel"
                        (clickSave)="changeCombobox($event)">
                    </codx-combobox-popup>
                </ng-template>

                <div class="d-flex align-items-center">
                    <span class="pt-1">
                        <codx-input type="switch" class="test-check" field="ApprovalControl"
                            (valueChange)="valueChangeSwitch($event)"
                            [checked]="quantity.ApprovalControl === '1' ? true : false"
                            [disabled]="this.typeCard == '7' ? true : false">
                        </codx-input>
                    </span>
                    <span class="setting-btnright">
                        <ng-container
                            *ngIf="quantity.ApprovalControl || quantity.ApprovalControl === '1'; else noPopupApprovalControl">
                            <span class="icon-edit-one text-hover-primary icon-18"
                                (click)="openPopupCbb(UserGroups)"></span>
                        </ng-container>
                        <ng-template #noPopupApprovalControl>
                            <span class="icon-edit-one text-hover-primary icon-18"></span>
                        </ng-template>

                    </span>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-start py-4 border-bottom border-light"
            *ngIf="item.fieldName == 'MaxSendControl'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                    {{quantity?.MaxSends}} {{'phiếu' | lang:'PolicyCard':'lblCoin' | async}}
                    {{quantity?.MaxSendPeriod|vll:"L1435":"text"|async}}
                </div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <span class="pt-1">
                    <codx-input type="switch" class="test-check" field="MaxSendControl"
                        (valueChange)="valueChangeSwitch($event)"
                        [checked]="quantity.MaxSendControl == '1' ? true : false">
                    </codx-input>
                </span>
                <span class="setting-btnright">
                    <ng-container
                        *ngIf="quantity.MaxSendControl || quantity.MaxSendControl == '1'; else noPopupMaxSendControl">
                        <span class="icon-edit-one text-hover-primary icon-18" (click)="open(content, 0)"></span>
                    </ng-container>
                    <ng-template #noPopupMaxSendControl>
                        <span class="icon-edit-one text-hover-primary icon-18"></span>
                    </ng-template>
                </span>
            </div>
        </div>
        <div class="d-flex align-items-start py-4 border-bottom border-light"
            *ngIf="item.fieldName == 'MaxReceiveControl'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                    {{quantity?.MaxReceives}} {{'phiếu' | lang:'PolicyCard':'lblCoin' | async}}
                    {{quantity?.MaxReceivePeriod|vll:"L1435":"text"|async}}
                </div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <span class="pt-1">
                    <codx-input type="switch" class="test-check" field="MaxReceiveControl"
                        (valueChange)="valueChangeSwitch($event)"
                        [checked]="quantity.MaxReceiveControl === '1' ? true : false">
                    </codx-input>
                </span>
                <span class="setting-btnright">
                    <ng-container
                        *ngIf="quantity.MaxReceiveControl || quantity.MaxReceiveControl === '1'; else noPopupMaxReceiveControl">
                        <span class="icon-edit-one text-hover-primary icon-18" (click)="open(content, 1)"></span>
                    </ng-container>
                    <ng-template #noPopupMaxReceiveControl>
                        <span class="icon-edit-one text-hover-primary icon-18"></span>
                    </ng-template>

                </span>

            </div>
        </div>
        <div class="d-flex align-items-start py-4 border-bottom border-light"
            *ngIf="item.fieldName == 'MaxPointControl'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                    {{quantity.MaxPoints}} {{'xu' | lang:'PolicyCard':'lblCoin' | async}}
                    {{quantity?.MaxPointPeriod|vll:"L1435":"text"|async}}</div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <span class="pt-1">
                    <codx-input type="switch" class="test-check" field="MaxPointControl"
                        (valueChange)="valueChangeSwitch($event)"
                        [checked]="quantity.MaxPointControl === '1' ? true:false">
                    </codx-input>
                </span>
                <span class="setting-btnright">
                    <ng-container
                        *ngIf="quantity.MaxPointControl || quantity.MaxPointControl === '1'; else noPopupMaxPointControl">
                        <span class="icon-edit-one text-hover-primary icon-18" (click)="open(content, 2)"></span>
                    </ng-container>
                    <ng-template #noPopupMaxPointControl>
                        <span class="icon-edit-one text-hover-primary icon-18"></span>
                    </ng-template>

                </span>
            </div>
        </div>
        <div class="d-flex align-items-start py-4" *ngIf="item.fieldName == 'MaxPointPerOnceControl'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">{{'Số lượng' | lang:'PolicyCard':'lblQuantity' | async}}
                    {{quantity.MaxPointPerOnce}} {{'xu mỗi phiếu' | lang:'PolicyCard':'lblCoinVotes' | async}}
                </div>
            </div>
            <div class="d-flex align-items-center ms-4">
                <span class="pt-1">
                    <codx-input type="switch" class="test-check" field="MaxPointPerOnceControl"
                        (valueChange)="valueChangeSwitch($event)"
                        [checked]="quantity.MaxPointPerOnceControl === '1' ? true : false">
                    </codx-input>
                </span>
                <span class="setting-btnright">
                    <ng-container
                        *ngIf="quantity.MaxPointPerOnceControl || quantity.MaxPointPerOnceControl === '1'; else noPopupMaxPointPerOnceControl">
                        <span class="icon-edit-one text-hover-primary icon-18" (click)="open(content, 3)"></span>
                    </ng-container>
                    <ng-template #noPopupMaxPointPerOnceControl>
                        <span class="icon-edit-one text-hover-primary icon-18"></span>
                    </ng-template>
                </span>
            </div>
        </div>
        <div class="d-flex align-items-start py-4 border-bottom border-light" *ngIf="item.fieldName == 'RuleSelected'">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{item.description}}
                </div>
            </div>
            <div class="ms-4">
                <div class="lv-control">
                    <codx-input type="valuelist" class="control-vll w-250px" placeholder="" refValue="L1439"
                        field="edit" [crrValue]="quantity.RuleSelected"
                        (valueChange)="changeValueListRuleSelected($event)">
                    </codx-input>
                </div>
            </div>
        </div>
        <div class="d-flex align-items-start py-4 border-bottom border-light"
            *ngIf="item.fieldName == 'PolicyControl' && quantity?.PolicyControl !== ''">
            <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold fs-6">
                    {{item.title}}
                </div>
                <div class="text-gray-500">
                    {{item.description}}
                </div>
            </div>
            <div class="ms-4">
                <div class="lv-control">
                    <codx-input type="valuelist" class="control-vll w-250px" placeholder=""
                        [refValue]="valueListNameCoin" field="PolicyControl" [crrValue]="quantity.PolicyControl"
                        (valueChange)="valueChangValueList($event)">
                    </codx-input>
                </div>
            </div>
        </div>
    </div>
</ng-container>
<ng-template #content let-modal>
    <div class="modal-header p-5">
        <h4 class="modal-title" id="modal-basic-title">{{ modelForm.title }}</h4>
        <button type="button" class="btn btn-icon btn-sm btn-white" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span class="icon-close icon-18"></span>
        </button>
    </div>
    <div class="modal-body">
        <div class="form-group">
            <div class="mb-1">
                <codx-label name="lblQuantity" [formModel]="formModel" [default]="'Số lượng'"></codx-label>
            </div>
            <div class="">
                <codx-input [crrValue]="modelForm.quantity" type="number" min="1" class="form-control"
                    [showSpinButton]="false" onkeypress="return event.charCode >= 48 && event.charCode <= 57"
                    placeholder="3" (valueChange)="valueChangeQuantity($event)">
                </codx-input>
            </div>
        </div>

        <div class="form-group" *ngIf="modelForm.type == 0 || modelForm.type == 1 || modelForm.type == 2">
            <div class="mb-1">
                <codx-label name="lblCycle" [formModel]="formModel" [default]="'Chu kỳ'"></codx-label>
            </div>
            <div class="lv-control">
                <codx-input type="valuelist" class="control-vll w-338px" placeholder="" refValue="L1435" field="edit"
                    [crrValue]="modelForm.cycle" (valueChange)="changValueListPopup($event,modelForm.type)">
                </codx-input>
            </div>
        </div>
    </div>
    <div class="modal-footer px-5 py-4">
        <button type="button" class="btn btn-primary" (click)="onSavePopup(modelForm.type)"
            (click)="modal.close('Save click')">
            {{'Lưu' | lang:'PolicyCard':'lblSave' | async}}
        </button>
    </div>
</ng-template>