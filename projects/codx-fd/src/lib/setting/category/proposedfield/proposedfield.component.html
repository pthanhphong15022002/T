<codx-views [views]="views" #viewbase [funcID]="funcID" [entityName]="'BS_Industries'"
    (buttonClick)="openFormCreate($event, true)" [buttons]="button"></codx-views>

<ng-template #panelLeft>
    <div class="list-table">
        <codx-gridview [columnsGrid]="columnsGrid" [itemTemplate]="itemTemplate" service="BS"
            assemblyName="ERM.Business.BS" className="IndustriesBusiness" method="LoadDataIndustryAsync"
            [predicate]="predicate" [dataValue]="dataValue" entityName="BS_Industries" [pageSize]="15" [height]="'520'"
            [headerStyle]="headerStyle" [columnStyle]="columnStyle" #gridView>
        </codx-gridview>
    </div>
</ng-template>

<ng-template #panelRightRef>
    <!-- offcanvas cập nhật thông tin -->
    <div id="canvas_hanhviungxu" class="offcanvas offcanvas-md offcanvas-right">
        <div class="offcanvas-header" kt-hidden-height="46">
            <div class="d-flex align-items-center justify-content-between header">
                <h2 class="m-0">
                    <codx-label *ngIf="isAddMode" formName="BS_Industries" name="lblTitleAddIndustries"
                        default="Thêm mới">
                    </codx-label>
                    <codx-label *ngIf="!isAddMode" formName="BS_Industries" name="lblTitleEditIndustries"
                        default="Chỉnh sửa"></codx-label>
                </h2>
                <a class="btn btn-xs btn-icon btn-light btn-hover-primary">
                    <span (click)="clickClosePopup()" class="icon-close icon-18"></span>
                </a>
            </div>
        </div>
        <div class="offcanvas-content content">
            <form>
                <div class="offcanvas-wrapper">
                    <div class="d-flex">
                        <div class="flex-grow-1">
                            <div class="form-group">
                                <codx-label formName="BS_Industries" name="lblIndustryID" default="Mã lĩnh vực"
                                    class="font-1rem font-w550">
                                </codx-label>
                                <span class="required"></span>
                                <codx-input type="text" class="form-control" formControlName="industryID"
                                    [disabled]="isAddMode ? false : true" placeholder="Mã lĩnh vực"
                                    (valueChange)="valueChange($event)" field="industryID"
                                    [crrValue]="addEditForm.controls['industryID'].value">
                                </codx-input>
                            </div>
                            <div class="form-group">
                                <codx-label formName="BS_Industries" name="lblIndustryName" default="Tên lĩnh vực"
                                    class="font-1rem font-w550">
                                </codx-label>
                                <span class="required"></span>
                                <codx-input type="text" class="form-control" placeholder="Tên lĩnh vực"
                                    formControlName="industryName"
                                    [crrValue]="addEditForm.controls['industryName'].value"
                                    (valueChange)="valueChange($event)" field="industryName">
                                </codx-input>
                            </div>
                            <div class="form-group mt-3">
                                <codx-label formName="BS_Industries" name="lblNote" default="Ghi chú"
                                    class="font-1rem font-w550">
                                </codx-label>
                                <codx-input type="textarea" class="form-control text-area" rows="3"
                                    formControlName="note" (valueChange)="valueChange($event)" field="note"
                                    [crrValue]="addEditForm.controls['note'].value">
                                </codx-input>
                            </div>
                            <div class="form-group">
                                <codx-label formName="BS_Industries" name="lblOwer" default="Người sở hữu"
                                    class="font-1rem font-w550">
                                </codx-label>
                                <span class="required"></span>
                                <codx-input (valueChange)="changeCombobox($event)" id="edit-usergroups" type="combobox"
                                    name="combobox" [crrValue]="addEditForm.controls['owner'].value"
                                    class=" form-control borderless p-0" style="border: none;"
                                    placeholder="Quy tắc ứng xử" ngDefaultControl refValue="Users" loadFull="false"
                                    field="owner" service="HR">
                                </codx-input>
                            </div>
                            <div class="d-flex align-items-start user-card mt-5">
                                <div class="pic mr-3 upload-img">
                                    <codx-img [objectId]="ownInfo?.domainUser" [isAllowEdit]="true" [funcId]="funcID"
                                        *ngIf="ownInfo?.domainUser" objectType="AD_Users" #imageUpLoad [width]="90">
                                    </codx-img>
                                </div>
                                <div class="d-flex flex-column flex-grow-1">
                                    <div class="text-dark font-weight-bold font-size-h6">{{ownInfo?.employeeName}}</div>
                                    <div class="text-dark-75 font-weight-bold">{{ownInfo?.positionName}}</div>
                                    <div class="text-dark-50">{{ownInfo?.departmentName}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-footer pt-4 footer">
                    <button type="button" class="btn btn-primary" (click)="onSaveForm()">
                        <codx-label formName="BS_Industries" name="lblBtnAdd" default="Lưu">
                        </codx-label>
                    </button>
                </div>
            </form>
        </div>
    </div>
    <div class="offcanvas-overlay"></div>
</ng-template>
<ng-template #itemTemplate>
    <div>
        <td>
            <div class="dropdown">
                <button class="btn btn-icon btn-xs" type="button" id="dropdownMenuButton" data-toggle="dropdown"
                    aria-haspopup="true" aria-expanded="false">
                    <span class="icon-more_vert icon-20"></span>
                </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                    <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                            <span class="icon-create icon-18"></span>
                            <span class="ml-3">Chỉnh sửa</span>
                        </div>
                    </a>
                    <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                            <span class="icon-delete icon-18"></span>
                            <span class="ml-3">Xóa</span>
                        </div>
                    </a>
                </div>
            </div>
        </td>
        <td>R2021001</td>
        <td>Điện tử</td>
        <td>
            <div class="text-dark-50">Chủ động lắng nghe phản hồi cụ thể và
                giải quyết kịp
                thời
                nhu cầu của khách
                hàng, các đối tác, nhà cung cấp và các bên liên quan để đạt được mục đích và
                mong đợi giữa các bên
            </div>
        </td>
        <td>
            <div class="d-flex align-items-center">
                <div class="symbol symbol-24 symbol-circle mr-3">
                    <img alt="Pic" src="../../../assets/demos/user/user7.jpg">
                </div>
                <div class="text-dark font-size-lg">Lê Thị Bảo Ngọc</div>
            </div>
        </td>
        <td>
            <div class="erm-date">27/7/2021</div>
        </td>
    </div>
</ng-template>
<ng-template #itemCreateBy let-dataItem>
    <div (mouseenter)="PopoverEmpEnter(empPopover, dataItem)">
        <div class="d-flex align-items-center" #itemCreateBy #empPopover="ngbPopover" [ngbPopover]="moreFunction"
            placement="top" container="body">
            <div class="w-30 h-30">
                <codx-img class="symbol symbol-30px symbol-circle me-4" [objectId]="dataItem.createdBy"
                    objectType="AD_Users" [width]="30" [funcId]="funcID">
                </codx-img>
            </div>
            <div *ngIf="dataItem.createName == null; else other" class="text-dark font-size-lg">{{userName}}</div>
            <ng-template #other>
                <span>{{dataItem.createName}}</span>
            </ng-template>
        </div>
    </div>
</ng-template>
<ng-template #itemOwner let-dataItem>
    <div *ngIf="industryIdUpdate == dataItem.industryID || checkAddEdit; else other">
        <div *ngIf="dataItem.ownDomain == null && dataItem.ownName == null && dataItem.ownPosition == null; else other">
            <div class="d-flex align-items-center">
                <div class="h-30 w-30">
                    <codx-img class="symbol symbol-30px symbol-circle me-4" [objectId]="ownDomain" objectType="AD_Users"
                        [width]="30" [funcId]="funcID">
                    </codx-img>
                </div>
                <div class="d-flex flex-column">
                    <div class="text-dark font-size-lg">{{ownName}}</div>
                    <div class="text-dark-50">{{ownPosition}}</div>
                </div>
            </div>
        </div>
    </div>
    <ng-template #other>
        <div class="d-flex align-items-center">
            <div class="h-30 w-30">
                <codx-img class="symbol symbol-30px symbol-circle me-4" [objectId]="dataItem.ownDomain"
                    objectType="AD_Users" [width]="30" [funcId]="funcID">
                </codx-img>
            </div>
            <div class="d-flex flex-column">
                <div class="text-dark font-size-lg">{{dataItem.ownName}}</div>
                <div class="text-dark-50">{{dataItem.ownPosition}}</div>
            </div>
        </div>
    </ng-template>
</ng-template>

<ng-template #note let-item>
    <span [innerHTML]="item.note"></span>
</ng-template>

<ng-template #createdOn let-item>
    <span>{{item.createdOn | date: 'dd/MM/yyy'}}</span>
</ng-template>

<ng-template #moreFunction>
    <div class="flex">
        <a class="action-item d-flex align-items-center">
            <span class="icon-edit icon-18 ml-2 mr-2 active" (click)="openFormCreate(dataItem, false)"></span>
        </a>
        <a class="action-item d-flex align-items-center" (click)="deleteProposedField(dataItem)">
            <span class="icon-close icon-18 text-danger mx-2"></span>
        </a>
    </div>
</ng-template>