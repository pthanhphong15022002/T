<codx-views #view [funcID]="funcID" service="FD" entityName="FD_KudosTrans" [views]="views" [autoLoad]="false">
</codx-views>

<ng-template #templateLeft>
    <div class="page-home page-master">
        <div class="d-flex flex-row w-100">
            <div class="d-flex flex-column w-100" id="erm_content">
                <div class="container d-flex pb-0 pd-r-0">
                    <div class="w-100 pr-6 mt-3 left-20 pd-r-10">
                        <div class="d-flex align-items-top">
                            <div class="me-3 w-150px">
                                <div class="d-flex flex-column mb-3">
                                    <codx-label name="lblfirstDay" formName="FD_KudosTrans" default="Từ ngày">
                                    </codx-label>
                                    <codx-input type="datetime" format="d" class="form-control" [crrValue]="firstDate"
                                        field="firstDay" ngDefaultControl
                                        (valueChange)="valueChange($event, 'firstDay')">
                                    </codx-input>
                                </div>
                            </div>
                            <div class="me-3 w-150px left-5">
                                <div class="d-flex flex-column mb-3" #ToDate>
                                    <codx-label name="lblToDate" formName="FD_KudosTrans" default="Đến ngày">
                                    </codx-label>
                                    <codx-input type="datetime" format="d" class="form-control" [crrValue]="toDate"
                                        field="toDate" ngDefaultControl (valueChange)="valueChange($event, 'toDate')">
                                    </codx-input>
                                </div>
                            </div>
                            <div class="me-3 left-5">
                                <div class="d-flex flex-column mb-3" #Organize>
                                    <codx-label name="lblOrganize" formName="FD_KudosTrans" default="Cơ cấu tổ chức">
                                    </codx-label>
                                    <div class="d-flex header-combo">
                                        <codx-input class="form-control" type="valuelist" field="vllOrganize"
                                            refValue="L1483" (valueChange)="valueChange($event, 'vllOrganize')">
                                        </codx-input>
                                        <div class="organize left-5">
                                            <codx-input class="form-control" type="combobox" field="Organize"
                                                [refValue]="comboboxName"
                                                (valueChange)="valueChange($event, 'Organize')">
                                            </codx-input>
                                        </div>
                                        <!-- <div class="organize left-5" *ngIf="!comboboxName">
                                            <codx-input class="form-control" type="combobox">
                                            </codx-input>
                                        </div> -->
                                    </div>
                                </div>
                            </div>
                            <div class="me-3 w-200px left-5">
                                <div class="d-flex flex-column mb-3" #Employee>
                                    <codx-label name="lblEmployee" formName="FD_KudosTrans" default="Nhân viên">
                                    </codx-label>
                                    <codx-input class="form-control" type="combobox" field="Employee"
                                        refValue="Employees" (valueChange)="valueChange($event, 'Employee')">
                                    </codx-input>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex">
                            <div class="chart chart-circle pr-9 chart-received">
                                <div style="display: block">
                                    <ng-container *ngIf="chartDatas.length !== 0">
                                        <codx-label name="lblCoinsReceived" formName="FD_KudosTrans" default="Xu nhận"
                                            class="lbl-coin"></codx-label>
                                        <ejs-accumulationchart background="transparent" id="doughnut-container-received"
                                            #pieReceived style="display: block" width="200" height="200"
                                            selectionMode="Point" [tooltip]="tooltip" [legendSettings]='legendSettings'>
                                            <e-accumulation-series-collection>
                                                <e-accumulation-series name="" [palettes]="colorReceived"
                                                    [dataSource]="chartDatas_Received" xName="key" yName="value"
                                                    [startAngle]="startAngle" [endAngle]="endAngle" innerRadius="90%"
                                                    legendShape='Rectangle'>
                                                </e-accumulation-series>
                                            </e-accumulation-series-collection>
                                        </ejs-accumulationchart>
                                        <div class="total-coins-received">
                                            <span>{{totalDataReceived}} xu</span>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="chartDatas.length == 0">
                                        <codx-label name="lblCoinsReceived" formName="FD_KudosTrans" default="Xu nhận"
                                            class="lbl-coin"></codx-label>
                                        <ejs-accumulationchart background="transparent" id="doughnut-container-received"
                                            #pieReceived style="display: block" width="200" height="200"
                                            selectionMode="Point">
                                            <e-accumulation-series-collection>
                                                <e-accumulation-series name="" [palettes]="colors_empty"
                                                    [dataSource]="chartDatas_empty" xName="label" yName="value"
                                                    [startAngle]="startAngle" [endAngle]="endAngle" innerRadius="90%">
                                                </e-accumulation-series>
                                            </e-accumulation-series-collection>
                                        </ejs-accumulationchart>
                                    </ng-container>
                                </div>
                            </div>
                            <div class="chart chart-circle pr-6 pl-3 chart-sended">
                                <div style="display: block">
                                    <ng-container *ngIf="chartDatas_Send.length !== 0">
                                        <codx-label name="lblCoinsSended" formName="FD_KudosTrans" default="Xu cho"
                                            class="lbl-coin"></codx-label>
                                        <ejs-accumulationchart background="transparent" id="doughnut-container-send"
                                            #pieSend style="display: block" width="200" height="200"
                                            selectionMode="Point" [legendSettings]='legendSettings'>
                                            <e-accumulation-series-collection>
                                                <e-accumulation-series name="" [palettes]="colorSend"
                                                    [dataSource]="chartDatas_Send" xName="label" yName="value"
                                                    [startAngle]="startAngle" [endAngle]="endAngle" innerRadius="90%"
                                                    legendShape='Rectangle'>
                                                </e-accumulation-series>
                                            </e-accumulation-series-collection>
                                        </ejs-accumulationchart>
                                        <div class="total-coins-received">
                                            <span>{{totalDataSended}} xu</span>
                                        </div>
                                    </ng-container>
                                    <ng-container *ngIf="chartDatas_Send.length == 0">
                                        <codx-label name="lblCoinsSended" formName="FD_KudosTrans" default="Xu cho"
                                            class="lbl-coin"></codx-label>
                                        <ejs-accumulationchart background="transparent" id="doughnut-container-send"
                                            #pieSend width="200" height="200" selectionMode="Point">
                                            <e-accumulation-series-collection>
                                                <e-accumulation-series name="" [palettes]="colors_empty"
                                                    [dataSource]="chartDatas_empty" xName="key" yName="value"
                                                    [startAngle]="startAngle" [endAngle]="endAngle" innerRadius="90%">
                                                </e-accumulation-series>
                                            </e-accumulation-series-collection>
                                        </ejs-accumulationchart>
                                    </ng-container>
                                </div>
                            </div>
                        </div>
                        <div class="box-wallets" *ngIf="data_Line.length == 0">
                            <div class="d-flex align-items-center justify-content-between">
                                <div class="text-dark font-size-h4 fw-bold">
                                    <codx-label name="lblEmployee" formName="FD_KudosTrans"
                                        default="Biến động số dư theo ví bộ phận"></codx-label>
                                </div>
                            </div>
                            <div class="list-table list-achiev mt-3">
                                <div class="control-section">
                                    <div align='center'>
                                        <ejs-chart style="display:block;" [chartArea]="" [width]="width" align="center"
                                            id="chartcontainer" [primaryXAxis]="primaryXAxis"
                                            [primaryYAxis]="primaryYAxis" [tooltip]="tooltip">
                                            <e-series-collection>
                                                <e-series [dataSource]="" type="Line" xName="month" yName="value"
                                                    [name]="'empty'" width="2" [marker]="marker" dashArray="5,1">
                                                </e-series>
                                            </e-series-collection>
                                        </ejs-chart>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="box-wallets top-100" *ngIf="data_Line.length !== 0">
                            <div class="d-flex align-items-center justify-content-between">
                                <div class="text-dark font-size-h4 fw-bold">
                                    <codx-label name="lblEmployee" formName="FD_KudosTrans"
                                        default="Biến động số dư theo ví bộ phận"></codx-label>
                                </div>
                            </div>
                            <div class="list-table list-achiev mt-3">
                                <div class="control-section">
                                    <div align='center'>
                                        <ejs-chart style="display:block;" [chartArea]="" [width]="width" align="center"
                                            id="chartcontainer" [primaryXAxis]="primaryXAxis"
                                            [primaryYAxis]="primaryYAxis" [tooltip]="tooltip">
                                            <e-series-collection>
                                                <e-series *ngFor="let item of chartDatas_Line" [dataSource]="item.data"
                                                    type="Line" xName="month" yName="value" [name]="item.label"
                                                    width="2" [marker]="marker" dashArray="5,1">
                                                </e-series>
                                            </e-series-collection>
                                        </ejs-chart>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <br><br>
                    </div>
                    <div class="min-w-400px w-400px pl-3">
                        <div class="master-more">
                            <div class="d-flex align-items-center mb-3 top-champion" *ngIf="reloadTop && lstRate">
                                <div class="top-item top2">
                                    <div class="top-pic w-100">
                                        <div>
                                            <codx-img [objectId]="lstRate[1]?.userID"
                                                [objectName]="lstRate[1]?.employeeName" objectType="AD_Users"
                                                width="40">
                                            </codx-img>
                                        </div>
                                    </div>
                                    <div class="top-name w-100 text-center">
                                        <div class="text-dark font-size-sm fw-bold">
                                            {{ lstRate[1]?.employeeName }}
                                        </div>
                                        <div class="text-dark-50">{{ lstRate[1]?.totalCoreEmp }}</div>
                                    </div>
                                </div>
                                <div class="top-item top1">
                                    <div class="top-pic w-100">
                                        <div>
                                            <codx-img [width]="50" [objectId]="lstRate[0]?.userID"
                                                [objectName]="lstRate[0]?.employeeName" objectType="AD_Users">
                                            </codx-img>
                                        </div>
                                    </div>
                                    <div class="top-name w-100 text-center">
                                        <div class="text-dark font-size-sm fw-bold">
                                            {{ lstRate[0]?.employeeName }}
                                        </div>
                                        <div class="text-dark-50">{{ lstRate[0]?.totalCoreEmp }}</div>
                                    </div>
                                </div>
                                <div class="top-item top3">
                                    <div class="top-pic w-100">
                                        <div>
                                            <codx-img [width]="40" [objectId]="lstRate[2]?.userID"
                                                [objectName]="lstRate[2]?.employeeName" objectType="AD_Users">
                                            </codx-img>
                                        </div>
                                    </div>
                                    <div class="top-name w-100 text-center">
                                        <div class="text-dark font-size-sm fw-bold">
                                            {{ lstRate[2]?.employeeName }}
                                        </div>
                                        <div class="text-dark-50">{{ lstRate[2]?.totalCoreEmp }}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="list-performance pt-2">
                                <codx-listview #listview service="FD" assemblyName="ERM.Business.FD"
                                    className="KudosTransBusiness" method="GetDataAchievementAsync"
                                    [predicate]="options.predicate" [dataValue]="options.dataValue"
                                    entityName="FD_KudosTrans" [itemTemplate]="TemplateList" [height]="heightList">
                                </codx-listview>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #TemplateList let-item>
    <div class="d-flex align-items-center user-card list-item mb-4" (click)="openViewDetailCoins(item?.userID)">
        <div class="symbol symbol-40 symbol-circle with-number me-4">
            <codx-img class="symbol symbol-40 symbol-circle me-2" [objectId]="item?.userID"
                [objectName]="item?.employeeName" objectType="AD_Users">
            </codx-img>
            <div *ngIf="item?.rate == 1">
                <span class="list-number top-premium" style="background-color: palevioletred; color: white;">{{
                    item?.rate
                    }}</span>
            </div>
            <div *ngIf="item?.rate == 2">
                <span class="list-number top-premium" style="background-color: orange; color: white;">{{ item?.rate
                    }}</span>
            </div>
            <div *ngIf="item?.rate == 3">
                <span class="list-number top-premium" style="background-color: aqua; color: white;">{{ item?.rate
                    }}</span>
            </div>
            <div *ngIf="item?.rate > 3">
                <span class="list-number top-premium" style="background-color: cornflowerblue; color: white;">{{
                    item?.rate
                    }}</span>
            </div>
        </div>
        <div class="d-flex flex-column flex-grow-1 left-15">
            <div class="text-dark fw-bold">
                {{ item?.employeeName }}
            </div>
            <div class="text-dark-50">{{ item?.orgUnitName }}</div>
        </div>
        <div class="d-flex flex-column pr-3">
            <div class="text-dark font-size-h5 text-right fw-bold mt-1">
                {{ item?.totalCoreEmp }}
            </div>
        </div>
    </div>
</ng-template>