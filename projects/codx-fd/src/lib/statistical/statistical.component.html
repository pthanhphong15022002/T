<codx-views
  #view
  [views]="views"
  [funcID]="funcID"
  (filterReportChange)="filterChange($event)"
  (onActions)="onActions($event)"
  [autoLoad]="false"
></codx-views>

<ng-template #panelLeft>
  <div class="container-fluid p-0" *ngIf="isLoaded">
    <ng-container *ngTemplateOutlet="dashboard"> </ng-container>
  </div>

</ng-template>
<ng-template #template let-item="item">
  <table class="table mb-0">
    <tbody>
      <tr>
        <td class="w-40">
          <div class="d-flex align-items-top">
            {{ item.text }}
          </div>
        </td>
        <td class="w-20 text-right">
          {{ item.totalCoinReceiver > 0 ? "+" : ""
          }}{{ item.totalCoinReceiver }}
        </td>
        <td class="w-20 text-right">
          {{ item.totalCoinReceiver > 0 ? "-" : "" }}{{ item.totalCoinSend }}
        </td>
        <td
          class="w-20 text-right fw-bold"
          [ngClass]="
            getClassTextCoin(item.totalCoinReceiver, item.totalCoinSend)
          "
        >
          {{ item.totalCoinReceiver - item.totalCoinSend }}
        </td>
      </tr>
    </tbody>
  </table>
</ng-template>
<ng-template #templateProgress let-item="item">
  <div class="mb-4 pe-20">
    <span [innerHTML]="item.behaviorName"></span>
    <div class="d-flex align-items-center">
      <div class="progressBar">
        <ejs-progressbar
          [id]="newGuid()"
          [type]="typeProgress"
          [maximum]="max"
          [minimum]="min"
          [value]="item.count > 0 ? (item.count / totalBehavior) * 100 : 0"
          [width]="widthProgress"
          [trackThickness]="trackThickness"
          [progressThickness]="progressThickness"
          [height]="heightProgress"
          [animation]="animation"
          trackColor="#ADD8E6"
          progressColor="#1E90FF"
          cornerRadius="Round"
        >
        </ejs-progressbar>
      </div>
      <div class="w-50px ms-6">{{ item.count }}</div>
    </div>
  </div>
</ng-template>
<ng-template #templatePopupProgress let-item="item">
  <div class="mb-2">
    <div>{{ item.behaviorName }}</div>
    <div class="d-flex align-items-center">
      <div class="w-100">
        <ejs-progressbar
          [id]="'linear' + item.idProgressBar"
          [type]="typeProgress"
          [maximum]="max"
          [minimum]="min"
          [value]="item.count > 0 ? (item.count / totalBehavior) * 100 : 0"
          [width]="widthProgress"
          [trackThickness]="trackThickness"
          [progressThickness]="progressThickness"
          [height]="heightProgress"
          [animation]="animation"
          trackColor="#ADD8E6"
          progressColor="#1E90FF"
          cornerRadius="Round"
        >
        </ejs-progressbar>
      </div>
      <div class="minw-20px ms-4">{{ item.count }}</div>
    </div>
  </div>
</ng-template>

<ng-template #content let-modal>
  <div class="modal-header py-3">
    <h4 class="modal-title" id="modal-basic-title">
      {{ "Danh sách chi tiết" | lang : "FEDSettings" : "lblUpdate" | async }}
    </h4>
    <button
      type="button"
      class="close btn btn-icon btn-sm btn-white"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    >
      <i class="icon-close icon-18"></i>
    </button>
  </div>
  <div class="modal-body">
    <div class="chart-progress">
      <div *ngFor="let item of lstBehavior">
        <ng-container
          *ngTemplateOutlet="templatePopupProgress; context: { item: item }"
        >
        </ng-container>
      </div>
    </div>
  </div>
  <div class="modal-footer"></div>
</ng-template>

<ng-template #dashboard>
  <codx-dashboard
    #dashboard
    [templates]="templates"
    [panels]="panels"
    [datas]="datas"
    [isEditMode]="false"
    [cellSpacing]="[10, 10]"
  ></codx-dashboard>
</ng-template>
<ng-template #dashboard2>
  <codx-dashboard
    #dashboard2
    [templates]="templates2"
    [panels]="panels2"
    [datas]="datas2"
    [isEditMode]="false"
    [cellSpacing]="[10, 10]"
  ></codx-dashboard>
</ng-template>

<ng-template #template let-data>
  <div class="container h-100" id="1">
    <div
      class="overflow-x-hidden"
      style="max-height: 100%; width: 100%"
    >
      <div *ngFor="let data of ratingStats" class="mt-4">
      <div class="mx-2 my-5">
        <div class="d-flex justify-content-between">
          <div>
            <span>{{ data.ratingName }}</span>
            <span>&nbsp;(</span>
            <span>{{ data.quantity }}</span>
            <span>)</span>
          </div>
          <div>
            <span>{{
              data.percentage
            }}</span
            ><span>% </span>
          </div>
        </div>
        <div class="d-flex align-items-center min-w-200px">
          <div class="h-5px w-100 bg-gray-200 rounded-4">
            <div
              class="rounded-4 h-5px"
              role="progressbar"
              [style.width]="data.percentage + '%'"
              [style.background-color]="'#ffaa00'"
            ></div>
          </div>
        </div>
      </div>
    </div>
    </div>
  </div>
</ng-template>
<ng-template #template let-data>
  <h2 id="2">Hé lô 1</h2>
</ng-template>
<ng-template #template let-data>
  <h2 id="3">Hé lô 2</h2>
</ng-template>
<ng-template #template let-data>
  <h2 id="4">Hé lô 3</h2>
</ng-template>
<ng-template #template let-data>
  <div class="container p-0 h-100" id="5">
    <ejs-chart
      style="display: block"
      [width]="width"
      align="center"
      [tooltip]="tooltip"
      [legendSettings]="{visible:false}"
      [primaryXAxis]=" {
        valueType: 'Category',
        majorGridLines: { width: 0},
    } "
      [primaryYAxis]="{
        majorTickLines: { width: 0 }, lineStyle: { width: 0}, majorGridLines:{width:0}
    }"
    [palettes]="['#0080ff']"
    [border]="{ width: 0, color: '#FF0000'}"
    >
      <e-series-collection>
        <e-series
          [dataSource]="chart_Datas"
          type="Column"
          [xName]="'key'"
          [yName]="'value'"
          columnSpacing="0.1"
          columnWidth="0.25"
          name="số lượng"
          [columnFacet]= "'Cylinder'"
          [marker]="{ dataLabel: { visible: true }}"
        >
        </e-series>
      </e-series-collection>
    </ejs-chart>
  </div>
</ng-template>
<ng-template #template let-data>
  <div class="container p-0 h-100" id="6">
    <div class="w-100 h-100">

      <div class="container p-0 h-100" *ngIf="statByEmps.length">
        <div
          class=" overflow-x-hidden scroll-hover"
          style="max-height: 95%; width: 100%"

        >
          <div
            class="mx-2 my-4"
            *ngFor="let data of sortByProp(statByEmps,'quantity','desc',5)"
          >
            <div class="row w-100">
              <div class="col-1 d-flex align-items-center">
                <codx-img
                  *ngIf="data.userID"
                  [objectType]="'AD_Users'"
                  [objectId]="data.userID"
                ></codx-img>
              </div>
              <div class="col-11">
                <div class="w-100 text-start fs-6">
                  <span class="fw-bold">{{ data.username}}</span>
                </div>
                <div class="w-100 text-start fs-7">
                  <span class="text-muted">{{ data.departmentName}} | {{data.positionName}}</span>
                </div>
                <div class="w-100">
                  <div class="h-10px w-100 rounded-4 d-flex" style="background-color:#fff ">
                    <div
                      class="h-10px rounded-4 float-start "
                      role="progressbar"
                      [style.width]="data.percentage + '%'"
                      [style.background-color]="'#00cc99'"
                    ></div>
                    <div class="text-start ms-3 fw-bold fs-7 float-end "  [style.width]="(100-data.percentage) + '%'">
                      <span>{{data.quantity}}</span>
                    </div>
                  </div>

                </div>
              </div>

            </div>
            <!-- <div class="d-flex justify-content-between">
              <div class="d-flex justify-content-between align-items-center">
                <codx-img
                  *ngIf="data.userID"
                  [objectType]="'AD_Users'"
                  [objectId]="data.userID"
                ></codx-img>
                <div class="ms-2">
                  <div class="text-dark">{{ data.username }}</div>
                  <div>{{ data.departmentName }}</div>
                </div>
              </div>
              <div class="progress-container">
                <div class="progress-container-align position-relative">
                  <div
                    class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
                  >
                    <span class="fw-bold" style="font-size: 0.4vw"
                      >{{data.percentage }}%</span
                    >
                  </div>
                  <ejs-progressbar
                    #annotation1
                    [id]="newGuid()"
                    [type]="'Circular'"
                    [maximum]="100"
                    [minimum]="0"
                    [value]="data.percentage"
                    [width]="'65'"
                    [height]="'65'"
                    [trackThickness]="10"
                    [progressThickness]="10"
                    [progressColor]="'#FF4500'"
                    [animation]="animation"
                  >
                  </ejs-progressbar>
                </div>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #template let-data>
  <div class="container h-100 p-0" id="7">
    <div class="w-100 h-100 scroll-hover">
      <!-- <div class="my-5 h-10">
        <div class="d-flex justify-content-center align-items-center">
          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnQuantityRadio"
              autocomplete="off"
              checked
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnQuantityRadio"
              default="Số lượng"
            ></codx-label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnTimeRadio"
              autocomplete="off"
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnTimeRadio"
              default="Thời gian"
            ></codx-label>
          </div>
        </div>
      </div> -->
      <div class="my-4" style="height: 45%">
        <ejs-accumulationchart
          #pie1
          class="h-100 w-100"
          style="display: block"
          [tooltip]="tooltip"

          [centerLabel]="{
            text:
            listCardsPerBev.length + '<br>Phiếu'
          }"
          [legendSettings]="{ visible: false }"
        >
          <e-accumulation-series-collection>
            <e-accumulation-series
              [dataSource]="statByBevs"
              xName="behaviorName"
              yName="quantity"
              startAngle="0"
              innerRadius="80%"
              radius="70%"
              [explode]="true"
              [explodeOffset]="'10%'"
              [dataLabel]="dataLabel"
              [palettes]="palettes"
            >
            </e-accumulation-series>
          </e-accumulation-series-collection>
        </ejs-accumulationchart>
      </div>
      <div class="h-50 container p-0">
        <div
          class="overflow-x-hidden"
          style="max-height: 100%; width: 100%"
        >
          <div
            *ngFor="let ref of statByBevs"
            class="mx-2 my-5"
          >
            <div class="d-flex justify-content-between">
              <span>{{ ref.behaviorName }} ({{ ref.quantity }})</span>
              <span>
                {{
                  ((ref.quantity / listCardsPerBev.length) * 100) %
                    1 ===
                  0
                    ? (ref.quantity / listCardsPerBev.length) * 100
                    : (
                        (ref.quantity / listCardsPerBev.length) *
                        100
                      ).toFixed(1)
                }}%
              </span>
            </div>
            <div class="d-flex align-items-center min-w-200px">
              <div class="h-5px w-100 bg-gray-200 rounded-4">
                <div
                  class="rounded-4 h-5px"
                  role="progressbar"
                  [style.width]="
                    (ref.quantity / listCardsPerBev.length) * 100 +
                    '%'
                  "
                  [style.background-color]="'#3699ff'"
                  aria-valuemin="0"
                  aria-valuemax="100"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #template let-data>
  <div class="container p-0 h-100" id="8">
    <div class="row" style="height:50px">
      <div class="col-3">

      </div>
      <div class="col-6 text-center">
        <div class="d-flex w-100 h-100">
          <div class="float-start w-60 d-flex align-items-center">
            <span class="text-dark fw-bold fs-6">% Tỉ lệ số phiếu nhận/tổng số nhân viên</span>
          </div>
          <div class="float-end d-flex align-items-center">
            <i class="icon-i-box-arrow-in-right icon-16"></i> &nbsp;&nbsp; <span class="text-dark fw-bold fs-6">Phiếu nhận</span>
          </div>
        </div>


      </div>
      <div class="col-3 text-center">
         <div class="my-1 h-10 d-flex align-items-center">
        <div class="d-flex justify-content-center align-items-center">
          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnQuantityRadio"
              autocomplete="off"
              checked
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnQuantityRadio"
              default="Phòng ban"
            ></codx-label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnTimeRadio"
              autocomplete="off"
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnTimeRadio"
              default="Bộ phận"
            ></codx-label>
          </div>
        </div>
      </div>
      </div>

    </div>
    <div class="row" style="height:calc( 100% - 50px)">
      <div class="col h-100">
        <div class="border w-100 h-100">
          <codx-gridview-v2 #eleGridCashPayment
          [editSettings]="editSettings" [allowSorting]="false"
          [columnsGrid]="columnGrids"
          [height]="'100%'"
          [dataSource]="statByDepts"
          [hideMoreFunc]="true"
          (onEdit)="doubleClick($event)"
          [editOnClick]="true"
          [rowHeight]="50"
         ></codx-gridview-v2>
        </div>
      </div>

    </div>
  </div>

</ng-template>
<ng-template #template let-data>
  <h2 id="9">Hé lô 8</h2>
</ng-template>
<ng-template #template let-data>
  <h2 id="10">Hé lô 9</h2>
</ng-template>
<ng-template #department let-data>
  <div class="d-flex flex-row justify-content-start align-items-center py-2">

    <div class="ms-4 d-flex flex-column align-items-between ">
      <span class="fw-bold" >{{data?.departmentName}}</span>
      <div class="float-left mt-1">

        <span class="fw-bold ms-1" >data?.departmentID</span>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #button let-data>
 <button>heheheh</button>
</ng-template>
<ng-template #template2 let-data>
  <div class="container h-100 p-0" id="1">
    <div class="w-100 h-100 overflow-scroll">
      <!-- <div class="my-5 h-10">
        <div class="d-flex justify-content-center align-items-center">
          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnQuantityRadio"
              autocomplete="off"
              checked
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnQuantityRadio"
              default="Số lượng"
            ></codx-label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnTimeRadio"
              autocomplete="off"
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnTimeRadio"
              default="Thời gian"
            ></codx-label>
          </div>
        </div>
      </div> -->
      <div class="my-4" style="height: 45%">
        <ejs-accumulationchart
          #pie1
          class="h-100 w-100"
          style="display: block"
          [tooltip]="tooltip"

          [centerLabel]="{
            text:
            listCardsPerBev.length + '<br>Phiếu'
          }"
          [legendSettings]="{ visible: false }"
        >
          <e-accumulation-series-collection>
            <e-accumulation-series
              [dataSource]="statByBevs"
              xName="behaviorID"
              yName="quantity"
              startAngle="0"
              innerRadius="80%"
              radius="70%"
              [explode]="true"
              [explodeOffset]="'10%'"
              [dataLabel]="dataLabel"
              [palettes]="palettes"
            >
            </e-accumulation-series>
          </e-accumulation-series-collection>
        </ejs-accumulationchart>
      </div>
      <div class="h-50 container p-0">
        <div
          class="overflow-x-hidden"
          style="max-height: 100%; width: 100%"
        >
          <div
            *ngFor="let ref of statByBevs"
            class="mx-2 my-5"
          >
            <div class="d-flex justify-content-between">
              <span>{{ ref.behaviorName }} ({{ ref.quantity }})</span>
              <span>
                {{
                  ((ref.quantity / listCardsPerBev.length) * 100) %
                    1 ===
                  0
                    ? (ref.quantity / listCardsPerBev.length) * 100
                    : (
                        (ref.quantity / listCardsPerBev.length) *
                        100
                      ).toFixed(1)
                }}%
              </span>
            </div>
            <div class="d-flex align-items-center min-w-200px">
              <div class="h-5px w-100 bg-gray-200 rounded-4">
                <div
                  class="rounded-4 h-5px"
                  role="progressbar"
                  [style.width]="
                    (ref.quantity / listCardsPerBev.length) * 100 +
                    '%'
                  "
                  [style.background-color]="'#3699ff'"
                  aria-valuemin="0"
                  aria-valuemax="100"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #template2 let-data>
  <div class="w-100 h-100" id="2">
    <ejs-chart
      style="display: block"
      align="center"
      width="100%"
      height="100%"
      [id]="newGuid()"
      [tooltip]="{ enable: true }"
      [primaryXAxis]=" {
        valueType: 'Category',
        majorGridLines: { width: 0 },
    } "
      [primaryYAxis]="{
        majorTickLines: { width: 0 }, lineStyle: { width: 0 }
    }"
    [palettes]="palettes"
    >
      <e-series-collection>
        <e-series
          [dataSource]="statByDepts"
          type="Line"
          [xName]="'departmentName'"
          [yName]="'quantity'"
          name="Số lượng quà"
          [marker]="circleMarker"
        >
        </e-series>
        <e-series
          [dataSource]="statByDepts"
          type="Column"
          [xName]="'departmentName'"
          [yName]="'quantity'"
          name="Xu đổi quà"
          columnSpacing="0.1"
          columnWidth="0.25"
        >
        </e-series>
      </e-series-collection>
    </ejs-chart>
  </div>
</ng-template>
<ng-template #template2 let-data>
  <div class="container p-0 h-100" id="3">
    <div class="w-100 h-100">
      <div class="my-5 h-10">
        <div class="d-flex justify-content-center align-items-center">
          <!-- <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnLowestRadio"
              autocomplete="off"

              #eleAsc
            />
            <label
              class="btn btn-outline-primary"
              for="btnLowestRadio"
            ><codx-label default="Thấp nhất" [formName]="'sys'" [name]="'lblLowest'"></codx-label></label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnHighestRadio"
              autocomplete="off"
              #eleDesc
              checked
            />
            <label
              class="btn btn-outline-primary"
              for="btnHighestRadio"
              default="Cao nhất"
            ><codx-label default="Cao nhất" [formName]="'sys'" [name]="'lblHighest'"></codx-label></label>
          </div> -->
        </div>
      </div>
      <div class="container p-0" style="height: 90%" *ngIf="statByEmps.length">
        <div
          class="overflow-scroll overflow-x-hidden"
          style="max-height: 95%; width: 100%"

        >
          <div
            class="mx-2 my-4"
            *ngFor="let data of sortByProp(statByEmps,'quantity','desc',5)"
          >
            <div class="row w-100">
              <div class="col-1 d-flex align-items-center">
                <codx-img
                  *ngIf="data.userID"
                  [objectType]="'AD_Users'"
                  [objectId]="data.userID"
                ></codx-img>
              </div>
              <div class="col-11">
                <div class="w-100 text-start fs-6">
                  <span class="fw-bold">{{ data.username}}</span>
                </div>
                <div class="w-100 text-start fs-7">
                  <span class="text-muted">{{ data.departmentName}} | {{data.positionName}}</span>
                </div>
                <div class="w-100">
                  <div class="h-15px w-100 rounded-4 d-flex" style="background-color:#fff ">
                    <div
                      class="h-15px rounded-4 float-start "
                      role="progressbar"
                      [style.width]="data.percentage + '%'"
                      [style.background-color]="'#00cc99'"
                    ></div>
                    <div class="text-start ms-3 fw-bold fs-7 float-end "  [style.width]="(100-data.percentage) + '%'">
                      <span>{{data.quantity}}</span>
                    </div>
                  </div>

                </div>
              </div>

            </div>
            <!-- <div class="d-flex justify-content-between">
              <div class="d-flex justify-content-between align-items-center">
                <codx-img
                  *ngIf="data.userID"
                  [objectType]="'AD_Users'"
                  [objectId]="data.userID"
                ></codx-img>
                <div class="ms-2">
                  <div class="text-dark">{{ data.username }}</div>
                  <div>{{ data.departmentName }}</div>
                </div>
              </div>
              <div class="progress-container">
                <div class="progress-container-align position-relative">
                  <div
                    class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
                  >
                    <span class="fw-bold" style="font-size: 0.4vw"
                      >{{data.percentage }}%</span
                    >
                  </div>
                  <ejs-progressbar
                    #annotation1
                    [id]="newGuid()"
                    [type]="'Circular'"
                    [maximum]="100"
                    [minimum]="0"
                    [value]="data.percentage"
                    [width]="'65'"
                    [height]="'65'"
                    [trackThickness]="10"
                    [progressThickness]="10"
                    [progressColor]="'#FF4500'"
                    [animation]="animation"
                  >
                  </ejs-progressbar>
                </div>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #template2 let-data>
  <div class="w-100 h-100" id="4">
    <ejs-chart
      style="display: block"
      align="center"
      width="100%"
      height="100%"
      [id]="newGuid()"
      [tooltip]="{ enable: true }"
      [primaryXAxis]=" {
        valueType: 'Category',
        majorGridLines: { width: 0 },
    } "
      [primaryYAxis]="{
        majorTickLines: { width: 0 }, lineStyle: { width: 0 }
    }"
    [palettes]="palettes"
    >
      <e-series-collection>
        <e-series
          [dataSource]="statByDepts"
          type="Column"
          [xName]="'departmentName'"
          [yName]="'cardType1'"
          name="Xu cho"
          columnSpacing="0.1"
          columnWidth="0.25"
        >
        </e-series>
        <e-series
          [dataSource]="statByDepts"
          type="Column"
          [xName]="'departmentName'"
          [yName]="'quantity'"
          name="Xu nhận"
          columnSpacing="0.1"
          columnWidth="0.25"
        >
        </e-series>
      </e-series-collection>
    </ejs-chart>
  </div>
</ng-template>
