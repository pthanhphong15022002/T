<codx-views id="dm" #view [autoLoad]="true" [entityName]="'DM_FolderInfo'" [method]="'GetFoldersAsync'"
  [className]="'FolderBussiness'" [assemblyName]="'DM'" idField="recID" [views]="views"
  (selectedChange)="onSelectionChanged($event)" [button]="button" (buttonClick)="addFile($event)"
  (viewChanged)="changeView($event)" (onLoading)="onLoading($event)" (requestEnded)="requestEnded($event)"></codx-views>

<ng-template #templateMain let-data>
  <div *ngIf="dmSV.checkUserForder(data); then noContext; else context"></div>
  <ng-template #noContext>
    <div oncontextmenu="return false;" class="d-flex align-items-center px-3 py-1" #item>
      <div class="node" [innerHTML]="dmSV.setFullHtmlNode(data, data.folderName)"></div>
    </div>
  </ng-template>
  <ng-template #context>
    <div appDragDropFileFolder [dataDrapDrop]="data" class="d-flex align-items-center px-3 py-1">
      <div class="leaf d-flex align-items-center" [innerHTML]="dmSV.setFullHtmlNode(data, '')"></div>
      <codx-temp-full class="float-start" imgCss="me-3 cursor-pointer" (clickMF)="dmSV.clickMF($event, data)"
        (changeDataMF)="dmSV.filterMoreFunction($event, data)" [title]="data.folderName" [formModel]="view.formModel"
        [typeMF]="'hover'">
      </codx-temp-full>
    </div>
  </ng-template>
</ng-template>

<ng-template #templateRight>
  <div appDragDropFileUpload (fileDropped)="fileUploadDropped($event)" class="w-100 scroll-y home" data-kt-scroll="true"
    data-kt-scroll-activate="{default: true}" data-kt-scroll-height="auto"
    data-kt-scroll-wrappers=".wrapper, .dm-wrapper, .dms-card-rowS" data-kt-scroll-offset="0">
    <ng-container *ngTemplateOutlet="empty"></ng-container>
    <ng-container *ngTemplateOutlet="currView"></ng-container>
    <ng-container *ngTemplateOutlet="nodata"></ng-container>
    <ng-container *ngTemplateOutlet="loading"></ng-container>
  </div>
</ng-template>

<ng-template #templateCard>
  <!-- <button class="btn btn-outline-primary btn-pill btn-lg" id="kt_demo_panel_toggle" (click)="openFile1()">
    <i class="icon-add"></i>
    <span class="font-size-lg">Open File</span>
  </button>
  <button class="btn btn-outline-primary btn-pill btn-lg" id="kt_demo_panel_toggle" (click)="saveFile1()">
    <i class="icon-add"></i>
    <span class="font-size-lg">save Files</span>
  </button> 
  <codx-attachment  
      #attachment1  
      [objectType]="'OD_Dispatches'" 
      [objectId]="'965e692f-8230-4ad1-b1be-ee68ce010b6f'" 
      hideFolder="1"  
      hideUploadBtn="0"   
      hideDes="0" 
      type="inline"
      hideImageUpload="0"
      allowExtensions=".jpg,.png"
      allowMultiFile="1"
      idBrowse="btn1"

      [formModel]="view.formModel"
      [functionID]="'ODT3'" 
      (fileAdded)="fileAdded($event)" 
      (fileCount)="getfileCount($event)" 
      displayThumb="simple"
    > 
  </codx-attachment>

  <button class="btn btn-outline-primary btn-pill btn-lg" id="kt_demo_panel_toggle" (click)="openFile2()">
    <i class="icon-add"></i>
    <span class="font-size-lg">Open File</span>
  </button>
  <button class="btn btn-outline-primary btn-pill btn-lg" id="kt_demo_panel_toggle" (click)="saveFile2()">
    <i class="icon-add"></i>
    <span class="font-size-lg">save Files</span>
  </button> 
  <codx-attachment  
      #attachment2
      [objectType]="'OD_Dispatches'" 
      [objectId]="'965e692f-8230-4ad1-b1be-ee68ce010b6f'" 
      hideFolder="1"  
      hideUploadBtn="0"   
      hideDes="0" 
      type="inline"
      hideImageUpload="0"
      allowExtensions=".jpg,.png"
      allowMultiFile="1"
      idBrowse="btn2"

      [formModel]="view.formModel"
      [functionID]="'ODT3'" 
      (fileAdded)="fileAdded($event)" 
      (fileCount)="getfileCount($event)" 
      displayThumb="simple"
    > 
  </codx-attachment> -->

  <!-- <div data-kt-scroll-activate="{default: true}" data-kt-scroll-max-height="auto" attr.data-kt-scroll-dependencies=''
   attr.data-kt-scroll-wrappers='dms-viewcard' attr.data-kt-scroll-offset="'0px'">     -->
  <div class="d-flex flex-wrap dms-card p-4">
    <card appDragDropFileFolder [dataDrapDrop]="item" (fileFolderDropped)="fileFolderDropped($event)"
      *ngFor="let item of data" [class]="classFile(item, 'pe-6 pb-6')" [data]="item" [formModel]="view.formModel">
    </card>
  </div>
</ng-template>
<ng-template #templateSmallCard>
  <div class="d-flex flex-wrap dms-card-sm p-4">
    <codx-temp-full appDragDropFileFolder [dataDrapDrop]="item" (fileFolderDropped)="fileFolderDropped($event)"
      *ngFor="let item of data" [class]="classFile(item, 'float-start')" [imageSrc]="dmSV.getImage(item)"
      imgCss="card-item img-folder me-3" (clickMF)="dmSV.clickMF($event, item)"
      [title]="item.folderName != undefined ? item.folderName : item.fileName"
      (changeDataMF)="dmSV.filterMoreFunction($event, item)" [formModel]="view.formModel" [typeMF]="'hover'"
      [bookmark]="dmSV.showBookmark(item)" subTitle="{{item.createdOn | date : 'dd/MM/yyyy'}} | {{item.userName}}"
      cardCss="card-item card-template w-300px sm-card rounded-2 p-2 mb-4 me-4">
    </codx-temp-full>
  </div>
</ng-template>
<ng-template #templateList>
  <ng-container *ngIf="data && data.length > 0">
    <div class="p-4">
      <table class="table">
        <thead>
          <tr>
            <th class="px-0" scope="col"></th>
            <th scope="col">
              <div class="fw-bold text-dark">{{ titleFileName }}</div>
            </th>
            <th scope="col">
              <div class="fw-bold text-dark">{{ titleCreatedBy }}</div>
            </th>
            <th scope="col">
              <div class="fw-bold text-dark">{{ titleCreatedOn }}</div>
            </th>
            <th scope="col">
              <div class="fw-bold text-dark">{{ titleLength }}</div>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr class="border-top dms-list" *ngFor="let item of data"
            [title]="item.folderName != undefined ? item.folderName : item.fileName">
            <td class="w-25px text-center px-0">
              <span [className]="dmSV.getBookmarksClass(item)"></span>
            </td>
            <td>
              <codx-temp-full appDragDropFileFolder [dataDrapDrop]="item"
                (fileFolderDropped)="fileFolderDropped($event)" [class]="classFile(item, 'float-start')"
                [imageWidth]="20" [imageSrc]="dmSV.getImage(item)" imgCss="w-20px me-3 cursor-pointer" [title]="
                item.folderName != undefined ? item.folderName : item.fileName
              " cardCss="w-225px">
              </codx-temp-full>
            </td>
            <td>
              <codx-temp-full [imageId]="item.createdBy" imageObjType="AD_Users" imgCss="me-3 cursor-pointer"
                [imageWidth]="25" [title]="item.userName">
              </codx-temp-full>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <div class="erm-date">
                  {{ item.createdOn | date: "dd/MM/yyyy" }}
                </div>
              </div>
            </td>
            <td>
              <codx-temp-full class="float-start" imgCss="me-3" (clickMF)="dmSV.clickMF($event, item)"
                [formModel]="view.formModel" [typeMF]="'hover'" [title]="dmSV.getSizeKB(item)"
                (changeDataMF)="dmSV.filterMoreFunction($event, item)" cardCss="w-150px">
              </codx-temp-full>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </ng-container>
</ng-template>
<ng-template #empty>
  <ng-container *ngIf="data && data[0] != null && data[0].isDelete">
    <div class="nondata-container w-100 mb-2">
      <div class="d-flex justify-content-between page-heading align-items-center">
        <div>{{ dmSV.titleEmptyTrash30 }}</div>
        <button (click)="this.dmSV.emptyTrash()" class="btn btn-sm btn-secondary">
          {{ dmSV.titleEmptyAction }}
        </button>
      </div>
    </div>
  </ng-container>
</ng-template>
<ng-template #nodata>
  <ng-container
    *ngIf="this.dmSV.loadedFile && this.dmSV.loadedFolder && (data === undefined || !data || data.length <= 0)">
    <div class="w-100 align-items-center mt-20">
      <div class="text-center">
        <img class="mh-200px" src="../../../assets/codx/dms/data-empty.png" />
      </div>
      <div class="text-center">
        <h5 class="text-dark mt-6">{{ dmSV.titleNodaTa }}</h5>
        <div class="mt-3">{{ dmSV.titleNodaTaFolder }}</div>
      </div>
    </div>
  </ng-container>
</ng-template>
<ng-template #loading>
  <ng-container *ngIf="!this.dmSV.loadedFile || !this.dmSV.loadedFolder">
    <div class="w-100 align-items-center mt-20">
      <div class="text-center">
        <img class="mh-200px" src="../../../assets/img/loader.gif" />
      </div>
    </div>
  </ng-container>
</ng-template>
<codx-attachment  
#attachment  
hideFolder="1"  
hideUploadBtn="1"   
hideDes="0" 
type="inline"
hideImageUpload="1"  
hideImageThumb="1"
allowMultiFile="1"
idBrowse="btn2"
[formModel]="view.formModel"  
displayThumb="simple"> 
</codx-attachment>