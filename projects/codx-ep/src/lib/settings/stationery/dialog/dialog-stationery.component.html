<div class="card card-custom cdx-tab">
  <div class="card-header border-0">
    <!--begin::Title-->
    <div class="d-flex align-items-start">
      <!--begin::Symbol-->
      <div class="symbol symbol-24px me-4">
        <span class="symbol-label bg-primary">
          <i class="icon-add_box text-white"></i>
        </span>
      </div>
      <!--end::Symbol-->
      <!--begin::Content-->
      <div class="me-5">
        <!--begin::Title-->
        <span class="card-label fw-bolder text-dark fs-2"
          >Thêm mới Văn Phòng phẩm</span
        >
        <!--end::Title-->
        <!--begin::Desc-->
        <span class="text-gray-400 fw-bold fs-7 d-block text-start ps-0">
          Đăt xe công tác</span
        >
        <!--end::Desc-->
      </div>
      <!--end::Content-->
    </div>
    <!--end::Title-->

    <!--begin::toolbar-->
    <div class="card-toolbar">
      <div class="text-gray-400 fw-bolder fs-7 text-end">
        <!--begin::Number-->
        <button
          type="button"
          class="btn btn-sm btn-icon btn-active-color-primary"
          aria-label="Close"
          (click)="closeForm()"
        >
          <i class="icon-close fs-1 text-dark text-hover-primary"></i>
        </button>
        <a
          class="text-dark-75 text-hover-primary d-flex align-items-center d-block"
        >
          <span class="mr-2 text-dark">Mở rộng</span>
          <span class="icon-login fs-1 ml-1"></span
        ></a>
        <!--end::Number-->
      </div>
      <!--end::toolbar-->
    </div>
  </div>
  <div class="card-body scroll-y">
    <form [formGroup]="addEditForm" *ngIf="isAfterRender">
      <div class="tab-content">
        <!-- Render the Tab Component -->
        <ejs-tab
          id="tab_orientation"
          #orientationTab
          [showCloseButton]="false"
          heightAdjustMode="Auto"
          headerPlacement="Left"
        >
          <e-tabitems>
            <e-tabitem [header]="headerText[0]">
              <ng-template #content>
                <div id="rome" class="tabpanel">
                  <div class="tab-content">
                    <div class="d-flex flex-column mb-4">
                      <!--begin::Label-->
                      <div
                        class="d-flex justify-content-between align-items-center"
                      >
                        <codx-label
                          class="fw-bold"
                          default="Tên sản phẩm"
                          fiedName="ResourceID"
                        >
                        </codx-label>
                      </div>
                      <!--end::Label-->
                      <codx-input
                        type="text"
                        name="text"
                        ControlName="resourceID"
                        [crrValue]="addEditForm.value.resourceID"
                        [Group]="addEditForm"
                        [refValue]="CbxName['ResourceID']"
                      ></codx-input>
                    </div>

                    <div class="d-flex row align-items-center mb-2">
                      <div class="col-8">
                        <codx-label
                          class="fw-bold"
                          default="Nhóm"
                          fiedName="ResourceID"
                        >
                        </codx-label>
                        <!--begin::Input-->
                        <codx-input
                          type="combobox"
                          class="form-control test-datetime"
                          ControlName="resourceID"
                          [crrValue]="addEditForm.value.resourceID"
                          [Group]="addEditForm"
                          [refValue]="CbxName['ResourceID']"
                        >
                        </codx-input>
                        <!--end::Input-->
                      </div>
                      <div class="col-4">
                        <codx-label
                          class="fw-bold"
                          default="Mã số"
                          fiedName="StartDate"
                          aria-disabled="false"
                        >
                        </codx-label>
                        <!--begin::Input-->
                        <!-- <codx-input type="datetime" class="test-datetime" field="datetime" placeholder="datetime"
                            dataformat="t" (valueChange)="valueStartTimeChange($event)">
                          </codx-input> -->
                        <codx-input
                          type="text"
                          name="text"
                          ControlName="resourceID"
                          [crrValue]="addEditForm.value.resourceID"
                          [Group]="addEditForm"
                          [refValue]="CbxName['ResourceID']"
                        ></codx-input>
                        <!--end::Input-->
                      </div>
                    </div>

                    <div class="d-flex flex-column mb-4">
                      <!--begin::Label-->
                      <codx-label
                        class="fw-bold"
                        default="Kho"
                        fiedName="ReasonID"
                      >
                      </codx-label>
                      <!--end::Label-->
                      <!-- <codx-combobox service="SYS" name="combobox" placeholder="" ngDefaultControl refValue="Users"
                          file="reasonID" [pageSize]="5" popupHeight="200px" [allowFilter]=true [Group]="addEditForm">
                        </codx-combobox> -->
                      <codx-input
                        type="combobox"
                        ngDefaultControl
                        [refValue]="CbxName['ReasonID']"
                        (valueChange)="valueOwnerChange($event)"
                        [multiple]="false"
                      >
                      </codx-input>
                    </div>

                    <div class="d-flex flex-column mb-4">
                      <!--begin::Label-->
                      <codx-label
                        class="fw-bold"
                        default="Người điều phối"
                        fiedName="Title"
                      >
                      </codx-label>
                      <!--end::Label-->
                      <div class="position-relative">
                        <codx-input
                          service="AD"
                          type="combobox"
                          name="combobox"
                          [crrValue]="addEditForm.value.owner"
                          ngDefaultControl
                          field="owner"
                          refValue="Users"
                          (valueChange)="valueOwnerChange($event)"
                        >
                        </codx-input>
                        <div
                          class="position-absolute translate-middle-y top-50 end-0 me-3"
                        >
                          <span class="icon-person_pin_circle"> </span>
                        </div>
                      </div>
                    </div>

                    <div class="d-flex flex-column mb-4">
                      <!--begin::Label-->
                      <codx-label
                        class="fw-bold"
                        default="Mô tả chi tiết"
                        fiedName="Memo"
                      >
                      </codx-label>
                      <!--end::Label-->
                      <codx-input
                        type="textarea"
                        class="test-textarea"
                        field="memo"
                        ControlName="memo"
                        placeholder="textarea"
                        [crrValue]="addEditForm.value.memo"
                        (valueChange)="valueOwnerChange($event)"
                      >
                      </codx-input>
                    </div>

                    <div class="d-flex flex-column mb-4">
                      <div
                        class="d-flex justify-content-between align-items-center mb-4"
                      >
                        <!-- <h5 class="text-dark">Thiết bị</h5> -->
                        <codx-label
                          class="fw-bold"
                          default="Hình ảnh màu sắc"
                          fiedName="Equipments"
                        >
                        </codx-label>
                        <span
                          class="icon-select_all text-primary icon-20"
                          (click)="openPopupDevices()"
                        ></span>
                      </div>
                    </div>

                    <div class="d-flex flex-column mb-4">
                      <!--begin::Title-->
                      <div
                        class="d-flex justify-content-between align-items-center mb-4"
                      >
                        <a
                          class="btn btn-sm btn-outline btn-outline-primary btn-active-light-primary"
                        >
                          <span
                            class="icon-cloud_upload btn-text-primary me-2"
                            (click)="popup($event)"
                          ></span
                          >Upload file</a
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </ng-template>
            </e-tabitem>
            <e-tabitem [header]="headerText[1]">
              <ng-template #gridTemplate>
                <h1>Danh sách phòng</h1>
                <codx-gridview
                  #gridView
                  [columnsGrid]="columnGrid"
                  [allowSorting]=""
                  [sortSettings]=""
                  [allowGrouping]=""
                  [groupSettings]=""
                  [editSettings]=""
                  [selectionOptions]=""
                  [rowHeight]="40"
                  [pageSize]="10"
                  funcId="EPS21"
                  assemblyName="EP"
                  entityName="EP_Resources"
                  className="ResourcesBusiness"
                  method="GetListAsync"
                  predicate="ResourceType=@0"
                  dataValue="6"
                  [pageSize]="15"
                  height="500px"
                  [showColumnMenu]="true"
                  [filterSettings]=""
                  [allowFiltering]=""
                  [allowResizing]=""
                >
                </codx-gridview>
              </ng-template>
            </e-tabitem>
            <e-tabitem [header]="headerText[2]">
              <ng-template #content>
                <div id="rome" class="tabpanel">
                  <div class="tab-content">
                    <!--begin::Title-->
                    <div
                      class="d-flex justify-content-between align-items-center mb-4"
                    >
                      <h4 class="fw-bolder text-gray-800 d-block mb-2">
                        Thông tin khác
                      </h4>
                      <span class="icon-layers text-primary fs-1"></span>
                    </div>
                    <!--end::Title-->

                    <div class="d-flex row align-items-center mb-4">
                      <div class="col-4">
                        <codx-label
                          class="fw-bold"
                          default="Số lượng hiện có"
                          fiedName="StartDate"
                          aria-disabled="false"
                        >
                        </codx-label>
                        <!--begin::Input-->
                        <!-- <codx-input type="datetime" class="test-datetime" field="datetime" placeholder="datetime"
                            dataformat="t" (valueChange)="valueStartTimeChange($event)">
                          </codx-input> -->
                        <codx-input
                          type="text"
                          name="text"
                          ControlName="resourceID"
                          [crrValue]="addEditForm.value.resourceID"
                          [Group]="addEditForm"
                          [refValue]="CbxName['ResourceID']"
                        ></codx-input>
                        <!--end::Input-->
                      </div>
                      <div class="col-4">
                        <codx-label
                          class="fw-bold"
                          default="Số lượng yêu cầu"
                          fiedName="StartDate"
                          aria-disabled="false"
                        >
                        </codx-label>
                        <!--begin::Input-->
                        <!-- <codx-input type="datetime" class="test-datetime" field="datetime" placeholder="datetime"
                            dataformat="t" (valueChange)="valueStartTimeChange($event)">
                          </codx-input> -->
                        <codx-input
                          type="text"
                          name="text"
                          ControlName="resourceID"
                          [crrValue]="addEditForm.value.resourceID"
                          [Group]="addEditForm"
                          [refValue]="CbxName['ResourceID']"
                        ></codx-input>
                        <!--end::Input-->
                      </div>
                      <div class="col-4">
                        <codx-label
                          class="fw-bold"
                          default="Số lượng còn lại"
                          fiedName="StartDate"
                          aria-disabled="false"
                        >
                        </codx-label>
                        <!--begin::Input-->
                        <!-- <codx-input type="datetime" class="test-datetime" field="datetime" placeholder="datetime"
                            dataformat="t" (valueChange)="valueStartTimeChange($event)">
                          </codx-input> -->
                        <codx-input
                          type="text"
                          name="text"
                          ControlName="resourceID"
                          [crrValue]="addEditForm.value.resourceID"
                          [Group]="addEditForm"
                          [refValue]="CbxName['ResourceID']"
                        ></codx-input>
                        <!--end::Input-->
                      </div>
                    </div>
                    <div class="d-flex flex-stack mb-4">
                      <div class="col-6">
                        <codx-label
                          class="fw-bold"
                          default="Giá mua sau cùng"
                          fiedName="StartDate"
                          aria-disabled="false"
                        >
                        </codx-label>
                        <!--begin::Input-->
                        <!-- <codx-input type="datetime" class="test-datetime" field="datetime" placeholder="datetime"
                            dataformat="t" (valueChange)="valueStartTimeChange($event)">
                          </codx-input> -->
                        <codx-input
                          type="text"
                          name="text"
                          ControlName="resourceID"
                          [crrValue]="addEditForm.value.resourceID"
                          [Group]="addEditForm"
                          [refValue]="CbxName['ResourceID']"
                        ></codx-input>
                        <!--end::Input-->
                      </div>
                    </div>
                    <div class="d-flex flex-column mb-4">
                      <!--begin::Label-->
                      <codx-label
                        class="fw-bold"
                        default="Ghi chú"
                        fiedName="Memo"
                      >
                      </codx-label>
                      <!--end::Label-->
                      <codx-input
                        type="textarea"
                        class="test-textarea"
                        field="memo"
                        ControlName="memo"
                        placeholder="textarea"
                        [crrValue]="addEditForm.value.memo"
                        (valueChange)="valueOwnerChange($event)"
                      >
                      </codx-input>
                    </div>
                  </div>
                </div>
              </ng-template>
            </e-tabitem>
          </e-tabitems>
        </ejs-tab>
      </div>
    </form>
  </div>
  <div class="card-footer border-0">
    <div class="d-flex justify-content-end">
      <a class="btn btn-primary font-weight-bold" (click)="onSaveForm()">Lưu</a>
    </div>
  </div>
</div>

<ng-template #addLink let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Link cuộc họp</h4>
    <button
      type="button"
      class="btn btn-xs btn-icon btn-light btn-hover-primary"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span class="icon-close icon-20"></span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group row">
      <div class="col-4">
        <label>Đường dẫn</label>
      </div>
    </div>
    <div class="form-group row">
      <codx-input
        type="text"
        class="form-control"
        placeholder="https://home.suremeet.vn/"
        [crrValue]="link"
        (valueChange)="changeLink($event)"
      ></codx-input>
    </div>
  </div>
  <div class="modal-footer" (click)="modal.close()">
    <button type="button" class="btn btn-primary">Lưu</button>
  </div>
</ng-template>

<ng-template #popupDevice let-modal>
  <!--begin::Card body-->
  <div class="modal-header">
    <div class="d-flex flex-column flex-grow-1">
      <div class="d-flex justify-content-between align-items-center">
        <h2 id="modal-basic-title">Thiết bị</h2>
        <button
          type="button"
          class="btn btn-xs btn-icon btn-light btn-hover-primary"
          aria-label="Close"
          (click)="modal.dismiss()"
        >
          <span class="icon-close icon-20 text-dark text-hover-primary"></span>
        </button>
      </div>
      <div class="text-dark-50">
        Chọn các thiết bị đã tích tích hợp sẵn trong phòng
      </div>
    </div>
  </div>
  <div class="modal-body">
    <div class="py-2" *ngFor="let item of tmplstDevice">
      <!--begin::Item-->
      <div class="d-flex flex-stack">
        <div class="d-flex">
          <span class="text-dark icon-wifi me-2 p-1"></span>
          <div class="d-flex flex-column">
            <a href="#" class="text-dark text-hover-primary fw-bolder">{{
              item.text
            }}</a>
          </div>
        </div>
        <div class="d-flex justify-content-end">
          <div class="form-check form-check-solid form-switch">
            <input
              class="form-check-input w-35px h-20px"
              type="checkbox"
              id="googleswitch"
              [checked]="item.isSelected"
              (change)="checkedChange($event, item)"
            />
            <label class="form-check-label" for="googleswitch"></label>
          </div>
        </div>
      </div>
      <!--end::Item-->
      <!-- <div class="separator separator-dashed my-5"></div> -->
    </div>
    <!--end::Card body-->
  </div>
  <div class="modal-footer" (click)="modal.close()">
    <button type="button" class="btn btn-primary">Lưu</button>
  </div>
</ng-template>
<ng-template #popupColor let-modal>
  <div class="modal-body">
    <codx-colorpicker [(value)]="color" (valueChange)="valueChange($event)">
    </codx-colorpicker>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-danger" (click)="add()">Lưu</button>
  </div>
</ng-template>

<ng-template #Devices let-dataItem>
  <div class="d-flex align-items-center fw-bold">
    <ng-container *ngFor="let item of getlstDevice(dataItem.equipments)">
      <span class="text-dark fs-5 icon-wifi me-3"
        ><span class="fs-6 ms-1">{{
          item | vll: "EP012":"text" | async
        }}</span></span
      >
    </ng-container>
  </div>
</ng-template>

<ng-template #ranking let-dataItem>
  <div class="d-flex justify-content-center">
    <span class="badge badge-light-success fs-7 fw-bold mb-1">{{
      dataItem.ranking | vll: "EP005":"text" | async
    }}</span>
  </div>
</ng-template>

<!-- <ng-template #roomResourceDialog>
  <app-dialog-stationery
    #editRoomBookingForm
    (closeEdit)="closeEditForm()"
    (onDone)="onDone($event)"
  ></app-dialog-stationery>
</ng-template> -->

<ng-template #Devices let-dataItem>
  <div class="d-flex align-items-center fw-bold">
    <ng-container *ngFor="let item of getlstDevice(dataItem.equipments)">
      <span class="text-dark fs-5 icon-wifi me-3"
        ><span class="fs-6 ms-1">{{ getDeviceName(item) }}</span></span
      >
    </ng-container>
  </div>
</ng-template>
