<codx-form
  [headerText]="headerTitle"
  [subHeaderText]="subHeaderTilte"
  [body]="body"
  [footer]="footer"
  [dialog]="dialog"
  [formGroup]="dialogStationery"
  *ngIf="isAfterRender"
>
  <ng-template popup add #body>
    <div class="tab-content">
      <!-- Render the Tab Component -->
      <ejs-tab
        id="tab_orientation"
        #orientationTab
        [showCloseButton]="false"
        heightAdjustMode="Auto"
        headerPlacement="Left"
      >
        <e-tabitems>
          <e-tabitem [header]="headerText[0]">
            <ng-template #content>
              <div id="rome" class="tabpanel">
                <div class="tab-content">
                  <div class="d-flex flex-column mb-4">
                    <!--begin::Label-->
                    <div
                      class="d-flex justify-content-between align-items-center"
                    >
                      <codx-label
                        class="fw-bold"
                        default="Tên sản phẩm"
                        fiedName="ResourceName"
                        [formModel]="dialog.formModel"
                      >
                      </codx-label>
                    </div>
                    <!--end::Label-->
                    <codx-input
                      type="text"
                      name="text"
                      ControlName="resourceName"
                      field="resourceName"
                      [crrValue]="dialogStationery.value?.resourceName"
                      [Group]="dialogStationery"
                    ></codx-input>
                  </div>

                  <div class="d-flex row align-items-center mb-2">
                    <div class="col-8">
                      <codx-label
                        class="fw-bold"
                        default="Nhóm"
                        fiedName="GroupID"
                        [formModel]="dialog.formModel"
                      >
                      </codx-label>
                      <!--begin::Input-->
                      <codx-input
                        type="text"
                        class="form-control"
                        field="groupID"
                        [crrValue]="dialogStationery.value?.groupID"
                        (valueChange)="valueChange($event)"
                      >
                      </codx-input>
                      <!--end::Input-->
                    </div>
                    <div class="col-4">
                      <codx-label
                        class="fw-bold"
                        default="Mã số"
                        fiedName="ResourceID"
                        [formModel]="dialog.formModel"
                      >
                      </codx-label>
                      <!--begin::Input-->
                      <!-- <codx-input type="datetime" class="test-datetime" field="datetime" placeholder="datetime"
                          dataformat="t" (valueChange)="valueStartTimeChange($event)">
                        </codx-input> -->
                      <codx-input
                        type="text"
                        name="text"
                        ControlName="resourceID"
                        [crrValue]="dialogStationery.value?.resourceID"
                        [Group]="dialogStationery"
                        [refValue]="CbxName['ResourceID']"
                        (valueChange)="valueChange($event)"
                      ></codx-input>
                      <!--end::Input-->
                    </div>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <!--begin::Label-->
                    <codx-label
                      class="fw-bold"
                      default="Kho"
                      fiedName="Location"
                      [formModel]="dialog.formModel"
                    >
                    </codx-label>
                    <!--end::Label-->
                    <!-- <codx-combobox service="SYS" name="combobox" placeholder="" ngDefaultControl refValue="Users"
                        file="reasonID" [pageSize]="5" popupHeight="200px" [allowFilter]=true [Group]="dialogStationery">
                      </codx-combobox> -->
                    <codx-input
                      type="text"
                      ControlName="location"
                      [crrValue]="dialogStationery.value?.location"
                      [Group]="dialogStationery"
                      (valueChange)="valueChange($event)"
                    >
                    </codx-input>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <!--begin::Label-->
                    <codx-label
                      class="fw-bold"
                      default="Người điều phối"
                      fiedName="Owner"
                      [formModel]="dialog.formModel"
                    >
                    </codx-label>
                    <!--end::Label-->
                    <div class="position-relative">
                      <codx-input
                        type="combobox"
                        [crrValue]="dialogStationery.value?.owner"
                        ngDefaultControl
                        field="owner"
                        [refValue]="CbxName['Owner']"
                        (valueChange)="valueChange($event)"
                      >
                      </codx-input>
                      <div
                        class="position-absolute translate-middle-y top-50 end-0 me-3"
                      >
                        <span class="icon-person_pin_circle"> </span>
                      </div>
                    </div>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <!--begin::Label-->
                    <codx-label
                      class="fw-bold"
                      default="Mô tả chi tiết"
                      fiedName="Memo"
                      [formModel]="dialog.formModel"
                    >
                    </codx-label>
                    <!--end::Label-->
                    <codx-input
                      type="textarea"
                      class="test-textarea"
                      field="memo"
                      format="ed2"
                      ControlName="memo"
                      rows="3"
                      ngDefaultControl
                      [crrValue]="dialogStationery.value?.memo"
                      (valueChange)="valueChange($event)"
                    >
                    </codx-input>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <div
                      class="d-flex justify-content-between align-items-center mb-4"
                    >
                      <!-- <h5 class="text-dark">Thiết bị</h5> -->
                      <codx-label
                        class="fw-bold"
                        default="Hình ảnh màu sắc"
                        name="lblImageStationary"
                      >
                      </codx-label>
                      <span
                        class="icon-select_all text-primary icon-20"
                        (click)="openPopupDevice(popupColor, null)"
                      ></span>
                    </div>
                  </div>
                  <div class="container">
                    <div class="row">
                      <div class="col-2">
                        <!-- <codx-attachment
                        #attachment
                        objectType="ES_Stationery"
                        [objectId]=""
                        hideBtnSave="1"
                        hideFolder="1"
                        hideUploadBtn="1"
                        [functionID]="formModel.funcID"
                        type="inline"
                        >
                        </codx-attachment> -->
                      </div>
                      <div class="col-10">
                        <div class="d-flex justify-content-start mb-4">
                          <div class="button-color">
                            <button
                              *ngFor="let item of listColor"
                              type="button"
                              class="btn btn-sm w-30px h-30px mx-2 border"
                              [ngStyle]="{ 'background-color': item }"
                              (click)="openPopupDevice(popupColor, item)"
                            ></button>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem [header]="headerText[1]">
            <ng-template #content>
              <div class="d-flex justify-content-end">
                <span
                  class="icon-add_circle text-primary icon-20"
                  (click)="openPopupDevice(popupDevice, null)"
                ></span>
              </div>
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">Định mức</th>
                    <th scope="col">Cấp bậc nhân viên</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>1/Người/tháng</td>
                    <td>Tất cả nhân viên</td>
                  </tr>
                  <tr>
                    <td>2/Từng lần đăng ký</td>
                    <td>Tất cả nhân viên</td>
                  </tr>
                </tbody>
              </table>
            </ng-template>
          </e-tabitem>
          <e-tabitem [header]="headerText[2]">
            <ng-template #content>
              <div id="rome" class="tabpanel">
                <div class="tab-content">
                  <!--begin::Title-->
                  <div
                    class="d-flex justify-content-between align-items-center mb-4"
                  >
                    <h4 class="fw-bolder text-gray-800 d-block mb-2">
                      <codx-label
                        name="lblInformation"
                        default="Thông tin khác"
                        [formModel]="dialog.formModel"
                      ></codx-label>
                    </h4>
                    <span class="icon-layers text-primary fs-1"></span>
                  </div>
                  <!--end::Title-->

                  <div class="d-flex row align-items-center mb-4">
                    <div class="col-4">
                      <codx-label
                        class="fw-bold"
                        default="Số lượng hiện có"
                        fiedName="vailableQty"
                        [formModel]="dialog.formModel"
                      >
                      </codx-label>
                      <!--begin::Input-->
                      <codx-input
                        type="text"
                        field="availableQty"
                        [crrValue]="dialogStationery.value?.availableQty"
                        [Group]="dialogStationery"
                      ></codx-input>
                      <!--end::Input-->
                    </div>
                    <div class="col-4">
                      <codx-label
                        class="fw-bold"
                        default="Số lượng yêu cầu"
                        fiedName="ReservedQty"
                        aria-disabled="false"
                        [formModel]="dialog.formModel"
                      >
                      </codx-label>
                      <!--begin::Input-->

                      <codx-input
                        type="text"
                        field="reservedQty"
                        [crrValue]="dialogStationery.value?.reservedQty"
                        [Group]="dialogStationery"
                      ></codx-input>
                      <!--end::Input-->
                    </div>
                    <div class="col-4">
                      <codx-label
                        class="fw-bold"
                        default="Số lượng còn lại"
                        fiedName="CurrentQty"
                        [formModel]="dialog.formModel"
                      >
                      </codx-label>
                      <!--begin::Input-->

                      <codx-input
                        type="text"
                        field="currentQty"
                        ngDefaultControl
                        [crrValue]="dialogStationery.value?.currentQty"
                        [Group]="dialogStationery"
                      ></codx-input>
                      <!--end::Input-->
                    </div>
                  </div>
                  <div class="d-flex flex-stack mb-4">
                    <div class="col-6">
                      <codx-label
                        class="fw-bold"
                        default="Giá mua sau cùng"
                        fiedName="CostPrice"
                        [formModel]="dialog.formModel"
                      >
                      </codx-label>
                      <!--begin::Input-->

                      <codx-input
                        type="text"
                        field="costPrice"
                        ngDefaultControl
                        [crrValue]="dialogStationery.value?.costPrice"
                        [Group]="dialogStationery"
                      ></codx-input>
                      <!--end::Input-->
                    </div>
                  </div>
                  <div class="d-flex flex-column mb-4">
                    <!--begin::Label-->
                    <codx-label
                      class="fw-bold"
                      default="Ghi chú"
                      fiedName="Note"
                      [formModel]="dialog.formModel"
                    >
                    </codx-label>
                    <!--end::Label-->
                    <codx-input
                      type="textarea"
                      class="test-textarea"
                      field="note"
                      format="ed2"
                      ControlName="note"
                      rows="3"
                      ngDefaultControl
                      [crrValue]="dialogStationery.value?.note"
                      (valueChange)="valueChange($event)"
                    >
                    </codx-input>
                  </div>
                </div>
              </div>
            </ng-template>
          </e-tabitem>
        </e-tabitems>
      </ejs-tab>
    </div>
  </ng-template>
  <ng-template #footer>
    <div class="d-flex justify-content-end">
      <button class="btn btn-light-primary" (click)="onSaveForm()">
        <codx-label
          name="lblSave"
          default="Lưu"
          [formModel]="dialog.formModel"
        ></codx-label>
      </button>
    </div>
  </ng-template>
</codx-form>

<ng-template #addLink let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">
      <codx-label
        name="lblLinkAppointment"
        default="Link cuộc họp"
        [formModel]="dialog.formModel"
      ></codx-label>
    </h4>
    <button
      type="button"
      class="btn btn-xs btn-icon btn-light btn-hover-primary"
      aria-label="Close"
      (click)="modal.dismiss()"
    >
      <span class="icon-close icon-20"></span>
    </button>
  </div>
  <div class="modal-body">
    <div class="form-group row">
      <div class="col-4">
        <codx-label
          name="lblLinks"
          default="Đường dẫn"
          [formModel]="dialog.formModel"
        ></codx-label>
      </div>
    </div>
    <div class="form-group row">
      <codx-input
        type="text"
        class="form-control"
        placeholder="https://home.suremeet.vn/"
        [crrValue]="link"
        (valueChange)="changeLink($event)"
      ></codx-input>
    </div>
  </div>
  <div class="modal-footer" (click)="modal.close()">
    <button type="button" class="btn btn-primary">
      <codx-label
        name="lblSave"
        default="Lưu"
        [formModel]="dialog.formModel"
      ></codx-label>
    </button>
  </div>
</ng-template>
<ng-template #popupDevice let-dialog>
  <!--begin::Card body-->
  <div class="modal-header">
    <div class="d-flex flex-column flex-grow-1">
      <div class="d-flex justify-content-between align-items-center">
        <h2 id="modal-basic-title">
          <codx-label
            name="lblEquipment"
            default="Thiết lập định mức VPP"
            [formModel]="dialog.formModel"
          ></codx-label>
        </h2>
        <button
          type="button"
          class="btn btn-xs btn-icon btn-light btn-hover-primary"
          aria-label="Close"
          (click)="dialog.close()"
        >
          <span class="icon-close icon-20 text-dark text-hover-primary"></span>
        </button>
      </div>
      <div class="text-dark-50">
        <codx-label
          name="lblChooseEquipments"
          default="Cho phép thiết lập định mức cho theo cấp bậc nhân viên"
          [formModel]="dialog.formModel"
        ></codx-label>
      </div>
    </div>
  </div>
  <div class="modal-body">
    <div class="d-flex row align-items-center mb-2">
      <div class="col-8">
        <codx-label
          class="fw-bold"
          default="Căn cứ"
          fiedName="GroupID"
          [formModel]="dialog.formModel"
        >
        </codx-label>
        <!--begin::Input-->
        <codx-input class="form-control" type="valuelist" [refValue]="'EP008'">
        </codx-input>
        <!--end::Input-->
      </div>
      <div class="col-4">
        <codx-label
          class="fw-bold"
          default="Số lượng"
          fiedName="ResourceID"
          [formModel]="dialog.formModel"
        >
        </codx-label>
        <!--begin::Input-->

        <codx-input
          type="number"
          field="number"
          placeholder="Input type number"
          [crrValue]="0"
          [min]="0"
          [max]="50"
        >
        </codx-input>
        <!--end::Input-->
      </div>
    </div>

    <div class="d-flex flex-column mb-4">
      <!--begin::Label-->
      <codx-label
        class="fw-bold"
        default="Cấp bậc"
        fiedName="Location"
        [formModel]="dialog.formModel"
      >
      </codx-label>
      <!--end::Label-->

      <codx-input type="combobox" name="combobox" ControlName="Location">
      </codx-input>
    </div>
    <!--end::Card body-->
  </div>
  <div
    class="modal-footer d-flex justify-content-end align-items-end"
    (click)="dialog.close()"
  >
    <div class="d-flex justify-content-end">
      <button type="button" class="btn btn-outline-primary me-4">
        <codx-label
          name="lblSaveAdd"
          default="Lưu&Thêm"
          [formModel]="dialog.formModel"
        ></codx-label>
      </button>
      <button type="button" class="btn btn-primary">
        <codx-label
          name="lblSave"
          default="Lưu"
          [formModel]="dialog.formModel"
        ></codx-label>
      </button>
    </div>
  </div>
</ng-template>
<ng-template #popupColor let-dialog>
  <div class="card-header">
    <div class="d-flex flex-column flex-grow-1">
      <div class="d-flex justify-content-between align-items-center">
        <h2 id="modal-basic-title">
          <codx-label
            name="lblEquipment"
            default="Chọn màu"
            [formModel]="dialog.formModel"
          ></codx-label>
        </h2>
        <button
          type="button"
          class="btn btn-xs btn-icon btn-light btn-hover-primary"
          aria-label="Close"
          (click)="dialog.close()"
        >
          <span class="icon-close icon-20 text-dark text-hover-primary"></span>
        </button>
      </div>
    </div>
  </div>
  <div class="card-body">
    <codx-input
      type="colorpicker"
      [showText]="true"
      [modeSwitcher]="true"
      [crrValue]="color"
      field="color"
      (valueChange)="valueChange($event)"
    >
    </codx-input>
    <!--end::Card body-->
  </div>
  <div
    class="card-footer d-flex justify-content-end"
    (click)="closeDialog($event)"
  >
    <button type="button" class="btn btn-primary" (click)="dialog.close()">
      <codx-label
        name="lblSave"
        default="Lưu"
        [formModel]="dialog.formModel"
      ></codx-label>
    </button>
  </div>
</ng-template>

<ng-template #Devices let-dataItem>
  <div class="d-flex align-items-center fw-bold">
    <ng-container *ngFor="let item of getlstDevice(dataItem.equipments)">
      <span class="text-dark fs-5 icon-wifi me-3"
        ><span class="fs-6 ms-1">{{
          item | vll: "EP012":"text" | async
        }}</span></span
      >
    </ng-container>
  </div>
</ng-template>

<ng-template #ranking let-dataItem>
  <div class="d-flex justify-content-center">
    <span class="badge badge-light-success fs-7 fw-bold mb-1">{{
      dataItem.ranking | vll: "EP005":"text" | async
    }}</span>
  </div>
</ng-template>

<ng-template #Devices let-dataItem>
  <div class="d-flex align-items-center fw-bold">
    <ng-container *ngFor="let item of getlstDevice(dataItem.equipments)">
      <span class="text-dark fs-5 icon-wifi me-3"
        ><span class="fs-6 ms-1">{{ getDeviceName(item) }}</span></span
      >
    </ng-container>
  </div>
</ng-template>
