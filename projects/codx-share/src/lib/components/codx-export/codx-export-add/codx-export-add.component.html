  <codx-form
    #form
    [headerText]="headerText"
    [body]="body"
    [footer]="footer"
    [dialog]="dialog"
    [headerText]="headerText"
  ></codx-form>
  <ng-template popup adde #body>
    <div class="d-flex flex-column mb-3">
        <div class="d-flex justify-content-between align-items-center">
          <div class="d-flex justify-content-start w-100">
            <codx-attachment 
              #attachment 
              [objectType]="module"
              hideBtnSave="1"  
              hideFolder="1" 
              hideUploadBtn="1"  
              hideDes="1"
              [functionID]="dialog?.formModel?.funcID"
              (fileAdded)="getfileCount($event)"
              (fileGet)="getFile($event)"
              [objectId]="data?.recID"
              [allowMultiFile]="0"
              showMessage="0"
              idBrowse="3"
              [allowExtensions]="'.docx,.xlsx'"
              class="w-100"
            >
            </codx-attachment>
          </div>
          <div class="d-flex justify-content-end ms-2">
            <button type="button" class="btn btn-outline-primary" style="width: 100px;" (click)="openFormUploadFile()">
              <codx-label [default]="'Chọn File'"></codx-label>
            </button>
          </div>
          <span class="icon-download ms-2 icon-20"></span>
        </div>
    </div>
    <div class="d-flex flex-column mb-3">
      <codx-label default="Tên template"></codx-label>
      <codx-input 
        type="text" 
        ngClass="w-100" 
        class="test-textbox"
        [Group]="exportAddForm"
        ControlName="templateName"
        [ngClass]="{ 'is-invalid': submitted && f.templateName.errors }"
      ></codx-input>
    </div>
    <div class="d-flex flex-column mb-3">
      <codx-label default="Diễn giải"></codx-label>
      <codx-input 
        type="textarea" 
        ngClass="w-100" 
        [format]="'ed2'"
        [Group]="exportAddForm"
        ControlName="description"
        [ngClass]="{ 'is-invalid': submitted && f.description.errors }"
      >
      </codx-input>
    </div>
    <div class="row mb-3">
      <div class="col">
        <codx-label default="Định dạng mật khẩu"></codx-label>
        <codx-input 
          type="text" 
          [class]="'me-3'" 
          style="width:100%"
          [Group]="exportAddForm"
          ControlName="pWControl"
        ></codx-input>
      </div>
      <div class="col">
        <codx-label default="Mật khẩu mặc định"></codx-label>
        <codx-input 
          type="text" 
          [class]="'me-3'" 
          style="width:100%" 
          [Group]="exportAddForm"
          ControlName="pWDefault"  
        ></codx-input>
      </div>
    </div>
    <ng-container *ngIf="type == 'excel'">
      <div class="row mb-3">
        <div class="col d-flex align-items-center justify-content-between">
          <codx-label default="Xuất PDF"></codx-label>
          <codx-input 
            type="switch"
            [Group]="exportAddForm"
            ControlName="covertPDF"  
          ></codx-input>
        </div>
        <div class="col d-flex align-items-center justify-content-between">
          <codx-label default="Is default"></codx-label>
          <codx-input 
            type="switch"
            [Group]="exportAddForm"
            ControlName="isDefault"     
          ></codx-input>
        </div>
      </div>
      <div class="text-primary mt-3 mb-3">Thiết lập</div>
      <div class="d-flex flex-column mb-3">
        <codx-label default="Trang chứa template"></codx-label>
        <codx-input 
          type="text"
          [showSpinButton]="false"
          [Group]="exportAddForm"
          ControlName="sheetIndex" 
          [ngClass]="{'is-invalid': submitted && f.sheetIndex.errors }"  
        ></codx-input>
      </div>
      <div class="row mb-3">
        <div class="col">
          <codx-label default="Dòng chi tiết"></codx-label>
          <codx-input 
          type="text" 
          ngClass="w-100" 
          class="test-textbox"
          style="width:100%" 
          [Group]="exportAddForm"
          ControlName="headerRow"
          [ngClass]="{'is-invalid': submitted && f.headerRow.errors }" 
          ></codx-input>
        </div>
        <div class="col">
          <codx-label default="Cột sau cùng"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="headerColumn" 
          ></codx-input>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col">
          <codx-label default="Trường chia trang"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="splitPagesOn" 
          ></codx-input>
        </div>
        <div class="col">
          <codx-label default="Kiểu chia trang"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="splitPagesMode" 
          ></codx-input>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col">
          <codx-label default="Cột đánh STT"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="rowNoIndex" 
          ></codx-input>
        </div>
        <div class="col">
          <codx-label default="Đánh lại STT"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="rowNoReset" 
          ></codx-input>
        </div>
      </div>
      <div class="text-primary mt-3 mb-3">Thiết lập nhóm</div>
      <div class="row mb-3">
        <div class="col">
          <codx-label default="Vị trí nhóm 1"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="groupName1" 
          ></codx-input>
        </div>
        <div class="col">
          <codx-label default="Dòng tổng nhóm 1"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="groupTotal1" 
          ></codx-input>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col">
          <codx-label default="Vị trí nhóm 2"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="groupName2" 
          ></codx-input>
        </div>
        <div class="col">
          <codx-label default="Dòng tổng nhóm 2"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="groupTotal2" 
          ></codx-input>
        </div>
      </div>
      <div class="row mb-3">
        <div class="col">
          <codx-label default="Vị trí nhóm 3"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="groupName3" 
          ></codx-input>
        </div>
        <div class="col">
          <codx-label default="Dòng tổng nhóm 3"></codx-label>
          <codx-input 
            type="text" 
            [class]="'me-3'" 
            style="width:100%" 
            [Group]="exportAddForm"
            ControlName="groupTotal3" 
          ></codx-input>
        </div>
      </div>
    </ng-container>
  </ng-template>
  <ng-template #footer>
      <div class="d-flex justify-content-end">
      <button class="btn btn-primary" (click)="onSave()">
         Lưu
      </button>
      </div>
  </ng-template>

