<codx-views
  #view
  [views]="views"
  [autoLoad]="false"
  [funcID]="funcID"
  (onActions)="onAction($event)"
>
</codx-views>

<ng-template #cellTemplate let-data>
  <div [innerHtml]="getCellContent(data?.calendarDate)"></div>
</ng-template>

<ng-template #contentTmp let-data>
  <ng-container #tmpTM_Tasks *ngIf="data?.transType == 'TM_Tasks'">
    <div>
      <h5>{{ data?.data?.taskName }}</h5>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <i class="icon-person me-1"></i>
      <span class="ms-1 fw-bold">
        {{ data?.data?.userNameCreate }}
      </span>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <div *ngIf="data?.data?.priority">
        <span
          class="icon-14 me-1"
          [class]="data?.data?.priority | vll : vllPriority : 'icon' | async"
          [style.color]="
            data?.data?.priority | vll : vllPriority : 'textColor' | async
          "
        >
        </span>
        <span class="text-gray-700">{{
          data?.data?.priority | vll : vllPriority : "text" | async
        }}</span>
      </div>
      <div
        #priority
        *ngIf="!data?.data?.priority"
        [innerHTML]="
          data?.data?.priority
            | formatvalue
              : view.formModel
              : 'priority'
              : priority
              : 'Tasks'
              : 'grvTasks'
            | async
        "
      ></div>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2">
      <div class="d-flex me-6">
        <i class="icon-calendar_today icon-16 me-2"></i>
        <span class="ms-1 fw-bold">
          <span
            *ngIf="data?.data?.dueDate"
            class="text-gray-700"
            #dueDate
            [innerHTML]="
              data?.data?.dueDate
                | formatvalue
                  : view.formModel
                  : 'dueDate'
                  : dueDate
                  : 'Tasks'
                  : 'grvTasks'
                | async
            "
          ></span>
          <span
            #dueDate
            *ngIf="!data?.data?.dueDate"
            [innerHTML]="
              data?.data?.dueDate
                | formatvalue
                  : view.formModel
                  : 'dueDate'
                  : dueDate
                  : 'Tasks'
                  : 'grvTasks'
                | async
            "
          ></span>
        </span>
      </div>
    </div>
    <hr />
    <div class="mb-2 text-dark me-6">
      <span>
        <codx-label
          default="Nội dung công việc :"
          name="lblMemo"
          [formModel]="view.formModel"
          class="text-gray-600"
        >
        </codx-label>
      </span>
      <span class="ms-2 fw-bold">
        <span class="text-gray-700 size-content-schedule cursor-pointer">
          <ng-container [ngTemplateOutlet]="tempHtml"></ng-container>
        </span>
      </span>
    </div>
    <div class="d-flex mb-2">
      <div class="d-flex text-dark me-6">
        <codx-label
          fiedName="Owner"
          formName="Tasks"
          gridViewName="grvTasks"
          default="Người thực hiện"
          class="text-gray-600 me-4"
        >
        </codx-label>
        <div class="d-flex justify-content-end">
          <codx-imgs
            [objectId]="data?.data?.owner"
            objectType="AD_Users"
            [numberImages]="4"
            [width]="30"
          >
          </codx-imgs>
        </div>
      </div>
    </div>
    <ng-template #tempHtml>
      <ng-container *ngIf="data?.data?.category == '2'">
        <span
          [innerHTML]="data?.data?.memo2"
          (mouseenter)="popoverMemo2.open()"
          (mouseover)="popoverMemo2.close()"
          [ngbPopover]="tooltipMemo2"
          popoverClass="empPopoverClass"
          #popoverMemo2="ngbPopover"
          placement="left bottom top right"
          container="body"
        ></span>
        <span
          #memo2
          *ngIf="!data?.data?.memo2"
          [innerHTML]="
            data?.data?.memo2
              | formatvalue
                : view.formModel
                : 'memo2'
                : memo2
                : 'Tasks'
                : 'grvTasks'
              | async
          "
        ></span>
      </ng-container>
      <ng-container *ngIf="data?.data?.category != '2'">
        <span
          [innerHTML]="data?.data?.memo"
          (mouseenter)="popoverMemo.open()"
          (mouseover)="popoverMemo.close()"
          [ngbPopover]="tooltipMemo"
          popoverClass="empPopoverClass"
          #popoverMemo="ngbPopover"
          placement="left bottom top right"
          container="body"
        ></span>
        <span
          #memo
          *ngIf="!data?.data?.memo"
          [innerHTML]="
            data?.data?.memo
              | formatvalue
                : view.formModel
                : 'memo'
                : memo
                : 'Tasks'
                : 'grvTasks'
              | async
          "
        ></span>
      </ng-container>
    </ng-template>
    <ng-template #tooltipMemo>
      <div [innerHTML]="data?.data?.memo"></div>
    </ng-template>
    <ng-template #tooltipMemo2>
      <div [innerHTML]="data?.data?.memo2"></div>
    </ng-template>
  </ng-container>
  <!-- <ng-container
    #tmpEP_BookingRooms
    *ngIf="data?.transType == 'EP_BookingRooms'"
  >
    <div class="d-flex justify-content-between">
      <span class="border-start fw-bold border-4 border-danger fs-3 ps-2"
        >{{ data?.data?.title }}
      </span>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <i class="icon-person me-1"></i>
      <span class="fw-bold">
        {{ data?.data?.requester }}
      </span>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <i class="icon-location_on me-1"></i>
      <span class="fw-bold">
        {{ getResourceNameRoom(data?.data?.resourceID) }}
      </span>
    </div>

    <div class="d-flex mt-1 flex-grow-1 mb-2">
      <div class="d-flex me-6">
        <i class="icon-calendar_today icon-16 me-2"></i>
        <span class="fw-bold">
          {{ data?.data?.bookingOn | fmDT : "dmy" }}
        </span>
      </div>
      <div class="d-flex me-6">
        <i class="icon-access_time me-1"></i>
        <span class="fw-bold">
          {{ showHour(data?.data?.startDate) }}
        </span>
        <span
          *ngIf="data?.data?.startDate && data?.data?.endDate"
          class="fw-bold ms-1 me-1"
          >{{ "-" }}</span
        >
        <span class="fw-bold">
          {{ showHour(data?.data?.endDate) }}
        </span>
      </div>
    </div>

    <hr />
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <codx-label
        name="lblReason"
        default="Lí do"
        class="fw-bold text-nowrap"
      ></codx-label>
      <span class="me-2 fw-bold">:</span>
      <span class="text-gray-800">
        {{ data?.data?.reasonID }}
      </span>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <codx-label
        default="Nội dung"
        name="lblMemo"
        class="fw-bold text-nowrap"
      ></codx-label>
      <span class="me-2 fw-bold">:</span>
      <span class="text-gray-800" [innerHTML]="data?.data?.memo"> </span>
    </div>
    <div class="d-flex mb-2">
      <div class="d-flex text-dark me-6">
        <codx-label
          name="lblAttendees"
          default="Người tham gia"
          class="fw-bold text-nowrap"
        >
        </codx-label>
        <span class="me-2 fw-bold">:</span>
        <div class="d-flex justify-content-end">
          <codx-imgs
            [objectId]="selectBookingAttendeesRoom"
            objectType="AD_Users"
            [numberImages]="6"
            [width]="30"
          >
          </codx-imgs>
        </div>
      </div>
    </div>
    <hr />
    <div
      *ngIf="selectBookingItems.length > 0"
      style="max-height: 150px; overflow: auto"
    >
      <div *ngFor="let item of selectBookingItems">
        <div class="d-flex mb-4 justify-content-between">
          <div class="d-flex flex-row">
            <div class="me-2">
              <codx-img
                [objectId]="item.recID"
                imageType="circle"
                width="35"
                objectType="EP_Resources"
                [objectName]="item.itemName"
              ></codx-img>
            </div>
            <div class="">
              <div class="">
                <span href="#" class="fw-bold">{{ item.itemName }}</span>
              </div>
              <div class="d-flex flex-row flex-grow-1">
                <codx-label
                  default="Đơn vị tính"
                  name="lblQuantity"
                  class="text-gray-800"
                ></codx-label>
                <span>:</span>
                <span class="d-block ms-2 fw-bold">{{ item?.umName }}</span>
              </div>
            </div>
          </div>

          <div class="d-flex align-items-center me-3">
            <codx-label
              default="Số lượng"
              name="lblQuantity"
              class="text-gray-800"
            ></codx-label>
            <span>:</span>
            <span class="ms-2 fw-bold">{{ item.quantity }}</span>
          </div>
        </div>
      </div>
    </div>
  </ng-container> -->
  <ng-container #EP_BookingCars *ngIf="data?.transType == 'EP_BookingCars'">
    <codx-booking-car-schedule-content
      [recID]="data?.transID"
    ></codx-booking-car-schedule-content>
  </ng-container>
  <ng-container
    #tmpEP_BookingRooms
    *ngIf="data?.transType == 'EP_BookingRooms'"
  >
    <codx-booking-room-schedule-content
      [recID]="data?.transID"
    ></codx-booking-room-schedule-content>
  </ng-container>
  <!-- <ng-container #EP_BookingCars *ngIf="data?.transType == 'EP_BookingCars'">
    <div>
      <codx-label
        [default]="data?.data?.title"
        class="border-start fw-bold border-4 border-danger fs-3 ps-2"
      ></codx-label>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <i class="icon-directions_car me-1"></i>
      <codx-label name="lblCar" default="Loại xe" class="fw-bold"></codx-label>
      <span class="me-1 fw-bold">:</span>
      <span class="">
        {{ getResourceNameCar(data?.data?.resourceID) }}
      </span>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <i class="icon-contact_mail me-1"></i>
      <codx-label
        name="lblDriver"
        default="Tài xế"
        class="fw-bold"
      ></codx-label>
      <span class="me-1 fw-bold">:</span>
      <span *ngIf="driverName != '' && driverName != null">
        <span class="">
          {{ driverName }}
        </span>
      </span>
      <span *ngIf="driverName == ''">
        <span></span>
      </span>
      <span *ngIf="driverName == null">
        <codx-label
          default="Không có tài xế"
          class=""
          name="lblUnavailableDriver"
        ></codx-label>
      </span>
    </div>

    <hr />
    <div class="d-flex mt-1 flex-grow-1 mb-2 me-6">
      <i class="icon-person me-1"></i>
      <span class="ms-1 fw-bold">
        {{ data?.data?.requester }}
      </span>
    </div>

    <div *ngIf="sameDayCheck(data?.data?.startDate, data?.data?.endDate)">
      <div class="d-flex mt-1 flex-grow-1 mb-2">
        <div class="d-flex me-6">
          <i class="icon-calendar_today icon-16 me-2"></i>
          <span class="ms-1 fw-bold">
            {{ data?.data?.startDate | fmDT }}
          </span>
        </div>
        <div class="d-flex me-6">
          <i class="icon-access_time me-1"></i>
          <span class="fw-bold">
            {{ showHour(data?.data?.startDate) }}
          </span>
          <span
            *ngIf="data?.data?.startDate && data?.data?.endDate"
            class="fw-bold ms-1 me-1"
            >{{ "-" }}</span
          >
          <span class="fw-bold">
            {{ showHour(data?.data?.endDate) }}
          </span>
        </div>
      </div>
    </div>
    <div *ngIf="!sameDayCheck(data?.data?.startDate, data?.data?.endDate)">
      <div class="d-flex mt-1 flex-grow-1 mb-2">
        <div class="d-flex me-6">
          <i class="icon-calendar_today icon-16 me-2"></i>
          <span class="ms-1 fw-bold">
            {{ data?.data?.startDate | fmDT : "dmy" : true }}
          </span>
        </div>
        <div class="d-flex me-6">
          <i class="icon-calendar_today icon-16 me-2"></i>
          <span class="fw-bold">
            {{ data?.data?.endDate | fmDT : "dmy" : true }}
          </span>
        </div>
      </div>
    </div>

    <hr />
    <div class="mb-2">
      <codx-label
        name="lblReason"
        default="Mục tiêu sử dụng"
        class="fw-bold"
      ></codx-label>
      <span class="me-1 fw-bold">:</span>
      <span class="ms-1">{{ data?.data?.reasonID }} </span>
    </div>
    <div class="mb-2">
      <codx-label
        name="lblAgencyName"
        default="Tên đơn vị"
        class="fw-bold"
      ></codx-label>
      <span class="me-1 fw-bold">:</span>
      <span class="ms-1">{{ data?.data?.agencyName }} </span>
    </div>
    <div class="mb-2">
      <codx-label
        name="lblAddress"
        default="Địa chỉ"
        class="fw-bold"
      ></codx-label>
      <span class="me-1 fw-bold">:</span>
      <span class="ms-1">{{ data?.data?.address }} </span>
    </div>

    <div>
      <div class="d-flex mb-2">
        <div class="d-flex text-dark me-6">
          <div class="d-flex justify-content-end">
            <codx-imgs
              [objectId]="selectBookingAttendeesCar"
              objectType="AD_Users"
              [numberImages]="7"
              [width]="30"
            >
            </codx-imgs>
          </div>
        </div>
      </div>
    </div>
  </ng-container> -->
  <ng-container #CO_Meetings *ngIf="data?.transType == 'CO_Meetings'">
    <div>
      <h5
        #meetingName
        [innerHTML]="
          data?.data?.meetingName
            | formatvalue
              : view.formModel
              : 'meetingName'
              : meetingName
              : 'Meetings'
              : 'grvMeetings'
            | async
        "
      ></h5>
    </div>
    <div class="d-flex mt-1 flex-grow-1 mb-2">
      <div class="d-flex me-6">
        <i class="icon-calendar_today icon-16 me-2"></i>
        <span class="ms-1 fw-bold">
          <span
            #startDate
            class="text-gray-700"
            [innerHTML]="
              data?.data?.startDate
                | formatvalue
                  : view.formModel
                  : 'startDate'
                  : startDate
                  : 'Meetings'
                  : 'grvMeetings'
                | async
            "
          ></span>
          <span
            *ngIf="data?.data?.startDate"
            class="fw-bold p-2"
            [innerHtml]="'( ' + getDate(data?.data) + ')'"
          ></span>
        </span>
      </div>
    </div>
    <hr />

    <div class="mb-2 text-dark me-6">
      <span>
        <codx-label
          default="Nội dung cuộc họp :"
          name="lblMemo"
          [formModel]="view.formModel"
          class="text-gray-600"
        >
        </codx-label>
      </span>
      <span class="ms-2 fw-bold">
        <span class="text-gray-700 size-content-schedule cursor-pointer">
          <span
            [innerHTML]="data?.data?.memo"
            (mouseenter)="popoverMemo.open()"
            (mouseover)="popoverMemo.close()"
            [ngbPopover]="tooltipMemo"
            popoverClass="empPopoverClass"
            #popoverMemo="ngbPopover"
            placement="left bottom top right"
            container="body"
          ></span>
          <span
            #memo
            *ngIf="!data?.data?.memo"
            [innerHTML]="
              data?.data?.memo
                | formatvalue
                  : view.formModel
                  : 'memo'
                  : memo
                  : 'Meetings'
                  : 'grvMeetings'
                | async
            "
          ></span>
        </span>
      </span>
    </div>
    <div class="d-flex mb-2">
      <div class="d-flex text-dark me-6">
        <codx-label
          name="lblResources"
          default="Người tham gia : "
          class="text-gray-600 me-4"
        >
        </codx-label>
        <div class="d-flex justify-content-end">
          <codx-imgs
            [objectId]="getResourceID(data?.data)"
            objectType="AD_Users"
            [width]="30"
            [numberImages]="3"
          >
          </codx-imgs>
        </div>
      </div>
    </div>
    <ng-template #tooltipMemo>
      <div [innerHTML]="data?.data?.memo"></div>
    </ng-template>
  </ng-container>
  <ng-container #WP_Notes *ngIf="data?.transType == 'WP_Notes'">
    <div class="checkbox-list">
      <div *ngIf="data?.data.noteType == 'text'">
        <div
          *ngIf="data?.data.isPin == true || data?.data.isPin == '1'"
          class="active"
        >
          <span class="icon-push_pin icon-16" type="button"></span>
        </div>
        <div class="d-flex flex-column note-option">
          <span [innerHTML]="data?.data.memo"></span>
        </div>
      </div>
      <div *ngIf="data?.data.noteType != 'text'">
        <div
          *ngIf="data?.data.isPin == true || data?.data.isPin == '1'"
          class="active"
        >
          <span class="icon-push_pin icon-16" type="button"></span>
        </div>
        <div class="d-flex flex-column note-option">
          <div *ngFor="let itemList of data?.data.checkList; index as i">
            <div *ngIf="itemList.status == null">
              <div class="my-2 note-list">
                <ul>
                  <li>{{ itemList.listNote }}</li>
                </ul>
              </div>
            </div>
            <div *ngIf="itemList.status != null">
              <div class="my-2 note-list">
                <codx-input
                  #checkBoxNote
                  id="checkBoxNote"
                  type="checkbox"
                  label="{{ itemList.listNote }}"
                  [disabled]="false"
                  [checked]="
                    itemList?.status == 'true' || itemList?.status == '1'
                  "
                  labelPosition="After"
                  class="test-check"
                ></codx-input>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</ng-template>

<ng-template #headerTemp>
  <div class="mt-6"></div>
</ng-template>

<ng-template #cardTemplate let-data>
  <ng-container *ngIf="data.transType == 'EP_BookingCars'">
    <div
      class="d-flex flex-column w-100"
      (click)="getMoreInfoBookingCars(data.transID)"
    >
      <span
        >{{ showHour(data.data.startDate) }} -
        {{ showHour(data.data.endDate) }}</span
      >
      <span
        class="fw-bold"
        style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis"
        >{{ data.title }}</span
      >
    </div>
  </ng-container>
  <ng-container *ngIf="data.transType == 'EP_BookingRooms'">
    <div
      class="d-flex flex-column w-100"
      (click)="getMoreInfoBookingRooms(data.transID)"
    >
      <span
        >{{ showHour(data.data.startDate) }} -
        {{ showHour(data.data.endDate) }}</span
      >
      <span
        class="fw-bold"
        style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis"
        >{{ data.title }}</span
      >
    </div>
  </ng-container>
  <ng-container
    *ngIf="data.transType == 'TM_Tasks' || data.transType == 'CO_Meetings'"
  >
    <span
      class="fw-bold"
      style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis"
      >{{ data.title }}</span
    >
  </ng-container>
  <ng-container *ngIf="data.transType == 'WP_Notes'">
    <span
      *ngIf="data?.noteType == 'text'"
      class="fw-bold"
      style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis"
      >{{ data?.memo }}</span
    >
    <div *ngIf="data?.noteType != 'text'">
      <div *ngFor="let itemList of data?.checkList; index as i">
        <div *ngIf="itemList.status == null">
          <div class="my-2 note-list">
            <ul>
              <li>{{ itemList.listNote }}</li>
            </ul>
          </div>
        </div>
        <div *ngIf="itemList.status != null">
          <div class="my-2 note-list">
            <codx-input
              #checkBoxNote
              id="checkBoxNote"
              type="checkbox"
              label="{{ itemList.listNote }}"
              [disabled]="false"
              [checked]="itemList?.status == 'true' || itemList?.status == '1'"
              labelPosition="After"
              class="test-check"
            ></codx-input>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</ng-template>
