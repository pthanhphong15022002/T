<div class="d-flex align-items-center justify-content-between mt-1 mb-2">
    <div class="d-flex align-items-center ms-1 text-hover-underline" (click)="showVotes(dataComment)">
        <ng-container *ngIf="dataComment.totalVote > 0">
            <div class="flex align-items-center">
                <div *ngFor="let votedType of dataComment.listVoteType">
                    <a>
                        <img src="assets/themes/wp/default/img/{{votedType | vll:'L1480':'icon' | async}}"
                            alt="Kiwi standing on oval" style="width: 15px; height: 15x;">
                    </a>
                </div>
            </div>
            <span class="ms-2 fs-6">{{dataComment.totalVote}}</span>
        </ng-container>
    </div>
    <div class="d-flex align-items-center text-hover-underline text-gray-800 me-1" (click)="showComments(dataComment)">
        <ng-container *ngIf="dataComment.totalComment > 0">
            <span>{{dataComment.totalComment}}</span>
            <span class="ms-1">
                <codx-label formName="WP_Comments" name="lblComments" default="bình luận"></codx-label>
            </span>
        </ng-container>
    </div>
</div>
<div class="row m-0 btn-comment py-2 border-top">
    <div class="col-6 p-0">
        <div class="btn-like btn-feed delay-500">
            <div *ngIf="!dataComment.myVotedType;else myVoted">
                <div class="d-flex align-items-center justify-content-center text-hover-primary">
                    <span class="fw-bold text-dark">
                        <codx-label [formModel]="formModel" name="lblLike" default="Thích"></codx-label>
                    </span>
                </div>
            </div>
            <div class="d-flex mod icon-like">
                <ng-container *ngFor="let item of vllL1480">
                    <a class="mod-icon" (click)="votePost(dataComment, item.value)">
                        <img src="assets/themes/wp/default/img/{{item.icon}}" alt="Kiwi standing on oval"></a>
                </ng-container>
            </div>
            <ng-template #myVoted>
                <div class="d-flex align-items-center justify-content-center text-hover-primary">
                    <img src="assets/themes/wp/default/img/{{(dataComment.myVotedType | vll:'L1480':'icon' | async)}}"
                        alt="Kiwi standing on oval" style="width: 18px; height: 18px">
                    <div>
                        <span class="fw-bold ms-2"
                            [style.color]="dataComment.myVotedType | vll:'L1480':'textColor' | async">
                            {{dataComment.myVotedType | vll:'L1480':'text' | async}}
                        </span>
                    </div>
                </div>
            </ng-template>
        </div>
    </div>
    <div class="col-6 p-0">
        <div class="btn-feed" (click)="showComments(dataComment)">
            <div class="d-flex align-items-center justify-content-center">
                <span class="text-dark fw-bold">
                    <codx-label [formModel]="formModel" name="lblComments" default="Bình luận"></codx-label>
                </span>
            </div>
        </div>
    </div>
</div>
<div class="isHiden border-top" [class.isShow]="dataComment.isShowComment">
    <codx-comments [funcID]="funcID" [objectType]="objectType" [new]="true" [formModel]="formModel"
        (evtSendComment)="sendComment($event)" [parentID]="dataComment.recID" [refID]="dataComment.recID">
    </codx-comments>
    <ng-container *ngFor="let cm of lstComment">
        <ng-container *ngTemplateOutlet="cmt; context: { $implicit: cm }"></ng-container>
    </ng-container>
</div>
<ng-template #cmt let-data>
    <div class="c1" [attr.dt]="setDicData(data)" id="{{data.recID}}">
        <codx-comments [funcID]="funcID" [objectType]="objectType" [data]="data" [parentID]="data.parentID"
            [refID]="data.recID" [new]="false" [formModel]="formModel" (evtDeleteComment)="deleteComment($event)"
            (evtReplyTo)="replyTo($event)">
        </codx-comments>
        <div class="ms-15" *ngFor="let item of data.listComment">
            <ng-container *ngTemplateOutlet="subCmt context: { $implicit: item }"></ng-container>
        </div>
        <ng-container *ngIf="data.showReply">
            <codx-comments [funcID]="funcID" [objectType]="objectType" (evtDeleteComment)="deleteComment($event)"
                (evtSendComment)="sendComment($event,data)" [new]="true" [parentID]="data.parentID" [refID]="data.recID"
                [formModel]="formModel">
            </codx-comments>
        </ng-container>
    </div>
</ng-template>
<ng-template #subCmt let-data>
    <div class="c2" [attr.dt]="setDicData(data)" id="{{data.recID}}">
        <div>
            <codx-comments [funcID]="funcID" [objectType]="objectType" [data]="data" [parentID]="data.parentID"
                [refID]="data.recID" [new]="false" [formModel]="formModel" (evtDeleteComment)="deleteComment($event)"
                (evtReplyTo)="replyTo($event)">
            </codx-comments>
        </div>
        <ng-container *ngIf="data.totalSubComment > 0">
            <div class="ms-16">
                <span class="text-gray-400 text-hover-underline" (click)="loadSubComment(data)">
                    <codx-label [formModel]="formModel" name="lblSeemore" default="Xem thêm"></codx-label>
                </span>
            </div>
        </ng-container>
        <div class="ms-15" *ngFor="let item of data.listComment">
            <ng-container *ngTemplateOutlet="cmt context: { $implicit: item }"></ng-container>
        </div>
        <ng-container *ngIf="data.showReply">
            <codx-comments [funcID]="funcID" [objectType]="objectType" (evtDeleteComment)="deleteComment($event)"
                (evtSendComment)="sendComment($event,data)" [new]="true" [parentID]="data.parentID" [refID]="data.recID"
                [formModel]="formModel">
            </codx-comments>
        </ng-container>
    </div>
</ng-template>
<ng-template #popContentListVoted let-dialog>
    <codx-form headerText="Danh sách" [body]="body" [dialog]="dialog">
    </codx-form>
    <ng-template #body>
        <div class="card-body">
            <div class="tab-horizone mt-2">
                <ul class="nav nav-tabs nav-tabs-line">
                    <li class="nav-item">
                        <a class="nav-link" data-toggle="tab">
                            <div class="flex align-items-center">
                                <div class="me-2">
                                    <span class="nav-text d-block h-20px">
                                        <codx-label formName="Comments" name="lblTotal" default="Tất cả"></codx-label>
                                    </span>
                                </div>
                                <span class="nav-text d-block">({{dataComment.totalVote}})</span>
                            </div>
                        </a>
                    </li>
                    <li *ngFor="let vote of votes" class="nav-item"
                        (click)="getUserVotes(dataComment.recID,vote.voteType)">
                        <a class="nav-link" data-toggle="tab">
                            <div class="flex align-items-center">
                                <div class="me-2">
                                    <img class="h-20px w-20px"
                                        src="assets/themes/wp/default/img/{{(vote.voteType | vll:'L1480':'icon' | async)}}">
                                </div>
                                <div class="me-2">
                                    <span class="nav-text d-block h-20px">
                                        <codx-label formName="Comments" name="lblLike"
                                            [default]="vote.voteType | vll:'L1480':'text' | async"></codx-label>
                                    </span>
                                </div>
                                <span class="nav-text d-block">({{vote.countVote}})</span>
                            </div>
                        </a>
                    </li>
                </ul>
                <div class="mt-2">
                    <div class="tab-pane">
                        <div *ngFor="let item of lstUserVote" class="d-flex align-items-center user-card py-4">
                            <div class="me-4">
                                <codx-img [width]="40" [objectId]="item.CreatedBy" objectType="HR_Employees">
                                </codx-img>
                            </div>
                            <div class="d-flex flex-column flex-grow-1">
                                <div class="text-dark fw-bold">{{item.createdName}}</div>
                                <div class="text-gray-800 fw-bold">{{item.positionName}}</div>
                                <div class="text-gray-400">{{item.createdOn | date:'dd-MM-yyy HH:mm:ss'}}</div>
                            </div>
                            <div class="ms-6" style="margin-right: 45px">
                                <img src="assets/themes/wp/default/img/{{(item.voteType|vll:'L1480':'icon'|async)}}"
                                    alt="Kiwi standing on oval" style="width: 15px; height: 15x;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
</ng-template>