<codx-treeview
  #treeView
  [itemTemplate]="templateTreeView"
  [data]="dataTree"
  [entityName]="'TM_Tasks'"
  [service]="'TM'"
  [enableCheck]="true"
  idField="recID"
  parentIdField="parentID"
  [autoLoad]="false"
  [isOutput]="true"
  [isLoadChild]="false"
  (selectionChange)="selectionChange($event)"
>
</codx-treeview>

<!-- temptree -->
<ng-template #templateTreeView let-data>
  <ng-container>
    <div class="tab-tch mt-3">
      <div class="d-flex align-items-start justify-content-between mb-3">
        <div class="d-flex align-items-start">
          <span *ngIf="data?.items.length > 0">
            <div
              id="{{ data.taskID }}"
              class="icon-16 icon-add_box me-2 align-items-start pt-3"
            ></div>
          </span>
          <div class="d-flex align-items-top w-100">
            <div class="me-3">
              <codx-img
                [width]="35"
                #image
                [objectId]="data?.userID"
              ></codx-img>
            </div>
            <div class="d-flex flex-column flex-grow-1">
              <div class="d-flex align-items-center">
                <span class="text-dark fw-bold">{{ data?.userName }}</span>
                <span
                  *ngIf="data?.isTimeOut"
                  class="icon-notifications expired icon-16 ms-1"
                ></span>
              </div>
              <div class="text-gray-700 text-italic fs-7">
                {{ data?.positionName }}
              </div>
              <div class="text-gray-600">
                <span *ngIf="data.category == '1' || data.category == '3'">
                  {{ data?.taskName }}</span
                >
                <span *ngIf="data.category == '2'"> {{ data?.memo2 }}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="d-flex align-items-center ms-7" (click)="clickTemp($event)">
          <span class="me-4">
            <codx-assign-temp
              [objectID]="data.taskID"
              [formModel]="formModel"
            ></codx-assign-temp>
          </span>
          <span class="me-4">
            <codx-comment-temp [objectID]="data.recID"></codx-comment-temp>
          </span>
          <span class="me-4">
            <codx-attachment-temp
              [objectID]="data.recID"
              [formModel]="formModel"
            ></codx-attachment-temp>
          </span>

          <!-- <div
            [class]="'d-flex align-items-center me-4'+ ' ' +(data?.items?.length > 0? 'text-dark' : 'text-gray-600')">
            <span class="text-dark icon-person_outline icon-16"></span>
            <span class="ms-1"> {{data?.items? data?.items?.length : 0}}</span>
          </div> -->
          <!-- <div [class]="'d-flex align-items-center me-4'+ ' ' +(data?.comments > 0? 'text-dark' : 'text-gray-600')">
            <span class="text-dark icon-mode_comment icon-16"></span>
            <span class="ms-1">
              {{data?.comments}}</span>
          </div>
          <div [class]="'d-flex align-items-center'+ ' ' +(data?.attachments >0? 'text-dark' : 'text-gray-600')">
            <span class="text-dark icon-attach_file icon-16"></span>
            <span>
              {{data?.attachments}}
            </span>
          </div> -->
          <div class="w-125px d-flex justify-content-end">
            <codx-vll
              [name]="data?.category=='3'?vllStatus:vllStatusAssign"
              [field]="'Status'"
              [value]="data?.status"
              [showText]="true"
              [showBgColor]="true"
              class="badge badge-light badge-md fs-7 ms-2"
            >
            </codx-vll>
          </div>
          <div class="d-flex flex-column w-50px ms-3">
            <div class="fs-7 text-gray-600 mb-1">
              {{ data?.percentage.toFixed(2) }}%
            </div>
            <div class="progress w-100 h-5px">
              <div
                class="progress-bar progress-bar-done"
                role="progressbar"
                [style.width.%]="data?.percentage"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</ng-template>
