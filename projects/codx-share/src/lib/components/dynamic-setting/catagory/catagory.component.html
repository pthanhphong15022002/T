<div class="list-group">
  <h3 class="list-header">{{ title }}</h3>
  <div class="list-content">
    <ng-container *ngIf="groupSetting && groupSetting.length > 0; else noGroup">
      <ng-container *ngFor="let item of groupSetting">
        <ng-container
          *ngTemplateOutlet="
            template;
            context: { $implicit: item, isGroup: true }
          "
        >
        </ng-container>
        <ng-container *ngIf="item.displayMode !== '1'">
          <ng-container *ngFor="let itemchild of setting | group: item.recID">
            <ng-container
              *ngTemplateOutlet="
                template;
                context: {
                  $implicit: itemchild,
                  collapse: item.displayMode === '3'
                }
              "
            >
            </ng-container>
          </ng-container>
        </ng-container>
      </ng-container>
    </ng-container>
    <ng-template #noGroup>
      <ng-container *ngFor="let item of setting">
        <ng-container
          *ngTemplateOutlet="
            template;
            context: { $implicit: item, collapse: item.displayMode === '3' }
          "
        >
        </ng-container>
      </ng-container>
    </ng-template>
  </div>
</div>
<ng-template #template let-data let-collapse="collapse" let-isGroup="isGroup">
  <div
    class="list-item"
    [ngClass]="collapse ? ' d-none' : ''"
    [attr.data-group]="data.refLineID"
  >
    <div class="d-flex justify-content-between">
      <div class="d-flex flex-column">
        <div class="font-size-h6 font-weight-bold text-dark mb-2">
          {{ data.tilte }}
        </div>
        <div class="text-muted">
          {{ data.description }}
        </div>
      </div>
      <div class="d-flex align-items-center ml-4">
        <codx-input
          [style]="
            data.controlType == 'TextBox' || data.controlType == 'Combobox'
              ? 'width: 200px'
              : ''
          "
          *ngIf="data.controlType && data.controlType != 'GroupControl'"
          [type]="data.controlType"
          [name]="data.controlType"
          placeholder=""
          ngDefaultControl
          [refType]="data.referedType"
          [refValue]="data.referedValue || data.referdValue"
          [loadFull]="true"
          [field]="data.fieldName"
          [crrValue]="dataValue[data.fieldName] || ''"
          (valueChange)="valueChange($event)"
        >
        </codx-input>
        <a
          [routerLink]="
            data.reference ? '../../../../' + data.reference : 'detail'
          "
          [state]="{
            setting: setting | group: data.recID:'2',
            function: function,
            dataValue: dataValue[data.fieldName]
          }"
          *ngIf="data.displayMode === '1'"
          ><span class="icon-keyboard_arrow_right icon-20 ml-6"></span
        ></a>
        <a
          href="javascript:void(0)"
          (click)="openPopup($event, data.reference, data.fieldName)"
          *ngIf="data.displayMode === '2'"
          ><span class="icon-edit icon-20 ml-6"></span
        ></a>
        <a
          href="javascript:void(0)"
          *ngIf="data.displayMode === '3'"
          (click)="collapseItem($event, data.recID)"
          ><span
            class="icon-keyboard_arrow_right icon-20 ml-6 button-collapse"
            [attr.data-id]="data.recID"
          ></span
        ></a>
        <ng-container
          *ngIf="data.displayMode === '4' || data.displayMode === '5'"
        >
          <codx-input
            type="Share"
            [refValue]="data.refValue"
            field="popup"
            [dataShared]="[]"
            [showInput]="false"
            [listCombobox]="data.reference"
            [multiple]="data.displayMode === '5'"
          >
          </codx-input>
        </ng-container>
      </div>
    </div>
    <hr *ngIf="!isGroup" />
  </div>
</ng-template>
