<codx-treeview
  id="tree"
  #treeView
  [itemTemplate]="templateTreeView"
  [data]="dataTree"
  [enableCheck]="false"
  idField="recID"
  parentIdField="parentID"
  [autoLoad]="false"
  [isOutput]="true"
  [isLoadChild]="false"
  (selectionChange)="selectionChange($event)"
>
</codx-treeview>

<ng-template #templateTreeView let-item>
  <div class="d-flex flex-row align-datas-top p-3 border-bottom">
    <div class="w-50px min-w-50px">
      <span *ngIf="item?.isAssign">
        <span class="icon-18 icon-add_box me-2 align-datas-start"></span>
      </span>
    </div>
    <div class="w-100 max-w-150px">
      <div class="a" [ngbTooltip]="item?.taskName">
        {{ item?.taskName }}
      </div>
    </div>

    <div [ngbTooltip]="item?.memo || item?.memo2 ? tempHtml : 'Không có mô tả'">
      <span class="icon-assignment icon-16 text-gray-600 me-1"></span>
    </div>
    <div class="w-100px min-w-100px">
      <div>
        <div *ngIf="item.category == '3'" class="">
          <codx-imgs
            [objectId]="item?.assignTo"
            objectType="AD_Users"
            [numberImages]="4"
          >
          </codx-imgs>
        </div>
        <div *ngIf="item.category == '1' || item.category == '2'" class="">
          <codx-imgs
            [objectId]="item?.owner"
            objectType="AD_Users"
            [numberImages]="4"
          >
          </codx-imgs>
        </div>
      </div>
    </div>
    <div class="w-20px min-w-20px">
      <span
        class="priority mb-1 max-h-70px"
        [class]="item?.priority | vll: vllPriority:'icon' | async"
        [style.color]="item?.priority | vll: vllPriority:'textColor' | async"
      ></span>
    </div>
    <div class="w-120px min-w-120px d-flex align-datas-center">
      <div
        [class]="
          'd-flex align-datas-center me-3' +
          ' ' +
          (item?.comments ? 'text-success' : 'text-gray-600')
        "
      >
        <span
          class="text-hover-primary icon-chat_bubble_outline icon-16"
        ></span>
        <span class="ms-1"> {{ item?.comments }}</span>
      </div>
      <div
        [class]="
          'd-flex align-datas-center me-3' +
          ' ' +
          (item?.todo ? 'text-success' : 'text-gray-600')
        "
      >
        <span class="text-hover-primary icon-check-correct icon-16"></span>
        <span class="ms-1"> {{ item?.todo }}</span>
      </div>
      <div
        [class]="
          'd-flex align-datas-center me-3' +
          ' ' +
          (item?.attachments ? 'text-success' : 'text-gray-600')
        "
      >
        <span class="text-hover-primary icon-attach_file icon-16"></span>
        <span>
          {{ item?.attachments }}
        </span>
      </div>
      <div class="w-100px min-w-100px">
        <div class="d-flex flex-column justify-content-start">
          <div class="text-gray-500 mb-1">
            {{ item?.percentage.toFixed(2) }}%
          </div>
          <div class="progress w-100 h-5px">
            <div
              class="progress-bar progress-bar-done"
              role="progressbar"
              [style.width.%]="item?.percentage"
            ></div>
          </div>
        </div>
      </div>
    </div>

    <div class="w-120px min-w-120px">
      <codx-vll
        [name]="vllStatus"
        [field]="'Status'"
        [value]="item?.status"
        [showText]="true"
        [showBgColor]="true"
        class="badge badge-light badge-md fs-7 ms-2"
      >
      </codx-vll>
    </div>
    <div class="w-10px min-w-10px">
      <codx-mfunc
        [formModel]="formModel"
        (clickMF)="clickMF($event, data)"
        (changeDataMF)="changeDataMF($event, item)"
        [isBookMark]="false"
        [dataItem]="data"
        type="hover"
      >
      </codx-mfunc>
    </div>
  </div>

  <ng-template #tempHtml>
    <span *ngIf="item?.category == '2'" [innerHTML]="item?.memo2"></span>
    <span *ngIf="item?.category != '2'" [innerHTML]="item?.memo"></span>
  </ng-template>
</ng-template>
