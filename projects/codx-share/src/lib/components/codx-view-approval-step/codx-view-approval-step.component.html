<div
  class="codx-approval step-signature-temp"
  *ngIf="process?.length > 0 && lstSttApproveStep.includes(approveStatus)"
>
  <ng-container *ngFor="let item of process; let index = index">
    <div class="codx-approval-step pb-3 step-approve">
      <div class="codx-approval-header d-flex align-items-center mb-3">
        <div class="step-number border-success">{{ item?.stepNo }}</div>
        <div class="step-title text-gray-700 fw-bold fs-5 me-1">
          {{ item?.stepType | vll : "ES002" : "text" | async }}
        </div>
        <div
          class="step-title text-gray-700 fw-bold fs-5 me-1"
          *ngIf="item?.signatureType">|</div>
        <div
          *ngIf="eSign"
          class="step-title text-gray-700 fw-bold fs-5 me-1"
          [innerHTML]="
            item?.signatureType
              | formatvalue : fmApprovalStep : 'signatureType'
              | async
          "
        ></div>
        <div class="text-gray-500 fs-5 me-1">-</div>
        <div class="text-gray-500 fs-5">
          {{ item?.stepName ?? item?.stepNote }}
        </div>
      </div>
      <div class="codx-approval-content ms-16">
        <ng-container *ngFor="let approver of item?.approvers">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <codx-temp-full
              *ngIf="
                approver?.roleType == 'U' || approver?.roleType == 'PA'
              "
              [imageId]="approver?.approver"
              [imageObjType]="'AD_Users'"
              [imageWidth]="35"
              [title]="
                approver?.name ??
                approver?.approverName ??
                (approver?.approver | vll : 'ES014' : 'text' | async)
              "
              [desc]="
                approver?.position ??
                approver?.approverPosition ??
                positionDefault
              "
            >
            </codx-temp-full>

            <codx-temp-full
            *ngIf="approver?.roleType=='P'"
            [imageSrc]="
              './assets/themes/sys/default/img/' +
              (item?.icon ? item?.icon : 'share_default.svg')
            "
            imgCss="w-30px p-3 me-3 user-mini-icon"
            [imageWidth]="20"
            [title]="approver?.name"
            [desc]="approver?.roleType | vll : 'ES014' : 'text' | async"
          >
          </codx-temp-full>

            <codx-temp-full
              *ngIf="approver?.roleType!='U' && approver?.roleType != 'PA' && approver?.roleType != 'P'"
              [imageSrc]="
                './assets/themes/sys/default/img/' +
                (item?.icon ? item?.icon : 'share_default.svg')
              "
              imgCss="w-30px p-3 me-3 user-mini-icon"
              [imageWidth]="20"
              [title]="approver?.approver | vll : 'ES014' : 'text' | async"
              [desc]="approver?.approver | vll : 'ES014' : 'text' | async"
            >
            </codx-temp-full>
            <div class="d-flex align-items-center ms-6 flex-column flex-column">
              <div class="d-flex align-items-center ms-6 flex-column">
                <!-- <span class="badge badge-light ms-6">
                  <codx-label
                    default="Chờ giải quyêt"
                    name="lblStatusNew"
                  ></codx-label>
                </span> -->
                <codx-vll
                  [value]="approver?.actived ? '1' : '0'"
                  [name]="'ES031'"
                  [showIcon]="true"
                  [showText]="true"
                  [showBgColor]="true"
                  class="badge"
                >
                </codx-vll>
                <div class="text-dark fs-7"></div>
              </div>
            </div>
          </div>
          <div
            class="d-flex align-items-center justify-content-between mb-3"
            *ngIf="approver?.leadtime != 0"
          >
            <div class="d-flex w-250px">
              <div
                class="progress h-6px w-100 me-3"
                style="background-color: #e9ecef"
              >
                <div
                  role="progressbar"
                  aria-valuenow="40"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  class="progress-bar"
                  [ngClass]="
                    approver?.leadtime < approver?.duration
                      ? 'bg-danger'
                      : 'bg-success'
                  "
                  [style]="
                    'width:' +
                    getPercent(approver?.leadtime, approver?.duration) +
                    '%'
                  "
                ></div>
              </div>
            </div>
            <ng-container>
              <div class="d-flex me-3">
                <div class="d-flex text-nowrap me-3">
                  <span class="fw-bold me-1">
                    <codx-label></codx-label>
                  </span>
                  <span class="fw-bold me-1">
                    <codx-label name="lblLeadtime" default="Dự kiến">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600">
                    {{ approver?.leadtime | number : ".2-2" }} h</span
                  >
                </div>

                |
                <div class="d-flex text-nowrap ms-3">
                  <span class="fw-bold me-1">
                    <codx-label name="lblDuration" default="Thực tế">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600"
                    >{{ approver?.duration ?? 0 | number : ".2-2" }} h</span
                  >
                </div>
              </div>
            </ng-container>
            <!-- <ng-container *ngIf="approveStatus == '1'">
                <div class="d-flex text-nowrap">
                  <span class="fw-bold">
                    <codx-label></codx-label>
                  </span>
                  <span class="fw-bold me-1">
                    <codx-label name="lblLeadtime" default="Dự kiến">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600">
                    {{ approver?.leadtime | number: ".2-2" }} h</span
                  >
                </div>
              </ng-container> -->
          </div>
          <!-- <div class="bg-gray-100 bg-opacity-70 rounded-2 px-3 py-4 mb-3">
              <div class="text-comment">
                Thank you so much for letting me be a part of your party. The
                food was delicious, and everything was so perfect. Thank you for
                inviting me.
              </div>
            </div>
            <div class="d-attach pb-5">
              <div class="d-flex flex-wrap align-items-center">
                <codx-temp-full
                  cardCss="sm-card rounded-1 px-2 py-3 d-flex flex-aligns-center me-5 w-250px"
                  imageSrc="../assets/codx/dms/doc.svg"
                  imgCss="img-folder me-4"
                  [title]="
                    'Checklisttestcase.xslxChecklisttestcase.xslxChecklisttestcase.xslx'
                  "
                  [titleLine]="2"
                  titleCss="w-175px"
                >
                </codx-temp-full>
                <codx-temp-full
                  cardCss="sm-card rounded-1 px-2 py-3 d-flex flex-aligns-center me-5 w-250px"
                  imageSrc="../assets/codx/dms/xls.svg"
                  imgCss="img-folder me-4"
                  [title]="'Checklisttestcase.xslx'"
                  [titleLine]="2"
                  titleCss="w-175px"
                  [subTitle]="'3.12MB'"
                >
                </codx-temp-full>
                <codx-temp-full
                  cardCss="sm-card rounded-1 px-2 py-3 w-250px"
                  imageSrc="../assets/codx/dms/pdf.svg"
                  imgCss="img-folder me-4"
                  [title]="'Checklisttestcase.xslx'"
                  [titleLine]="2"
                  titleCss="w-175px"
                  [subTitle]="'3.12MB'"
                >
                </codx-temp-full>
              </div>
            </div> -->
        </ng-container>
      </div>
    </div>
  </ng-container>
</div>


<div
  class="codx-approval step-signature-temp"
  *ngIf="process?.length > 0 && !lstSttApproveStep.includes(approveStatus)"
>
  <ng-container *ngFor="let item of process; let index = index">
    <div class="codx-approval-step pb-3 step-approve">
      <div class="codx-approval-header d-flex align-items-center mb-3">
        <div class="step-number border-success">{{ item?.stepNo }}</div>
        <div class="step-title text-gray-700 fw-bold fs-5 me-1">
          {{ item?.stepType | vll : "ES002" : "text" | async }}
          <!-- {{ item?.stepType | formatvalue : eDiseasesFormModel : "Conclusion" | async }} -->
        </div>
        <ng-container *ngIf="item?.signatureType && fmApprovalTrans">
          <div
          class="step-title text-gray-700 fw-bold fs-5 me-1">|</div>
          <div
            *ngIf="eSign"
            class="step-title text-gray-700 fw-bold fs-5 me-1"
            [innerHTML]="
              item?.signatureType
                | formatvalue : fmApprovalTrans : 'signatureType'
                | async
            "
          ></div>
        </ng-container>
        
        <div class="text-gray-400 fs-5 me-1">-</div>
        <div class="text-gray-400 fs-5 me-1">
          {{ item?.stepName ?? item?.stepNote }}
        </div>
      </div>
      <div class="codx-approval-content ms-17">
        <ng-container *ngFor="let approver of item?.approvers">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <codx-temp-full
              [imageId]="approver?.approver"
              [imageObjType]="'AD_Users'"
              [imageWidth]="35"
              [title]="
                approver?.name ??
                approver?.approverName ??
                (approver?.approver | vll : 'ES014' : 'text' | async)
              "
              [desc]="
                approver?.position ??
                approver?.approverPosition ??
                positionDefault
              "
            >
            </codx-temp-full>
            <div class="d-flex justify-content-between">
              <div
                class="text-dark fs-7 me-4 mt-1"
                *ngIf="approver?.status == '3'"
              >
                {{ approver?.activedOn | amTimeAgo }}
              </div>
              <div class="d-flex flex-wrap">
                <div class="d-flex mt-1" *ngIf="approver?.status == '5'">
                  <!-- <codx-label
                    fiedName="ApprovedOn"
                    [formModel]="fmApprovalTrans"
                  ></codx-label> -->
                  <div class="d-flex text-dark fs-7 me-4">
                    {{ approver?.approvedOn | fmDT }}
                  </div>
                </div>

                <codx-vll
                  *ngIf="approver?.status != '1'"
                  [value]="approver?.status + approver?.stepType"
                  [name]="'ES030'"
                  [showIcon]="true"
                  [showText]="true"
                  [showBgColor]="true"
                  class="badge"
                >
                </codx-vll>
              </div>

              <div
                *ngIf="approver?.status == '1'"
                class="d-flex align-items-center justify-content-between ms-6 flex-column"
              >
                <codx-vll
                  [value]="approver?.actived ? '1' : '0'"
                  [name]="'ES031'"
                  [showIcon]="true"
                  [showText]="true"
                  [showBgColor]="true"
                  class="badge"
                >
                </codx-vll>
              </div>
            </div>
          </div>
          <div
            class="d-flex align-items-center justify-content-between mb-3"
            *ngIf="approver?.leadtime != 0"
          >
            <div class="d-flex w-250px">
              <div
                class="progress h-6px w-100 me-3"
                style="background-color: #e9ecef"
              >
                <div
                  role="progressbar"
                  aria-valuenow="40"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  class="progress-bar"
                  [ngClass]="
                    approver?.leadtime < approver?.duration
                      ? 'bg-danger'
                      : 'bg-success'
                  "
                  [style]="
                    'width:' +
                    getPercent(approver?.leadtime, approver?.duration) +
                    '%'
                  "
                ></div>
              </div>
            </div>
            <ng-container>
              <div class="d-flex me-3">
                <div class="d-flex text-nowrap me-3">
                  <span class="fw-bold me-1">
                    <codx-label></codx-label>
                  </span>
                  <span class="fw-bold me-1">
                    <codx-label name="lblLeadtime" default="Dự kiến">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600">
                    {{ approver?.leadtime | number : ".2-2" }} h</span
                  >
                </div>

                |
                <div class="d-flex text-nowrap ms-3">
                  <span class="fw-bold me-1">
                    <codx-label name="lblDuration" default="Thực tế">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600"
                    >{{ approver?.duration ?? 0 | number : ".2-2" }} h</span
                  >
                </div>
              </div>
            </ng-container>
            <!-- <ng-container *ngIf="approveStatus == '1'">
                <div class="d-flex text-nowrap">
                  <span class="fw-bold">
                    <codx-label></codx-label>
                  </span>
                  <span class="fw-bold me-1">
                    <codx-label name="lblLeadtime" default="Dự kiến">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600">
                    {{ approver?.leadtime | number: ".2-2" }} h</span
                  >
                </div>
              </ng-container> -->
          </div>
          <div
            class="bg-gray-100 bg-opacity-70 rounded-2 px-3 py-4 mb-3"
            *ngIf="
              approver?.status != '3' &&
              approver?.comment != '' &&
              approver?.comment
            "
          >
            <div class="text-comment">
              {{ approver?.comment }}
            </div>
          </div>
          <!-- <div class="d-attach pb-5">
              <div class="d-flex flex-wrap align-items-center">
                <codx-temp-full
                  cardCss="sm-card rounded-1 px-2 py-3 d-flex flex-aligns-center me-5 w-250px"
                  imageSrc="../assets/codx/dms/doc.svg"
                  imgCss="img-folder me-4"
                  [title]="
                    'Checklisttestcase.xslxChecklisttestcase.xslxChecklisttestcase.xslx'
                  "
                  [titleLine]="2"
                  titleCss="w-175px"
                >
                </codx-temp-full>
                <codx-temp-full
                  cardCss="sm-card rounded-1 px-2 py-3 d-flex flex-aligns-center me-5 w-250px"
                  imageSrc="../assets/codx/dms/xls.svg"
                  imgCss="img-folder me-4"
                  [title]="'Checklisttestcase.xslx'"
                  [titleLine]="2"
                  titleCss="w-175px"
                  [subTitle]="'3.12MB'"
                >
                </codx-temp-full>
                <codx-temp-full
                  cardCss="sm-card rounded-1 px-2 py-3 w-250px"
                  imageSrc="../assets/codx/dms/pdf.svg"
                  imgCss="img-folder me-4"
                  [title]="'Checklisttestcase.xslx'"
                  [titleLine]="2"
                  titleCss="w-175px"
                  [subTitle]="'3.12MB'"
                >
                </codx-temp-full>
              </div>
            </div> -->
        </ng-container>
      </div>
    </div>
  </ng-container>
</div>


<div
  class="codx-approval step-signature-temp"
  *ngIf="canceledProcess?.length > 0 "
>

<button type="button" class="btn btn-link"  (click)="showCanceledTrans(showCanceled)" ><codx-label class="fw-bold fs-5" default="Quy trình duyệt đã hủy" name="lblCanceledTrans"></codx-label></button>

<ng-container *ngIf="showCanceled">
<ng-container *ngFor="let gr of canceledProcess">
  <ng-container *ngFor="let item of gr; let index = index">
    <div class="codx-approval-step pb-3 step-approve opacity-50">
      <div class="codx-approval-header d-flex align-items-center mb-3">
        <div class="step-number border-success">{{ item?.stepNo }}</div>
        <div class="step-title text-gray-700 fw-bold fs-5 me-1">
          {{ item?.stepType | vll : "ES002" : "text" | async }}
          <!-- {{ item?.stepType | formatvalue : eDiseasesFormModel : "Conclusion" | async }} -->
        </div>
        <ng-container *ngIf="item?.signatureType && fmApprovalTrans">
          <div
          class="step-title text-gray-700 fw-bold fs-5 me-1">|</div>
          <div
            *ngIf="eSign"
            class="step-title text-gray-700 fw-bold fs-5 me-1"
            [innerHTML]="
              item?.signatureType
                | formatvalue : fmApprovalTrans : 'signatureType'
                | async
            "
          ></div>
        </ng-container>
        
        <div class="text-gray-400 fs-5 me-1">-</div>
        <div class="text-gray-400 fs-5 me-1">
          {{ item?.stepName ?? item?.stepNote }}
        </div>
      </div>
      <div class="codx-approval-content ms-17">
        <ng-container *ngFor="let approver of item?.approvers">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <codx-temp-full
              [imageId]="approver?.approver"
              [imageObjType]="'AD_Users'"
              [imageWidth]="35"
              [title]="
                approver?.name ??
                approver?.approverName ??
                (approver?.approver | vll : 'ES014' : 'text' | async)
              "
              [desc]="
                approver?.position ??
                approver?.approverPosition ??
                positionDefault
              "
            >
            </codx-temp-full>
            <div class="d-flex justify-content-between">
              <div
                class="text-dark fs-7 me-4 mt-1"
                *ngIf="approver?.status == '3'"
              >
                {{ approver?.activedOn | amTimeAgo }}
              </div>
              <div class="d-flex flex-wrap">
                <div class="d-flex mt-1" *ngIf="approver?.status == '5'">
                  <!-- <codx-label
                    fiedName="ApprovedOn"
                    [formModel]="fmApprovalTrans"
                  ></codx-label> -->
                  <div class="d-flex text-dark fs-7 me-4">
                    {{ approver?.approvedOn | fmDT }}
                  </div>
                </div>
                <codx-vll
                  *ngIf="approver?.status != '1'"
                  [value]="approver?.status + approver?.stepType"
                  [name]="'ES030'"
                  [showIcon]="true"
                  [showText]="true"
                  [showBgColor]="true"
                  class="badge"
                >
                </codx-vll>
              </div>

              <div
                *ngIf="approver?.status == '1'"
                class="d-flex align-items-center justify-content-between ms-6 flex-column"
              >
                <codx-vll
                  [value]="approver?.actived ? '1' : '0'"
                  [name]="'ES031'"
                  [showIcon]="true"
                  [showText]="true"
                  [showBgColor]="true"
                  class="badge"
                >
                </codx-vll>
              </div>
            </div>
          </div>
          <div
            class="d-flex align-items-center justify-content-between mb-3"
            *ngIf="approver?.leadtime != 0"
          >
            <div class="d-flex w-250px">
              <div
                class="progress h-6px w-100 me-3"
                style="background-color: #e9ecef"
              >
                <div
                  role="progressbar"
                  aria-valuenow="40"
                  aria-valuemin="0"
                  aria-valuemax="100"
                  class="progress-bar"
                  [ngClass]="
                    approver?.leadtime < approver?.duration
                      ? 'bg-danger'
                      : 'bg-success'
                  "
                  [style]="
                    'width:' +
                    getPercent(approver?.leadtime, approver?.duration) +
                    '%'
                  "
                ></div>
              </div>
            </div>
            <ng-container>
              <div class="d-flex me-3">
                <div class="d-flex text-nowrap me-3">
                  <span class="fw-bold me-1">
                    <codx-label></codx-label>
                  </span>
                  <span class="fw-bold me-1">
                    <codx-label name="lblLeadtime" default="Dự kiến">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600">
                    {{ approver?.leadtime | number : ".2-2" }} h</span
                  >
                </div>

                |
                <div class="d-flex text-nowrap ms-3">
                  <span class="fw-bold me-1">
                    <codx-label name="lblDuration" default="Thực tế">
                    </codx-label>
                    :
                  </span>
                  <span class="text-gray-600"
                    >{{ approver?.duration ?? 0 | number : ".2-2" }} h</span
                  >
                </div>
              </div>
            </ng-container>
          </div>
          <div
            class="bg-gray-100 bg-opacity-70 rounded-2 px-3 py-4 mb-3"
            *ngIf="
              approver?.status != '3' &&
              approver?.comment != '' &&
              approver?.comment
            "
          >
            <div class="text-comment">
              {{ approver?.comment }}
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </ng-container>
</ng-container>
</ng-container>
</div>
