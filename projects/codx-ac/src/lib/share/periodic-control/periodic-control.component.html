<codx-views class="ac-views" #view idField="recID" [views]="views" service="AC" [entityName]="view?.entityName" (changeDataMF)="changeDataMF($event,'view')"
  [isSubView]="true" assemblyName="AC" className="RunPeriodicBusiness" service="AC" method="GetDataAsync" (clickMF)="clickMF($event)" (requestEnded)="requestEnded($event)">
</codx-views>
<ng-template #template let-data>

  <ng-container *ngIf="setting">
  <div class="h-100 overflow-auto">
    <div class="d-flex container w-60 mb-5">
      <div class="bg-body rounded-3 p-6 flex-grow-1 overflow-auto">
          <dynamic-setting-control [setting]="setting" [dataValue]="dataValue" (valueChanges)="valuechange($event)"></dynamic-setting-control>
      </div>
    </div>
    <ng-container *ngIf="setting.length">
      <div class="d-flex container w-60 ">
        <div class="bg-body rounded-3 p-6 flex-grow-1">
          <div class="list-group">
            <div style="align-items: center;" class="d-flex justify-content-between">
              <div style="align-items: center;" class="d-flex w-100">
                <i class="text-primary icon-i-calendar4-event icon-16 me-3"></i>
                <h3 class="list-header mx-0 my-0">Lần chạy sau cùng</h3>
              </div>
              <div class="d-flex ms-4 justify-content-end category-control w-250px min-w-250px">
                <!-- <button [disabled]="showLess" (click)="loadData()" type="button" class="btn btn-md btn-light-primary"
                  style="border: 1px solid var(--primary-dark) !important">
                  <div class="d-flex align-items-center">
                    <i class="icon-i-arrows-collapse icon-16"></i>
                    <codx-label class="fw-normal" fiedName="lblSaveAndClear" default="Thu gọn"></codx-label>
                  </div>
              </button> -->
              </div>
            </div>
          </div>
          <div *ngIf="!oData.length" class="list-content">
            <div style="justify-content: center !important;
              display: flex;
              align-items: center;
              flex-direction: column !important;">
              <img style="width: 13%;" src="../assets/themes/sys/default/img/DataEmpty.svg" />
              <div class="fs-6 text-dark mt-2 text-center">
                {{ "SYS011" | mssg | async }}
              </div>
            </div>
          </div>
          <ng-container *ngIf="oData.length">
            <ng-container *ngFor="let item of oData;trackBy: trackByFn">
              <div>
                <div style="padding-left: 2rem;" class="list-content">
                  <div class="list-item py-3">
                    <div class="d-flex justify-content-between">
                      <div class="d-flex flex-column w-100">
                        <div class="fw-bold text-dark">
                          <span #runDate [innerHTML]="
                                        item?.runDate
                                          | formatvalue : view.formModel : 'runDate' : runDate
                                          | async
                                      " class="me-3"></span>
                          <ng-container *ngIf="displayMode && displayMode === '1'">
                            <span *ngIf="item?.runMode === '1'" class="badge ac-badge-light-warning">
                              Mô phỏng
                            </span>
                            <span *ngIf="item?.runMode === '2'" class="badge ac-badge-light-success">
                              Chính thức
                            </span>
                          </ng-container>
                        </div>
                        <div class="text-dark">
                          <span class="mt-1">{{title+' tháng '}}</span>
                          <span class="me-3 mt-1">{{item?.runDate | formatDate}}</span>
                        </div>
                        <div class="text-gray-500 pt-1 setting-description">
                          <span>Thực hiện bởi: </span>
                          <ng-container>
                            <span *ngIf="item?.createdBy">{{
                              item?.createdBy
                              }}</span>
                            <span *ngIf="
                                (item?.createdBy == '' || item?.createdBy == null) &&
                                view?.gridViewSetup
                              " class="place-holder line-clamp line-clamp-1 fs-6 me-2">
                              {{ view?.gridViewSetup["CreatedBy"].headerText }}
                            </span>
                          </ng-container>
                          <span> | </span>
                          <span>Ngày: </span>
                          <span #runDate
                            [innerHTML]="item?.runDate | formatvalue : view.formModel : 'runDate' : runDate | async"></span>
                        </div>
                      </div>
                      <div class="d-flex ms-4 justify-content-end category-control w-250px min-w-250px">
                        <div class="d-flex flex-column">
                          <codx-mfunc [formModel]="view.formModel" [isToolBar]="true" type="view"
                            [dataItem]="item" (changeDataMF)="showMFCancel($event)" (clickMF)="clickMF($event,item)"></codx-mfunc>
                          <span class="badge ac-badge-light-primary mb-3">
                            Đã hoàn tất
                          </span>
                          <!-- <button (click)="cancel(item)" type="button" class="btn btn-md btn-danger">
                            <div class="d-flex align-items-center">
                              <i class="icon-cancel icon-16"></i>
                              <codx-label class="fw-normal" default="Hủy"></codx-label>
                            </div>
                          </button> -->
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <hr class="ms-9 my-0" style="margin-top: -1px;">
            </ng-container>
          </ng-container>
          <div *ngIf="oData.length" class="d-flex align-items-center justify-content-center mt-5">
            <div>
              <button [disabled]="showAll" (click)="loadData()" type="button" class="btn btn-md btn-light-primary me-3"
                style="border: 1px solid var(--primary-dark) !important">
                <div class="d-flex align-items-center">
                  <i class="icon-i-arrows-expand icon-16"></i>
                  <codx-label class="fw-normal" fiedName="lblSaveAndClear" default="Xem thêm"></codx-label>
                </div>
              </button>
              <button *ngIf="showLess" (click)="onCollaple()" type="button" class="btn btn-md btn-light-primary"
                style="border: 1px solid var(--primary-dark) !important">
                <div class="d-flex align-items-center">
                  <i class="icon-i-arrows-collapse icon-16"></i>
                  <codx-label class="fw-normal" fiedName="lblSaveAndClear" default="Thu gọn"></codx-label>
                </div>
              </button>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>  
  </ng-container>
</ng-template>