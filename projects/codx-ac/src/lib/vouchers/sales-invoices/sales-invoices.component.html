<codx-views
  #view
  [views]="views"
  [button]="btnAdd"
  entityName="SM_SalesInvoices"
  predicates="JournalNo=@0"
  [dataValues]="journalNo"
  (buttonClick)="onClickAdd($event)"
  (selectedChange)="onChange($event)"
>
</codx-views>

<ng-template #moreTemplate let-data>
  <codx-mfunc
    [dataItem]="data"
    [formModel]="view.formModel"
    (clickMF)="onClickMF($event, data)"
    [isBookMark]="true"
    type="view"
  ></codx-mfunc>
</ng-template>

<ng-template #sider let-data>
  <codx-temp-full
    [descTmp]="descTmp"
    [desc2Tmp]="desc2Tmp"
    [titleTmp]="titleTmp"
    cardCss="card-template border-bottom p-3 list-task"
    [formModel]="view.formModel"
    [modeImgs]="true"
    [titleLine]="2"
    [dataItem]="data"
    [footer]="siderFooter"
    [hideMF]="false"
    typeMF="hover"
    moreFuncCss="me-15"
    (clickMF)="onClickMF($event, data)"
  >
  </codx-temp-full>
</ng-template>

<ng-template #descTmp let-data>
  <div class="fw-bold mt-1">
    {{ data.objectName }}
  </div>
</ng-template>

<ng-template #desc2Tmp let-data>
  <span class="text-gray-500 mt-1 line-clamp line-clamp-2">{{
    data?.memo
  }}</span>
</ng-template>

<ng-template #titleTmp let-data>
  <span class="fw-bold fs-6">{{ data.voucherNo }}</span>
  <span class="fw-bold fs-6">{{
    data.totalAmt | currency : data.currencyID : "code"
  }}</span>
</ng-template>

<ng-template #siderFooter let-data>
  <div class="d-flex align-items-center justify-content-between mt-1">
    <div class="d-flex align-items-center">
      <codx-vll
        [formModel]="view.formModel"
        field="Status"
        [value]="data?.status"
        [showText]="true"
        [showBgColor]="true"
        class="badge badge-light badge-sm me-3"
      >
      </codx-vll>
      <div class="d-flex align-items-center">
        <span class="icon-customize icon-16 me-1 text-gray-600"></span>
        <span
          class="text-gray-600"
          [innerHTML]="
            data?.voucherDate
              | formatvalue : view.formModel : 'voucherDate'
              | async
          "
        ></span>
      </div>
    </div>

    <codx-img [objectId]="data?.createdBy" objectType="AD_Users" [width]="30">
    </codx-img>
  </div>
</ng-template>

<ng-template #content>
  <codx-detail-tmp
    [header]="header"
    [body]="body"
    [hideMF]="false"
    [formModel]="view.formModel"
    [dataItem]="selectedData"
    [footer]="contentFooter"
    (clickMF)="onClickMF($event, selectedData)"
  >
  </codx-detail-tmp>
</ng-template>

<ng-template #header>
  <div class="d-flex align-items-center ac-cashID mt-n8">
    <div
      class="w-20px h-20px rounded-circle bg-primary d-flex flex-center me-2"
    >
      <i class="icon-i-file-earmark-text text-white icon-14"></i>
    </div>
    <span class="fw-bold line-clamp line-clamp-1 mt-1 fs-4 text-uppercase">
      {{ selectedData?.voucherNo }}
    </span>

    <div class="d-flex mt-1 ms-5">
      <codx-label
        fiedName="voucherDate"
        [formModel]="view.formModel"
        class="fw-bold label-colon"
      ></codx-label>
      <span
        class="text-gray-600"
        [innerHTML]="
          selectedData?.voucherDate
            | formatvalue : view.formModel : 'voucherDate'
            | async
        "
      ></span>
    </div>
  </div>

  <div class="d-flex align-items-center justify-content-between mt-3 mb-2">
    <span class="fw-bold line-clamp line-clamp-1 fs-4">{{selectedData?.objectName}}</span>
    <codx-vll
      [formModel]="view.formModel"
      field="Status"
      [value]="selectedData?.status"
      [showText]="true"
      [showBgColor]="true"
      class="badge badge-light badge-sm border-0 me-3"
    >
    </codx-vll>
  </div>
</ng-template>

<ng-template #body>
  <div class="d-flex align-items-center justify-content-between">
    <div class="d-flex flex-wrap">
      <div class="d-flex align-items-top me-5 mb-5px">
        <codx-label
          fiedName="invoiceNo"
          [formModel]="view.formModel"
          class="fw-bold label-colon"
        ></codx-label>
        <span
          class="text-gray-600"
          [innerHTML]="
            selectedData?.invoiceNo
              | formatvalue : view.formModel : 'invoiceNo'
              | async
          "
        ></span>
      </div>
      <div class="d-flex align-items-top me-5 mb-5px">
        <codx-label
          fiedName="invoiceDate"
          [formModel]="view.formModel"
          class="fw-bold label-colon"
        ></codx-label>
        <span
          [innerHTML]="
            selectedData.invoiceDate
              | formatvalue : view.formModel : 'invoiceDate'
              | async
          "
          class="text-gray-600"
        ></span>
      </div>
      <div class="d-flex align-items-top me-5 mb-5px">
        <codx-label
          fiedName="invoiceDueDate"
          [formModel]="view.formModel"
          class="fw-bold label-colon"
        ></codx-label>
        <span
          [innerHTML]="
            selectedData.invoiceDueDate
              | formatvalue : view.formModel : 'invoiceDueDate'
              | async
          "
          class="text-gray-600"
        ></span>
      </div>
    </div>

    <span class="badge badge-pill badge-primary me-3">
      <span class="fw-bold fs-6">{{
        selectedData.totalAmt | currency : selectedData?.currencyID : "code"
      }}</span>
    </span>
  </div>

  <div class="d-flex flex-wrap">
    <div class="d-flex align-items-top me-5 mb-5px">
      <codx-label
        fiedName="pmtMethodID"
        [formModel]="view.formModel"
        class="fw-bold label-colon"
      ></codx-label>
      <span
        class="text-gray-600"
        [innerHTML]="
          selectedData?.pmtMethodID
            | formatvalue : view.formModel : 'pmtMethodID'
            | async
        "
      ></span>
    </div>
    <div class="d-flex align-items-top me-5 mb-5px">
      <codx-label
        fiedName="salespersonID"
        [formModel]="view.formModel"
        class="fw-bold label-colon"
      ></codx-label>
      <span
        [innerHTML]="
          selectedData.salespersonID
            | formatvalue : view.formModel : 'salespersonID'
            | async
        "
        class="text-gray-600"
      ></span>
    </div>
  </div>

  <div class="me-5 mb-5px line-clamp line-clamp-2">
    <codx-label
      fiedName="memo"
      [formModel]="view.formModel"
      class="fw-bold label-colon"
    ></codx-label>
    <span
      [innerHTML]="
        selectedData?.memo | formatvalue : view.formModel : 'memo' | async
      "
      class="text-gray-600"
    ></span>
  </div>

  <ejs-tab class="mt-5">
    <e-tabitems>
      <e-tabitem>
        <ng-template #headerText>
          <div class="d-flex me-2">
            <span class="icon-format_list_numbered icon-18 me-2"></span>
            <codx-label
              class="fw-bold"
              fiedName="lblDetail"
              [formModel]="view.formModel"
              default="Thông tin chi tiết"
            ></codx-label>
          </div>
        </ng-template>
        <ng-template #content>
          <lib-table-line-detail
            [transID]="selectedData.recID"
            [gvs]="salesInvoiceService.gvsSalesInvoicesLines"
            [height]="300"
          ></lib-table-line-detail>
        </ng-template>
      </e-tabitem>
    </e-tabitems>
  </ejs-tab>
</ng-template>

<ng-template #contentFooter>
  <codx-tabs
    [entityName]="view.formModel.entityName"
    [formModel]="view.formModel"
    [objectID]="selectedData.recID"
    [funcID]="view.formModel.funcID"
    [TabControl]="tabControl"
  ></codx-tabs>
</ng-template>
