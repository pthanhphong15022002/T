<codx-gridview-v2
  #grid
  [formName]="fmSalesInvoicesLines.formName"
  [gridViewName]="fmSalesInvoicesLines.gridViewName"
  [entityName]="fmSalesInvoicesLines.entityName"
  [templateMore]="more"
  service="SM"
  [height]="height"
  [autoLoad]="false"
  [hideMoreFunc]="!hasMF"
  [columnsGrid]="columns"
  [showRowNumber]="true"
  predicates="TransID=@0"
  [dataValues]="transID"
  (created)="onCreate($event)"
></codx-gridview-v2>

<ng-template #columnItemID let-data>
  <div class="py-1 d-flex flex-column gap-1">
    <div class="fw-bold">{{ data.itemName }}</div>
    <div>
      <codx-label
        fiedName="idiM3"
        [formModel]="fmSalesInvoicesLines"
        class="label-colon"
      ></codx-label>
      <span
        *ngFor="let i of [0, 1, 2, 3]; last as isLast"
        class="text-gray-500"
      >
        <span
          *ngIf="data['idiM' + i]"
          [innerHTML]="
            data['idiM' + i]
              | formatvalue : fmSalesInvoicesLines : 'idiM' + i
              | async
          "
        ></span>
        <ng-container *ngIf="!isLast && data['idiM' + (i + 1)]"
          >,&nbsp;</ng-container
        >
      </span>
    </div>
    <div class="d-flex flex-wrap">
      <codx-label
        fiedName="lblIdiM4"
        [formModel]="fmSalesInvoicesLines"
        default="Kho"
        class="label-colon"
      ></codx-label>
      <span
        *ngFor="let i of [4, 5, 6, 7, 8, 9]; last as isLast"
        class="text-gray-500"
      >
        <span
          *ngIf="data['idiM' + i]"
          [innerHTML]="
            data['idiM' + i]
              | formatvalue : fmSalesInvoicesLines : 'idiM' + i
              | async
          "
        ></span>
        <ng-container *ngIf="!isLast && data['idiM' + (i + 1)]"
          >,&nbsp;</ng-container
        >
      </span>
    </div>

    <codx-vll
      *ngIf="data.lineType !== '1'"
      [formModel]="fmSalesInvoicesLines"
      field="LineType"
      [value]="data.lineType"
      [showText]="true"
      [showBgColor]="true"
      class="badge badge-primary align-self-start"
    >
    </codx-vll>
  </div>
</ng-template>

<ng-template #columnQuantity let-data>
  <div class="d-flex flex-column pt-1 gap-1">
    <div>{{ data.quantity }}</div>
    <div>{{ data.umid }}</div>
  </div>
</ng-template>

<ng-template #columnVatid let-data>
  <div class="d-flex flex-column pt-1 gap-1">
    <div>{{ data.vatAmt | currency : "" : "" }}</div>
    <div
      *ngIf="
        vats | nameById : 'VATID' : 'TaxRate' : data.vatid as taxRate;
        else taxRate
      "
    >
      {{ taxRate * 100 }}%
    </div>
    <ng-template #taxRate>-</ng-template>
  </div>
</ng-template>

<ng-template #more let-data>
  <codx-mfunc
    [dataItem]="data"
    [formModel]="fmSalesInvoicesLines"
    (clickMF)="onClickMF($event, data)"
    [isBookMark]="true"
    type="view"
  ></codx-mfunc>
</ng-template>
