<div #myTable class="table-responsive h-100">
  <table class="table table-hover h-100">
    <thead>
      <tr>
        <th scope="col" *ngFor="let th of ths" [class]="th.class">
          <codx-label [fiedName]="th.field" [default]="th.headerText" [formModel]="fmSalesInvoicesLines"></codx-label>
        </th>
      </tr>
    </thead>

    <tbody>
      <tr *ngIf="loading">
        <td colspan="100%" style="text-align: center; vertical-align: middle">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </td>
      </tr>

      <tr *ngIf="salesInvoicesLines?.length === 0 && !loading">
        <td colspan="100%" style="text-align: center; vertical-align: middle">
          <img src="../assets/themes/sys/default/img/DataEmpty.svg" class="w-200px" />
          <div class="fw-bold mt-1">
            {{ "SYS011" | mssg | async }}
          </div>
        </td>
      </tr>
    </tbody>

    <tbody>
      <tr *ngFor="let line of salesInvoicesLines; index as i">
        <th style="width: 30px">
          <div class="pt-1">{{ i + 1 }}</div>
        </th>
        <td>
          <div class="py-1 d-flex flex-column gap-1">
            <div class="fw-bold">{{ line.itemName }}</div>
            <div>
              <codx-label fiedName="idiM3" [formModel]="fmSalesInvoicesLines" class="label-colon"></codx-label>
              <!-- IDIM 0 -->
              <span class="text-gray-500" [innerHTML]="
              line.packingSpecificationsName
                | formatvalue : fmSalesInvoicesLines : 'idiM0': '' : '' : '': false
                | async
            ">
              </span>
              ,&nbsp;

              <!-- IDIM 0 -->
              <span class="text-gray-500" [innerHTML]="
              line.styleName
                | formatvalue : fmSalesInvoicesLines : 'idiM1': '' : '' : '': false
                | async
            ">
              </span>
              ,&nbsp;

              <!-- IDIM 0 -->
              <span class="text-gray-500" [innerHTML]="
              line.colorName
                | formatvalue : fmSalesInvoicesLines : 'idiM2' : '' : '' : '': false
                | async
            ">
              </span>
              ,&nbsp;

              <!-- IDIM 0 -->
              <span class="text-gray-500" [innerHTML]="
              line.specificationsName
                | formatvalue : fmSalesInvoicesLines : 'idiM3': '' : '' : '': false
                | async
            ">
              </span>
            </div>

            <div class="d-flex flex-wrap">
              <codx-label fiedName="lblIdiM4" [formModel]="fmSalesInvoicesLines" default="Kho"
                class="label-colon"></codx-label>

              <!-- IDIM 4 -->
              <span class="text-gray-500" [innerHTML]="
              line.warehouseName
                | formatvalue : fmSalesInvoicesLines : 'idiM4': '' : '' : '': false
                | async
            ">
              </span>
              ,&nbsp;

              <!-- IDIM 5 -->
              <span class="text-gray-500" [innerHTML]="
              line.locationName
                | formatvalue : fmSalesInvoicesLines : 'idiM5': '' : '' : '': false
                | async
            ">
              </span>
              ,&nbsp;

              <!-- IDIM 6 -->
              <span class="text-gray-500" [innerHTML]="
              line.batchNo
                | formatvalue : fmSalesInvoicesLines : 'idiM6': '' : '' : '': false
                | async
            ">
              </span>
              ,&nbsp;

              <!-- IDIM 7 -->
              <span class="text-gray-500" [innerHTML]="
              line.seriName
                | formatvalue : fmSalesInvoicesLines : 'idiM7': '' : '' : '': false
                | async
            "></span>
              ,&nbsp;

              <!-- IDIM 7 -->
              <span class="text-gray-500" [innerHTML]="
              line.palletName
                | formatvalue : fmSalesInvoicesLines : 'idiM8': '' : '' : '': false
                | async
            ">
              </span>
              ,&nbsp;

              <!-- IDIM 7 -->
              <span class="text-gray-500" [innerHTML]="
              line.idiM9
                | formatvalue : fmSalesInvoicesLines : 'idiM9'
                | async
            ">
              </span>
            </div>

            <codx-vll *ngIf="line.lineType !== '1'" [formModel]="fmSalesInvoicesLines" field="LineType"
              [value]="line.lineType" [showText]="true" [showBgColor]="true"
              class="badge badge-primary align-self-start">
            </codx-vll>
          </div>
        </td>
        <td class="text-end pe-5">
          <div class="d-flex flex-column pt-1 gap-1">
            <div>{{ line.quantity }}</div>
            <div>{{ line.umid }}</div>
          </div>
        </td>
        <td class="text-end pe-5">
          <div class="d-flex flex-column pt-1 gap-1">
            <div>{{ line.salesPrice | currency : "" : "" }}</div>
            <div>&nbsp;</div>
          </div>
        </td>
        <td class="text-end pe-5">
          <div class="d-flex flex-column pt-1 gap-1">
            <div>{{ line.netAmt | currency : "" : "" }}</div>
            <div>&nbsp;</div>
          </div>
        </td>
        <td class="text-end pe-5">
          <div class="d-flex flex-column pt-1 gap-1">
            <div>{{ line.vatAmt | currency : "" : "" }}</div>
            <div *ngIf="
                vats | nameById : 'VATID' : 'TaxRate' : line.vatid as taxRate;
                else taxRate
              ">
              {{ taxRate * 100 }}%
            </div>
            <ng-template #taxRate>-</ng-template>
          </div>
        </td>
      </tr>

      <tr *ngIf="!hasVerticalScrollbar" class="h-100"></tr>
    </tbody>

    <tfoot>
      <tr>
        <th></th>
        <th class="text-end pe-5">
          <codx-label fiedName="lblTotal" [formModel]="fmSalesInvoicesLines" default="Tổng cộng"></codx-label>
        </th>
        <th class="text-end pe-5">
          {{ totalRow.totalQuantity }}
        </th>
        <th></th>
        <th class="text-end pe-5">
          {{ totalRow.totalNetAmt | currency : "" : "" }}
        </th>
        <th class="text-end pe-5">
          {{ totalRow.totalVatAmt | currency : "" : "" }}
        </th>
      </tr>
    </tfoot>
  </table>
</div>