<codx-detail-tmp
  [header]="header"
  [body]="body"
  [hideMF]="false"
  [formModel]="formModel"
  [dataItem]="viewData"
  [footer]="footer"
  (clickMF)="onClickMF($event, viewData)"
>
</codx-detail-tmp>

<ng-template #header>
  <div
    class="d-flex align-items-center ac-cashID mt-n8 position-relative"
    style="z-index: 100; width: fit-content"
  >
    <div
      class="w-25px h-25px rounded-circle bg-primary d-flex flex-center me-2"
    >
      <i class="icon-i-file-earmark-text text-white icon-14"></i>
    </div>
    <span class="fw-bold line-clamp line-clamp-1 mt-1 fs-4 text-uppercase">
      {{ viewData?.voucherNo }}
    </span>

    <div class="d-flex mt-1 ms-5">
      <codx-label
        fiedName="lblVoucherDate"
        [formModel]="formModel"
        default="Ngày chứng từ"
        class="fw-bold label-colon"
      ></codx-label>
      <span
        class="text-gray-600"
        [innerHTML]="
          viewData?.voucherDate
            | formatvalue : formModel : 'voucherDate'
            | async
        "
      ></span>
    </div>
  </div>
</ng-template>

<ng-template #body>
  <div class="d-flex flex-column h-100" *ngIf="viewData">
    <div class="d-flex align-items-center justify-content-between mb-2">
      <span class="fw-bold line-clamp line-clamp-1 fs-4">
        {{ viewData.cashBookName }}
      </span>
      <codx-vll
        [formModel]="formModel"
        field="Status"
        [value]="viewData?.status"
        [showText]="true"
        [showBgColor]="true"
        class="badge badge-light badge-sm border-0 me-3"
      >
      </codx-vll>
    </div>

    <div class="d-flex align-items-center justify-content-between mb-2">
      <div>
        <codx-label
          fiedName="lblCashBookID"
          [formModel]="formModel"
          class="fw-bold label-colon"
          default="Tài khoản chuyển"
        ></codx-label>
        <span>{{ viewData?.cashBookID }}</span>
      </div>

      <div class="badge badge-pill badge-primary me-3">
        <span class="fw-bold fs-6">{{
          viewData.totalAmt | currency : viewData?.currencyID : "code"
        }}</span>
      </div>
    </div>

    <div class="mb-2">
      <codx-label
        fiedName="lblCashBookID2Name"
        [formModel]="formModel"
        class="fw-bold label-colon"
        default="Chuyển đến"
      ></codx-label>
      <span
        class="text-gray-600"
        [innerHTML]="
          viewData?.cashBookID2
            | formatvalue : formModel : 'cashBookID2'
            | async
        "
      ></span>
    </div>

    <div class="mb-2">
      <codx-label
        fiedName="lblCashBookID2"
        [formModel]="formModel"
        class="fw-bold label-colon"
        default="Tài khoản nhận"
      ></codx-label>
      <span
        class="text-gray-600"
        [innerHTML]="
          !viewData?.cashBookID2
            ? (viewData?.cashBookID2
              | formatvalue : formModel : 'cashBookID2'
              | async)
            : viewData?.cashBookID2
        "
      ></span>
    </div>

    <div class="mb-2" [ngClass]="!expanding ? 'd-flex' : ''">
      <span #memo [class]="!expanding ? 'text-truncate' : ''">
        <codx-label
          fiedName="memo"
          [formModel]="formModel"
          class="fw-bold label-colon"
          default="Diễn giải"
        ></codx-label>
        <span
          class="text-gray-600"
          [innerHTML]="
            viewData?.memo | formatvalue : formModel : 'memo' | async
          "
        ></span>
      </span>
      <codx-label
        *ngIf="!expanding"
        fieldName="lblMore"
        [formModel]="formModel"
        default="&nbsp;Xem thêm"
        class="text-primary"
        style="white-space: nowrap"
        [ngClass]="!overflowed ? 'd-none' : ''"
        role="button"
        (click)="expanding = !expanding"
      ></codx-label>
      <codx-label
        *ngIf="expanding"
        fieldName="lblLess"
        [formModel]="formModel"
        default="&nbsp;Thu lại"
        class="text-primary"
        role="button"
        (click)="onClickShowLess()"
      ></codx-label>
    </div>

    <div class="mt-3 flex-grow-1" style="height: 0">
      <ejs-tab heightAdjustMode="Fill">
        <e-tabitems>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex me-2 gap-2">
                <span class="icon-i-file-earmark-spreadsheet icon-18"></span>
                <codx-label
                  class="fw-bold"
                  fiedName="lblAccounting"
                  [formModel]="formModel"
                  default="Hoạch toán"
                ></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <lib-table-accounting
                [lines]="lines"
                [loading]="loading"
              ></lib-table-accounting>
            </ng-template>
          </e-tabitem>
        </e-tabitems>
      </ejs-tab>
    </div>
  </div>
</ng-template>

<ng-template #footer>
  <codx-tabs
    [entityName]="formModel.entityName"
    [formModel]="formModel"
    [objectID]="viewData?.recID"
    [funcID]="formModel.funcID"
    [TabControl]="tabControl"
  ></codx-tabs>
</ng-template>
