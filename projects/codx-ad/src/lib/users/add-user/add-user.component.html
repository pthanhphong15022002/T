<codx-layout-add #form [title]="title" [tabInfo]="tabInfo" [footer]="footer" [formModel]="dialog.formModel"
  [dialog]="dialog" [openMore]="true" [tabContent]="[tabDescription, tabRoles]" (setTitle)="setTitle($event)"
  (buttonClick)="buttonClick($event)"></codx-layout-add>

<ng-template #tabDescription>
  <div class="form-group">
    <div class="form-group row mt-3 pb-5">
      <codx-img #imageUpload class="symbol symbol-120 symbol-circle me-2 image-inpt-wrapper fullImage" [width]="150"
        [funcId]="formModel?.funcID" [objectId]="adUser.userID" [objectType]="'AD_Users'" data-kt-menu-trigger="click"
        data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end" data-kt-menu-flip="bottom"
        [isAllowEdit]="true">
      </codx-img>
    </div>
    <div class="form-group row mt-3">
      <div class="form-group col-6">
        <codx-label fiedName="UserID" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
          default="Mã người dùng">
        </codx-label>
        <codx-input field="userID" type="text" [disabled]="formType == 'edit' ? true : false"
          [crrValue]="adUser.userID">
        </codx-input>
      </div>
      <div class="form-group col-6">
        <codx-label fiedName="EmployeeID" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName">
        </codx-label>
        <codx-input type="combobox" refValue="EmployeeUser" [disabled]="!adUser.employeeID ? false : true"
          field="employeeID" [crrValue]="adUser.employeeID" (valueChange)="valueEmp($event)" [multiple]="false"
          loadFull="true" *ngIf="formType == 'edit'">
        </codx-input>
        <codx-input type="combobox" refValue="EmployeeUser" field="employeeID" [crrValue]="adUser.employeeID"
          (valueChange)="valueEmp($event)" [multiple]="false" loadFull="true" *ngIf="formType == 'add'">
        </codx-input>
      </div>
    </div>

    <div class="form-group mt-3">
      <codx-label fiedName="UserName" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
        default="Tên người dùng">
      </codx-label>
      <codx-input type="text" field="userName" [crrValue]="adUser.userName" (valueChange)="valueChangeU($event)">
      </codx-input>
    </div>
    <div class="form-group row mt-3">
      <codx-label fiedName="UserGroup" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
        default="Nhóm người dùng">
      </codx-label>
      <codx-input type="combobox" field="userGroup" [crrValue]="adUser.userGroup" refValue="UserGroups"
        (valueChange)="valueUG($event)" [multiple]="false" loadFull="true">
      </codx-input>
    </div>
    <div class="form-group row mt-3">
      <codx-label fiedName="BUID" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
        default="Bộ phận">
      </codx-label>
      <codx-input type="combobox" field="buid" [crrValue]="adUser.buid" refValue="BusinessUnits" [service]="'SYS'"
        (valueChange)="valueBU($event)">
      </codx-input>
    </div>
    <div class="form-group row mt-3">
      <div class="form-group col-6">
        <codx-label fiedName="Email" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
          default="Email">
        </codx-label>
        <codx-input field="email" type="text" [crrValue]="adUser.email" (valueChange)="valueChangeM($event)"
          [disabled]="!adUser.employeeID ? false : true" *ngIf="formType == 'edit'">
        </codx-input>
        <codx-input field="email" type="text" [crrValue]="adUser.email" (valueChange)="valueChangeM($event)"
          [disabled]="false" *ngIf="formType == 'add'">
        </codx-input>
      </div>
      <div class="form-group col-6">
        <codx-label fiedName="Mobile" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
          default="Phone">
        </codx-label>
        <codx-input type="text" field="mobile" [crrValue]="adUser.phone" (valueChange)="valueChangeP($event)">
        </codx-input>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #tabRoles>
  <div class="form-group mt-3">
    <div class="d-flex justify-content-end">
      <button type="button" class="btn btn-primary" (click)="openPopup(viewChooseRole)">Chỉnh sửa
        quyền</button>
    </div>

    <!-- List checkbox of UserRoles -->

    <div class="form-group py-5 px-5" *ngIf="countListViewChooseRoleApp > 0">
      <div class="row">
        <div class="col-12">
          <span class="d-flex flex-column align-items-start">
            <span class="fw-bolder">
              <codx-label name="titleUserRoles" formName="UserRoles" default="Ứng dụng được phần quyền ">
              </codx-label>({{countListViewChooseRoleApp}})
            </span>
            <hr>
          </span>
        </div>

        <div class="col-12 " *ngFor="let item of viewChooseRole; let i = index">
          <div class="row" *ngIf="!item.isPortal">
            <div class="col-6 text-start">
              <div class="row">
                <div class="col-2">
                  <img class="w-50px" src="../../../{{item.smallIcon}}" alt="" />
                </div>
                <div class="col-10 space_row">
                  <div class="fw-bold" style="font-weight: bold">
                    {{item.customName}}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6 text-end">
              <div class="text-end">
                <div [style.color]="item.color">
                  {{item.roleName}}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-group py-5 px-5" *ngIf="countListViewChooseRoleService > 0">
      <div class="row">
        <div class="col-12">
          <span class="d-flex flex-column align-items-start">
            <span class="fw-bolder">
              <codx-label name="titleUserRoles" formName="UserRoles" default="Dịch vụ nhân viên được phân quyền">
              </codx-label>({{countListViewChooseRoleService}})
            </span>
            <hr>
          </span>
        </div>

        <div class="col-12 " *ngFor="let item of viewChooseRole; let i = index">
          <div class="row" *ngIf="item.isPortal">
            <div class="col-6 text-start">
              <div class="row">
                <div class="col-2">
                  <img class="w-50px" src="../../../{{item.smallIcon}}" alt="" />
                </div>
                <div class="col-10 space_row">
                  <div class="fw-bold" style="font-weight: bold">
                    {{item.customName}}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6 text-end">
              <div class="text-end">
                <div [style.color]="item.color">
                  {{item.roleName}}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #footer>
  <div class="d-flex justify-content-end">
    <button type="button" class="btn btn-primary" (click)="onSave()">
      <codx-label fiedName="lblSave" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
        default="Lưu"></codx-label>
    </button>
  </div>
</ng-template>