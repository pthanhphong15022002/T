<codx-layout-add #form [title]="title" [tabInfo]="tabInfo" [footer]="footer" [formModel]="dialog.formModel"
  [dialog]="dialog" [openMore]="true" [tabContent]="[tabDescription, tabRoles]">
</codx-layout-add>

<ng-template #tabDescription>
  <div class="mt-3 pb-5">
    <codx-img #imageUpload class="symbol symbol-120 symbol-circle me-2 image-inpt-wrapper fullImage" [width]="60"
      [funcId]="formModel?.funcID" [objectId]="adUser.userID" [objectType]="'AD_Users'" [isAllowEdit]="true">
    </codx-img>
  </div>
  <div class="row mx-0 mt-3">
    <div class="col-6 ps-0">
      <div class="form-group">
        <codx-label fiedName="UserID" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
          default="Mã người dùng">
        </codx-label>
        <codx-input field="userID" type="text" [disabled]="formType == 'edit' ? true : false"
          [crrValue]="adUser.userID">
        </codx-input>
      </div>
    </div>
    <div class="col-6 pe-0">
      <div class="form-group">
        <codx-label fiedName="EmployeeID" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName">
        </codx-label>
        <codx-input type="combobox" refValue="EmployeeUser" [disabled]="!adUser.employeeID ? false : true"
          field="employeeID" [crrValue]="adUser.employeeID" (valueChange)="valueEmp($event)" [multiple]="false"
          loadFull="true" *ngIf="formType == 'edit'">
        </codx-input>
        <codx-input type="combobox" refValue="EmployeeUser" field="employeeID" [crrValue]="adUser.employeeID"
          (valueChange)="valueEmp($event)" [multiple]="false" loadFull="true"
          *ngIf="formType == 'add' || formType == 'copy'">
        </codx-input>
      </div>
    </div>
  </div>
  <div class="form-group">
    <codx-label fiedName="UserName" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
      default="Tên người dùng">
    </codx-label>
    <codx-input type="text" field="userName" [crrValue]="adUser.userName" (valueChange)="valueChangeU($event)">
    </codx-input>
  </div>
  <div class="form-group">
    <codx-label fiedName="UserGroup" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
      default="Nhóm người dùng">
    </codx-label>
    <codx-input type="combobox" field="userGroup" [crrValue]="adUser.userGroup" refValue="UserGroups"
      (valueChange)="valueUG($event)" [multiple]="false" loadFull="true">
    </codx-input>
  </div>
  <div class="form-group">
    <codx-label fiedName="BUID" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
      default="Bộ phận">
    </codx-label>
    <codx-input type="combobox" field="buid" [crrValue]="adUser.buid" refValue="BusinessUnits" [service]="'SYS'"
      (valueChange)="valueBU($event)">
    </codx-input>
  </div>
  <div class="form-group row m-0">
    <div class="form-group col-6 ps-0">
      <codx-label fiedName="Email" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
        default="Email">
      </codx-label>
      <codx-input field="email" type="text" [crrValue]="adUser.email" (valueChange)="valueChangeM($event)"
        [disabled]="!adUser.email ? false : true" *ngIf="formType == 'edit'">
      </codx-input>
      <codx-input field="email" type="text" [crrValue]="adUser.email" (valueChange)="valueChangeM($event)"
        [disabled]="false" *ngIf="formType == 'add' || formType == 'copy'">
      </codx-input>
    </div>
    <div class="form-group col-6 pe-0">
      <codx-label fiedName="Mobile" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
        default="Phone">
      </codx-label>
      <codx-input type="text" field="mobile" [crrValue]="adUser.phone" (valueChange)="valueChangeP($event)">
      </codx-input>
    </div>
  </div>
</ng-template>
<ng-template #tabRoles>
  <div class="form-group mt-3">
    <div class="d-flex justify-content-end">
      <button type="button" class="btn btn-primary" (click)="openPopup(viewChooseRole)">Chỉnh sửa
        quyền</button>
    </div>

    <!-- List checkbox of UserRoles -->

    <div class="" *ngIf="countListViewChooseRoleApp > 0">

      <div class="d-flex align-items-center mb-3">
        <codx-label class="me-1" name="titleUserRoles" formName="UserRoles" default="Ứng dụng được phần quyền ">
        </codx-label>
        <span class="fw-bold">({{countListViewChooseRoleApp}})</span>
      </div>

      <div *ngFor="let item of viewChooseRole; let i = index">
        <div class="d-flex align-items-center justify-content-between mb-4" *ngIf="!item.isPortal">
          <div class="d-flex align-items-center">
            <div class="me-2">
              <img class="w-30px" src="../../../{{item.smallIcon}}" alt="" />
            </div>
            <div class="fw-bold">{{item.customName}}</div>
          </div>
          <div class="text-end">
            <div [style.color]="item.color">
              {{item.roleName}}
            </div>
          </div>
        </div>
      </div>

    </div>

    <div class="form-group" *ngIf="countListViewChooseRoleService > 0">


      <div class="row">
        <div class="col-12">
          <div class="d-flex flex-column align-items-start">
            <span class="fw-bold">
              <codx-label name="titleUserRoles" formName="UserRoles" default="Dịch vụ nhân viên được phân quyền">
              </codx-label>({{countListViewChooseRoleService}})
            </span>
            <hr>
          </div>
        </div>

        <div class="col-12 " *ngFor="let item of viewChooseRole; let i = index">
          <div class="d-flex align-items-center justify-content-between mb-4" *ngIf="item.isPortal">
            <div class="d-flex align-items-center">
              <div class="me-2">
                <img class="w-40px" src="../../../{{item.smallIcon}}" alt="" />
              </div>
              <div class="fw-bold">{{item.customName}}</div>
            </div>
            <div class="text-end">
              <div [style.color]="item.color">
                {{item.roleName}}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #footer>
  <div class="d-flex justify-content-end">
    <button type="button" class="btn btn-primary" (click)="onSave()">
      <codx-label fiedName="lblSave" [formName]="formModel?.formName" [gridViewName]="formModel?.gridViewName"
        default="Lưu"></codx-label>
    </button>
  </div>
</ng-template>

<ng-template #firstComment>
  <div *ngIf="dataComment">
    <div class="card border rounded-4 border">
      <!--begin::Body-->
      <div class="card-body d-flex">
        <!--begin::Wrapper-->
        <div class="d-flex flex-column w-350px me-4">
          <a href="/" class="mb-2">
            <img alt="Logo" class="h-15px " src="assets/themes/wp/default/img/WP.svg">
          </a>
          <h4 class="fw-bolder text-primary">Chào mừng thành viên mới</h4>
          <div class="mb-4">Rất hân hạnh chào đón bạn đến với chúng tôi. Chúng tôi tin rằng với khả năng và nhiệt huyết
            của mình, bạn sẽ là một nhân tố giúp công ty ngày càng phát triển hơn. </div>
          <!--begin::user center-->
          <div class="d-flex align-items-center flex-center  py-2 px-6">
            <div class="symbol symbol-40px symbol-circle me-4">
              <codx-img #image [objectType]="formModel?.entityName" [funcId]="formModel?.funcID"
                [objectId]="dataComment.userID" [objectType]="'AD_Users'"></codx-img>
            </div>
            <div class="d-flex flex-column w-100">
              <div class="text-dark fw-bold fs-5">{{dataComment.userName}}</div>
              <div class="text-gray-400">
                <span *ngIf="dataComment.positionName">{{dataComment.positionName}}</span>
              </div>
            </div>
          </div>
          <!--end::user center-->
        </div>
        <!--begin::Wrapper-->
        <!--begin::Illustration-->
        <img src="/assets/themes/sys/default/img/Welcome.svg" class="position-absolute me-3  end-0 h-175px" alt="">
        <!--end::Illustration-->
      </div>
      <!--end::Body-->
    </div>
  </div>
</ng-template>