<codx-layout-add #form [title]="title" [tabInfo]="tabInfo" [footer]="footer" [formModel]="dialog.formModel"
  [dialog]="dialog" [openMore]="true" [tabContent]="[tabDescription, tabRoles]" (setTitle)="setTitle($event)"
  (buttonClick)="buttonClick($event)"></codx-layout-add>

<ng-template #tabDescription>
  <div class="form-group">
    <div class="form-group row mt-3 pb-5">
      <codx-img #imageUpload class="symbol symbol-120 symbol-circle mr-2 image-inpt-wrapper fullImage" [width]="150"
        funcId="AD006" [objectId]="adUser.userID" [objectName]="adUser.userName" objectType="AD_Users"
        [isAllowEdit]=true data-kt-menu-trigger="click" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end"
        data-kt-menu-flip="bottom" [updateDirect]="false">
      </codx-img>
    </div>
    <div class="form-group row mt-3">
      <div class="form-group col-6">
        <codx-label fiedName="UserID" formName="Users" gridViewName="grvUsers" default="Mã người dùng">
        </codx-label>
        <codx-input field="userID" type="text" [attr.disabled]="!data?.isNew() ? '' : null" [crrValue]="adUser.userID">
        </codx-input>
      </div>
      <div class="form-group col-6">
        <codx-label fiedName="EmployeeID" formName="Users" gridViewName="grvUsers" default="Nhân viên">
        </codx-label>
        <codx-input type="combobox" refValue="EmployeeUser" [disabled]="readOnly" field="employeeID"
          [crrValue]="adUser.employeeID" (valueChange)="valueEmp($event)" [multiple]="false" loadFull="true">
        </codx-input>
      </div>
    </div>

    <div class="form-group mt-3">
      <codx-label name="UserName" formName="Users" gridViewName="grvUsers" default="Tên người dùng">
      </codx-label>
      <codx-input type="text" field="userName" [crrValue]="adUser.userName" (valueChange)="valueChange($event)">
      </codx-input>
    </div>
    <div class="form-group row mt-3">
      <codx-label fiedName="UserGroup" formName="Users" gridViewName="grvUsers" default="Nhóm người dùng">
      </codx-label>
      <codx-input type="combobox" field="userGroup" [crrValue]="adUser.userGroup" refValue="UserGroups"
        (valueChange)="valueUG($event)" [multiple]="false" loadFull="true">
      </codx-input>
    </div>
    <div class="form-group row mt-3">
      <codx-label fiedName="BUID" formName="Users" gridViewName="grvUsers" default="Bộ phận">
      </codx-label>
      <codx-input type="combobox" field="buid" [crrValue]="adUser.buid" refValue="BusinessUnits"
        (valueChange)="valueBU($event)" [multiple]="false" loadFull="true">
      </codx-input>
    </div>
    <div class="form-group row mt-3">
      <div class="form-group col-6">
        <codx-label fiedName="Email" formName="Users" gridViewName="grvUsers" default="Email">
        </codx-label>
        <codx-input field="email" type="text" [crrValue]="adUser.email" (valueChange)="valueChange($event)">
        </codx-input>
      </div>
      <div class="form-group col-6">
        <codx-label fiedName="Mobile" formName="Users" gridViewName="grvUsers" default="Phone">
        </codx-label>
        <codx-input type="text" field="mobile" [crrValue]="adUser.mobile" (valueChange)="valueChange($event)">
        </codx-input>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #tabRoles>
  <div class="form-group mt-3">
    <div class="d-flex justify-content-end">
      <button type="button" class="btn btn-primary" (click)="openPopup(viewChooseRole)">Chỉnh sửa
        quyền</button>
    </div>

    <!-- List checkbox of UserRoles -->

    <div class="form-group py-5 px-5" *ngIf="countListViewChooseRoleApp > 0">
      <div class="row">
        <div class="col-12">
          <span class="d-flex flex-column align-items-start">
            <span class="fw-bolder">
              <codx-label name="titleUserRoles" formName="UserRoles" default="Ứng dụng được phần quyền ">
              </codx-label>({{countListViewChooseRoleApp}})
            </span>
            <hr>
          </span>
        </div>

        <div class="col-12 " *ngFor="let item of viewChooseRole; let i= index">
          <div class="row" *ngIf="!item.isPortal">
            <div class="col-6 text-start">
              <div class="row">
                <div class="col-2">
                  <img class="w-50px" src="../../../{{item.smallIcon}}" alt="" />
                </div>
                <div class="col-10 space_row">
                  <div class="font-weight-bold" style="font-weight: bold">
                    {{item.customName}}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6 text-end">
              <div class="text-end">
                <div [style.color]="item.color">
                  {{item.recRoleName}}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-group py-5 px-5" *ngIf="countListViewChooseRoleService > 0">
      <div class="row">
        <div class="col-12">
          <span class="d-flex flex-column align-items-start">
            <span class="fw-bolder">
              <codx-label name="titleUserRoles" formName="UserRoles" default="Dịch vụ nhân viên được phân quyền">
              </codx-label>({{countListViewChooseRoleService}})
            </span>
            <hr>
          </span>
        </div>

        <div class="col-12 " *ngFor="let item of viewChooseRole; let i= index">
          <div class="row" *ngIf="item.isPortal">
            <div class="col-6 text-start">
              <div class="row">
                <div class="col-2">
                  <img class="w-50px" src="../../../{{item.smallIcon}}" alt="" />
                </div>
                <div class="col-10 space_row">
                  <div class="font-weight-bold" style="font-weight: bold">
                    {{item.customName}}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6 text-end">
              <div class="text-end">
                <div [style.color]="item.color">
                  {{item.recRoleName}}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #footer>
  <div class="d-flex justify-content-lg-start pl-3">
    <span>
      <input #checkShareRight1 type="checkbox" [disabled]="readOnly" id="checkShareRight1">
    </span>
    <label>Ngưng sử dụng</label>
  </div>
  <div class="d-flex justify-content-end">
    <button type="button" class="btn btn-primary" (click)="onSave()">Lưu</button>
  </div>
</ng-template>
