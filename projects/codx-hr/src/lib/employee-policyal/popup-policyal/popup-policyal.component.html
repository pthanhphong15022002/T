<codx-layout-add
  #form
  [title]="headerText"
  [tabInfo]="tabInfo"
  [formModel]="formModel"
  [subHeader]=""
  (setTitle)="setTitle($event)"
  [footer]="footer"
  [dialog]="dialog"
  (tabChange)="changeTab($event)"
  [openMore]="true"
  [tabContent]="[overallInfo, policyInfo, setting, applyObj, subtractObj]"
  [data]="alpolicyObj"
  *ngIf="isAfterRender"
>
</codx-layout-add>

<ng-template #overallInfo>
  <div class="form-group row">
    <div class="col-8">
      <codx-label fiedName="ALObjectID" [formModel]="formModel"></codx-label>
      <codx-input
        field="alObjectID"
        [formModel]="formModel"
        [Group]="formGroup"
      ></codx-input>
    </div>
    <div class="col-4">
      <codx-vll
        *ngIf="alpolicyObj.status"
        [formModel]="formModel"
        [field]="'Status'"
        [value]="alpolicyObj?.status"
        [showText]="true"
        [showIcon]="false"
        [showBgColor]="true"
        ngClass="badge badge-sm badge-light"
      >
      </codx-vll>
    </div>
  </div>

  <div class="form-group row">
    <div class="col-8">
      <codx-label fiedName="PolicyID" [formModel]="formModel"></codx-label>
      <codx-input
        field="policyID"
        [disabled]="autoNumField == 'PolicyID'"
        [formModel]="formModel"
        [Group]="formGroup"
        (valueChange)="onInputPolicyID($event)"
      ></codx-input>
    </div>
    <div class="col-4">
      <codx-label fiedName="Priority" [formModel]="formModel"></codx-label>
      <codx-input
        field="priority"
        [formModel]="formModel"
        [Group]="formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row">
    <codx-label fiedName="PolicyName" [formModel]="formModel"></codx-label>
    <codx-input
      field="policyName"
      [formModel]="formModel"
      [Group]="formGroup"
    ></codx-input>
  </div>

  <div class="form-group row">
    <div class="col-4">
      <codx-label fiedName="ActiveOn" [formModel]="formModel"></codx-label>
      <codx-input
        field="activeOn"
        [formModel]="formModel"
        [Group]="formGroup"
      ></codx-input>
    </div>
    <div class="col-4">
      <codx-label fiedName="ExpiredOn" [formModel]="formModel"></codx-label>
      <codx-input
        field="expiredOn"
        [formModel]="formModel"
        [Group]="formGroup"
      ></codx-input>
    </div>
    <div class="col-4 d-flex flex-column">
      <codx-label fiedName="Stop" [formModel]="formModel"></codx-label>
      <codx-input
        class="mt-3"
        field="stop"
        [formModel]="formModel"
        [Group]="formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row">
    <codx-label fiedName="Note" [formModel]="formModel"></codx-label>
    <codx-input
      field="note"
      [formModel]="formModel"
      [Group]="formGroup"
    ></codx-input>
  </div>

  <div class="fs-5 fw-bold text-primary mt-6 mb-3">
    <codx-label 
        [formModel]="formModel" 
        [name]="'lblTcPhepNam'"
        [default]="'Tiêu chuẩn phép năm'"
    >
    </codx-label>
  </div>

  <div class="form-group row d-flex justify-content-between">
    <div class="col-6 d-flex flex-column">
      <codx-label fiedName="ALStandard" [formModel]="formModel"></codx-label>
      <codx-label
        [name]="'ALStandard'"
        [default]="grvSetup.ALStandard.headerNote"
        [formModel]="formModel"
      ></codx-label>
    </div>
    <div class="col-4">
      <codx-input
        field="alStandard"
        [formModel]="formModel"
        [Group]="formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="fs-5 fw-bold text-primary mt-6 mb-3">
    <codx-label
      name="lblAttachFile"
      [formModel]="formModel"
      [default]="'File đính kèm'"
    >
    </codx-label>
  </div>

  <div class="flex-nowrap">
    <codx-attachment
      #attachment
      [objectType]="formModel?.entityName"
      showMessage="0"
      hideBtnSave="1"
      hideFolder="1"
      hideUploadBtn="1"
      hideDes="1"
      hideImageUpload="0"
      hideImageThumb="0"
      [objectId]="alpolicyObj?.policyID"
      [allowMultiFile]="1"
      [idBrowse]="'add'"
      displayThumb="full"
      [functionID]="funcID"
      (fileAdded)="addFiles($event)">
      [referType]="'source'"
      >
      <!-- [formModel]="formModel"
      [idField]="'RecID'" -->
    <!-- (fileDelete)="handleDelete($event)"
    (fileCount)="getfileCount($event)"
    (fileGet)="getfileCount($event)" -->
    </codx-attachment>
  </div>
</ng-template>

<ng-template #policyInfo>
  <div class="form-group row mt-5">
    <codx-input
      field="memo"
      [formModel]="formModel"
      [Group]="formGroup"
    ></codx-input>
  </div>
</ng-template>

<ng-template #setting> 
    <div class="fs-5 fw-bold text-primary mt-6 mb-3">
      <codx-label
      [formModel]="formModel"
      [name]="'lblThietLapChung'"
      [default]="'Thiết lập chung'"
  >
  </codx-label>
    </div>

    <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="CloseToDay" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'CloseToDay'"
            [default]="grvSetup.CloseToDay.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-3">
          <codx-input
            field="closeToDay"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="onChangeSelectCloseToDay($event)"
          ></codx-input>
        </div>
        <div class="col-3">
            <codx-input
              field="closeToMonth"
              [formModel]="formModel"
              [Group]="formGroup"
            (valueChange)="onChangeSelectCloseToMonth($event)"

            ></codx-input>
          </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="CalculateALBy" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'CalculateALBy'"
            [default]="grvSetup.CalculateALBy.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="calculateALBy"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="RegisterALBy" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'RegisterALBy'"
            [default]="grvSetup.RegisterALBy.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="registerALBy"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="RoundingTransfer" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'RoundingTransfer'"
            [default]="grvSetup.RoundingTransfer.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="roundingTransfer"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="RoundingTotal" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'RoundingTotal'"
            [default]="grvSetup.RoundingTotal.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="roundingTotal"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

    <div class="fs-5 fw-bold text-primary mt-6 mb-3">
      <codx-label
      [formModel]="formModel"
      [name]="'lblQuyDinhPhepNam'"
      [default]="'Quy định tính phép năm'"
  >
  </codx-label>
    </div>

    
    <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="FirstMonthType" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'FirstMonthType'"
            [default]="grvSetup.FirstMonthType.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="firstMonthType"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="onChangeFirstMonthType($event)"
          ></codx-input>
        </div>
      </div>

    <div class="form-group row ms-6" *ngIf="loadGridview1 == true">
      <codx-gridview-v2
      #gridView1
      [columnsGrid]="columnGrid1"
      [formModel]="fmPolicyDetail"
      [formName]="fmPolicyDetail.formName"
      [gridViewName]="fmPolicyDetail.gridViewName"
      [entityName]="fmPolicyDetail.entityName"
      [hideMoreFunc]="true"
      [editSettings]="editSettings"
      [autoFitColumns]="false"
      [dataSource]="dataSourceGridView1"
      rowHeight="35"
      (onAddNew)="onAddNewGrid1($event)"
      [autoAddRow]="true"
      (onEdit)="onEditGrid1($event)"
      (onDelete)="onDeleteGrid1($event)"
      >
        </codx-gridview-v2>
        <div class="d-flex justify-content-end mt-5">
          <button
          class="btn btn-sm btn-light-primary"
          (click)="addRowGrid1()"
        >
    <i class="icon-add icon-16 ms-n1"></i>
        <codx-label
        name="lblAddBtnGrid1"
        default="Thêm"
        [formModel]="formModel"
      >
    </codx-label>
        </button>
        </div>
    </div>

    <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="IsAdvanceNextYear" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'IsAdvanceNextYear'"
            [default]="grvSetup.IsAdvanceNextYear.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-3">
          <codx-input
            field="isAdvanceNextYear"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
        <div class="col-3">
            <codx-input
              field="maxDayAdvance"
              [formModel]="formModel"
              [Group]="formGroup"
            ></codx-input>
          </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="IsRegisterNextYear" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'IsRegisterNextYear'"
            [default]="grvSetup.IsRegisterNextYear.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-3">
          <codx-input
            field="isRegisterNextYear"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
        <div class="col-3">
            <codx-input
              field="maxDayRegister"
              [formModel]="formModel"
              [Group]="formGroup"
            ></codx-input>
          </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="IsTransferNextYear" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'IsTransferNextYear'"
            [default]="grvSetup.IsTransferNextYear.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="isTransferNextYear"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="ValChangeTransferNextYear($event)"
          ></codx-input>
          <button
          class="btn btn-icon ms-3"
          (click)="onClickExpandTransferNextYear()"
        >
          <i class="icon-18"
            [ngClass]="expandTransferNextYear ? 'icon-keyboard_arrow_down':'icon-keyboard_arrow_right'"
          ></i>
        </button>
        </div>
      </div>

      <div class="form-group row" *ngIf="expandTransferNextYear">
        <div class="col-6 d-flex flex-column">
          <codx-label class="ms-6" fiedName="TransferYears" [formModel]="formModel"></codx-label>
          <codx-label
          class="ms-6"
            [name]="'TransferYears'"
            [default]="grvSetup.TransferYears.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
          [disabled]="transferNextYearDisabled"
            field="transferYears"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row" *ngIf="expandTransferNextYear">
        <div class="col-6 d-flex flex-column">
          <codx-label class="ms-6" fiedName="TransferToDay" [formModel]="formModel"></codx-label>
          <codx-label
          class="ms-6"
            [name]="'TransferToDay'"
            [default]="grvSetup.TransferToDay.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-3">
          <codx-input
          [disabled]="transferNextYearDisabled"
            field="transferToDay"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="onChangeSelectTransferDay($event)"
          ></codx-input>
        </div>
        <div class="col-3">
            <codx-input
          [disabled]="transferNextYearDisabled"
              field="transferToMonth"
              [formModel]="formModel"
              [Group]="formGroup"
            (valueChange)="onChangeSelectTransferMonth($event)"
            ></codx-input>
          </div>
      </div>

      <div class="form-group row" *ngIf="expandTransferNextYear">
        <div class="col-6 d-flex flex-column">
          <codx-label class="ms-6" fiedName="MaxDayTransfer" [formModel]="formModel"></codx-label>
          <codx-label
          class="ms-6"
            [name]="'MaxDayTransfer'"
            [default]="grvSetup.MaxDayTransfer.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
          [disabled]="transferNextYearDisabled"
            field="maxDayTransfer"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row" *ngIf="expandTransferNextYear">
        <div class="col-6 d-flex flex-column">
          <codx-label class="ms-6" fiedName="MaxALStandard" [formModel]="formModel"></codx-label>
          <codx-label
          class="ms-6"
            [name]="'MaxALStandard'"
            [default]="grvSetup.MaxALStandard.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
          [disabled]="transferNextYearDisabled"
            field="maxALStandard"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

    <div class="fs-5 fw-bold text-primary mt-6 mb-3">
      <codx-label
      [formModel]="formModel"
      [name]="'lblQuyDinhTC'"
      [default]="'Quy định tăng phép tiêu chuẩn theo thâm niên'"
  >
  </codx-label>
    </div>

    <div class="form-group row ms-6" *ngIf="alpolicyObj.seniorityType == '1' && loadGridview2 == true">
      <codx-gridview-v2
      #gridView2
      [columnsGrid]="columnGrid2"
      [formModel]="fmPolicyDetail"
      [formName]="fmPolicyDetail.formName"
      [gridViewName]="fmPolicyDetail.gridViewName"
      [entityName]="fmPolicyDetail.entityName"
      [hideMoreFunc]="true"
      [autoFitColumns]="false"
      [editSettings]="editSettings"
      [dataSource]="dataSourceGridView2"
      rowHeight="35"
      (onAddNew)="onAddNewGrid2($event)"
      [autoAddRow]="true"
      (onEdit)="onEditGrid2($event)"
      (onDelete)="onDeleteGrid2($event)"
      >
        </codx-gridview-v2>
        <div class="d-flex justify-content-end mt-5">
          <button
          class="btn btn-sm btn-light-primary"
          (click)="addRowGrid2()"
        >
    <i class="icon-add icon-16 ms-n1"></i>
        <codx-label
        name="lblAddBtnGrid2"
        default="Thêm"
        [formModel]="formModel"
      >
    </codx-label>
        </button>
        </div>
    </div>

    <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="IncreaseSeniorityType" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'IncreaseSeniorityType'"
            [default]="grvSetup.IncreaseSeniorityType.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="increaseSeniorityType"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="IsIncreaseSeniorityOnMonth" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'IsIncreaseSeniorityOnMonth'"
            [default]="grvSetup.IsIncreaseSeniorityOnMonth.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="isIncreaseSeniorityOnMonth"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <!-- <div class="fs-5 fw-bold text-primary mt-6 mb-3">
        <codx-label
        [formModel]="formModel"
        [name]="'lblTinhTungThang'"
        [default]="'Phép tính theo từng tháng'"
    >
    </codx-label>
      </div> -->

      <div class="form-group row">
        <div class="col-6">
          <div class="fs-5 fw-bold text-primary mt-6 mb-3">
            <codx-label
            [formModel]="formModel"
            [name]="'lblTinhTungThang'"
            [default]="'Phép tính theo từng tháng'"
        >
        </codx-label>
          </div>
        </div>
        <div class="col-6">
            <codx-input
                field="isMonth"
                [formModel]="formModel"
                [Group]="formGroup"
                (valueChange)="ValueChangeIsMonth($event)"
            ></codx-input>
            <button
            class="btn btn-icon ms-3"
            (click)="onClickExpandIsMonth()"
          >
            <i class="icon-18"
              [ngClass]="expandIsMonth ? 'icon-keyboard_arrow_down':'icon-keyboard_arrow_right'"
            ></i>
          </button>
        </div>
    </div>

      <div class="form-group row" *ngIf="expandIsMonth">
        <div class="col-6 d-flex flex-column">
          <codx-label class="ms-6" fiedName="IsAdvanceMonth" [formModel]="formModel"></codx-label>
          <codx-label
          class="ms-6"
            [name]="'IsAdvanceMonth'"
            [default]="grvSetup.IsAdvanceMonth.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-3">
          <codx-input
          [disabled]="isMonthDisabled"
            field="isAdvanceMonth"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
        <div class="col-3">
            <codx-input
            [disabled]="isMonthDisabled"
              field="maxDayAdvanceMonth"
              [formModel]="formModel"
              [Group]="formGroup"
            ></codx-input>
          </div>
      </div>

      <div class="form-group row" *ngIf="expandIsMonth">
        <div class="col-6 d-flex flex-column">
          <codx-label class="ms-6" fiedName="AllocateSeniorityType" [formModel]="formModel"></codx-label>
          <codx-label
          class="ms-6"
            [name]="'AllocateSeniorityType'"
            [default]="grvSetup.AllocateSeniorityType.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-6">
          <codx-input
            field="allocateSeniorityType"
            [formModel]="formModel"
            [disabled]="isMonthDisabled"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>
</ng-template>

<ng-template #applyObj>
  <div class="form-group row">
    <div class="col-6 d-flex flex-column">
        <codx-label
            fiedName="HasIncludeObjects"
            [formModel]="formModel"
        ></codx-label>
        <codx-label
        [name]="'HasIncludeObjects'"
        [default]="grvSetup.HasIncludeObjects.headerNote"
        [formModel]="formModel"
></codx-label>
    </div>
    <div class="col-6 d-flex flex-row">
        <codx-input
            class="mt-2"
            field="hasIncludeObjects"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="ValChangeHasInclueObj($event)"
        ></codx-input>
        <!-- <codx-input
        class="mt-2"
        field="includeObjects"
        [formModel]="formModel"
        [Group]="formGroup"
        (valueChange)="ValChangeSelectObj($event)"
    ></codx-input> -->
        <button
        class="btn btn-icon ms-3"
        (click)="onClickOpenSelectIncludeObj()"
      >
        <i class="icon-edit-one icon-18" 
        [ngClass]="alpolicyObj.hasIncludeObjects? 'text-dark':'text-gray-400'"
        ></i>
      </button>
    </div>
</div>
<span *ngIf="alpolicyObj.hasIncludeObjects && lstSelectedObj.length > 0">
    <span *ngFor="let obj of lstSelectedObj">
      <!-- <span
      class="badge badge-success border-0 ms-2"
      [innerHTML]="obj
          | formatvalue : benefitFormModel : 'benefitID'
          | async"
    ></span> -->
        <codx-vll
        [showText]="true"
        [showBgColor]="true"
        name="HRObject"
        [value]="obj"
        class="badge badge-success border-0 ms-2"
      >
      </codx-vll>
      <!-- <button
      class="btn btn-icon ms-3"
      (click)="onClickOpenSelectIncludeObj()"
    >
      <i class="icon-edit-one icon-18" 
      [ngClass]="alpolicyObj.hasIncludeObjects? 'text-dark':'text-gray-400'"
      ></i>
    </button> -->
    </span>
</span>
<div class="form-group row w-100 mt-8" *ngIf="lstPolicyBeneficiariesApply.length > 0">

  <div class="fs-5 fw-bold text-primary mt-6 mb-3" *ngIf="alpolicyObj.hasExcludeObjects">
    <codx-label
    [formModel]="formModel"
    [name]="'lblDetailApplyObj'"
    [default]="'Chi tiết Đối tượng áp dụng'"
></codx-label>
  </div>
  <!-- <div class="col-6 d-flex flex-row" *ngIf="lstPolicyBeneficiariesApply.length > 1">
      <button
      class="btn btn-icon ms-3"
      >
      <i class="icon-arrow_drop_down icon-32" 
      [ngClass]="alpolicyObj.hasIncludeObjects? 'text-primary':'text-gray-400'"
      ></i>
    </button>
    <button
    class="btn btn-icon ms-3"
    >
    <i class="icon-arrow_drop_up icon-32" 
    [ngClass]="alpolicyObj.hasIncludeObjects? 'text-primary':'text-gray-400'"
    ></i>
  </button>
  </div> -->
</div>

<div *ngIf="alpolicyObj.hasIncludeObjects">
  <div *ngFor="let obj of lstPolicyBeneficiariesApply; let last = last">
    <div class="w-auto btn-hover">
      <div class="d-flex justify-content-end" *ngIf="lstPolicyBeneficiariesApply.length > 1">
  
        <button
        (click)="onClickMoveObjDown(obj)"
        *ngIf="obj.priority > 0 && obj.priority < lstPolicyBeneficiariesApply.length"
        class="btn btn-icon ms-3"
        >
        <i class="icon-arrow_drop_down icon-32" 
        [ngClass]="alpolicyObj.hasIncludeObjects? 'text-primary':'text-gray-400'"
        ></i>
      </button>
      <button
      (click)="onClickMoveObjUp(obj)"
      class="btn btn-icon ms-3"
      *ngIf="obj.priority < lstPolicyBeneficiariesApply.length + 1 && obj.priority > 1"
      >
      <i class="icon-arrow_drop_up icon-32" 
      [ngClass]="alpolicyObj.hasIncludeObjects? 'text-primary':'text-gray-400'"
      ></i>
    </button>
  
    </div>
    </div>
    <div class="border content-hover">
    <div class="d-flex mb-3 fw-bold align-items-center justify-content-between border-bottom">
    <div class="text-primary ms-3">{{obj.priority}}</div>
    <div class="text-dark me-3 btn btn-icon" (click)="onClickDeleteObject(obj)">x</div>
  </div>
    <div *ngFor="let detail of lstSelectedObj">
      <div class="d-flex justify-content-between">
        <codx-vll
          [showText]="true"
          [showBgColor]="false"
          name="HRObject"
          [value]="detail"
          class="ms-3"
        >
        </codx-vll>
              <button
        class="btn btn-icon ms-3"
        (click)="onClickOpenSelectApplyObjDetail(detail, obj)"
      >
        <i class="icon-edit-one icon-18 me-3" 
        [ngClass]="alpolicyObj.hasIncludeObjects? 'text-dark':'text-gray-400'"
        ></i>
      </button>
      </div>
      <div class="mb-3" *ngIf="detail == '1' && !obj.orgUnitID">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.orgUnitID && detail == '1'">
        <span *ngFor="let org of lstOrgUnitID">
          <span *ngIf="org.rec == obj.recID"
          class="badge badge-success border-0 ms-2"
          [innerHTML]="org.id
              | formatvalue : fmPolicyBeneficiaries : 'OrgUnitID'
              | async"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="detail == '2' && !obj.jobLevel">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.jobLevel && detail == '2'">
        <span *ngFor="let joblevel of lstJobLevel">
          <span *ngIf="joblevel.rec == obj.recID"
          class="badge badge-success border-0 ms-2"
          [innerHTML]="joblevel.id
              | formatvalue : fmPolicyBeneficiaries : 'JobLevel'
              | async"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="detail == '3' && !obj.positionID">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.positionID && detail == '3'">
        <span *ngFor="let position of lstPositionID">
          <span *ngIf="position.rec == obj.recID"
          class="badge badge-success border-0 ms-2"
          [innerHTML]="position.id
              | formatvalue : fmPolicyBeneficiaries : 'PositionID'
              | async"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="detail == '4' && !obj.employeeTypeID">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.employeeTypeID && detail == '4'">
        <span *ngFor="let empType of lstEmployeeTypeID">
          <span *ngIf="empType.rec == obj.recID"
          class="badge badge-success border-0 ms-2"
          [innerHTML]="empType.id
              | formatvalue : fmPolicyBeneficiaries : 'EmployeeTypeID'
              | async"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="detail == '5' && !obj.labourType">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.labourType && detail == '5'">
        <span *ngFor="let labourType of lstLabourType">
          <span *ngIf="labourType.rec == obj.recID">
          <codx-vll
          [showText]="true"
          [showBgColor]="false"
          name="HR022"
          [value]="labourType.id"
          ngClass="badge badge-success border-0 ms-2"
        >
        </codx-vll>
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="detail == '6' && !obj.contractTypeID">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.contractTypeID && detail == '6'">
        <span *ngFor="let contractType of lstContractTypeID">
          <span *ngIf="contractType.rec == obj.recID"
          class="badge badge-success border-0 ms-2"
          [innerHTML]="contractType.id
              | formatvalue : fmPolicyBeneficiaries : 'ContractTypeID'
              | async"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="detail == '7' && !obj.employeeID">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.employeeID && detail == '7'">
        <span *ngFor="let emp of lstEmployeeID">
          <!-- <span *ngIf="emp.rec == obj.recID"
          class="badge badge-success border-0 ms-2"
          [innerHTML]="emp.id
              | formatvalue : fmPolicyBeneficiaries : 'EmployeeID'
              | async"
          >
          </span> -->
          <div *ngIf="emp.rec == obj.recID" class="ms-2 d-flex align-items-centerp py-1 h-50px">
              <codx-img [objectId]="emp?.id" [objectType]="'HR_Employees'" [cssClass]="'me-3'"
                    [objectName]="emp.info?.employeeName" [width]="30">
              </codx-img>
                <div class="d-flex flex-column w-350px">
                    <span #employeeName class="fs-6 line-clamp line-clamp-1">
                        {{emp.info?.employeeName}}</span>
                    <span #positionName class="text-gray-600 line-clamp line-lamp-1">
                        {{emp.positionName}}
                    </span>
                      <!-- <ng-template #positionTooltip>
                        {{emp.positionName}}
                    </ng-template>
                      <ng-template #employeeNameTooltip>
                        {{emp.positionName}}
                </ng-template> -->
            </div>
          </div>
        </span>
      </div>
      <div class="mb-3" *ngIf="detail == '8' && !obj.employeeStatus">
        <span>
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="'Tất cả'"
          >
          </span>
        </span>
      </div>
      <div class="mb-3" *ngIf="obj.employeeStatus && detail == '8'">
        <span *ngFor="let empStatus of lstEmpStatus">
          <span *ngIf="empStatus.rec == obj.recID">
          <codx-vll
          [showText]="true"
          [showBgColor]="false"
          name="HR003"
          [value]="empStatus.id"
          ngClass="badge badge-success border-0 ms-2"
        >
        </codx-vll>
          </span>
        </span>
      </div>
    </div>
  </div>
  
    <div class="fs-6 fw-bold text-primary mt-6 mb-3" *ngIf="!last">
      <codx-label
      default="Hoặc"
      name="lblOr"
      [formModel]="formModel"
    ></codx-label>
    </div>
  </div>
</div>
<codx-combobox-popup
*ngIf="!isHidden"
[comboboxName]="currentCbxName"
[multiple]="true"
[width]="600"
[height]="500"
[value]="currentCbxValue"
(clickSave)="onClickHideComboboxPopup($event)"
>
</codx-combobox-popup>

<div class="d-flex justify-content-end mt-3" *ngIf="alpolicyObj.hasIncludeObjects" >
  <button
    type="button"
    class="btn btn-sm btn-light-primary"
    (click)="addApplyObj()"
  >
    <i class="icon-add icon-16 ms-n1"></i>
    <codx-label
      name="lblAddNew"
      default="Thêm mới"
      [formModel]="formModel"
    ></codx-label>
  </button>
</div>
</ng-template>

<ng-template #subtractObj> 
  <div class="form-group row">
    <div class="col-6 d-flex flex-column">
        <codx-label
            fiedName="HasExcludeObjects"
            [formModel]="formModel"
        ></codx-label>
        <codx-label
        [name]="'HasExcludeObjects'"
        [default]="grvSetup.HasExcludeObjects.headerNote"
        [formModel]="formModel"
></codx-label>
    </div>
    <div class="col-6 d-flex flex-row">
        <codx-input
            class="mt-2"
            field="hasExcludeObjects"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="ValChangeHasExcludeObj($event)"
        ></codx-input>
        <!-- <codx-input
        class="mt-2"
        field="includeObjects"
        [formModel]="formModel"
        [Group]="formGroup"
        (valueChange)="ValChangeSelectObj($event)"
    ></codx-input> -->
        <button
        class="btn btn-icon ms-3"
        (click)="onClickOpenSelectExcludeObj()"
      >
        <i class="icon-edit-one icon-18" 
        [ngClass]="alpolicyObj.hasExcludeObjects? 'text-dark':'text-gray-400'"
        ></i>
      </button>
    </div>
</div>
<span *ngIf="alpolicyObj.hasExcludeObjects && lstSelectedExcludeObj.length > 0">
    <span *ngFor="let obj of lstSelectedExcludeObj">
      <!-- <span
      class="badge badge-success border-0 ms-2"
      [innerHTML]="obj
          | formatvalue : benefitFormModel : 'benefitID'
          | async"
    ></span> -->
        <codx-vll
        [showText]="true"
        [showBgColor]="true"
        name="HRObject"
        [value]="obj"
        class="badge badge-success border-0 ms-2"
      >
      </codx-vll>
      <!-- <button
      class="btn btn-icon ms-3"
      (click)="onClickOpenSelectIncludeObj()"
    >
      <i class="icon-edit-one icon-18" 
      [ngClass]="alpolicyObj.hasIncludeObjects? 'text-dark':'text-gray-400'"
      ></i>
    </button> -->
    </span>
</span>
<div class="form-group row w-100 mt-8" *ngIf="lstPolicyBeneficiariesExclude.length > 0">

  <div class="fs-5 fw-bold text-primary mt-6 mb-3" *ngIf="alpolicyObj.hasExcludeObjects">
    <codx-label
    [formModel]="formModel"
    [name]="'lblDetailApplyObj'"
    [default]="'Chi tiết Đối tượng loại trừ'"
></codx-label>
  </div>
  <!-- <div class="col-6 d-flex flex-row" *ngIf="lstPolicyBeneficiariesExclude.length > 1">
      <button
      class="btn btn-icon ms-3"
      >
      <i class="icon-arrow_drop_down icon-32" 
      [ngClass]="alpolicyObj.hasExcludeObjects? 'text-primary':'text-gray-400'"
      ></i>
    </button>
    <button
    class="btn btn-icon ms-3"
    >
    <i class="icon-arrow_drop_up icon-32" 
    [ngClass]="alpolicyObj.hasExcludeObjects? 'text-primary':'text-gray-400'"
    ></i>
  </button>
  </div> -->
</div>
<div *ngIf="alpolicyObj.hasExcludeObjects">

<div *ngFor="let obj of lstPolicyBeneficiariesExclude; let last = last">
  <div class="w-auto btn-hover">
    <div class="d-flex justify-content-end" *ngIf="lstPolicyBeneficiariesExclude.length > 1">
      <button
      (click)="onClickMoveObjDown(obj)"
      *ngIf="obj.priority > 0 && obj.priority < lstPolicyBeneficiariesExclude.length"
      class="btn btn-icon ms-3"
      >
      <!-- (click)="onClickOpenCbxSelectIncludeObj()" -->
      <i class="icon-arrow_drop_down icon-32" 
      [ngClass]="alpolicyObj.hasExcludeObjects? 'text-primary':'text-gray-400'"
      ></i>
    </button>
    <button
    (click)="onClickMoveObjUp(obj)"
    class="btn btn-icon ms-3"
    *ngIf="obj.priority < lstPolicyBeneficiariesExclude.length + 1 && obj.priority > 1"
    >
    <!-- (click)="onClickOpenCbxSelectIncludeObj()" -->
    <i class="icon-arrow_drop_up icon-32" 
    [ngClass]="alpolicyObj.hasExcludeObjects? 'text-primary':'text-gray-400'"
    ></i>
  </button>
  </div>
  </div>
  <div class="border content-hover">
    <div class="d-flex mb-3 align-items-center justify-content-between border-bottom">
  <div class="text-primary ms-3">{{obj.priority}}</div>
  <div class="fw-bold btn btn-icon me-3" (click)="onClickDeleteObject(obj)">x</div>
</div>

  <div *ngFor="let detail of lstSelectedExcludeObj">
    <div class="d-flex justify-content-between">
      <codx-vll
        [showText]="true"
        [showBgColor]="false"
        name="HRObject"
        [value]="detail"
        class="ms-3"
      >
      </codx-vll>
            <button
      class="btn btn-icon ms-3"
      (click)="onClickOpenSelectExcludeObjDetail(detail, obj)"
    >
      <i class="icon-edit-one icon-18 me-3" 
      [ngClass]="alpolicyObj.hasExcludeObjects? 'text-dark':'text-gray-400'"
      ></i>
    </button>
    </div>
    <div class="mb-3" *ngIf="detail == '1' && !obj.orgUnitID">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.orgUnitID && detail == '1'">
      <span *ngFor="let org of lstOrgUnitID">
        <span *ngIf="org.rec == obj.recID"
        class="badge badge-success border-0 ms-2"
        [innerHTML]="org.id
            | formatvalue : fmPolicyBeneficiaries : 'OrgUnitID'
            | async"
        >
        </span>
      </span>
    </div>
    <div class="mb-3" *ngIf="detail == '2' && !obj.jobLevel">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.jobLevel && detail == '2'">
      <span *ngFor="let joblevel of lstJobLevel">
        <span *ngIf="joblevel.rec == obj.recID"
        class="badge badge-success border-0 ms-2"
        [innerHTML]="joblevel.id
            | formatvalue : fmPolicyBeneficiaries : 'JobLevel'
            | async"
        >
        </span>
      </span>
    </div>
    <div class="mb-3" *ngIf="detail == '3' && !obj.positionID">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.positionID && detail == '3'">
      <span *ngFor="let position of lstPositionID">
        <span *ngIf="position.rec == obj.recID"
        class="badge badge-success border-0 ms-2"
        [innerHTML]="position.id
            | formatvalue : fmPolicyBeneficiaries : 'PositionID'
            | async"
        >
        </span>
      </span>
    </div>
    <div class="mb-3" *ngIf="detail == '4' && !obj.employeeTypeID">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.employeeTypeID && detail == '4'">
      <span *ngFor="let empType of lstEmployeeTypeID">
        <span *ngIf="empType.rec == obj.recID"
        class="badge badge-success border-0 ms-2"
        [innerHTML]="empType.id
            | formatvalue : fmPolicyBeneficiaries : 'EmployeeTypeID'
            | async"
        >
        </span>
      </span>
    </div>
    <div class="mb-3" *ngIf="detail == '5' && !obj.labourType">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.labourType && detail == '5'">
      <span *ngFor="let labourType of lstLabourType">
        <span *ngIf="labourType.rec == obj.recID">
        <codx-vll
        [showText]="true"
        [showBgColor]="false"
        name="HR022"
        [value]="labourType.id"
        ngClass="badge badge-success border-0 ms-2"
      >
      </codx-vll>
        </span>
      </span>
    </div>
    <div class="mb-3" *ngIf="detail == '6' && !obj.contractTypeID">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.contractTypeID && detail == '6'">
      <span *ngFor="let contractType of lstContractTypeID">
        <span *ngIf="contractType.rec == obj.recID"
        class="badge badge-success border-0 ms-2"
        [innerHTML]="contractType.id
            | formatvalue : fmPolicyBeneficiaries : 'ContractTypeID'
            | async"
        >
        </span>
      </span>
    </div>
    <div class="mb-3" *ngIf="detail == '7' && !obj.employeeID">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.employeeID && detail == '7'">
      <span *ngFor="let emp of lstEmployeeID">
        <!-- <span *ngIf="emp.rec == obj.recID"
        class="badge badge-success border-0 ms-2"
        [innerHTML]="emp.id
            | formatvalue : fmPolicyBeneficiaries : 'EmployeeID'
            | async"
        >
        </span> -->
        <div *ngIf="emp.rec == obj.recID" class="ms-2 d-flex align-items-centerp py-1 h-50px">
          <codx-img [objectId]="emp?.id" [objectType]="'HR_Employees'" [cssClass]="'me-3'"
                [objectName]="emp.info?.employeeName" [width]="30">
          </codx-img>
            <div class="d-flex flex-column w-350px">
                <span #employeeName class="fs-6 line-clamp line-clamp-1">
                    {{emp.info?.employeeName}}</span>
                <span #positionName class="text-gray-600 line-clamp line-lamp-1">
                    {{emp.positionName}}
                </span>
                  <!-- <ng-template #positionTooltip>
                    {{emp.positionName}}
                </ng-template>
                  <ng-template #employeeNameTooltip>
                    {{emp.positionName}}
            </ng-template> -->
        </div>
      </div>
      </span>
    </div>
    <div class="mb-3" *ngIf="detail == '8' && !obj.employeeStatus">
      <span>
        <span
        class="badge badge-success border-0 ms-2"
        [innerHTML]="'Tất cả'"
        >
        </span>
      </span>
    </div>
    <div class="mb-3"  *ngIf="obj.employeeStatus && detail == '8'">
      <span *ngFor="let empStatus of lstEmpStatus">
        <span *ngIf="empStatus.rec == obj.recID">
        <codx-vll
        [showText]="true"
        [showBgColor]="false"
        name="HR003"
        [value]="empStatus.id"
        ngClass="badge badge-success border-0 ms-2"
      >
      </codx-vll>
        </span>
      </span>
    </div>
  </div>
</div>
  <div class="fs-6 fw-bold text-primary mt-6 mb-3" *ngIf="!last">
    <codx-label
    default="Hoặc"
    name="lblOr"
    [formModel]="formModel"
  ></codx-label>
  </div>
</div>
<!-- <codx-combobox-popup
*ngIf="!isHidden"
[comboboxName]="currentCbxName"
[multiple]="true"
[width]="600"
[height]="500"
[value]="currentCbxValue"
(clickSave)="onClickHideComboboxPopup($event)"
>
</codx-combobox-popup> -->
</div>

<div class="d-flex justify-content-end mt-3" *ngIf="alpolicyObj.hasExcludeObjects">
  <button
    type="button"
    class="btn btn-sm btn-light-primary"
    (click)="addExcludeObj()"
  >
    <i class="icon-add icon-16 ms-n1"></i>
    <codx-label
      name="lblAddNew"
      default="Thêm mới"
      [formModel]="formModel"
    ></codx-label>
  </button>
</div>

    <!-- <codx-combobox-popup
    *ngIf="!isHidden && alpolicyObj.hasIncludeObjects"
    [comboboxName]="'HRObject'"
    [multiple]="true"
    [width]="600"
    [height]="500"
    [value]="alpolicyObj.includeObjects"
    (clickSave)="onClickHideComboboxPopup($event)"
    >
    </codx-combobox-popup> -->


</ng-template>

<ng-template #footer>
  <div class="d-flex justify-content-between">
    <button
    class="btn btn-sm btn-outline btn-outline-primary btn-active-light-primary d-flex flex-row"
    (click)="openFormUploadFile()"
  >
    <codx-label
      name="lblAddFile"
      default="Đính kèm file"
      [formModel]="formModel"
    ></codx-label>
  </button>

    <button class="btn btn-primary" (click)="onSaveForm()">
      <i class="icon-save"></i>
      <codx-label
        default="Lưu"
        name="lblSave"
        [formModel]="formModel"
      ></codx-label>
    </button>
  </div>
</ng-template>


<ng-template #headTmpGrid1Col1>
  <codx-label
    [formModel]="formModel"
    [name]="'lblGridCol1'"
    default="Từ (>=)"
    class="fw-bold fs-6 text-gray-800"
  >
  </codx-label>
</ng-template>

<ng-template #headTmpGrid1Col2>
  <codx-label
    [formModel]="formModel"
    [name]="'lblGridCol2'"
    default="Số ngày phép"
    class="fw-bold fs-6 text-gray-800"
  >
  </codx-label>
</ng-template>

<ng-template #tmpGrid1Col1 let-data>
  <div class="d-flex align-items-center mb-2">
    {{data.fromValue}}
  </div>
</ng-template>

<ng-template #tmpGrid1Col2 let-data>
  <div class="d-flex align-items-center mb-2 has-action-menu">
    {{data.days}}
    <codx-mfunc
    [dataItem]="data"
    [formModel]="formModel"
    (clickMF)="clickMF($event, data, 1)"
    (changeDataMF)="changeDataMF($event)"
    type="hover"
  ></codx-mfunc>
  </div>
</ng-template>


<ng-template #headTmpGrid2Col1>
  <codx-label
    [formModel]="formModel"
    [name]="'lblGridCol1'"
    default="Số tháng làm việc từ (>=)"
    class="fw-bold fs-6 text-gray-800"
  >
  </codx-label>
</ng-template>

<ng-template #headTmpGrid2Col2>
  <codx-label
    [formModel]="formModel"
    [name]="'lblGridCol2'"
    default="Số ngày phép được tăng thêm"
    class="fw-bold fs-6 text-gray-800"
  >
  </codx-label>
</ng-template>

<ng-template #tmpGrid2Col1 let-data>
  <div class="d-flex align-items-center mb-2">
    {{data.fromValue}}
  </div>
</ng-template>

<ng-template #tmpGrid2Col2 let-data>
  <div class="d-flex align-items-center mb-2 has-action-menu">
    {{data.days}}
    <codx-mfunc
    [dataItem]="data"
    [formModel]="formModel"
    (clickMF)="clickMF($event, data, 2)"
    (changeDataMF)="changeDataMF($event)"
    type="hover"
  ></codx-mfunc>
  </div>
</ng-template>
