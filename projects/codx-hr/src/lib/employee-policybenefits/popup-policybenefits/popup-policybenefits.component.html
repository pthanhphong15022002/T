<codx-layout-add
  #form
  [title]="headerText"
  [tabInfo]="tabInfo"
  [formModel]="formModel"
  [subHeader]=""
  (setTitle)="setTitle($event)"
  [footer]="footer"
  [dialog]="dialog"
  (tabChange)="changeTab($event)"
  [openMore]="true"
  [tabContent]="[overallInfo, policyInfo, setting, applyObj, subtractObj]"
  [data]="benefitPolicyObj"
  *ngIf="isAfterRender"
>
</codx-layout-add>

<ng-template #overallInfo>
    <div class="fs-5 fw-bold text-primary mt-6 mb-3">
        <codx-label 
            [formModel]="formModel" 
            [name]="'lblOverallInfo'"
            [default]="'Thông tin chung'"
        >
        </codx-label>
      </div>

    <div class="form-group row">
        <div class="col-8">
          <codx-label fiedName="BenefitID" [formModel]="formModel"></codx-label>
          <codx-input
            field="benefitID"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
        <div class="col-4">
          <codx-vll
            *ngIf="benefitPolicyObj.status"
            [formModel]="formModel"
            [field]="'Status'"
            [value]="benefitPolicyObj?.status"
            [showText]="true"
            [showIcon]="false"
            [showBgColor]="true"
            ngClass="badge badge-sm badge-light"
          >
          </codx-vll>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-8">
          <codx-label fiedName="PolicyID" [formModel]="formModel"></codx-label>
          <codx-input
            field="policyID"
            [disabled]="autoNumField == 'PolicyID'"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="onInputPolicyID($event)"
          ></codx-input>
        </div>
        <div class="col-4">
          <codx-label fiedName="Priority" [formModel]="formModel"></codx-label>
          <codx-input
            field="priority"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row">
        <codx-label fiedName="PolicyName" [formModel]="formModel"></codx-label>
        <codx-input
          field="policyName"
          [formModel]="formModel"
          [Group]="formGroup"
        ></codx-input>
      </div>

      <div class="form-group row">
        <div class="col-4">
          <codx-label fiedName="ActiveOn" [formModel]="formModel"></codx-label>
          <codx-input
            field="activeOn"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
        <div class="col-4">
          <codx-label fiedName="ExpiredOn" [formModel]="formModel"></codx-label>
          <codx-input
            field="expiredOn"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
        <div class="col-4 d-flex flex-column">
          <codx-label fiedName="Stop" [formModel]="formModel"></codx-label>
          <codx-input
            class="mt-3"
            field="stop"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row">
        <codx-label fiedName="Note" [formModel]="formModel"></codx-label>
        <codx-input
          field="note"
          [formModel]="formModel"
          [Group]="formGroup"
        ></codx-input>
      </div>

      <div class="fs-5 fw-bold text-primary mt-6 mb-3">
        <codx-label 
            [formModel]="formModel" 
            [name]="'lblAmount'"
            [default]="'Mức hưởng'"
        >
        </codx-label>
      </div>

      <div class="form-group row d-flex justify-content-between">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="Interval" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'Interval'"
            [default]="grvSetup.Interval.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-4">
          <codx-input
            field="interval"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row d-flex justify-content-between">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="FixedAmt" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'FixedAmt'"
            [default]="grvSetup.FixedAmt.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-4">
          <codx-input
            field="fixedAmt"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row d-flex justify-content-between">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="Percentage" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'Percentage'"
            [default]="grvSetup.Percentage.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-4">
          <codx-input
            field="percentage"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row d-flex justify-content-between">
        <div class="col-6 d-flex flex-column">
          <codx-label fiedName="PercentageOn" [formModel]="formModel"></codx-label>
          <codx-label
            [name]="'PercentageOn'"
            [default]="grvSetup.PercentageOn.headerNote"
            [formModel]="formModel"
          ></codx-label>
        </div>
        <div class="col-4">
          <codx-input
            field="percentageOn"
            [formModel]="formModel"
            [Group]="formGroup"
          ></codx-input>
        </div>
      </div>

      <div class="form-group row">
        <div class="col-6 d-flex flex-column">
            <codx-label
                fiedName="HasIncludeBenefits"
                [formModel]="formModel"
            ></codx-label>
            <codx-label
            [name]="'HasIncludeBenefits'"
            [default]="grvSetup.HasIncludeBenefits.headerNote"
            [formModel]="formModel"
    ></codx-label>
        </div>
        <div class="col-6 d-flex flex-row">
            <codx-input
                class="mt-2"
                field="hasIncludeBenefits"
                [formModel]="formModel"
                [Group]="formGroup"
                (valueChange)="ValChangeHasIncludeBenefits($event)"
            ></codx-input>
            <!-- <codx-input
            class="mt-2"
            field="includeObjects"
            [formModel]="formModel"
            [Group]="formGroup"
            (valueChange)="ValChangeSelectObj($event)"
        ></codx-input> -->
            <button
            class="btn btn-icon ms-3"
            (click)="onClickOpenSelectIncludeBenefits()"
          >
            <i class="icon-edit-one icon-18" 
            [ngClass]="benefitPolicyObj.hasIncludeBenefits? 'text-dark':'text-gray-400'"
            ></i>
          </button>
        </div>
    </div>

    <span *ngIf="benefitPolicyObj.hasIncludeBenefits && lstSelectedBenefits.length > 0">
        <span *ngFor="let obj of lstSelectedBenefits">
            <!-- <codx-vll
            [showText]="true"
            [showBgColor]="true"
            name="HRObject"
            [value]="obj"
            class="badge badge-success border-0 ms-2"
          >
          </codx-vll> -->
          <span
          class="badge badge-success border-0 ms-2"
          [innerHTML]="obj
              | formatvalue : benefitFormModel : 'benefitID'
              | async"
        ></span>
        </span>
    </span>

    <div class="fs-5 fw-bold text-primary mt-6 mb-3">
        <codx-label
          name="lblAttachFile"
          [formModel]="formModel"
          [default]="'File đính kèm'"
        >
        </codx-label>
      </div>

      <codx-combobox-popup
      *ngIf="!isHidden && benefitPolicyObj.hasIncludeBenefits"
      [comboboxName]="grvSetup.IncludeBenefits.referedValue"
      [multiple]="true"
      [width]="600"
      [height]="500"
      [value]="benefitPolicyObj.includeBenefits"
      (clickSave)="onClickHideComboboxPopup($event)"
      >
      </codx-combobox-popup>
</ng-template>

<ng-template #policyInfo>
    <div class="form-group row mt-5">
    <codx-input
        field="memo"
        [formModel]="formModel"
        [Group]="formGroup"
    ></codx-input>
    </div>
</ng-template>

<ng-template #setting>

</ng-template>

<ng-template #applyObj>

</ng-template>

<ng-template #subtractObj>

</ng-template>

<ng-template #footer>
<div class="d-flex justify-content-between">
    <!-- <button
    class="btn btn-sm btn-outline btn-outline-primary btn-active-light-primary d-flex flex-row"
    (click)="openFormUploadFile()"
>
    <codx-label
    name="lblAddFile"
    default="Đính kèm file"
    [formModel]="formModel"
    ></codx-label>
</button> -->

    <button class="btn btn-primary" (click)="onSaveForm()">
    <i class="icon-save"></i>
    <codx-label
        default="Lưu"
        name="lblSave"
        [formModel]="formModel"
    ></codx-label>
    </button>
</div>
</ng-template>