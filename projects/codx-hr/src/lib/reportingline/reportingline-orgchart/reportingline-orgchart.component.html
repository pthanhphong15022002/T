<ng-container *ngIf="data; else tmpEmpty">
  <div>
    <ejs-diagram #diagram class="codx-orgchart" 
      width="100%" 
      height="650px" 
      [getConnectorDefaults]="connDefaults"
      [getNodeDefaults]="nodeDefaults" 
      [layout]="layout" 
      [tool]="tool" 
      [snapSettings]="snapSettings"
      [dataSourceSettings]="datasetting" (click)="orgClick($event)">
      <ng-template #nodeTemplate let-node>
        <ng-container *ngIf="node?.data" [ngTemplateOutlet]="template"
          [ngTemplateOutletContext]="{ $implicit: node.data, node: node }">
        </ng-container>
      </ng-template>
    </ejs-diagram>
  </div>
</ng-container>
<ng-template #tmpEmpty>
  <div class="container h-100">
    <div class="list-empty card card-flush h-100">
      <div class="d-flex flex-column flex-center justify-content-center">
        <img src="../assets/themes/sys/default/img/DataEmpty.svg" class="w-250px" />
        <div class="fw-bold mt-1 text-center">
          {{ "SYS011" | mssg | async }}
        </div>
      </div>
    </div>
  </div>
</ng-template>


<ng-template #template let-data>
  <div class="w-250px position-relative p-4">
    <div class="position-relative">
      <ng-container *ngIf="data.employees?.length > 0;else tmpNoEmployee">
        <!-- <ng-container *ngIf="data.employees.length == 1;else tmpMoreEmploye">
          <div class="d-flex flex-column flex-grow-1 align-items-center">
            <codx-img [isDefaulImg]="true" [objectId]="data.employees[0].employeeID" [objectType]="'HR_Employees'"
              [width]="60" [referType]="'avt'">
            </codx-img>
          </div>
        </ng-container>
        <ng-template #tmpMoreEmploye>
          <div class="d-flex justify-content-center">
            <codx-img [isDefaulImg]="true" [objectId]="data.employees[0].employeeID" [objectType]="'HR_Employees'"
              [width]="60" [referType]="'avt'">
            </codx-img>
            <div ngbDropdown ngbDropdownToggle (click)="showEmploy(data.employees)" class="rounded-circle w-60px h-60px bg-secondary d-flex align-items-center justify-content-center">
              <span class="text-white-50 fs-3">+{{data.employees?.length - 1}}</span>
              
              
            </div>
          </div>
        </ng-template> -->
        <ng-container
            *ngTemplateOutlet="templateListEmployee; context: { $implicit: data.employees }">
        </ng-container>
        <div class="text-center mt-2">
          <p class="text-dark m-0 p-0 fw-bolder">{{data.employees[0].employeeName}}</p>
          <p class="text-dark m-0 p-0">{{data.employees[0].positionName}}</p>
          <p class="text-dark m-0 p-0">{{data.employees[0].orgUnitName}}</p>
        </div>
      </ng-container>
      <ng-template #tmpNoEmployee>
        <div class="d-flex justify-content-center w-100">
          <img src="assets/themes/sys/default/img/Avatar_Default.svg" class="w-60px" alt="" />
        </div>
        <div class="text-center mt-2">
          <p class="text-dark m-0 p-0 ">{{data.positionName}}</p>
          <p class="text-dark m-0 p-0">{{data.orgUnitName}}</p>
        </div>
      </ng-template>
    </div>
    <div *ngIf="data.isChildrent" class="d-flex justify-content-center">
      <span #icon class="icon-20 " [classList]="data.loadChildrent ? 'icon-do_disturb_on' : 'icon-add_circle_outline'"
        (click)="loadDataChild(data,icon)"></span>
    </div>
  </div>
</ng-template>
<!-- template view employee -->
<ng-template #templateListEmployee let-employees>
  <div ngbDropdown class="d-flex align-items-center justify-content-center   symbol-more" [container]="'body'">
      <div ngbDropdownToggle class="btn d-flex align-items-center btn-vimgs p-0 ms-0 mt-1 symbol symbol-50px"
          type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
          style="padding: 0 !important ; margin-left: 0 !important; border:none">
          <div class="d-flex align-items-center">
              <codx-img 
                [objectId]="employees[0].employeeID" 
                [objectName]="employees[0].employeeName"
                [objectType]="'HR_Employees'" 
                [width]="50"
                [referType]="'avt'">
              </codx-img>
              <span *ngIf="employees.length > 1" class="multiple-employee rounded-circle">
                  <span class="text-white fs-3">+{{(employees.length - 1)}}</span>
              </span>
          </div>
      </div>
      <div ngbDropdownMenu class="dropdown-menu p-3" aria-labelledby="dropdownMenuButton">
          <div class="py-2">
              <codx-label default="Danh sách nhân viên" class="fw-bolder"></codx-label>
              <span class="fw-bold">{{employees.length}}</span>
          </div>
          <!-- <codx-searchbar (searchEvent)="searchUser($event)"></codx-searchbar> -->
          <div class="hr-list-employee">
              <ng-container *ngFor="let emp of employees">
                  <div class="d-flex align-items-center mt-3">
                      <codx-img 
                        [objectId]="emp.employeeID" 
                        [objectType]="'HR_Employees'" 
                        [cssClass]="'me-3'"
                        [objectName]="emp.employeeName" 
                        [width]="30"
                        [referType]="'avt'">
                      </codx-img>
                      <div class="d-flex flex-column w-300px">
                          <span class="fs-6">{{emp.employeeName}}</span>
                          <span class="text-gray-600">{{emp.positionName}}</span>
                      </div>
                  </div>
              </ng-container>
          </div>
      </div>
  </div>
</ng-template>