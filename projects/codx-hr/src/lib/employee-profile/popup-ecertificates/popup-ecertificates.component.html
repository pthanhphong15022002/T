<ng-container *ngIf="certificateObj">

<codx-layout-add
  #form
  [title]="headerText"
  [tabInfo]="tabInfo"
  [formModel]="formModel"
  [subHeader]=""
  [footer]="footer"
  [dialog]="dialog"
  (setTitle)="setTitle($event)"
  [openMore]="true"
  [tabContent]="[cerOveralInf, cerMoreInf]"
  [data]="certificateObj"
  >
  <!-- [group]="form.formGroup"
  *ngIf="isAfterRender" -->
</codx-layout-add>

<ng-template #cerOveralInf>
<ng-container *ngIf="form.formGroup">

  <div class="form-group row mx-0">
    <codx-label
      fiedName="CertificateType"
      [formModel]="form.formModel"
    ></codx-label>
    <codx-input
    [disabled]="disabledInput"
      field="certificateType"
      [formModel]="form.formModel"
      [Group]="form.formGroup"
      (valueChange)="valueChange($event, certificateID)"
    ></codx-input>
  </div>

  <div class="form-group row mx-0">
      <codx-label
      fiedName="CertificateID"
      [formModel]="form.formModel"
    ></codx-label>
    <codx-input
    [disabled]="disabledInput"
      #certificateID
      field="certificateID"
      [formModel]="form.formModel"
      [Group]="form.formGroup"
      (valueChange)="valueChange($event)"
    ></codx-input>
  </div>

  <div class="form-group row mx-0 mt-5">
    <div class="col-6">
      <codx-label
        fiedName="CertificateGradeID"
        [formModel]="form.formModel"
      ></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="certificateGradeID"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
        (valueChange)="valueChange($event)"
      ></codx-input>
    </div>

    <div class="col-6">
      <codx-label
        fiedName="ForeignLanguage"
        [formModel]="form.formModel"
      ></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="foreignLanguage"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row mx-0">
    <div class="col-6">
      <codx-label fiedName="LimitMonths" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="limitMonths"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
        [showSpinButton]="false"
      ></codx-input>
    </div>
    <div class="col-6">
      <codx-label fiedName="IsExpire" [formModel]="form.formModel"></codx-label>
      <div>
        <codx-input
        [disabled]="disabledInput"
          field="isExpire"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
    </div>
  </div>

  <div class="form-group row mx-0">
    <div class="col-6">
      <codx-label
        fiedName="EffectedDate"
        [formModel]="form.formModel"
      ></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="effectedDate"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
    <div class="col-6">
      <codx-label fiedName="ExpiredDate" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="expiredDate"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row mx-0 mt-5">
    <div class="col-6">
      <codx-label fiedName="TotalScore" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="totalScore"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
        [showSpinButton]="false"
      ></codx-input>
    </div>
    <div class="col-6">
      <codx-label fiedName="Ranking" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="ranking"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row mx-0">
    <codx-label fiedName="Note" [formModel]="form.formModel"></codx-label>
    <codx-input
    [disabled]="disabledInput"
      field="note"
      [formModel]="form.formModel"
      [Group]="form.formGroup"
    ></codx-input>
  </div>

  <div class="fs-6 fw-bold text-primary mt-6 mb-3 ps-3"
  *ngIf="certificateObj?.attachments > 0"
  >
    <codx-label
      name="lblAttachFile"
      [formModel]="form.formModel"
      [default]="'File đính kèm'"
    >
    </codx-label>
  </div>

  <div class=" flex-nowrap">
    <codx-attachment
      #attachment
      [objectType]="formModel?.entityName"
      showMessage="0"
      hideBtnSave="1"
      hideFolder="1"
      hideUploadBtn="1"
      hideDes="1"
      hideImageUpload="0"
      hideImageThumb="0"
      [objectId]="certificateObj?.recID"
      [allowMultiFile]="1"
      [idBrowse]="'add'"
      displayThumb="full"
      [functionID]="funcID"
      (fileAdded)="addFiles($event)">
      [referType]="'source'"
      >
    </codx-attachment>
  </div>
</ng-container>
</ng-template>

<ng-template #cerMoreInf>
  <ng-container *ngIf="form.formGroup">
  <div class="fs-6 fw-bold text-primary mt-6 mb-3 ps-3">
    <codx-label
      name="lblTraining"
      [formModel]="form.formModel"
      default="Thông tin đào tạo"
    >
    </codx-label>
  </div>

  <div class="form-group row mx-0">
    <codx-label
      fiedName="TrainSupplierID"
      [formModel]="form.formModel"
    ></codx-label>
    <codx-input
    [disabled]="disabledInput"
      field="trainSupplierID"
      [formModel]="form.formModel"
      [Group]="form.formGroup"
    ></codx-input>
  </div>

  <div class="form-group row mx-0">
    <div class="col-6">
      <codx-label
        fiedName="TrainCourseID"
        [formModel]="form.formModel"
      ></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="trainCourseID"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
    <div class="col-6">
      <codx-label fiedName="TrainForm" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="trainForm"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row mx-0">
    <div class="col-6">
      <codx-label fiedName="TrainFrom" [formModel]="form.formModel"></codx-label>
      <!-- <codx-input
        [disabled]="disabledInput"
      field="trainFrom"
      [formModel]="form.formModel"
      [Group]="form.formGroup"
    ></codx-input> -->
    <!--123123123-->
      <codx-dropdown-calendar
        [emptyText]="headerTextCalendar[0]"
        [firstChange]="isNullFrom"
      [disabled]="disabledInput"
      cssPopup="h-350px w-550px"
        [value]="Date(certificateObj.trainFromDate)"
        [selectedType]="fromDateFormat"
        [displayOption]="ops"
        cssClass="w-100 om-calendar"
        class="me-4"
        (click)="ClickCalendar($event)"
        (change)="changeCalendar($event, 'FromDate')"
      >
      </codx-dropdown-calendar>
    </div>
    <div class="col-6">
      <codx-label fiedName="TrainTo" [formModel]="form.formModel"></codx-label>

      <codx-dropdown-calendar
      [emptyText]="headerTextCalendar[1]"
      [firstChange]="isNullTo"
      [disabled]="disabledInput"
      cssPopup="h-350px w-550px"
      [value]="Date(certificateObj.trainToDate)"
      [selectedType]="toDateFormat"
      [displayOption]="ops"
      cssClass="w-100 om-calendar"
      class="me-4"
      (click)="ClickCalendar($event)"
      (change)="changeCalendar($event, 'ToDate')"
    >
    </codx-dropdown-calendar>
    </div>
  </div>

  <div class="fs-6 fw-bold text-primary mt-6 mb-3 ps-3">
    <codx-label
      name="lblCertInfo"
      [formModel]="form.formModel"
      default="Thông tin chứng chỉ"
    >
    </codx-label>
  </div>

  <div class="form-group row mx-0">
    <div class="col-6">
      <codx-label fiedName="DecisionNo" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="decisionNo"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
    <div class="col-6">
      <codx-label fiedName="IssuedDate" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="issuedDate"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row mx-0">
    <div class="col-6">
      <codx-label
        fiedName="CertificateNo"
        [formModel]="form.formModel"
      ></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="certificateNo"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
    <div class="col-6">
      <codx-label fiedName="BookNo" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="bookNo"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
  </div>

  <div class="form-group row mx-0">
    <div class="d-flex flex-stack">
      <codx-label fiedName="IssuedPlace" [formModel]="form.formModel"></codx-label>

      <span class="text-end align-items-end mb-1" *ngIf="actionType !='view'">
        <a
          class="btn btn-sm border border-gray-300 btn-active-light-primary align-items-center d-flex flex-row text-italic"
          (click)="setIssuedPlace()"
        >
          <span class="icon-south text-danger btn-text-primary me-2"></span>
          <codx-label
            name="lblSetIssuedPlace"
            default="(=Nơi đào tạo)"
            [formModel]="form.formModel"
          ></codx-label>
        </a>
      </span>
    </div>
    <codx-input
    [disabled]="disabledInput"
      field="issuedPlace"
      [formModel]="form.formModel"
      [Group]="form.formGroup"
    ></codx-input>
  </div>

  <div class="form-group row mx-0">
    <codx-label fiedName="IssuedBy" [formModel]="form.formModel"></codx-label>
    <codx-input
    [disabled]="disabledInput"
      field="issuedBy"
      [formModel]="form.formModel"
      [Group]="form.formGroup"
    ></codx-input>
  </div>

  <div *ngIf="displayForeignCert == true">
    <div class="fs-6 fw-bold text-primary mt-6 mb-3 ps-3">
      <codx-label
        name="lblForeignSkillPoint"
        [formModel]="form.formModel"
        default="Điểm kỹ năng ngoại ngữ"
      >
      </codx-label>
    </div>
  
    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label
          fiedName="ScoreListening"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreListening"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label
          fiedName="ScoreSpeaking"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreSpeaking"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
    </div>
  
    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label
          fiedName="ScoreReading"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreReading"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label
          fiedName="ScoreWriting"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreWriting"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
    </div>
  </div>
</ng-container>
</ng-template>

<ng-template #footer>
  <div class="d-flex justify-content-between" *ngIf="actionType != 'view'">
    <button
    class="btn btn-sm btn-outline btn-outline-primary btn-active-light-primary d-flex flex-row"
    (click)="openFormUploadFile()"
  >
    <codx-label
      name="lblAddFile"
      default="Đính kèm file"
      [formModel]="form.formModel"
    ></codx-label>
  </button>

    <button class="btn btn-primary" (click)="onSaveForm()" 
    [disabled]="!form.formModel.currentData.updateColumn && !changedInForm"
    >
      <i class="icon-save"></i>
      <codx-label
        default="Lưu"
        name="lblSave"
        [formModel]="form.formModel"
      ></codx-label>
    </button>
  </div>
</ng-template>
</ng-container>

<!-- <codx-form
  #form
  [headerText]="headerText"
  [body]="body"
  [formModel]="form.formModel"
  [footer]="footer"
  [dialog]="dialog"
  [data]="certificateObj"
  *ngIf="isAfterRender"
>
  <ng-template #body>
    <div class="form-group row mx-0">
      <codx-label
        fiedName="CertificateType"
        [formModel]="form.formModel"
      ></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="certificateType"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
        (valueChange)="valueChange($event, certificateID)"
      ></codx-input>
    </div>

    <div class="form-group row mx-0 mt-5">
      <div class="col-6">
        <codx-label
          fiedName="CertificateID"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          #certificateID
          field="certificateID"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          (valueChange)="valueChange($event)"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label
          fiedName="CertificateGradeID"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="certificateGradeID"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          (valueChange)="valueChange($event)"
        ></codx-input>
      </div>
    </div>

    <div class="form-group row mx-0">
      <codx-label
        fiedName="TrainSupplierID"
        [formModel]="form.formModel"
      ></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="trainSupplierID"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label
          fiedName="TrainCourseID"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="trainCourseID"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label fiedName="TrainForm" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="trainForm"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label fiedName="TrainFrom" [formModel]="form.formModel"></codx-label>
        <codx-dropdown-calendar
          [emptyText]="headerTextCalendar[0]"
          [firstChange]="isNullFrom"
          cssPopup="h-500px w-500px"
          [value]="Date(certificateObj.trainFromDate)"
          [selectedType]="fromDateFormat"
          [displayOption]="ops"
          cssClass="w-100 om-calendar"
          class="me-4"
          (change)="changeCalendar($event, 'FromDate')"
        >
        </codx-dropdown-calendar>
      </div>
      <div class="col-6">
        <codx-label fiedName="TrainTo" [formModel]="form.formModel"></codx-label>

        <codx-dropdown-calendar
        [emptyText]="headerTextCalendar[1]"
        [firstChange]="isNullTo"
        cssPopup="h-500px w-500px"
        [value]="Date(certificateObj.trainToDate)"
        [selectedType]="toDateFormat"
        [displayOption]="ops"
        cssClass="w-100 om-calendar"
        class="me-4"
        (change)="changeCalendar($event, 'ToDate')"
      >
      </codx-dropdown-calendar>
      </div>
    </div>

    <div class="form-group row mx-0 mt-5">
      <div class="col-6">
        <codx-label fiedName="TotalScore" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="totalScore"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label fiedName="Ranking" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="ranking"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
    </div>
    <div class="fs-5 fw-bold text-uppercase text-primary mt-6 mb-3">
      <codx-label
        name="lblTitleLanguage"
        [formModel]="form.formModel"
        default="Ngoại ngữ"
      >
      </codx-label>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label
          fiedName="ScoreListening"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreListening"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label
          fiedName="ScoreSpeaking"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreSpeaking"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label
          fiedName="ScoreReading"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreReading"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label
          fiedName="ScoreWriting"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="scoreWriting"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label fiedName="DecisionNo" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="decisionNo"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label fiedName="IssuedDate" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="issuedDate"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label
          fiedName="CertificateNo"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="certificateNo"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label fiedName="BookNo" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="bookNo"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
    </div>

    <div class="form-group row mx-0">
      <div class="d-flex flex-stack">
        <codx-label fiedName="IssuedPlace" [formModel]="form.formModel"></codx-label>

        <span class="text-end align-items-end mb-1">
          <a
            class="btn btn-sm border border-gray-300 btn-active-light-primary align-items-center d-flex flex-row text-italic"
            (click)="setIssuedPlace()"
          >
            <span class="icon-south text-danger btn-text-primary me-2"></span>
            <codx-label
              name="lblSetIssuedPlace"
              default="(=Nơi đào tạo)"
              [formModel]="form.formModel"
            ></codx-label>
          </a>
        </span>
      </div>
      <codx-input
      [disabled]="disabledInput"
        field="issuedPlace"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>

    <div class="form-group row mx-0">
      <codx-label fiedName="IssuedBy" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="issuedBy"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label fiedName="LimitMonths" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="limitMonths"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
          [showSpinButton]="false"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label fiedName="IsExpire" [formModel]="form.formModel"></codx-label>
        <div>
          <codx-input
          [disabled]="disabledInput"
            field="isExpire"
            [formModel]="form.formModel"
            [Group]="form.formGroup"
          ></codx-input>
        </div>
      </div>
    </div>

    <div class="form-group row mx-0">
      <div class="col-6">
        <codx-label
          fiedName="EffectedDate"
          [formModel]="form.formModel"
        ></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="effectedDate"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
      <div class="col-6">
        <codx-label fiedName="ExpiredDate" [formModel]="form.formModel"></codx-label>
        <codx-input
        [disabled]="disabledInput"
          field="expiredDate"
          [formModel]="form.formModel"
          [Group]="form.formGroup"
        ></codx-input>
      </div>
    </div>

    <div class="form-group row mx-0">
      <codx-label fiedName="Note" [formModel]="form.formModel"></codx-label>
      <codx-input
      [disabled]="disabledInput"
        field="note"
        [formModel]="form.formModel"
        [Group]="form.formGroup"
      ></codx-input>
    </div>
  </ng-template>
</codx-form> -->
