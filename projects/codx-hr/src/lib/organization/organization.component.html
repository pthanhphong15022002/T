<codx-views
  #view
  [autoLoad]="true"
  entityName="HR_OrganizationUnits"
  idField="orgUnitID"
  [views]="views"
  [selectedFirst]="true"
  (selectedChange)="onSelectionChanged($event)"
  [button]="button"
  (buttonClick)="btnClick($event)"
  (viewChanged)="changeView($event)"
  [viewActiveType]="1"
></codx-views>

<ng-template #templateRight>
  <ng-container *ngTemplateOutlet="currView"></ng-container>
</ng-template>

<ng-template #templateDetail>
  <ng-container *ngIf="orgUnitID">
    <lib-organize-detail
      [orgUnitID]="orgUnitID"
      [data]="dataDetail"
      [formModel]="view.formModel"
      [numberLV]="numberLV"
      (afterInit)="orgChartAfterView($event)"
    ></lib-organize-detail>
  </ng-container>
</ng-template>

<ng-template #templateListView>
  <div class="p-5 card-organization">
    <ng-container *ngFor="let data of dataCard; let i = index">
      <!-- <codx-temp-full
        [typeMF]="'hover'"
        [dataItem]="data"
        [formModel]="view.formModel"
        (clickMF)="clickMF($event, data)"
        [imageId]="data.employeeID"
        [imageObjName]="data.employeeName"
        imageObjType="HR_Employee"
        typeMF="hover"
        [title]="
          data.employeeName
            ? data.employeeName
            : setupEmp['EmployeeName']?.headerText || 'EmployeeName'
        "
        [subTitle]="
          data.positionName
            ? data.positionName
            : setupEmp['PositionName']?.headerText || 'PositionName'
        "
        [imgOn]="data.modifiedOn"
      >
      </codx-temp-full> -->
      <div class="d-flex flex-column">
        <div
          class="d-flex justify-content-between align-items-top list-action-menu"
        >
          <div class="d-flex flex-column org-card flex-grow-1">
            <div class="d-flex align-items-center org-header mt-1 mb-3">
              <div class="div-action-menu right left-300">
                <div class="d-flex align-items-center">
                  <div ngbDropdown class="dropdown" container="body">
                    <a
                      href="javascript:void(0)"
                      class="btn btn-clean btn-hover-light-primary btn-sm btn-icon"
                      ngbDropdownToggle
                      id="dropdownMenuButton1"
                      aria-expanded="false"
                    >
                      <i class="icon-more_vert icon-20 text-dark-75"></i>
                    </a>
                    <ul ngbDropdownMenu aria-labelledby="dropdownMenuButton1">
                      <li>
                        <a
                          ngbDropdownItem
                          href="javascript:void(0)"
                          (click)="clickMF('SYS03', data)"
                        >
                          <span class="icon-edit"></span>
                          <span
                            ><codx-label
                              fiedName="Update"
                              [formModel]="view.formModel"
                              default="Cập nhật"
                            ></codx-label
                          ></span>
                        </a>
                      </li>
                      <li>
                        <a
                          ngbDropdownItem
                          href="javascript:void(0)"
                          (click)="clickMF('SYS02', data)"
                        >
                          <span class="icon-close"></span>
                          <span
                            ><codx-label
                              fiedName="Delete"
                              [formModel]="view.formModel"
                              default="Xóa"
                            ></codx-label
                          ></span>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
              <div class="text-dark font-weight-bold font-size-h6">
                {{ data.departmentName }}
              </div>
              <span class="label label-inline label-pill label-xxs ml-2 mr-2">
                <codx-vll
                  [name]="'L0605'"
                  [value]="data.orgUnitType"
                  [showText]="true"
                  [showBgColor]="true"
                  [showIcon]="true"
                  class="badge badge-light badge-md fs-7 me-2"
                >
                </codx-vll>
              </span>
              <div *ngIf="data.parentID" class="text-dark mr-2">
                <span>
                  <codx-label
                    fiedName="under"
                    formName="OrganizationUnits"
                    gridViewName="grvOrganizationUnits"
                    default=" Trực thuộc:"
                  >
                  </codx-label>
                </span>
              </div>
              <div *ngIf="data.parentID" class="text-dark">
                {{ data.parentName }}
              </div>
            </div>
            <div class="d-flex align-items-start">
              <codx-img
                *ngIf="data.employeeID"
                class="symbol symbol-40 symbol-circle mr-3"
                [objectName]="data.employeeName"
                [objectId]="data.employeeID"
                objectType="HR_Employees"
              >
              </codx-img>
              <div
                *ngIf="!data.employeeID"
                class="symbol symbol-40 symbol-circle mr-3"
              >
                <span
                  class="noimage symbol symbol-40 symbol-circle symbol-label text-white ng-star-inserted"
                  style="background-color: #a2dbdb38; background-image: none"
                  ><span class="icon-account_circle icon-60 text-dark-50"></span
                ></span>
              </div>
              <div class="d-flex flex-column flex-grow-1">
                <div class="align-items-center mb-1">
                  <span
                    *ngIf="data.employeeName"
                    class="text-dark font-weight-bold font-size-lg mr-2"
                  >
                    {{ data.employeeName }}</span
                  >
                  <span
                    *ngIf="!data.employeeName"
                    class="text-muted font-weight-bold mr-2"
                  >
                    <codx-label
                      fiedName="name"
                      formName="OrganizationUnits"
                      gridViewName="grvOrganizationUnits"
                      default="Tên nhân viên"
                    >
                    </codx-label>
                  </span>
                </div>
                <div class="align-items-center mb-1">
                  <span class="text-dark-50 ml-2" *ngIf="data.positionName">
                    {{ data.positionName }}</span
                  >
                  <span
                    class="text-50 ml-2 text-muted"
                    *ngIf="!data.positionName"
                  >
                    <codx-label
                      fiedName="positionName"
                      formName="OrganizationUnits"
                      gridViewName="grvOrganizationUnits"
                      default="Chức vụ"
                    >
                    </codx-label>
                  </span>
                </div>
                <div class="d-flex align-items-center">
                  <div class="d-flex align-items-center mr-4">
                    <span
                      class="icon-phone_android icon-16 text-dark-50 mr-2"
                    ></span>
                    <span class="text-dark-50" *ngIf="data.phone">
                      {{ data.phone }}
                    </span>
                    <span class="text-50 ml-2 text-muted" *ngIf="!data.phone">
                      <codx-label
                        fiedName="phone"
                        formName="OrganizationUnits"
                        gridViewName="grvOrganizationUnits"
                        default="Số điện thoại"
                      >
                      </codx-label>
                    </span>
                  </div>
                  <div class="d-flex align-items-center">
                    <span class="icon-email icon-16 text-dark-50 mr-2"></span>
                    <div class="text-dark-50 font-size-sm" *ngIf="data.email">
                      {{ data.email }}
                    </div>
                    <div
                      class="text-50 font-size-sm text-muted"
                      *ngIf="!data.email"
                    >
                      <codx-label
                        fiedName="email"
                        formName="OrganizationUnits"
                        gridViewName="grvOrganizationUnits"
                        default="Email"
                      >
                      </codx-label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex org-dinhbien">
            <div
              #h
              class="mx-6 d-flex flex-column align-items-center"
              (click)="loadEmployList(h, data.departmentCode, '')"
            >
              <h4 class="text-dark-75 mb-2">{{ data.headcounts }}</h4>
              <span class="text-dark-75">
                <codx-label
                  fiedName="headcounts"
                  formName="OrganizationUnits"
                  gridViewName="grvOrganizationUnits"
                  default="Định biên"
                >
                </codx-label>
              </span>
            </div>
            <div
              #c
              class="mx-6 d-flex flex-column align-items-center"
              (click)="loadEmployList(c, data.departmentCode, '50')"
            >
              <h4 class="text-dark-75 mb-2 text-primary">{{ data.counts }}</h4>
              <span class="text-dark-75">
                <codx-label
                  fiedName="counts"
                  formName="OrganizationUnits"
                  gridViewName="grvOrganizationUnits"
                  default="Chính thức"
                >
                </codx-label>
              </span>
            </div>
            <div
              #o
              class="mx-6 d-flex flex-column align-items-center"
              (click)="loadEmployList(o, data.departmentCode, '30')"
            >
              <h4 class="text-dark-75 mb-2 text-warning">{{ data.onboard }}</h4>
              <span class="text-dark-75">
                <codx-label
                  fiedName="onboard"
                  formName="OrganizationUnits"
                  gridViewName="grvOrganizationUnits"
                  default="Onbroard"
                >
                </codx-label>
              </span>
            </div>
            <div
              #f
              class="mx-6 d-flex flex-column align-items-center"
              (click)="loadEmployList(f, data.departmentCode, '70')"
            >
              <h4 class="text-dark-75 mb-2 text-danger">{{ data.offboard }}</h4>
              <span class="text-dark-75">
                <codx-label
                  fiedName="offboard"
                  formName="OrganizationUnits"
                  gridViewName="grvOrganizationUnits"
                  default="Offboard"
                >
                </codx-label>
              </span>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>
</ng-template>

<ng-template #templateTree let-data>
  <span>{{ data.orgUnitName }}</span>
</ng-template>
