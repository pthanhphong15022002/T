<!-- <div>
  <ejs-diagram
    #diagram
    class="codx-orgchart"
    width="100%"
    height="700px"
    [getConnectorDefaults]="connDefaults"
    [getNodeDefaults]="nodeDefaults"
    [layout]="layout"
    [tool]="tool"
    [dataSourceSettings]="dataSource"
    [snapSettings]="snapSettings"
  >
    <ng-template #nodeTemplate let-node>
      <ng-container
        *ngIf="node.data"
        [ngTemplateOutlet]="template"
        [ngTemplateOutletContext]="{ $implicit: node.data, node: node }"
      >
      </ng-container>
    </ng-template>
  </ejs-diagram>
</div>
<ng-template #template let-data let-node="node">
  <div
    class="department-card border border-gray-300 w-250px h-350px position-relative"
  >
    <div
      class="d-flex align-items-center p-3 w-100"
      [style.background-color]="
        data.colorStatus ? data.colorStatus : headerColor
      "
    >
      <i
        class="text-white me-2"
        [ngClass]="data.icon ? data.icon : 'icon-business icon-18'"
      ></i>
      <div class="d-flex flex-grow-1 text-white fs-5">
        {{ data.orgUnitName }}
      </div>
      <div>
        <codx-mfunc
          [formModel]="formModel"
          (clickMF)="clickMF($event, data)"
          [isBookMark]="false"
          [dataItem]="data"
          type="view"
        >
        </codx-mfunc>
      </div>
    </div>
    <div class="p-3 department-card-main mb-1">
      <div class="d-flex flex-column flex-grow-1 align-items-center mt-2">
        <codx-img
          class="symbol symbol-60 symbol-circle me-2"
          [width]="60"
          [objectId]="data.employeeID"
          [objectName]="data.employeeName"
          [objectType]="'HR_Employees'"
        >
        </codx-img>
        <div class="text-dark fs-4 fw-bold mt-4 mb-2">
          <codx-label
            [formModel]="formModel"
            name="lblEmployeeName"
            [default]="data.employeeName || 'Tên Nhân Viên'"
          ></codx-label>
        </div>
        <div class="text-gray-600 mb-3">
          <codx-label
            [formModel]="formModel"
            name="txtPositionName"
            [default]="data.positionName || 'Chức vụ'"
          ></codx-label>
        </div>
        <div class="d-flex align-items-center mt-2">
          <div class="btn btn-sm btn-light-primary me-3 counter">
            <i class="icon-account_tree icon-16 me-1"></i>
            <span class="fw-bold text-primary">{{
              data.headcounts ? data.headcounts : 0
            }}</span>
          </div>
          <div class="btn btn-sm btn-light-primary counter">
            <i class="icon-perm_contact_calendar icon-16 me-1"></i>
            <span class="fw-bold text-primary">{{
              data.filledCounts ? data.filledCounts : 0
            }}</span>
          </div>
        </div>
      </div>
      <div class="d-flex justify-content-between mt-5 px-3">
        <div
          class="d-flex flex-column align-items-center counter cursor-pointer"
        >
          <h3 class="text-primary">{{ data.counts ? data.counts : 0 }}</h3>
          <codx-label
            class="text-gray-600"
            [formModel]="formModel"
            name="lblStaff"
            [default]="'Chính thức'"
          ></codx-label>
        </div>
        <div
          class="d-flex flex-column align-items-center counter cursor-pointer"
        >
          <h3 class="text-success">{{ data.onboard ? data.onboard : 0 }}</h3>
          <codx-label
            class="text-gray-600"
            [formModel]="formModel"
            name="lblOnboard"
            [default]="'Onboard'"
          ></codx-label>
        </div>
        <div
          class="d-flex flex-column align-items-center counter cursor-pointer"
        >
          <h3 class="text-danger">{{ data.offboard ? data.offboard : 0 }}</h3>
          <codx-label
            class="text-gray-600"
            [formModel]="formModel"
            name="lblOffboard"
            [default]="'Offboard'"
          ></codx-label>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #popEmpContent>
  <div class="d-flex flex-column">
    <div class="d-flex align-items-center mt-2">
      <codx-label
        class="text-gray-500 me-2"
        [formModel]="formModel"
        name="lblBirthDay"
        [default]="'Ngày sinh:'"
      ></codx-label>
      <span class="text-dark" *ngIf="imployeeInfo.birthday">{{
        imployeeInfo.birthday | date : "dd/MM/yyyy"
      }}</span>
    </div>
    <div class="me-5 d-flex align-items-center mt-2">
      <codx-label
        class="text-gray-500 me-2"
        [formModel]="formModel"
        name="lblJoinOn"
        [default]="'Ngày vào làm:'"
      ></codx-label>
      <span class="text-dark" *ngIf="imployeeInfo.joinedOn">{{
        imployeeInfo.joinedOn | date : "dd/MM/yyyy"
      }}</span>
    </div>
    <div class="me-5 d-flex align-items-center mt-2">
      <codx-label
        class="text-gray-500 me-2"
        [formModel]="formModel"
        name="lblStatus"
        [default]="'Tình trạng:'"
      ></codx-label>
      <ng-container *ngIf="imployeeInfo.status">
        <codx-vll
          class="text-dark"
          [name]="'L0225'"
          [value]="imployeeInfo.status"
          [showText]="true"
          [showIcon]="false"
          [showBgColor]="false"
        >
        </codx-vll>
      </ng-container>
    </div>
  </div>
</ng-template>

<ng-template #popEmpTitle>
  <div class="d-flex align-items-top">
    <div class="d-flex align-items-start user-card">
      <codx-img
        class="me-3"
        [width]="40"
        [objectId]="imployeeInfo.employeeID"
        [objectName]="imployeeInfo.employeeName"
        [objectType]="'HR_Employees'"
      >
      </codx-img>
      <div class="d-flex flex-column flex-grow-1">
        <div class="d-flex align-items-center">
          <div class="text-dark fw-bold mb-1">
            {{ imployeeInfo.employeeName }}
          </div>
        </div>
        <div class="text-gray-700" *ngIf="imployeeInfo.positionName">
          {{ imployeeInfo.positionName }}
        </div>
        <div
          class="text-gray-500 fw-normal"
          *ngIf="imployeeInfo.organizationName"
        >
          {{ imployeeInfo.organizationName }}
        </div>
      </div>
    </div>
  </div>
  <div class="d-flex flex-column employee-add mt-2">
    <div class="d-flex align-items-center mt-2">
      <span class="icon-email icon-16 me-2"></span>
      <div class="text-gray-500" *ngIf="imployeeInfo.email">
        {{ imployeeInfo.email }}
      </div>
    </div>
    <div class="d-flex align-items-center mt-2">
      <span class="icon-phone_android icon-16 me-2"></span>
      <div class="text-gray-500" *ngIf="imployeeInfo.phone">
        {{ imployeeInfo.phone }}
      </div>
    </div>
    <div class="d-flex align-items-top mt-2">
      <span class="icon-place icon-16 me-2"></span>
      <div class="text-gray-500" *ngIf="imployeeInfo.street">
        {{ imployeeInfo.street }}
      </div>
    </div>
  </div>
</ng-template>

<ng-template #popContent>
  <div class="container">
    <div class="row">
      <div
        *ngFor="let emp of employees"
        class="p-2 full rounded-2 codx-bghover cursor-pointer"
      >
        <div
          *ngIf="emp.employeeName"
          class="d-flex justify-content-between align-items-center cursor-pointer"
          popoverClass="userPopoverClass"
          [ngbPopover]="popEmpContent"
          placement="right left"
          [popoverTitle]="popEmpTitle"
          #pemp="ngbPopover"
          triggers="manual"
        >
          <div class="d-flex flex-column org-card flex-grow-1">
            <div class="d-flex align-items-start">
              <codx-img
                class="me-3"
                [width]="35"
                [objectId]="emp.employeeID"
                [objectName]="emp.employeeName"
                [objectType]="'HR_Employees'"
              >
              </codx-img>
              <div class="d-flex flex-column flex-grow-1">
                <div class="text-dark fw-bold">
                  <codx-label
                    [formModel]="formModel"
                    name="lblEmployeeName"
                    [default]="emp.employeeName || 'Tên nhân viên'"
                  ></codx-label>
                </div>
                <div class="text-gray-500">
                  <codx-label
                    [formModel]="formModel"
                    name="lblPositionName"
                    [default]="emp.positionName || 'Chức vụ'"
                  ></codx-label>
                </div>
              </div>
            </div>
          </div>
          <div>
            <a class="text-gray-500">
              <span class="icon-keyboard_arrow_right icon-20"></span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template> -->

<!-- (wheel)="onMouseWheel($event)" -->

<!-- <button class="btn btn-primary" (click)="onScale(0.5)">50%</button>
<button class="btn btn-primary mx-2" (click)="onScale(1)">100%</button>
<button class="btn btn-primary" (click)="onScale(1.5)">150%</button> -->

<!-- <org-diagram
  [items]="items"
  [annotations]="annotations"
  [pageFitMode]="PageFitMode.FitToPage"
  [cursorItem]="0"
  [highlightItem]="0"
  [normalLevelShift]="20"
  [dotLevelShift]="10"
  [lineLevelShift]="10"
  [normalItemsInterval]="20"
  [dotItemsInterval]="10"
  [lineItemsInterval]="5"
  [buttonsPanelSize]="48"
  [itemTitleSecondFontColor]="'#FFFFFF'"
  [leavesPlacementType]="ChildrenPlacementType.Vertical"
  [arrowsDirection]="GroupByType.Children"
  [hasSelectorCheckbox]="Enabled.False"
  [centerOnCursor]="true"
  [connectorType]="ConnectorType"
  [scale]="scaleNumber"
  [templates]="[
  {
    name: 'contactTemplate',
    itemTemplate: contactTemplate,
    itemSize: { width: 150, height: 150 },
  }
]"
>
</org-diagram> -->

<input
  min="1"
  max="100"
  value="50"
  step="1"
  #ref
  (change)="showVal(ref.value)"
  type="range"
  [style]="stylesObj"
/>

<div ngbDropdown class="symbol-more" [container]="'body'">
  <div
    ngbDropdownToggle
    class="btn d-flex align-items-center btn-vimgs p-0 ms-0 mt-1 symbol symbol-30px"
    type="button"
    id="dropdownMenuButton"
    data-toggle="dropdown"
    aria-haspopup="true"
    aria-expanded="false"
    style="padding: 0 !important ; margin-left: 0 !important; border: none"
  >
    Thiết lập mode view
  </div>
  <div ngbDropdownMenu aria-labelledby="dropdownMenuButton">
    <select #teams (change)="onSelected(teams.value)">
      <option default>Chọn mode view</option>
      <option>Không có quản lý</option>
      <option>Có quản lý</option>
    </select>

    <p>Page fit mode</p>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        name="flexRadioDefault"
        id="pageFitModeNone"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="pageFitModeNone"> None </label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        name="flexRadioDefault"
        id="pageFitModeFit"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="pageFitModeFit"> FitToPage </label>
    </div>

    <p>Orientation Type</p>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        name="orientation"
        id="orientationTop"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="orientationTop"> Top </label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        name="orientation"
        id="orientationBottom"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="orientationBottom"> Bottom </label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        name="orientation"
        id="orientationLeft"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="orientationLeft"> Left </label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        name="orientation"
        id="orientationRight"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="orientationRight"> Right </label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        name="orientation"
        id="orientationNone"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="orientationNone"> None </label>
    </div>

    <p>Placement Type</p>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        id="childrenPlacementAuto"
        name="placement"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="childrenPlacementAuto"> Auto </label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        id="childrenPlacementVertical"
        name="placement"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="childrenPlacementVertical">
        Vertical
      </label>
    </div>
    <div class="form-check">
      <input
        class="form-check-input"
        type="radio"
        id="childrenPlacementHorizontal"
        name="placement"
        (change)="changeMode($event)"
      />
      <label class="form-check-label" for="childrenPlacementHorizontal">
        Horizontal
      </label>
    </div>
  </div>
</div>

<div class="sample">
  <org-diagram
    [items]="items"
    [annotations]="annotations"
    [pageFitMode]="pagefit"
    [orientationType]="orientationType"
    [highlightItem]="0"
    [normalLevelShift]="20"
    [dotLevelShift]="10"
    [lineLevelShift]="20"
    [normalItemsInterval]="40"
    [dotItemsInterval]="20"
    [lineItemsInterval]="50"
    [buttonsPanelSize]="48"
    [showFrame]="true"
    [itemTitleSecondFontColor]="'#FFFFFF'"
    [childrenPlacementType]="childrenPlacementType"
    [arrowsDirection]="GroupByType.Children"
    [hasSelectorCheckbox]="Enabled.False"
    [centerOnCursor]="true"
    [connectorType]="ConnectorType"
    [scale]="scaleNumber"
    [templates]="[
    {
      name: 'contactTemplate',
      itemSize: { width: 170, height: 150 },
      itemTemplate: contactTemplate,
      minimizedItemSize: { width: 5, height: 5 },
    }
  ]"
  >
  </org-diagram>
</div>

<ng-template #contactTemplate let-itemConfig="context" let-isCursor="isCursor">
  <div class="border border-gray-300">
    <ng-container *ngFor="let item of dataVll">
      <div
        *ngIf="itemConfig.context.orgUnitType === item.value"
        class="d-flex align-items-center p-2 w-100"
        [style.background-color]="item.color"
      >
        <i class="text-white me-2" [ngClass]="item.icon"></i>
        <div>
          <span
            #departmentField
            class="line-clamp line-clamp-1 text-white fs-6"
            [ngbTooltip]="
              departmentField.scrollHeight > departmentField.clientHeight
                ? departmentTooltip
                : null
            "
          >
            {{ itemConfig.title }}
          </span>
        </div>

        <ng-template #departmentTooltip>
          <div class="d-flex flex-column">
            <span> {{ itemConfig.title }}</span>
          </div>
        </ng-template>
        <div class="ms-auto">
          <codx-mfunc
            [formModel]="view.formModel"
            (clickMF)="clickMF($event, itemConfig)"
            [isBookMark]="false"
            [dataItem]="itemConfig"
            type="view"
          >
          </codx-mfunc>
        </div>
      </div>
    </ng-container>
    <div class="p-1 mb-1">
      <div class="d-flex flex-column flex-grow-1 align-items-center mt-1">
        <codx-img
          class="symbol symbol-60 symbol-circle me-2"
          [width]="35"
          [objectId]="
            itemConfig.context.employeeManager &&
            itemConfig.context.employeeManager.employeeID
          "
          [objectName]="
            itemConfig.context.employeeManager &&
            itemConfig.context.employeeManager.employeeName
          "
          [objectType]="'HR_Employees'"
        >
        </codx-img>
        <div class="text-dark fs-6 fw-bold mt-2 mb-2">
          <span>
            {{
              itemConfig.context.employeeManager &&
                itemConfig.context.employeeManager.employeeName
            }}
          </span>
          <!-- <codx-label
            [formModel]="formModel"
            name="lblEmployeeName"
            [default]="
              (itemConfig.context.employeeManager &&
                itemConfig.context.employeeManager.employeeName) ||
              'Tên Nhân Viên'
            "
          ></codx-label> -->
        </div>
        <div class="text-gray-600 mb-1 fs-6">
          <span>
            {{
              itemConfig.context.employeeManager &&
                itemConfig.context.employeeManager.positionName
            }}
          </span>
          <!-- <codx-label
            [formModel]="formModel"
            name="txtPositionName"
            [default]="
              (itemConfig.context.employeeManager &&
                itemConfig.context.employeeManager.positionName) ||
              'Chức vụ'
            "
          ></codx-label> -->
        </div>
        <!-- <div class="d-flex align-items-center mt-2">
          <div class="btn btn-sm btn-light-primary me-3 counter">
            <i class="icon-account_tree icon-16 me-1"></i>
            <span class="fw-bold text-primary">{{
              itemConfig.headcounts ? itemConfig.headcounts : 0
            }}</span>
          </div>
          <div class="btn btn-sm btn-light-primary counter">
            <i class="icon-perm_contact_calendar icon-16 me-1"></i>
            <span class="fw-bold text-primary">{{
              itemConfig.filledCounts ? itemConfig.filledCounts : 0
            }}</span>
          </div>
        </div> -->
      </div>
      <!-- <div class="d-flex justify-content-between mt-5 px-3">
        <div
          class="d-flex flex-column align-items-center counter cursor-pointer"
        >
          <h3 class="text-primary">
            {{ itemConfig.counts ? itemConfig.counts : 0 }}
          </h3>
          <codx-label
            class="text-gray-600"
            [formModel]="formModel"
            name="lblStaff"
            [default]="'Chính thức'"
          ></codx-label>
        </div>
        <div
          class="d-flex flex-column align-items-center counter cursor-pointer"
        >
          <h3 class="text-success">
            {{ itemConfig.onboard ? itemConfig.onboard : 0 }}
          </h3>
          <codx-label
            class="text-gray-600"
            [formModel]="formModel"
            name="lblOnboard"
            [default]="'Onboard'"
          ></codx-label>
        </div>
        <div
          class="d-flex flex-column align-items-center counter cursor-pointer"
        >
          <h3 class="text-danger">
            {{ itemConfig.offboard ? itemConfig.offboard : 0 }}
          </h3>
          <codx-label
            class="text-gray-600"
            [formModel]="formModel"
            name="lblOffboard"
            [default]="'Offboard'"
          ></codx-label>
        </div>
      </div> -->
    </div>
  </div>
</ng-template>
<ng-template #contactCursorTemplate let-itemConfig="context"> </ng-template>
<ng-template #contactHighlightTemplate let-itemConfig="context">
  <div class="highlight-frame"></div>
</ng-template>
