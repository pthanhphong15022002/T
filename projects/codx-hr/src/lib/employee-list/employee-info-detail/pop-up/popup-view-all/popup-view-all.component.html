<codx-form
    #form
    [body]="body"
    [formModel]="formModel"
    [dialog]="dialogRef"
    [customToolbar]="customeHeader"
    [subHeader]="filter"
>
<ng-template #body>
    <!-- <ng-container *ngIf="true">
        <ng-container *ngComponentOutlet="filter"></ng-container>
    </ng-container> -->

    <div class="card-body p-0 mt-3" 
    *ngIf="formModel && columnGrid; else emptyDataTemplate"
    >
      <!-- <codx-gridview
        #gridView
        [funcId]="funcID"
        service="HR"
        [sort]="[sortModel]"
        [predicates]="'EmployeeID=@0'"
        [assemblyName]="'Core'"
        [className]="'DataBusiness'"
        [method]="'LoadDataAsync'"
        [dataValues]="employeeId"
        [formModel]="formModel"
        [columnsGrid]="columnGrid"
        [emptyTemplate]="emptyDataTemplate"
      ></codx-gridview> -->

      <codx-gridview-v2
      #gridView
      [formModel]="formModel"
      [columnsGrid]="columnGrid"
      [service]="'HR'"
      [sorts]="[sortModel]"
      [assemblyName]="'Core'"
      [className]="'DataBusiness'"
      [hideMoreFunc]="true"
      [method]="'LoadDataAsync'"
      [predicates]="'EmployeeID=@0'"
      [dataValues]="employeeId"
      [emptyTemplate]="emptyDataTemplate"
    ></codx-gridview-v2>
    </div>
  </ng-template>
</codx-form>


<!-- #region Hộ chiếu columnGrid templates-->
<ng-template #passportCol1 let-data>
  <div class="d-flex align-items-center">
    <!-- <span
      class="bullet bullet-vertical d-flex align-items-center min-h-40px mh-100 me-3"
      [class]="
        data.recID == crrPassport?.recID ? ' bg-primary' : 'bg-transparent'
      "
    ></span> -->
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center mb-5px">
        <span class="icon-i-card-text icon-16 text-gray-500 me-2"></span>
        <div
          class="text-dark"
          [innerHTML]="
            data?.passportNo
              | formatvalue : formModel : 'passportNo'
              | async
          "
        ></div>
      </div>
      <div class="d-flex align-items-center">
        <span class="icon-home_work icon-16 text-gray-500 me-2"></span>
        <div
          class="text-dark"
          [innerHTML]="
            data?.issuedPlace
              | formatvalue : formModel : 'issuedPlace'
              | async
          "
        ></div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #passportCol2 let-data>
  <div class="has-action-menu">
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center mb-5px">
        <span class="icon-event icon-16 text-primary me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.issuedDate
                | formatvalue : formModel : 'issuedDate'
                | async
            "
          ></span>
        </span>
      </div>
      <div class="d-flex align-items-center">
        <span class="icon-event icon-16 text-danger me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.expiredDate
                | formatvalue : formModel : 'expiredDate'
                | async
            "
          ></span>
        </span>
        <codx-mfunc
          [formModel]="formModel"
          (clickMF)="clickMF($event, data, funcID)"
          type="hover"
          [dataItem]="data"
        >
        </codx-mfunc>
      </div>
    </div>
  </div>
</ng-template>

<!-- #endregion -->

<!-- #region Giấy phép lao động columnGrid templates-->
<ng-template #workPermitCol1 let-data>
  <div class="d-flex align-items-center">
    <!-- <span
      class="bullet bullet-vertical d-flex align-items-center min-h-40px mh-100 me-3"
      [class]="
        data.recID == crrWorkpermit?.recID ? ' bg-primary' : 'bg-transparent'
      "
    ></span> -->
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center mb-5px">
        <span class="icon-i-card-text icon-16 text-gray-500 me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.workPermitNo
                | formatvalue : formModel : 'workPermitNo'
                | async
            "
          ></span>
          <i class="icon-i-dot text-gray-500 icon-16"></i>
          <span
          class="badge badge-primary border-2"
          [innerHTML]="
            data?.workPermitType
              | formatvalue : formModel : 'workPermitType'
              | async
          "
        ></span>
        </span>
      </div>
      <div class="d-flex align-items-center">
        <span class="icon-event icon-16 text-primary me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.fromDate
                | formatvalue : formModel : 'fromDate'
                | async
            "
          ></span>
        </span>
        <span class="mx-2">-</span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.toDate
                | formatvalue : formModel : 'toDate'
                | async
            "
          ></span>
        </span>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #workPermitCol2 let-data>
  <div class="has-action-menu">
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center mb-5px">
        <span class="icon-category icon-16 text-primary me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.jobAssign
                | formatvalue : formModel : 'JobAssign'
                | async
            "
          ></span>
        </span>
      </div>
      <div class="d-flex align-items-center">
        <span class="icon-i-card-text icon-16 text-gray-500 me-2"></span>
        <span class="text-dark">
          <span
          >{{data.workingForm}}</span>
        </span>
      </div>
      <codx-mfunc
        [formModel]="formModel"
        (clickMF)="clickMF($event, data, funcID)"
        type="hover"
        [dataItem]="data"
      >
      </codx-mfunc>
    </div>
  </div>
</ng-template>

<!-- #endregion -->

<!-- #region Thị thực columnGrid templates-->
<ng-template #visaCol1 let-data>
  <div class="d-flex align-items-center">
    <!-- <span
      class="bullet bullet-vertical d-flex align-items-center min-h-40px mh-100 me-3"
      [class]="data.recID == crrVisa?.recID ? ' bg-primary' : 'bg-transparent'"
    ></span> -->
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center mb-5px">
        <span class="icon-i-card-text icon-16 text-gray-500 me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.visaNo | formatvalue : formModel : 'visaNo' | async
            "
          ></span>
        </span>
      </div>
      <div class="d-flex align-items-center">
        <span class="icon-category icon-16 text-gray-500 me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.visaType | formatvalue : formModel : 'visaType' | async
            "
          ></span>
        </span>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #visaCol2 let-data>
  <div class="has-action-menu">
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center">
        <span class="icon-event icon-16 text-danger me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.effectedDate
                | formatvalue : formModel : 'effectedDate'
                | async
            "
          ></span>
        </span>
        <span class="me-1 ms-1">-</span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.expiredDate
                | formatvalue : formModel : 'expiredDate'
                | async
            "
          ></span>
        </span>
      </div>
      <div class="d-flex align-items-center">
        <span class="icon-home_work icon-16 text-gray-500 me-2"></span>
        <span class="text-dark">
          <span
            [innerHTML]="
              data?.nationalityID | formatvalue : formModel : 'nationalityID' | async
            "
          ></span>
        </span>
      </div>
      <codx-mfunc
        [formModel]="formModel"
        (clickMF)="clickMF($event, data, funcID)"
        type="hover"
        [dataItem]="data"
      >
      </codx-mfunc>
    </div>
  </div>
</ng-template>

<!-- #endregion -->

<!-- #region Lương cơ bản columnGrid templates-->
<ng-template #basicSalaryCol1 let-data>
  <div class="d-flex align-items-center">
    <!-- <span
      class="bullet bullet-vertical d-flex align-items-center min-h-30px mh-100 me-3"
      [class]="data.isCurrent ? 'bg-primary' : 'bg-transparent'"
    ></span> -->
    <div class="d-flex flex-column">
      <div
        class="d-flex align-items-center text-dark fs-6 fw-bold"
      >
      <ng-template #popNewest>
        <span>
          <codx-label
            name="lblIsNewest"
            [formModel]="formModel"
            default="Đang hiệu lực"
          ></codx-label>
        </span>
      </ng-template>
      <div
        *ngIf="checkIsNewestDate(data.effectedDate, data.expiredDate)"
        #popOver="ngbPopover"
        [openDelay]="500"
        (mouseenter)="popOver.open()"
        (mouseleave)="popOver.close()"
        placement="right"
        [ngbPopover]="popNewest"
        [style.color]="'#0078FF'"
        class="icon-bookmark icon-18 ms-auto"
      >

      </div>
        <span class="icon-attach_money icon-16 me-1"></span>
        <span class="">
          <span
            [innerHTML]="
              data?.bSalary
                | formatvalue : formModel : 'bSalary'
                | async
            "
          ></span>
        </span>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #basicSalaryCol2 let-data>
  <div class="d-flex flex-column">
    <div class="d-flex align-items-center">
      <span
        class="icon-monetization_on icon-16 me-2 text-dark fs-6 fw-bold"
      ></span>
      <span
        [ngClass]="
          data.isCurrent ? 'text-primary fw-bold' : 'text-dark fs-6 fw-bold'
        "
      >
        <span
          [innerHTML]="
            data?.siSalary
              | formatvalue : formModel : 'siSalary'
              | async
          "
        ></span>
      </span>
    </div>
  </div>
</ng-template>

<ng-template #basicSalaryCol3 let-data>
  <div class="d-flex flex-column">
    <div
      class="d-flex align-items-center mb-5px text-dark fs-6 fw-bold"
    >
      <span class="icon-attach_money icon-16 me-2"></span>
      <span
        [innerHTML]="
          data?.jSalary
            | formatvalue : formModel : 'jSalary'
            | async
        "
      ></span>
    </div>
  </div>
</ng-template>

<ng-template #basicSalaryCol4 let-data>
  <div class="has-action-menu">
    <div class="d-flex flex-column">
      <div
        class="d-flex align-items-center text-dark fs-6 fw-bold"
      >
        <span class="icon-event icon-16 text-gray-500 me-2"></span>
        <span
          [innerHTML]="
            data?.effectedDate
              | formatvalue : formModel : 'effectedDate'
              | async
          "
        ></span>
        <span class="mx-2">-</span>
        <span
          [innerHTML]="
            data?.expiredDate
              | formatvalue : formModel : 'expiredDate'
              | async
          "
        ></span>
      </div>
    </div>
    <codx-mfunc
      [formModel]="formModel"
      (clickMF)="clickMF($event, data, funcID)"
      type="hover"
      [dataItem]="data"
    >
    </codx-mfunc>
  </div>
</ng-template>
<!-- #endregion -->

<!-- #region template Phụ cấp  -->
<ng-template #templateBenefitID let-data>
  <ng-template #popNewest>
    <span>
      <codx-label
        name="lblIsNewest"
        [formModel]="formModel"
        default="Đang hiệu lực"
      ></codx-label>
    </span>
  </ng-template>
  <span
    *ngIf="checkIsNewestDate(data.effectedDate, data.expiredDate)"
    #popOver="ngbPopover"
    [openDelay]="500"
    (mouseenter)="popOver.open()"
    (mouseleave)="popOver.close()"
    placement="right"
    [ngbPopover]="popNewest"
    [style.color]="'#0078FF'"
    class="icon-bookmark icon-18 ms-auto"
  >
</span>

  <span
    [innerHTML]="
      data?.benefitID | formatvalue : formModel : 'benefitID' | async
    "
  >
    <!-- <span
      class="icon-i-plus-circle icon-12 pe-2"
    ></span> -->
  </span>
</ng-template>

<ng-template #templateBenefitAmt let-data>
  <div #benefitNorm>
    <span
      [innerHTML]="
        data?.benefitAmt | formatvalue : formModel : 'benefitAmt' | async
      "
    >
    </span>
    <span class="mx-1">/</span>
    <span
      [innerHTML]="
        data?.benefitNorm
          | formatvalue : formModel : 'benefitNorm'
          | async
      "
    ></span>
  </div>
</ng-template>

<ng-template #templateBenefitEffected let-data>
  <div
  class="has-action-menu"
  >
    <span
      [innerHTML]="
        data?.effectedDate
          | formatvalue : formModel : 'effectedDate'
          | async
      "
    ></span>
    <span class="mx-2"> - </span>
    <span
      [innerHTML]="
        data?.expiredDate
          | formatvalue : formModel : 'expiredDate'
          | async
      "
    ></span>
    <codx-mfunc
      [formModel]="formModel"
      (clickMF)="clickMF($event, data, funcID)"
      type="hover"
      [dataItem]="data"
    >
    </codx-mfunc>
  </div>
</ng-template>

<!--#endregion -->

<!-- #region customeHeader html-->
<ng-template #customeHeader>
  <div class="d-flex align-items-center justify-content-between w-100">
    <div class="d-flex align-items-center mb-5 mt-5 fw-normal">
      <span class="icon-i-filter-right icon-20 me-2"></span>
      <div class="d-flex align-items-center me-3">
        <codx-label
          [formModel]="formModel"
          [default]="headerText"
          name='lblViewAllHeader'
          class="fw-bold fs-5"
        >
        </codx-label>
        <span class="text-gray-400 mx-2 fw-normal fs-body"> | </span>
        <span class="text-gray-600 fs-6 fw-normal">Tất cả ({{ rowCount }})</span>
      </div>
    </div>
    <div class="card-toolbar me-2">
      <button
        type="button"
        class="btn btn-flex text-dark-75 text-hover-primary px-0"
        (click)="closeDialog()"
      >
        <span class="icon-close icon-18"></span>
      </button>
    </div>
  </div>
</ng-template>
<!--#endregion -->

<!-- #region Hợp đồng lao động column template  -->
<ng-template #eContractCol1 let-data>
  <div class="d-flex align-items-center">
    <!-- <span
      class="bullet bullet-vertical d-flex align-items-center min-h-50px mh-100 me-4"
      [class]="
        !data.isAppendix && data.isCurrent ? 'bg-primary' : 'bg-transparent'
      "
    ></span> -->
    <ng-template #popNewest>
      <span>
        <codx-label
          name="lblIsNewest"
          [formModel]="formModel"
          default="Đang hiệu lực"
        ></codx-label>
      </span>
    </ng-template>

    <div class="d-flex flex-column">
      <div class="d-flex align-items-center" *ngIf="data.isAppendix">
        <div class="d-flex flex-wrap mb-1">
          <div class="d-flex align-items-center">
            <span class="badge border-0 me-2 badge-primary">
              <codx-label
                [formModel]="formModel"
                [name]="'lblIsAppendix'"
                [default]="'Phụ lục hợp đồng'"
              ></codx-label>
            </span>
          </div>
        </div>
      </div>
      <div class="d-flex align-items-center mb-2" *ngIf="!data.isAppendix">
        <span
        *ngIf="checkIsNewestDate(data.effectedDate, data.expiredDate)"
        #popOver="ngbPopover"
        [openDelay]="500"
        (mouseenter)="popOver.open()"
        (mouseleave)="popOver.close()"
        placement="right"
        [ngbPopover]="popNewest"
        [style.color]="'#0078FF'"
        class="icon-bookmark icon-18"
      >
    </span>
        <span class="fw-bolder">
          <span
            [innerHTML]="
              data?.contractTypeID
                | formatvalue : formModel : 'contractTypeID'
                | async
            "
          ></span>
        </span>
      </div>

      <div class="d-flex align-items-center mb-2">
        <span class="icon-event icon-16 text-gray-800 me-1"></span>
        <span class="fw-bold fs-6">
          <span
            [innerHTML]="
              data?.effectedDate
                | formatvalue : formModel : 'effectedDate'
                | async
            "
          ></span>
        </span>
        <span class="me-1 ms-1 fw-bolder">-</span>
        <span class="fw-bold fs-6">
          <span
            [innerHTML]="
              data?.expiredDate
                | formatvalue : formModel : 'expiredDate'
                | async
            "
          ></span>
        </span>
      </div>


    </div>
  </div>
</ng-template>

<ng-template #eContractCol2 let-data>
  <div class="d-flex flex-column">
    <div class="d-flex align-items-center">
      <div class="d-flex flex-wrap mb-1" >
        <div class="d-flex align-items-center" *ngIf="data.isAppendix">
          <span class="fw-bold">
            <span
            class="me-1 icon-i-layout-text-sidebar-reverse icon-10 text-gray-800"
          ></span>
            <span
          [title]="eContractHeaderText.CefContractNo"
              [innerHTML]="
                data?.refContractNo
                  | formatvalue : formModel : 'refContractNo'
                  | async
              "
            ></span>
          </span>
        </div>

        <div class="d-flex align-items-center">
          <span
            class="me-1 icon-i-layout-text-sidebar-reverse icon-10 text-gray-800"
          ></span>
          <span class="text-dark">
            <span
          [title]="eContractHeaderText.ContractNo"

            >{{ data?.contractNo }}</span>
          </span>
        </div>
        <div class="d-flex align-items-center">
          <span
            class="icon-i-arrow-down-left-circle-fill fs-icon fs-10 ms-2 me-2 text-gray-400"
          ></span>
          <span class="fw-bold">
            <span
          [title]="eContractHeaderText.SignedDate"

              [innerHTML]="
                data?.signedDate
                  | formatvalue : formModel : 'signedDate'
                  | async
              "
            ></span>
          </span>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #eContractCol3 let-data>
  <div class="has-action-menu min-h-40px">
    <div class="d-flex flex-column">
      <div class="d-flex align-items-center mb-2">
        <span class="icon-edit icon-16 text-gray-800 me-1"></span>
        <span class="fw-bold fs-6">
          <span
            [innerHTML]="
              data?.note | formatvalue : formModel : 'note' | async
            "
          ></span>
        </span>
      </div>
      <codx-mfunc
        [formModel]="formModel"
        (clickMF)="clickMF($event, data, funcID)"
        type="hover"
        [dataItem]="data"
      >
      </codx-mfunc>
    </div>
  </div>
</ng-template>

<!-- #endregion -->


<!-- <ng-template #filterPassport>
    <div class="d-flex align-items-center">
        <span class="ms-2" *ngIf="hasFilter">
          <codx-dropdown-select
            [cssClass]="'rounded-pill border-1'"
            cssPopup="h-350px w-300px"
            [emptyText]="passportHeaderText['PassportNo']"
            [isMulti]="true"
            type="combobox"
            field="BenefitID"
          ></codx-dropdown-select>
        </span>
        <span class="ms-2">
          <codx-dropdown-calendar
            [cssPopup]="'w-550px h-350px'"
            emptyText="Chọn năm"
            [firstChange]="false"
            [displayOption]="ops"
            [selectedType]="'y'"
            [cssClass]="'rounded-pill'"
          ></codx-dropdown-calendar>
        </span>
      </div> 
</ng-template> -->

<ng-template #filterBenefit>
    <div class="d-flex align-items-center fs-body">
      <span class="me-2">
        <codx-dropdown-select
          *ngIf="eBenefitGrvSetup"
          [cssClass]="'rounded-pill border-1'"
          cssPopup="h-350px w-300px"
          [emptyText]="benefitHeaderText['BenefitID']"
          [isMulti]="true"
          type="combobox"
          field="BenefitID"
          [refValue]="eBenefitGrvSetup?.BenefitID?.referedValue"
          (valueChange)="valueChangeFilterBenefit($event)"
        ></codx-dropdown-select>
      </span>
      <span class="me-2">
        <codx-dropdown-calendar
          [cssPopup]="'w-500px h-300px'"
          emptyText="Chọn năm"
          [firstChange]="false"
          [displayOption]="ops"
          [selectedType]="'y'"
          [cssClass]="'rounded-pill'"
          (change)="valueChangeYearFilterBenefit($event)"
        ></codx-dropdown-calendar>
      </span> 
      </div> 
</ng-template>

<ng-template #emptyDataTemplate>
  <div class="d-flex ms-1">
    <span class="text-gray-500 fw-bold">
      {{ "SYS011" | mssg | async }}
    </span>
  </div>
</ng-template>

<ng-template #headTempContracts1>
  <codx-label
  [formModel]="formModel"
  [name]="'lblContractsGridCol1'"
  default="Loại hợp đồng | Thời hạn"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempContracts2>
  <codx-label
  [formModel]="formModel"
  [name]="'lblContractsGridCol2'"
  default="Hợp đồng"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempContracts3>
  <codx-label
  [formModel]="formModel"
  [name]="'lblContractsGridCol3'"
  default="Ghi chú"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempBasicSal1>
  <codx-label
  [formModel]="formModel"
  [name]="'lblBasicSalGridCol1'"
  default="Lương cơ bản"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempBasicSal2>
  <codx-label
  [formModel]="formModel"
  [name]="'lblBasicSalGridCol2'"
  default="Lương đóng BH"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempBasicSal3>
  <codx-label
  [formModel]="formModel"
  [name]="'lblBasicSalGridCol3'"
  default="Lương chức danh"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempBasicSal4>
  <codx-label
  [formModel]="formModel"
  [name]="'lblBasicSalGridCol4'"
  default="Hiệu lực"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempBenefit1>
  <codx-label
  [formModel]="formModel"
  [name]="'lblBenefitGridCol1'"
  default="Loại phụ cấp"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempBenefit2>
  <codx-label
  [formModel]="formModel"
  [name]="'lblBenefitGridCol2'"
  default="Số tiền"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempBenefit3>
  <codx-label
  [formModel]="formModel"
  [name]="'lblBenefitGridCol3'"
  default="Hiệu lực"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempWorkPermit1>
  <codx-label
  [formModel]="formModel"
  [name]="'lblWorkPermitGridCol1'"
  default="Số GPLĐ | Thời hạn"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>

<ng-template #headTempWorkPermit2>
  <codx-label
  [formModel]="formModel"
  [name]="'lblWorkPermitGridCol2'"
  default="Vị trí công việc | Hình thức làm việc"
  class="fw-bold fs-6 text-gray-600"
>
</codx-label>
</ng-template>