<div class="container mt-2 h-100 w-100">
    <ng-container *ngIf="showManager">
        <div class="d-flex align-items-top p-3">
            <div class="me-5">
                <codx-img #empAvatar [width]="50" [objectId]="manager?.employeeID ? manager?.employeeID : ''"
                    [objectName]="manager?.employeeName ? manager?.employeeName : ''" [objectType]="'HR_Employees'"
                    [imageType]="'circle'">
                </codx-img>
            </div>
            <div class="d-flex align-items-top w-100 justify-content-between">
                <div class="d-flex flex-column">
                    <div class="mb-1">
                        <ng-container *ngIf="manager?.employeeName; else lblEmployeeName">
                            <span class="fw-bold text-dark fs-5">{{manager.employeeName}}</span>
                        </ng-container>
                        <ng-template #lblEmployeeName>
                            <span class="place-holder">{{grvSetup['EmployeeName']?.headerText}}</span>
                        </ng-template>
                    </div>
                    <div class="mb-1">
                        <ng-container *ngIf="manager?.positionID; else lblPositionName">
                            <span class="text-gray-500">{{manager.positionName? manager.positionName:
                                manager.positionID}}</span>
                        </ng-container>
                        <ng-template #lblPositionName>
                            <span class="place-holder">{{grvSetup['PositionID']?.headerText}}</span>
                        </ng-template>
                        <span class="ms-2 me-2 text-gray-500">|</span>
                        <ng-container *ngIf="manager?.orgUnitID; else lblOrgUnitName">
                            <span class="text-gray-700">{{manager.orgUnitName? manager.orgUnitName:
                                manager.orgUnitID}}</span>
                        </ng-container>
                        <ng-template #lblOrgUnitName>
                            <span class="place-holder"> {{grvSetup['OrgUnitID']?.headerText}}</span>
                        </ng-template>
                    </div>
                    <div>
                        <ng-container *ngIf="manager?.phone; else lblPhone">
                            <span class="text-gray-700">{{ manager?.phone }}</span>
                        </ng-container>
                        <ng-template #lblPhone>
                            <span class="place-holder"> {{grvSetup['Phone']?.headerText}}</span>
                        </ng-template>
                        <span class="mx-2">|</span>
                        <ng-container *ngIf="manager?.email; else lblEmail">
                            <span class="text-gray-700">{{ manager.email }}</span>
                        </ng-container>
                        <ng-template #lblEmail>
                            <span class="place-holder"> {{grvSetup['Email']?.headerText}}</span>
                        </ng-template>
                    </div>
                </div>
                <div class="w-150px text-center">
                    <div class="fs-1 fw-bold text-primary mb-1">{{ grid?.dataService?.rowCount }}</div>
                    <codx-label class="text-gray-600" [formModel]="formModel" name="lblTotalEmployee"
                        default="Tổng số nhân viên"></codx-label>
                </div>
            </div>
        </div>
    </ng-container>

    <div *ngIf="columnsGrid" class="h-100" [ngClass]="showManager? 'manager-gridview': 'no-manager-gridview'">
        <codx-gridview-v2 #grid [formModel]="formModel" [columnsGrid]="columnsGrid" [service]="'HR'"
            [entityName]="'HR_Employees'" assemblyName="ERM.Business.HR" [className]="'EmployeesBusiness'"
            [hideMoreFunc]="true" [method]="'GetEmployeeListByOrgUnitIDGridView'" [dataValues]="orgUnitID"
            [emptyTemplate]="emptyDataTemplate" [autoLoad]="false" [showRowNumber]="showRowNumber" [autoFitColumns]="false"
            [allowResizing]="false" [allowFiltering]="false" [allowSorting]="false" idField="employeeID"
            [rowHeight]="rowHeight" height="auto"></codx-gridview-v2>
    </div>
</div>

<!-- employeelist -->
<ng-template #templateName let-data>
    <div class="d-flex align-items-center emp-list">
        <codx-img class="me-3" [width]="30" [objectId]="data.employeeID" [objectName]="data.employeeName"
            objectType="HR_Employees" [referType]="'avt'">
        </codx-img>
        <div class="d-flex flex-column flex-grow-1">
            <div class="d-flex align-items-center">
                <div class="text-dark fw-bold me-2">{{ data.employeeName }}</div>
            </div>
            <div class="mt-1">
                <span *ngIf="data.positionName; else noPosName" class="text-gray-600 fs-7">
                    <span>{{data.positionName? data.positionName : data.positionID}}</span>
                </span>
                <ng-template #noPosName>
                    <span class="place-holder fs-7">
                        <span>{{grvSetup['PositionID']?.headerText}}</span>
                    </span>
                </ng-template>
            </div>
        </div>
    </div>
</ng-template>
<ng-template #templateBirthday let-item>
    <ng-container *ngIf="item.birthday; else noBirthday">
        <span class="text-gray-700">{{ item.birthday | fmDT }}</span>
    </ng-container>
    <ng-template #noBirthday>
        <span class="place-holder">{{ grvSetup["Birthday"]?.headerText }}</span>
    </ng-template>
</ng-template>
<ng-template #templatePhone let-data>
    <div class="d-flex align-items-center employee-add">
        <span *ngIf="formModel.formName != 'EmployeeInfomation'" class="icon-phone_android icon-16 me-2"></span>
        <span class="text-gray-600" [innerHTML]="data.phone | formatvalue: formModel:'phone' | async"></span>
    </div>
</ng-template>
<ng-template #templateEmail let-data>
    <div class="d-flex align-items-center employee-email">
        <span *ngIf="formModel.formName != 'EmployeeInfomation'" class="icon-email icon-16 me-2"> </span>
        <span class="text-gray-600" [innerHTML]="data.email | formatvalue: formModel:'email' | async"></span>
    </div>
</ng-template>
<ng-template #templateJoinedOn let-item>
    <div *ngIf="item.joinedOn; else noJoinedOn">{{item.joinedOn | fmDT}}</div>
    <ng-template #noJoinedOn>
        <div class="place-holder">{{grvSetup['JoinedOn']?.headerText}}</div>
    </ng-template>
</ng-template>
<ng-template #templateStatus let-item>
    <div class="d-flex align-items-center has-action-menu">
        <ng-container *ngIf="item.status">
            <codx-vll [formModel]="formModel" [classList]="'badge badge-sm badge-inline'" [name]="'HR003'"
                [value]="item.status" [showText]="true" [showBgColor]="true">
            </codx-vll>
        </ng-container>
        <div class="align-self-center" *ngIf="editable">
            <div style="height: 40px">
                <codx-mfunc [formModel]="view.formModel" (clickMF)="clickMF($event, item)"
                    (changeDataMF)="clickMF($event, item)" [dataItem]="item" type="hover">
                </codx-mfunc>
            </div>
        </div>
    </div>
</ng-template>
<!-- end employeelist -->



<!-- contact -->
<!-- header template -->
<ng-template #colEmployeeHeader>
    <codx-label [name]="'lblColEmployeeHeader'" [default]="'Nhân viên'"> </codx-label>
</ng-template>
<ng-template #colContactHeader>
    <codx-label [name]="'lblColContactHeader'" [default]="'Liên hệ'">
    </codx-label>
</ng-template>
<ng-template #colPersonalHeader>
    <codx-label [name]="'lblColPersonalHeader'" [default]="'Thông tin cá nhân'">
    </codx-label>
</ng-template>
<ng-template #colStatusHeader>
    <codx-label [name]="'lblColStatusHeader'" [default]="'Tình trạng'">
    </codx-label>
</ng-template>
<!--column Nhân viên -->
<ng-template #colEmployee let-data>
    <div class="d-flex align-items-center cursor-pointer hover-active py-3" (dblclick)="clickViewEmpInfo(data)">
        <div class="d-flex flex-column me-4">
            <codx-img [objectId]="data.employeeID" [objectName]="data.employeeName" objectType="HR_Employees"
                [width]="40">
            </codx-img>
            <ng-container *ngIf="data.gender">
                <div class="mt-1 mx-auto">
                    <codx-vll [name]="'HR001'" [value]="data.gender" showText="true" [showBgColor]="true"
                        [classList]="'badge badge-sm badge-inline flex-wrap me-0'"></codx-vll>
                </div>
            </ng-container>
        </div>
        <div class="d-flex flex-column">
            <div class="d-flex align-items-center mb-1">
                <ng-container *ngIf="data.employeeName">
                    <span class="fw-bold fs-6 me-3 text-nowrap item-active" (click)="clickViewEmpInfo(data)">{{
                        data.employeeName
                        }}</span>
                    <i class="icon-qr_code_scanner text-danger icon-14 me-1"></i>
                    <span class="text-danger">{{ data.employeeID }}</span>
                </ng-container>
            </div>

            <div class="text-gray-600 mb-1 fs-7">
                <!-- <span [innerHTML]=" data.positionID| formatvalue : view.formModel : 'positionID' | async"></span> -->
                <span *ngIf="data.positionID">{{data.positionName? data.positionName : data.positionID}}</span>
            </div>

            <div class="text-gray-700 mb-1">
                <!-- <span [innerHTML]="data.orgUnitID | formatvalue : view.formModel : 'orgUnitID' | async"></span> -->
                <span *ngIf="data.orgUnitID">{{data.orgUnitName? data.orgUnitName : data.orgUnitID}}</span>

            </div>

            <div class="text-gray-600">
                <!-- <span #departmentName [innerHTML]="data.departmentID| formatvalue : view.formModel : 'departmentID'| async"></span> -->
                <span *ngIf="data.departmentID">{{data.departmentName? data.departmentName : data.departmentID}}</span>
                <ng-container *ngIf="data?.departmentID && data.divisionID">
                    <span class="text-gray-400 mx-1">,</span>
                </ng-container>
                <ng-container *ngIf="data.divisionID">
                    <!-- <span #divisionName [innerHTML]="data.divisionID | formatvalue : view.formModel : 'divisionID' | async"></span> -->
                    <span>{{data.divisionName? data.divisionName: data.divisionID }}</span>
                </ng-container>
            </div>
        </div>
    </div>
</ng-template>
<!-- columns Liên hệ -->
<ng-template #colContact let-data>
    <div (dblclick)="clickViewEmpInfo(data)">
        <div class="d-flex flex-column">
            <div class="d-flex align-items-center mb-1">
                <span class="text-gray-700" [ngbTooltip]="data.email? grvSetup?.Email.headerText : null"
                    [innerHTML]="data.email | formatvalue : view.formModel : 'email' | async">
                </span>
            </div>
            <div class="d-flex align-items-center mb-1">
                <span class="text-gray-700" [ngbTooltip]="data.phone? grvSetup?.Phone.headerText : null"
                    [innerHTML]="data.phone | formatvalue : view.formModel : 'phone' | async">
                </span>
            </div>
            <div class="d-flex align-items-center mb-1">
                <span class="text-gray-700" [ngbTooltip]="data.mobile? grvSetup?.Mobile.headerText : null"
                    [innerHTML]="data.mobile | formatvalue : view.formModel : 'mobile' | async">
                </span>
            </div>
        </div>
    </div>
</ng-template>
<!-- columns Thông tin cá nhân -->
<ng-template #colPersonal let-data>
    <div (dblclick)="clickViewEmpInfo(data)">
        <div class="d-flex flex-column">
            <div class="align-items-center1 mb-1">
                <codx-label class="text-dark fw-bold label-colon" [setRequire]="false" [fiedName]="'Birthday'"
                    [formModel]="view.formModel" default="Ngày sinh"></codx-label>
                <ng-container *ngIf="data.birthday; else noBirthday">
                    <span class="text-gray-700">{{ data.birthday | fmDT}}</span>
                </ng-container>
                <ng-template #noBirthday>
                    <span class="place-holder">{{grvSetup?.Birthday.headerText}}</span>
                </ng-template>
            </div>
            <div class="align-items-center mb-1">
                <codx-label class="text-dark fw-bold label-colon" [setRequire]="false" [fiedName]="'BirthPlace'"
                    [formModel]="view.formModel" default="Nơi sinh"></codx-label>
                <span class="text-gray-700"
                    [innerHTML]="data?.birthPlace | formatvalue : view.formModel : 'birthPlace'| async">
                </span>
            </div>
            <div #degreeNameContent class="align-items-center line-clamp line-clamp-2">
                <codx-label #labelContent class="label-colon fw-bold text-dark" [setRequire]="false" [fiedName]="'DegreeName'"
                    [formModel]="view.formModel" default="Chuyên môn"></codx-label>
                <ng-container *ngIf="data.degreeName; else noDegreeName">
                    <span #dataContent class="text-gray-600">{{ data.degreeName }}</span>
                </ng-container>
                <ng-template #noDegreeName>
                    <span class="place-holder">{{grvSetup['DegreeName'].headerText}}</span>
                </ng-template>
            </div>
        </div>
    </div>
</ng-template>
<!-- columns Tình trạng -->
<ng-template #colStatus let-data>
    <div (dblclick)="clickViewEmpInfo(data)" class="d-flex has-action-menu justify-content-between w-100">
        <div class="d-flex flex-column">
            <div class="d-flex mb-1">
                <codx-vll [name]="'HR003'" [value]="data.status" [showBgColor]="true" [showText]="true"
                    [className]="'badge badge-sm badge-inline'">
                </codx-vll>
            </div>
            <div class="align-items-center mb-1">
                <codx-label class="label-colon text-dark fw-bold" [setRequire]="false" [fiedName]="'JoinedOn'"
                    [formModel]="view.formModel" default="Ngày vào làm">
                </codx-label>
                <ng-container *ngIf="data.joinedOn; else noJoinedOn">
                    <span class="text-gray-700">{{data.joinedOn | fmDT}}</span>
                </ng-container>
                <ng-template #noJoinedOn>
                    <span class="place-holder">{{grvSetup['JoinedOn'].headerText}}</span>
                </ng-template>
            </div>
            <div class="align-items-center">
                <codx-label class="label-colon text-dark fw-bold" name="lblSenioritydate" [fiedName]="'Senioritydate'"
                    [setRequire]="false" [formModel]="view.formModel" default="Thâm niên">
                </codx-label>
                <ng-container *ngIf="data.senioritydate; else noSeniorityDate">
                    <span class="text-gray-700">{{ data.senioritydate | timeAgo }}</span>
                </ng-container>
                <ng-template #noSeniorityDate>
                    <span class="place-holder">{{grvSetup['Senioritydate'].headerText}}</span>
                </ng-template>
            </div>
        </div>
        <div class="align-self-center">
            <div style="height: 35px" class="has-action-menu">
                <codx-mfunc [formModel]="view.formModel" (clickMF)="clickMF($event, data)"
                    (changeDataMF)="clickMF($event, data)" [dataItem]="data" type="hover">
                </codx-mfunc>
            </div>
        </div>
    </div>
</ng-template>
<!-- #end contact -->




<ng-template #emptyDataTemplate>
    <div class="d-flex ms-1">
        <span class="text-gray-500 fw-bold">
            {{ "SYS011" | mssg | async }}
        </span>
    </div>
</ng-template>