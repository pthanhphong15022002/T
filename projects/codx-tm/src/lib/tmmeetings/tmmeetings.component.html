<div class="tm-meeting">
  <codx-views #view [funcID]="funcID" service="CO" assemblyName="ERM.Business.CO" entityName="CO_Meetings"
    [views]="views" [button]="showButtonAdd ? button : null" className="MeetingsBusiness" method="GetListMeetingsAsync"
    (buttonClick)="click($event)" [dataObj]="dataObj" [moreFuncs]="moreFuncs" [autoLoad]="true" idField="meetingID"
    (onActions)="onActions($event)">
  </codx-views>

  <!-- view-list -->
  <ng-template #itemViewList let-data>
    <lib-view-list-meet [formModel]="view.formModel" [data]="data" (clickMoreFunction)="receiveMF($event)"
      [itemSelected]="itemSelected" (viewDetail)="viewDetail($event)">
    </lib-view-list-meet>
  </ng-template>
  <!-- view-list -->

  <!-- cardCenter -->
  <ng-template #cardCenter let-data>
    <div (dblclick)="doubleClick(data)">
      <codx-card-center cardCss="border w-250px h-100 px-3 py-3 position-relative" [formModel]="view.formModel"
        [headerTmp]="headerTmp" [title]="getDate(data)" titleCss="fs-5 mb-2 fw-bold" [subTitle]="data.meetingName"
        [dataItem]="data" [footer]="footer" [typeMF]="'hover'" (clickMF)="clickMF($event, data)"
        (changeDataMF)="changeDataMF($event, data)">
      </codx-card-center>
    </div>
  </ng-template>
</div>
<ng-template #headerTmp let-data>
  <div class="d-flex align-items-center justify-content-between">
    <div class="d-flex align-items-top">
      <div style="width: 5px" [style.background-color]="
          data.status | vll: statusVll:'textColor' | async
        "></div>
      <div [innerHtml]="convertHtmlAgency(data)"></div>
    </div>
    <div *ngIf="data?.isOnline" [ngbPopover]="popoverLinks"
    #p1="ngbPopover" [openDelay]="500" (mouseenter)="p1.open()" (mouseleave)="p1.close()" placement="right left">
      <i class="icon-insert_link text-primary text-hover-primary icon-24" ></i>
    </div>
  </div>
  <ng-template #popoverLinks >
    <span>
      <codx-label name="lblLinkOnlineMeeting" [formModel]="view.formModel" default="Link họp online"></codx-label>
    </span>
  </ng-template>
</ng-template>

<ng-template #footer let-data>
  <div class="d-flex justify-content-center h-50px">
    <codx-imgs [objectId]="getResourceID(data)" objectType="AD_Users" [width]="30" [numberImages]="3">
    </codx-imgs>
  </div>
  <div class="footer-tag">
    <div class="d-flex align-items-center justify-content-between">
      <div class="tag-1line" *ngIf="data.tags">
        <codx-tag [entityName]="view.formModel.entityName" [disabled]="true" [isEdit]="false" [value]="data?.tags">
        </codx-tag>
      </div>
      <div *ngIf="!data.tags"></div>

    </div>
  </div>
  <div class="footer-att" *ngIf="data.attachments > 0" [ngbPopover]="popperAttachment"
    #p="ngbPopover" [openDelay]="500" (mouseenter)="p.open()" (mouseleave)="p.close()" placement="right left">
    <span class="icon-attach_file icon-18"> </span>
    <span class="position-absolute top-0 start-100 translate-middle badge badge-sm badge-circle badge-primary">
      {{ data.attachments }}</span>
  </div>

  <ng-template #popperAttachment >
    <span>
      <codx-label name="lblAttachment" [formModel]="view.formModel" default="Tài liệu đính kèm"></codx-label>
    </span>
  </ng-template>
</ng-template>
<!-- cardCenter -->

<!-- calendar -->
<!-- <ng-template #template7 let-data>
  <div class="has-action-menu">
    <codx-imgs [objectId]="getResourceID(data)" objectType="AD_Users" [numberImages]="3">
    </codx-imgs>
    <div class="action-menu d-flex align-items-center cursor-pointer">
      <i class="cursor-pointer icon-16 ms-1 me-2 icon-edit text-primary" (click)="edit(data)"></i>
      <i class="cursor-pointer icon-16 ms-1 me-2 icon-close text-dangger" (click)="delete(data)"></i>
    </div>
  </div>
</ng-template> -->

<ng-template #eventTemplate let-data>
  <div (dblclick)="viewDetail(data)" class="text-start  "
    [style.color]="data.status | vll: statusVll:'textColor' | async">
    <div class="fw-bold " [innerHtml]="getDate(data)"></div>
    <div class="fw-bolder">{{ data.meetingName }}</div>
  </div>
</ng-template>
<!-- calendar -->

<!-- kanban -->
<ng-template #cardKanban let-data let-setting="setting">
  <codx-card-img cardCss="border h-100" imageObjType="AD_Users" (clickMF)="clickMF($event, data)"
    cardCss="card-template meeting-card border-bottom" (changeDataMF)="changeDataMF($event, data)" [typeMF]="'hover'"
    [title]="data?.meetingName" [status]="data.status" [statusVll]="statusVll" [showBgColorVll]="true"
    [icoStatus2]="data?.isOnline" [icoStatusVll2]="'icon-insert_link text-primary text-hover-primary icon-24'"
    [date]="data.startDate" [rootData]="data" [formModel]="view.formModel" [setting]="setting" [footer]="cardImgFooter"
    [dataItem]="data">
  </codx-card-img>
</ng-template>

<!-- tách riêng để dễ fix sau này -->
<ng-template #cardImgFooter let-data let-setting="setting">
  <div *ngIf="setting?.resources" class="d-flex justify-content-center h-75px">
    <codx-imgs [objectId]="getResourceID(data)" objectType="AD_Users" [width]="30" [numberImages]="3">
    </codx-imgs>
  </div>
  <div *ngIf="!setting?.resources" class="d-flex justify-content-center h-50px"></div>
  <div class="footer-tag">
    <div class="d-flex align-items-center justify-content-between">
      <div class="tag-1line" *ngIf="data.tags && setting?.tags">
        <codx-tag [entityName]="view.formModel.entityName" [disabled]="true" [isEdit]="false" [value]="data?.tags">
        </codx-tag>
      </div>
      <div *ngIf="!data.tags"></div>

    </div>
  </div>
  <div class="footer-att" *ngIf="data.attachments > 0">
    <span class="icon-attach_file icon-18"> </span>
    <span class="position-absolute top-0 start-100 translate-middle badge badge-sm badge-circle badge-primary">
      {{ data.attachments }}</span>
  </div>
</ng-template>

<!-- calendar -->
<ng-template #cellTemplate let-data>
  <div [innerHtml]="getCellContent(data.date)"></div>
</ng-template>

<ng-template #contentTmp let-data>
  <div>
    <h5 #meetingName>
      {{
      data.meetingName
      | formatvalue
      : view.formModel
      : "meetingName"
      : meetingName
      : "Meetings"
      : "grvMeetings"
      | async
      }}
    </h5>
  </div>

  <div class="d-flex mt-1 flex-grow-1 mb-2">
    <div class="d-flex me-6">
      <i class="icon-calendar_today me-1"></i>
      <span class="ms-1 fw-bold">
        <span #startDate class="text-gray-700">{{
          data.startDate | formatvalue
          : view.formModel
          : "startDate"
          : startDate
          : "Meetings"
          : "grvMeetings"
          | async
          }}</span>
        <span *ngIf="data.startDate" class="fw-bold p-2" [innerHtml]="'( ' + getDate(data) + ')'"></span>
      </span>
    </div>
  </div>

  <hr />

  <div class="mb-2 text-dark me-6">
    <span>
      <codx-label default="Nội dung cuộc họp :" name="lblMemo" [formModel]="view.formModel" class="text-gray-600">
      </codx-label>
    </span>
    <span class="ms-2 fw-bold">
      <span class="text-gray-700 size-content-schedule cursor-pointer">
        <span [innerHTML]="data?.memo" (mouseenter)="popoverMemo.open()" (mouseover)="popoverMemo.close()"
          [ngbPopover]="tooltipMemo" popoverClass="empPopoverClass" #popoverMemo="ngbPopover"
          placement="left bottom top right" container="body"></span>
        <span #memo *ngIf="!data?.memo">{{
          data?.memo
          | formatvalue: view.formModel:"memo":memo:"Meetings":"grvMeetings"
          | async
          }}</span>
      </span>
    </span>
  </div>
  <div class="d-flex mb-2">
    <div class="d-flex text-dark me-6">
      <codx-label name="lblResources" default="Người tham gia : " class="text-gray-600 me-4">
      </codx-label>
      <div class="d-flex justify-content-end">
        <codx-imgs [objectId]="getResourceID(data)" objectType="AD_Users" [width]="30" [numberImages]="3">
        </codx-imgs>
      </div>
    </div>
  </div>

  <ng-template #tooltipMemo>
    <div [innerHTML]="data?.memo"></div>
  </ng-template>
</ng-template>

<ng-template #mfButton let-data>
  <div class="mt-2 me-2">
    <codx-mfunc [dataItem]="data" [formModel]="view.formModel" (clickMF)="clickMF($event, data)"
      (changeDataMF)="changeDataMF($event, data)" type="hover">
    </codx-mfunc>
  </div>
</ng-template>


<ng-template #headerTemp let-data>
  <div style="font-weight: bold;font-size: 14px; height: 40px; text-align: center; float: left !important;">
    <div>
      <codx-label name="lblDate" [default]="getDayCalendar(data?.date)"></codx-label>
    </div>
    <div>{{data?.date.getDate()}}</div>
  </div>
</ng-template>

<ng-template #footerNone></ng-template>

<!-- kanban -->