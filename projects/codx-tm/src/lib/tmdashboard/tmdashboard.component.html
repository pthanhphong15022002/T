<codx-views
  #view
  [views]="views"
  [autoLoad]="false"
  [funcID]="funcID"
  (filterReportChange)="filterChange($event)"
  (onActions)="onActions($event)"
  [moreFuncs]="buttons"
>
</codx-views>

<ng-template #template>
  <div class="w-100 h-100" *ngIf="isLoaded">
    <div *ngIf="reportID == 'TMD001'">
      <ng-container *ngTemplateOutlet="dashboard1"> </ng-container>
    </div>
    <div *ngIf="reportID == 'TMD002'">
      <ng-container *ngTemplateOutlet="dashboard2"> </ng-container>
    </div>
    <div *ngIf="reportID == 'TMD003'">
      <ng-container *ngTemplateOutlet="dashboard3"> </ng-container>
    </div>
  </div>
  <div class="w-100 h-100" *ngIf="!isLoaded">
    <div
      class="d-flex justify-content-center align-items-center h-100 bg-light"
    >
      <div class="col-lg-3 col-md-3 col-3" align="center">
        <div id="rounded-container">
          <!-- <ejs-progressbar
            [id]="newGuid()"
            [type]="'Circular'"
            [maximum]="100"
            [minimum]="0"
            [value]="40"
            [width]="'150'"
            [height]="'150'"
            [isIndeterminate]="true"
            [progressThickness]="10"
            [animation]="{ enable: true, duration: 2000, delay: 0 }"
          >
          </ejs-progressbar> -->
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #dashboard1>
  <codx-dashboard
    [templates]="templates1"
    [panels]="panels1"
    [datas]="datas1"
    [isEditMode]="isEditMode"
    [cellSpacing]="[20, 20]"
  ></codx-dashboard>
</ng-template>

<ng-template #dashboard2>
  <codx-dashboard
    [templates]="templates2"
    [panels]="panels2"
    [datas]="datas2"
    [isEditMode]="isEditMode"
    [cellSpacing]="[20, 20]"
  ></codx-dashboard>
</ng-template>

<ng-template #dashboard3
  ><codx-dashboard
    [templates]="templates3"
    [panels]="panels3"
    [datas]="datas3"
    [isEditMode]="isEditMode"
    [cellSpacing]="[20, 20]"
  ></codx-dashboard
></ng-template>

<!--#region my_dashboard  -->
<ng-template #my_dashboard>
  <div class="w-100 h-100" id="1">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Chuathuchien.svg'"
      [title]="'Chưa thực hiện'"
      [value]="+myDBData?.status?.newTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="2">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Dangthuchien.svg'"
      [title]="'Đang thực hiện'"
      [value]="+myDBData?.status?.processingTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="3">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Quahan.svg'"
      [title]="'Quá hạn'"
      [value]="+myDBData?.status?.overdueTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="4">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Hoantat.svg'"
      [title]="'Hoàn tất'"
      [value]="+myDBData?.status?.doneTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="5">
    <div class="assignchart-group w-100" style="height: 60%">
      <div
        *ngFor="let tasks of myDBData?.tasksByCategory; let i = index"
        class="assignchart-item d-flex align-items-center justify-content-end"
        [title]=""
      >
        <div class="fw-bold me-2">{{ tasks.quantity }}</div>
        <div
          class="assignchart-task"
          style="color: #000000"
          [style.background-color]="paletteColor[i]"
          [style.width]="
            (tasks.quantity / myDBData?.tasksByCategory[0].quantity) * 100 + '%'
          "
        ></div>
      </div>
    </div>
    <div class="w-100" style="height: 40%">
      <div class="d-flex justify-content-around align-items-center">
        <div class="d-flex align-items-center">
          <div
            style="width: 20px; height: 5px; background-color: #a6dff5"
          ></div>
          <div class="ms-2">Được giao</div>
        </div>
        <div class="d-flex align-items-center">
          <div
            style="width: 20px; height: 5px; background-color: #06ddb8"
          ></div>
          <div class="ms-2">Tự tạo</div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="6">
    <ejs-treemap
      align="center"
      style="display: block"
      [dataSource]="myDBData?.tasksByRef?.tasksRef"
      weightValuePath="quantity"
      rangeColorValuePath="quantity"
      [palette]="['#005dc7', '#0078ff', '#3699ff', '#d3e8ff']"
      [leafItemSettings]="{
        labelPath: 'refName'
      }"
      [tooltipSettings]="{
        visible: true,
        template:
          '<div><span >${refName}: </span><span >${quantity}</span></div>'
      }"
    >
    </ejs-treemap>
    <!-- <img
      style="width: 100%; height: 100%"
      src="assets/themes/sys/default/img/Empty_TreeMaps.svg"
    /> -->
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="7">
    <div
      class="d-flex justify-content-center align-items-center w-100"
      style="height: 60%"
    >
      <ejs-circulargauge
        class="d-block"
        style="width: 100%; height: 100%"
        background="transparent"
        #circulargauge=""
        [tooltip]="tooltip"
        [legendSettings]="{
          visible: false
        }"
      >
        <e-axes>
          <e-axis
            [title]="'Tỷ lệ hoàn thành công việc'"
            minimum="0"
            radius="100%"
            maximum="100"
            startAngle="0"
            endAngle="360"
            [majorTicks]="{
              height: 0
            }"
            [labelStyle]="{
              position: 'Inside',
              useRangeColor: true,
              font: { size: '0px', fontFamily: 'inherit' }
            }"
            [lineStyle]="{
              width: 0
            }"
            [minorTicks]="{
              height: 0
            }"
            [ranges]="[
              {
                start: 0,
                end: 100,
                radius: '100%',
                startWidth: 12,
                endWidth: 12,
                color: '#E0E0E0'
              }
            ]"
            [pointers]="[
              {
                roundedCornerRadius: 20,
                value: toFixed(myDBData?.rateDoneTask),
                type: 'RangeBar',
                radius: '100%',
                color: '#0078ff',
                border: {
                  width: 0
                },
                animation: {
                  enable: false
                },
                pointerWidth: 12
              }
            ]"
          >
          </e-axis>
          <e-axis
            [title]="'Tỷ lệ hoàn thành đúng hạn'"
            minimum="0"
            radius="80%"
            maximum="100"
            startAngle="0"
            endAngle="360"
            [majorTicks]="{
              height: 0
            }"
            [labelStyle]="{
              position: 'Inside',
              useRangeColor: true,
              font: { size: '0px', fontFamily: 'inherit' }
            }"
            [lineStyle]="{
              width: 0
            }"
            [minorTicks]="{
              height: 0
            }"
            [ranges]="[
              {
                start: 0,
                end: 100,
                radius: '70%',
                startWidth: 12,
                endWidth: 12,
                color: '#E0E0E0'
              }
            ]"
            [pointers]="[
              {
                roundedCornerRadius: 20,
                value: toFixed(myDBData?.rateDoneTaskOnTime),
                type: 'RangeBar',
                radius: '70%',
                color: '#2cd9c5',
                border: {
                  width: 0
                },
                animation: {
                  enable: false
                },
                pointerWidth: 12
              }
            ]"
          >
          </e-axis>
        </e-axes>
      </ejs-circulargauge>
    </div>
    <div class="container w-100" style="height: 40%">
      <div class="d-flex flex-column">
        <div class="m-2">
          <div class="d-flex align-items-center">
            <div
              class="me-2"
              style="
                height: 15px;
                width: 15px;
                border-radius: 10%;
                background-color: #5465ff;
              "
            ></div>
            <span>Tỷ lệ hoàn thành công việc</span>
          </div>
          <div class="ms-6">
            <span class="fw-bold fs-3"
              >{{ toFixed(myDBData?.rateDoneTask) }}%</span
            >
          </div>
        </div>
        <div class="m-2">
          <div class="d-flex align-items-center">
            <div
              class="me-2"
              style="
                height: 15px;
                width: 15px;
                border-radius: 10%;
                background-color: #04deb7;
              "
            ></div>
            <span>Tỷ lệ hoàn thành công việc đúng hạn</span>
          </div>
          <div class="ms-6">
            <span class="fw-bold fs-3"
              >{{ toFixed(myDBData?.rateDoneTaskOnTime) }}%</span
            >
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="8">
    <div
      class="d-flex justify-content-center align-items-center w-100"
      style="height: 60%"
    >
      <div style="position: relative" class="w-100 h-100">
        <ejs-circulargauge class="d-block" style="width: 100%; height: 100%">
          <e-axes>
            <e-axis
              [lineStyle]="lineStyle"
              radius="100%"
              startAngle="230"
              endAngle="130"
              minimum="0"
              maximum="150"
              [labelStyle]="labelStyle1"
              [majorTicks]="majorTicks1"
              [minorTicks]="minorTicks"
            >
              <e-ranges>
                <e-range
                  start="0"
                  end="150"
                  radius="100%"
                  roundedCornerRadius="15"
                  color="#FF8008"
                  [linearGradient]="rangeLinearGradient2"
                  startWidth="15"
                  endWidth="15"
                >
                </e-range>
              </e-ranges>
              <e-pointers>
                <e-pointer
                  type="Marker"
                  [value]="myDBData?.workPerformance?.performance"
                  markerShape="Image"
                  imageUrl="./assets/themes/tm/default/img/Button.svg"
                  radius="90%"
                  markerWidth="30"
                  markerHeight="30"
                >
                </e-pointer>
              </e-pointers>
            </e-axis>
          </e-axes>
        </ejs-circulargauge>
        <div
          *ngIf="myDBData?.workPerformance?.performance"
          style="
            position: absolute;
            top: 50%;
            right: 50%;
            transform: translate(50%, -50%);
          "
        >
          <p class="text-center text-gray-900 fw-bold fs-4" style="margin: 0px">
            {{ toFixed(myDBData?.workPerformance?.performance) }}
          </p>
        </div>
      </div>
    </div>
    <div class="w-100" style="height: 40%">
      <div class="d-flex justify-content-between align-items-center">
        <div class="w-100 h-100 d-flex flex-column justify-content-center">
          <div class="fw-bold text-center" style="font-size: 0.75vw">
            Tổng thời gian hoàn thành thực tế
          </div>
          <div class="d-flex justify-content-center align-items-center">
            <div class="fw-bold" style="font-size: 1.75vw">
              {{ myDBData.workPerformance?.actualHours ?? 0 }}
            </div>
            <div class="ms-2" style="font-size: 0.75vw">giờ</div>
          </div>
        </div>
        <div class="w-100 h-100 d-flex flex-column justify-content-center">
          <div class="fw-bold text-center" style="font-size: 0.75vw">
            Tổng thời gian làm việc
          </div>
          <div class="d-flex justify-content-center align-items-center">
            <div class="fw-bold" style="font-size: 1.75vw">
              {{ myDBData.workPerformance?.workHours ?? 0 }}
            </div>
            <div class="ms-2" style="font-size: 0.75vw">giờ</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div id="9">
    <div class="w-100 h-100">
      <div class="mt-5">
        <div class="d-flex justify-content-center align-items-center">
          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnradiobtnQuantityRadio"
              autocomplete="off"
              checked
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnQuantityRadio"
              default="Số lượng"
            ></codx-label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnTimeRadio"
              autocomplete="off"
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnTimeRadio"
              default="Thời gian"
            ></codx-label>
          </div>
        </div>
      </div>
      <div class="my-4">
        <div class="control-section">
          <ejs-accumulationchart
            #pie1
            style="display: block"
            [tooltip]="tooltip"
            [centerLabel]="{
              text: myDBData?.tasksByGroupQty + '<br>công việc'
            }"
            [legendSettings]="{ visible: false }"
          >
            <e-accumulation-series-collection>
              <e-accumulation-series
                [dataSource]="myDBData?.tasksByGroup"
                xName="taskGroupName"
                yName="quantity"
                startAngle="0"
                innerRadius="80%"
                radius="70%"
                [explode]="true"
                [explodeOffset]="'10%'"
                [palettes]="[
                  '#005dc7',
                  '#21b3d2',
                  '#06ddb8',
                  '#00f5e9',
                  '#a6dff5'
                ]"
              >
              </e-accumulation-series>
            </e-accumulation-series-collection>
          </ejs-accumulationchart>
          <!-- <div class="d-flex justify-content-center">
            <img
              style="width: 70%; height: 70%"
              src="assets/themes/sys/default/img/Empty_Piechart.svg"
            />
          </div> -->
        </div>
      </div>
      <div *ngFor="let data of myDBData?.tasksByGroup" class="mt-4">
        <div class="mx-2 my-5">
          <div class="d-flex justify-content-between">
            <div>
              <span>{{ data.taskGroupName }}</span>
              <span>&nbsp;(</span>
              <span>{{ data.quantity }}</span>
              <span>)</span>
            </div>
            <div>
              <span>{{
                data.percentage % 1 === 0
                  ? data.percentage
                  : data.percentage.toFixed(1)
              }}</span
              ><span>% </span>
            </div>
          </div>
          <div class="d-flex align-items-center min-w-200px">
            <div class="h-5px w-100 bg-gray-200 rounded-4">
              <div
                class="rounded-4 h-5px"
                role="progressbar"
                [style.width]="data.percentage + '%'"
                [style.background-color]="'#3699ff'"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #my_dashboard>
  <div class="w-100 h-100" id="10">
    <ejs-chart
      style="display: block"
      align="center"
      width="100%"
      height="100%"
      [id]="newGuid()"
      [tooltip]="{ enable: true }"
    >
      <e-series-collection>
        <e-series
          [dataSource]="myDBData?.dataBarChart?.lineChart"
          type="Line"
          xName="label"
          yName="value"
          name="WorkHours"
        >
        </e-series>
        <e-series
          [dataSource]="myDBData?.dataBarChart?.barChart"
          type="Column"
          xName="label"
          yName="value"
          name="Tasks"
        >
        </e-series>
      </e-series-collection>
    </ejs-chart>
  </div>
</ng-template>

<!--#endregion -->

<!--#region team_dashboard  -->
<ng-template #team_dashboard>
  <div class="w-100 h-100" id="1">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Chuathuchien.svg'"
      [title]="'Chưa thực hiện'"
      [value]="+teamDBData?.status?.newTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="2">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Dangthuchien.svg'"
      [title]="'Đang thực hiện'"
      [value]="+teamDBData?.status?.processingTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="3">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Quahan.svg'"
      [title]="'Quá hạn'"
      [value]="+teamDBData?.status?.overdueTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="4">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Hoantat.svg'"
      [title]="'Hoàn tất'"
      [value]="+teamDBData?.status?.doneTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="5">
    <div
      class="w-100 h-100 d-flex justify-content-start align-items-center p-2"
    >
      <div class="d-flex align-items-center">
        <div class="progress-container">
          <div class="progress-container-align position-relative">
            <div
              class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
            >
              <span class="fw-bold" style="font-size: 0.5vw"
                >{{
                  toFixed(
                    (+teamDBData?.status?.onTimeTasks /
                      +teamDBData?.status?.doneTasks) *
                      100
                  )
                }}%</span
              >
            </div>
            <ejs-progressbar
              #annotation1
              [id]="newGuid()"
              [type]="'Circular'"
              [maximum]="+teamDBData?.status?.doneTasks"
              [minimum]="0"
              [value]="+teamDBData?.status?.onTimeTasks"
              [width]="'75'"
              [height]="'75'"
              [trackThickness]="10"
              [progressThickness]="10"
              [animation]="animation"
            >
            </ejs-progressbar>
          </div>
        </div>
      </div>
      <div class="p-2">
        <div class="fw-bold">Đúng hạn</div>
        <div class="fw-bold" style="font-size: 1.25rem">
          {{ +teamDBData?.status?.onTimeTasks }}
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="6">
    <div
      class="w-100 h-100 d-flex justify-content-start align-items-center p-2"
    >
      <div class="d-flex align-items-center">
        <div class="progress-container">
          <div class="progress-container-align position-relative">
            <div
              class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
            >
              <span class="fw-bold" style="font-size: 0.5vw">
                {{
                  toFixed(
                    (+teamDBData?.status?.overDueTasks /
                      +teamDBData?.status?.doneTasks) *
                      100
                  )
                }}%</span
              >
            </div>
            <ejs-progressbar
              #annotation1
              [id]="newGuid()"
              [type]="'Circular'"
              [maximum]="+teamDBData?.status?.doneTasks"
              [minimum]="0"
              [value]="+teamDBData?.status?.overDueTasks"
              [width]="'75'"
              [height]="'75'"
              [trackThickness]="10"
              [progressThickness]="10"
              [progressColor]="'#FF4500'"
              [animation]="animation"
            >
            </ejs-progressbar>
          </div>
        </div>
      </div>
      <div class="p-2">
        <div class="fw-bold">Quá hạn</div>
        <div class="fw-bold" style="font-size: 1.25rem">
          {{ +teamDBData?.status?.overDueTasks }}
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="7">
    <ejs-accumulationchart
      #pie2
      class="w-100 h-100"
      style="display: block"
      [tooltip]="tooltip"
      [centerLabel]="{
        text: teamDBData?.tasksByGroupQty + '<br>công việc'
      }"
    >
      <e-accumulation-series-collection>
        <e-accumulation-series
          [dataSource]="teamDBData?.tasksByGroup"
          xName="taskGroupName"
          yName="quantity"
          startAngle="0"
          innerRadius="80%"
          radius="70%"
          [palettes]="['#005dc7', '#21b3d2', '#06ddb8', '#00f5e9', '#a6dff5']"
        >
        </e-accumulation-series>
      </e-accumulation-series-collection>
    </ejs-accumulationchart>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="8">
    <div class="w-100 h-100">
      <div class="my-5">
        <div class="d-flex justify-content-center align-items-center">
          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnLowestRadio"
              autocomplete="off"
              checked
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnLowestRadio"
              default="Thấp nhất"
            ></codx-label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnHighestRadio"
              autocomplete="off"
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnHighestRadio"
              default="Cao nhất"
            ></codx-label>
          </div>
        </div>
      </div>
      <div class="my-5">
        <div
          class="mx-2 my-5"
          *ngFor="let data of teamDBData.topEmpByDoneTasks"
        >
          <div class="d-flex justify-content-between">
            <div class="d-flex justify-content-between align-items-center">
              <codx-img
                *ngIf="data.employee.userID"
                [objectType]="'AD_Users'"
                [objectId]="data.employee.userID"
              ></codx-img>
              <div class="ms-2">
                <div class="text-dark">{{ data.employee.employeeName }}</div>
                <div>{{ data.employee.organizationName }}</div>
              </div>
            </div>
            <div class="progress-container">
              <div class="progress-container-align position-relative">
                <div
                  class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
                >
                  <span class="fw-bold" style="font-size: 0.5vw"
                    >{{ data.percentage }}%</span
                  >
                </div>
                <ejs-progressbar
                  #annotation1
                  [id]="newGuid()"
                  [type]="'Circular'"
                  [maximum]="100"
                  [minimum]="0"
                  [value]="data.percentage"
                  [width]="'75'"
                  [height]="'75'"
                  [trackThickness]="10"
                  [progressThickness]="10"
                  [progressColor]="'#FF4500'"
                  [animation]="animation"
                >
                </ejs-progressbar>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div id="9">
    <div class="topchart-group mt-3">
      <div
        *ngFor="let data of teamDBData?.topEmpByQtyTasks"
        class="topchart-item d-flex align-items-center justify-content-end"
      >
        <div *ngIf="+data?.percentage > 0">
          <div class="fw-bold me-2">
            {{ data?.quantity }}
          </div>
          <div
            class="topchart-user"
            style="background-color: #1d1dcc; color: #fff"
            [style.width]="data?.percentage + '%'"
            [title]="data?.employee?.employeeName"
          >
            <span>{{ data?.employee?.employeeName }}</span>
          </div>
        </div>
      </div>
    </div>
    <!-- <div class="d-flex justify-content-center">
      <img
        style="width: 100%; height: 100%"
        src="assets/themes/sys/default/img/Empty_Bar.svg"
      />
    </div> -->
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="10">
    <ejs-chart
      style="display: block"
      align="center"
      width="100%"
      height="100%"
      [id]="newGuid()"
      [tooltip]="{ enable: true }"
    >
      <e-series-collection>
        <e-series
          [dataSource]="teamDBData?.dataBarChart?.lineChart"
          type="Line"
          xName="label"
          yName="value"
          name="WorkHours"
        >
        </e-series>
        <e-series
          [dataSource]="teamDBData?.dataBarChart?.barChart"
          type="Column"
          xName="label"
          yName="value"
          name="Tasks"
        >
        </e-series>
      </e-series-collection>
    </ejs-chart>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="11">
    <div
      class="d-flex justify-content-center align-items-center w-100"
      style="height: 60%"
    >
      <div style="position: relative" class="w-100 h-100">
        <ejs-circulargauge class="d-block" style="width: 100%; height: 100%">
          <e-axes>
            <e-axis
              [lineStyle]="lineStyle"
              radius="100%"
              startAngle="230"
              endAngle="130"
              minimum="0"
              maximum="150"
              [labelStyle]="labelStyle1"
              [majorTicks]="majorTicks1"
              [minorTicks]="minorTicks"
            >
              <e-ranges>
                <e-range
                  start="0"
                  end="150"
                  radius="100%"
                  roundedCornerRadius="15"
                  color="#FF8008"
                  [linearGradient]="rangeLinearGradient2"
                  startWidth="15"
                  endWidth="15"
                >
                </e-range>
              </e-ranges>
              <e-pointers>
                <e-pointer
                  type="Marker"
                  [value]="teamDBData?.workPerformance?.performance"
                  markerShape="Image"
                  imageUrl="./assets/themes/tm/default/img/Button.svg"
                  radius="90%"
                  markerWidth="30"
                  markerHeight="30"
                >
                </e-pointer>
              </e-pointers>
            </e-axis>
          </e-axes>
        </ejs-circulargauge>
        <div
          *ngIf="teamDBData?.workPerformance?.performance"
          style="
            position: absolute;
            top: 50%;
            right: 50%;
            transform: translate(50%, -50%);
          "
        >
          <p class="text-center text-gray-900 fw-bold fs-4" style="margin: 0px">
            {{ toFixed(teamDBData?.workPerformance?.performance) }}
          </p>
        </div>
      </div>
    </div>
    <div class="w-100" style="height: 40%">
      <div class="d-flex justify-content-between align-items-center">
        <div class="w-100 h-100 d-flex flex-column justify-content-center">
          <div class="fw-bold text-center" style="font-size: 0.75vw">
            Tổng thời gian hoàn thành thực tế
          </div>
          <div class="d-flex justify-content-center align-items-center">
            <div class="fw-bold" style="font-size: 1.75vw">
              {{ teamDBData.workPerformance?.actualHours ?? 0 }}
            </div>
            <div class="ms-2" style="font-size: 0.75vw">giờ</div>
          </div>
        </div>
        <div class="w-100 h-100 d-flex flex-column justify-content-center">
          <div class="fw-bold text-center" style="font-size: 0.75vw">
            Tổng thời gian làm việc
          </div>
          <div class="d-flex justify-content-center align-items-center">
            <div class="fw-bold" style="font-size: 1.75vw">
              {{ teamDBData.workPerformance?.workHours ?? 0 }}
            </div>
            <div class="ms-2" style="font-size: 0.75vw">giờ</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<!-- <ng-template #team_dashboard>
  <div class="w-100 h-100" id="12" title="Tổng thời gian hoàn thành thực tế">
    <div class="w-100 h-100 d-flex flex-column justify-content-center">
      <div class="fw-bold text-center" style="font-size: 0.75vw">
        Tổng thời gian hoàn thành thực tế
      </div>
      <div class="d-flex justify-content-center align-items-center">
        <div class="fw-bold" style="font-size: 1.75vw">
          {{ teamDBData.workPerformance.actualHours }}
        </div>
        <div class="ms-2" style="font-size: 0.75vw">giờ</div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #team_dashboard>
  <div class="w-100 h-100" id="13" title="Tổng thời gian làm việc">
    <div class="w-100 h-100 d-flex flex-column justify-content-center">
      <div class="fw-bold text-center" style="font-size: 0.75vw">
        Tổng thời gian làm việc
      </div>
      <div class="d-flex justify-content-center align-items-center">
        <div class="fw-bold" style="font-size: 1.75vw">
          {{ teamDBData.workPerformance.workHours }}
        </div>
        <div class="ms-2" style="font-size: 0.75vw">giờ</div>
      </div>
    </div>
  </div>
</ng-template> -->

<!--#endregion -->

<!--#region assign_dashboard  -->
<ng-template #assign_dashboard>
  <div class="w-100 h-100" id="1">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Chuathuchien.svg'"
      [title]="'Chưa thực hiện'"
      [value]="+assignDBData?.status?.newTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div class="w-100 h-100" id="2">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Dangthuchien.svg'"
      [title]="'Đang thực hiện'"
      [value]="+assignDBData?.status?.processingTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div class="w-100 h-100" id="3">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Quahan.svg'"
      [title]="'Quá hạn'"
      [value]="+assignDBData?.status?.overdueTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div class="w-100 h-100" id="4">
    <count-chart
      class="w-100 h-100"
      [hasIcon]="true"
      [iconUrl]="'assets/themes/tm/default/img/DB_Hoantat.svg'"
      [title]="'Hoàn tất'"
      [value]="+assignDBData?.status?.doneTasks"
    ></count-chart>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div class="w-100 h-100" id="5">
    <div
      class="w-100 h-100 d-flex justify-content-start align-items-center p-2"
    >
      <div class="d-flex align-items-center">
        <div class="progress-container">
          <div class="progress-container-align position-relative">
            <div
              class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
            >
              <span class="fw-bold" style="font-size: 0.5vw"
                >{{
                  toFixed(
                    (+assignDBData?.status?.onTimeTasks /
                      +assignDBData?.status?.doneTasks) *
                      100
                  )
                }}%</span
              >
            </div>
            <ejs-progressbar
              #annotation1
              [id]="newGuid()"
              [type]="'Circular'"
              [maximum]="+assignDBData?.status?.doneTasks"
              [minimum]="0"
              [value]="+assignDBData?.status?.onTimeTasks"
              [width]="'75'"
              [height]="'75'"
              [trackThickness]="10"
              [progressThickness]="10"
              [animation]="animation"
            >
            </ejs-progressbar>
          </div>
        </div>
      </div>
      <div class="p-2">
        <div class="fw-bold">Đúng hạn</div>
        <div class="fw-bold" style="font-size: 1.25rem">
          {{ +assignDBData?.status?.onTimeTasks }}
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div class="w-100 h-100" id="6">
    <div
      class="w-100 h-100 d-flex justify-content-start align-items-center p-2"
    >
      <div class="d-flex align-items-center">
        <div class="progress-container">
          <div class="progress-container-align position-relative">
            <div
              class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
            >
              <span class="fw-bold" style="font-size: 0.5vw"
                >{{
                  toFixed(
                    (+assignDBData?.status?.overDueTasks /
                      +assignDBData?.status?.doneTasks) *
                      100
                  )
                }}%</span
              >
            </div>
            <ejs-progressbar
              #annotation1
              [id]="newGuid()"
              [type]="'Circular'"
              [maximum]="+assignDBData?.status?.doneTasks"
              [minimum]="0"
              [value]="+assignDBData?.status?.overDueTasks"
              [width]="'75'"
              [height]="'75'"
              [trackThickness]="10"
              [progressThickness]="10"
              [progressColor]="'#FF4500'"
              [animation]="animation"
            >
            </ejs-progressbar>
          </div>
        </div>
      </div>
      <div class="p-2">
        <div class="fw-bold">Quá hạn</div>
        <div class="fw-bold" style="font-size: 1.25rem">
          {{ +assignDBData?.status?.overDueTasks }}
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div id="7">
    <div class="w-100 h-100">
      <div class="my-5">
        <div class="d-flex justify-content-center align-items-center">
          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnQuantityRadio"
              autocomplete="off"
              checked
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnQuantityRadio"
              default="Số lượng"
            ></codx-label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio1"
              id="btnTimeRadio"
              autocomplete="off"
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnTimeRadio"
              default="Thời gian"
            ></codx-label>
          </div>
        </div>
      </div>
      <div class="my-4">
        <div class="control-section">
          <ejs-accumulationchart
            #pie1
            style="display: block"
            [tooltip]="tooltip"
            [centerLabel]="{
              text: assignDBData?.tasksByRef?.totalTasks.toString()
            }"
            [legendSettings]="{ visible: false }"
          >
            <e-accumulation-series-collection>
              <e-accumulation-series
                [dataSource]="assignDBData?.tasksByRef?.tasksRef"
                xName="refName"
                yName="quantity"
                startAngle="0"
                innerRadius="80%"
                radius="70%"
                [explode]="true"
                [explodeOffset]="'10%'"
                [palettes]="[
                  '#005dc7',
                  '#21b3d2',
                  '#06ddb8',
                  '#00f5e9',
                  '#a6dff5'
                ]"
              >
              </e-accumulation-series>
            </e-accumulation-series-collection>
          </ejs-accumulationchart>
        </div>
      </div>
      <div class="mt-4">
        <div
          *ngFor="let ref of assignDBData?.tasksByRef?.tasksRef"
          class="mx-2 my-5"
        >
          <div class="d-flex justify-content-between">
            <span>{{ ref.refName }} ({{ ref.quantity }})</span>
            <span>
              {{
                ((ref.quantity / assignDBData?.tasksByRef.totalTasks) * 100) %
                  1 ===
                0
                  ? (ref.quantity / assignDBData?.tasksByRef.totalTasks) * 100
                  : (
                      (ref.quantity / assignDBData?.tasksByRef.totalTasks) *
                      100
                    ).toFixed(1)
              }}%
            </span>
          </div>
          <div class="d-flex align-items-center min-w-200px">
            <div class="h-5px w-100 bg-gray-200 rounded-4">
              <div
                class="rounded-4 h-5px"
                role="progressbar"
                [style.width]="
                  (ref.quantity / assignDBData?.tasksByRef.totalTasks) * 100 +
                  '%'
                "
                [style.background-color]="'#3699ff'"
                aria-valuemin="0"
                aria-valuemax="100"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div class="w-100 h-100" id="8">
    <div class="w-100 h-100">
      <div class="my-2" *ngFor="let task of assignDBData?.tasksByProject">
        <div>
          {{ task?.projectName ? task?.projectName : task?.projectID }}
        </div>
        <div class="d-flex flex-row justify-content-between align-items-center">
          <div class="d-block w-100">
            <div class="progress">
              <div
                class="progress-bar bg-danger"
                [style.width]="
                  (task?.tasksStatus[2]?.quantity / task?.totalTasks) * 100 +
                  '%'
                "
                [title]="
                  (task?.tasksStatus[2]?.quantity / task?.totalTasks) * 100 +
                  '%'
                "
              ></div>
              <div
                class="progress-bar bg-warning"
                [style.width]="
                  (task?.tasksStatus[3]?.quantity / task?.totalTasks) * 100 +
                  '%'
                "
                [title]="
                  (task?.tasksStatus[3]?.quantity / task?.totalTasks) * 100 +
                  '%'
                "
              ></div>
              <div
                class="progress-bar bg-success"
                [style.width]="
                  (task?.tasksStatus[4]?.quantity / task?.totalTasks) * 100 +
                  '%'
                "
                [title]="
                  (task?.tasksStatus[4]?.quantity / task?.totalTasks) * 100 +
                  '%'
                "
              ></div>
            </div>
          </div>
          <div class="ms-2">
            <span>{{ task?.totalTasks }}</span>
          </div>
        </div>
      </div>
    </div>
    <!-- <img
      style="width: 100%; height: 100%"
      src="assets/themes/sys/default/img/Empty_Stack.svg"
    /> -->
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div id="9">
    <div class="topchart-group mt-3">
      <div
        *ngFor="let data of assignDBData?.topEmpByQtyTasks"
        class="topchart-item d-flex align-items-center justify-content-end"
      >
        <div *ngIf="+data?.percentage > 0">
          <div class="fw-bold me-2">
            {{ data?.quantity }}
          </div>
          <div
            class="topchart-user"
            style="background-color: #1d1dcc; color: #fff"
            [style.width]="data?.percentage + '%'"
            [title]="data?.employee?.employeeName"
          >
            <span>{{ data?.employee?.employeeName }}</span>
          </div>
        </div>
      </div>
      <!-- <div class="topchart-item d-flex align-items-center justify-content-end">
        <div class="fw-bold me-2">65</div>
        <div
          class="topchart-user"
          style="background-color: #6e6efd; width: 50%; color: #fff"
        >
          <span>Nguyễn Ngọc Phú Sỹ</span>
        </div>
      </div>
      <div class="topchart-item d-flex align-items-center justify-content-end">
        <div class="fw-bold me-2">12</div>
        <div
          class="topchart-user"
          style="background-color: #f5a9ff; width: 22%; color: #000"
        >
          <span>Nguyễn Thị Bích Vân</span>
        </div>
      </div> -->
    </div>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div id="10">
    <ejs-accumulationchart
      id="pie"
      class="d-block"
      style="height: 100%; width: 100%"
      [legendSettings]="{
    visible: true,
  }"
      [tooltip]="{ enable: true }"
      [enableAnimation]="{
        enable: true
      }"
      [centerLabel]="{
        text: assignDBData?.tasksByProjectQty + '<br>công việc'
      }"
    >
      <e-accumulation-series-collection>
        <e-accumulation-series
          [dataSource]="assignDBData?.tasksByProject"
          xName="projectName"
          yName="totalTasks"
          innerRadius="70%"
          [border]="{ width: 3 }"
        >
        </e-accumulation-series>
      </e-accumulation-series-collection>
    </ejs-accumulationchart>
  </div>
</ng-template>

<ng-template #assign_dashboard>
  <div id="11">
    <div class="w-100 h-100">
      <div class="my-5">
        <div class="d-flex justify-content-center align-items-center">
          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnLowestRadio"
              autocomplete="off"
              checked
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnLowestRadio"
              default="Thấp nhất"
            ></codx-label>

            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnHighestRadio"
              autocomplete="off"
            />
            <codx-label
              class="btn btn-outline-primary"
              for="btnHighestRadio"
              default="Cao nhất"
            ></codx-label>
          </div>
        </div>
      </div>
      <div class="my-5">
        <div
          class="mx-2 my-5"
          *ngFor="let data of assignDBData.topEmpByDoneTasks"
        >
          <div class="d-flex justify-content-between">
            <div class="d-flex justify-content-between align-items-center">
              <codx-img
                *ngIf="data.employee.userID"
                [objectType]="'AD_Users'"
                [objectId]="data.employee.userID"
              ></codx-img>
              <div class="ms-2">
                <div class="text-dark">{{ data.employee.employeeName }}</div>
                <div>{{ data.employee.organizationName }}</div>
              </div>
            </div>
            <div class="progress-container">
              <div class="progress-container-align position-relative">
                <div
                  class="position-absolute w-100 h-100 d-flex justify-content-center align-items-center"
                >
                  <span class="fw-bold" style="font-size: 0.5vw"
                    >{{ data.percentage }}%</span
                  >
                </div>
                <ejs-progressbar
                  #annotation1
                  [id]="newGuid()"
                  [type]="'Circular'"
                  [maximum]="100"
                  [minimum]="0"
                  [value]="data.percentage"
                  [width]="'75'"
                  [height]="'75'"
                  [trackThickness]="10"
                  [progressThickness]="10"
                  [progressColor]="'#FF4500'"
                  [animation]="animation"
                >
                </ejs-progressbar>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<!--#endregion -->
