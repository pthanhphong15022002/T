<codx-form
  [dialog]="dialogRef"
  [headerText]="headerText"
  [body]="body"
  [footer]="footer"
  [subHeader]="subHeader"
>
</codx-form>
<ng-template #subHeader>
  <div class="row w-100">
    <div class="col-2">
      <codx-img
        #codxImg
        [objectId]="group.groupID"
        [objectType]="'WP_Groups'"
        [width]="40"
        [isDefaulImg]="true"
        [isAllowEdit]="true"
        [funcId]="dialogRef.formModel.funcID">
      </codx-img>
    </div>
    <div class="col-10">
      <codx-input
        [type]="'text'"
        [field]="'groupName'"
        [crrValue]="group.groupName"
        (valueChange)="valueChange($event)"
      >
      </codx-input>
    </div>
    
  </div>
</ng-template>
<ng-template #body>
  <div class="row">
    <div class="col-6">
      <codx-label
        class="fw-bold"
        [className]="'fs-6'"
        [formModel]="dialogRef.formModel"
        name="lblListUser"
        default="Danh sách người dùng"
      ></codx-label>
      <codx-searchbar
          #codxSearch
          [iconPos]="'left'"
          (searchEvent)="searchEvent($event)"
      ></codx-searchbar>
    </div>
    <div class="col-6">
      <codx-label
          class="fw-bold"
          [className]="'fs-6'"
          [formModel]="dialogRef.formModel"
          name="lblListUser"
          [default]="'Đã chọn'">
        </codx-label>
      <span class="fw-bold">{{'('+arrUsers.length+')'}}</span>
    </div>
  </div>
  <div class="row mt-2">
    <div class="col-6">
      aaaaaaaaa
      <!-- <codx-listview
        #codxListView1
        (onSelectionChanged)="selectedChange($event)"
        [comboboxName]="'users'"
        [itemTemplate]="itemtemplate"
        [funcId]="dialogRef.formModel.funcID"
        [entityName]="'AD_Users'"
        [service]="'SYS'"
        [assemblyName]="'ERM.Business.Core'"
        [className]="'DataBusiness'"
        [method]="'LoadDataCbxAsync'"
        [selectFirst]="false"
      >
      </codx-listview> -->
    </div>
    <div class="col-6">
      <codx-listview
        #codxListView2
        [itemTemplate]="selectedtemplate"
        [funcId]="dialogRef.formModel.funcID"
        [entityName]="'AD_Users'"
        [comboboxName]="'users'"
        [service]="'SYS'"
        [assemblyName]="'ERM.Business.Core'"
        [className]="'DataBusiness'"
        [method]="'LoadSelectedDataCbxAsync'"
        [currentValue]="strUserID"
        [selectFirst]="false"
      >
      </codx-listview>
    </div>
  </div>
  <ng-template #itemtemplate let-item>
    <div class="d-flex align-items-center justify-content-between p-2">
      <div class="d-flex align-items-center justify-content-between">
        <codx-img
          [width]="30"
          [objectId]="item.UserID"
          [objectName]="item.UserName"
          objectType="AD_Users"
          imageType="circle"
        >
        </codx-img>
        <div class="text-left ms-2">
          <p class="m-0 fw-bold" *ngIf="item.UserName">{{ item.UserName }}</p>
        </div>
      </div>
      <div>
        <codx-input
          [disabled]="true"
          [checked]="false"
          [attr.data-id]="item.UserID"
          type="checkbox"
          [class]="'check-circle'"
        >
        </codx-input>
      </div>
    </div>
  </ng-template>
  <ng-template #selectedtemplate let-item>
    <div class="d-flex align-items-center justify-content-between p-2">
      <div class="d-flex justify-content-between">
        <codx-img
          [width]="30"
          [objectId]="item.UserID"
          [objectName]="item.UserName"
          objectType="AD_Users"
          imageType="circle"
        >
        </codx-img>
        <div class="text-left ms-2">
          <p class="m-0 fw-bold" *ngIf="item.UserName">{{ item.UserName }}</p>
        </div>
      </div>
      <div (click)="removeMember(item)">
        <span class="icon-close text-danger"></span>
      </div>
    </div>
  </ng-template>
</ng-template>
<ng-template #footer>
  <div class="d-flex justify-content-end">
    <button [disabled]="isLoading"
      class="btn btn-sm btn-primary"
      (click)="insertGroup()"
    >
      Lưu
    </button>
  </div>
</ng-template>
