<codx-views
  #view
  [funcID]="funcID"
  [service]="service"
  [assemblyName]="assemblyName"
  [entityName]="entityName"
  [className]="className"
  [method]="method"
  [views]="views"
  [button]="button"
  (buttonClick)="click($event)"
  [dataObj]="dataObj"
  [moreFuncs]="moreFuncs"
  [autoLoad]="true"
  [idField]="idField"
  [autoSearch]="false"
  (selectedChange)="selectedChange($event)"
  (viewChanged)="viewChanged($event)"
  (onLoading)="onLoading($event)"
  (searchChanged)="searchChanged($event)"
></codx-views>

<!----------------------------------Schedule---------------------------------->
<ng-template #cardTemplate let-data>
  <div class="d-flex flex-row justify-content-start align-items-center w-100">
    <!-- <codx-img [objectId]="data?.owner" objectType="AD_Users" [width]="30">
    </codx-img> -->
    <div class="ps-3 d-flex w-100 flex-column pe-12">
      <!-- <span class="w-100 text-truncate fw-bold">{{ showHour(data?.startDate) }} - {{ showHour(data?.endDate) }}</span> -->
      <span
        class="w-100 text-truncate fw-bold"
        [innerHTML]="targetToFixed(data?.target)"
      ></span>
    </div>
  </div>
</ng-template>

<ng-template #resourceHeader let-data>
  <div class="d-flex flex-row ms-5 align-items-center">
    <codx-img
      [objectId]="data?.resourceData?.salespersonID"
      imageType="circle"
      width="40"
      [objectType]="'AD_Users'"
      [objectName]="data?.resourceData?.userName"
    ></codx-img>
    <div class="ms-4 d-flex flex-column" style="width: 160px">
      <span
        class="fw-bold text-truncate"
        [title]="data?.resourceData?.userName"
        >{{ data?.resourceData?.userName }}</span
      >
      <div [ngbTooltip]="tooltip" class="line-clamp line-clamp-1">
        {{ data?.resourceData?.positionName }}
        <ng-template #tooltip>
          <div>{{ data?.resourceData?.positionName }}</div>
        </ng-template>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #contentTmp let-data> </ng-template>

<ng-template #resourceTootip let-data>
  <span
    class="w-100 text-truncate fw-bold"
    [innerHTML]="targetToFixed(data?.target)"
  ></span>
</ng-template>

<ng-template #mfButton let-data>
  <div class="mt-1 me-1">
    <codx-mfunc
      [dataItem]="data"
      [formModel]="view.formModel"
      (clickMF)="clickMF($event, data)"
      type="hover"
      (changeDataMF)="changeDataMF($event, data)"
    ></codx-mfunc>
  </div>
</ng-template>
<!--end-->

<!--Tree-->
<ng-template #panelRight>
  <div class="w-100 h-100 bg-white rounded-2 pt-5 d-flex flex-column">
    <div class="d-flex align-items-center justify-content-end mb-1">
      <codx-dropdown-calendar
        cssPopup="h-500px w-800px"
        [value]="date"
        [selectedType]="'y'"
        [displayOption]="ops"
        cssClass="w-100 om-calendar"
        class="me-2"
        (valueChange)="changeCalendar($event)"
        (change)="changeCalendar($event)"
      ></codx-dropdown-calendar>
    </div>
    <div
      class="d-flex justify-content-end container treeview"
      style="padding-right: 70px; padding-left: 70px"
    >
      <div class="ms-2 me-2" ngbDropdown [container]="'body'">
        <div
          role="button"
          class="d-flex align-items-center border rounded align-items-center p-2 w-90px"
          (click)="clickShow(!isShow)"
          *ngIf="isShow == true"
        >
          <i class="icon-i-arrows-collapse me-2"></i>
          <codx-label default="Thu gọn" fiedName="lblCollapse"></codx-label>
        </div>
        <div
          role="button"
          class="d-flex align-items-center border rounded align-items-center p-2 w-90px"
          (click)="clickShow(!isShow)"
          *ngIf="isShow == false"
        >
          <i class="icon-i-arrows-expand me-2"></i>
          <codx-label default="Mở rộng" fiedName="lblExpand"></codx-label>
        </div>
      </div>
    </div>
    <div class="mt-2 om-ejs-tab">
      <ng-container *ngIf="loadedTree">
        <div *ngIf="lstDataTree != null && lstDataTree.length > 0; else noData">
          <div
            class="container treeview"
            *ngIf="loadedTree"
            style="padding-right: 70px; padding-left: 70px"
          >
            <codx-view-tree-targets
              [dataTree]="lstDataTree"
              [fmTargetLines]="fmTargetLines"
              [formModel]="view.formModel"
              (clickMoreFunc)="clickMoreFunc($event)"
              (changeMoreMF)="changeMoreMF($event)"
            ></codx-view-tree-targets>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</ng-template>

<ng-template #noData>
  <div class="empty-data">
    <div class="container h-100">
      <div class="list-empty card card-flush h-100">
        <div class="d-flex flex-column flex-center justify-content-center">
          <img
            src="../assets/themes/sys/default/img/DataEmpty.svg"
            class="w-200px"
          />
          <div class="fs-5 text-dark fw-bold mt-2 text-center">
            {{ "SYS011" | mssg | async }}
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<!--end-->

<!--Grid-->
<ng-template #templateMonth0 let-item>
  <div class="d-flex flex-row ms-5 align-items-center">
    <codx-img
      [objectId]="item?.salespersonID"
      imageType="circle"
      width="40"
      [objectType]="'AD_Users'"
      [objectName]="item?.userName"
    ></codx-img>
    <div class="ms-4 d-flex flex-column" style="width: 160px">
      <span class="fw-bold text-truncate" [title]="item?.userName">{{
        item?.userName
      }}</span>
      <div [ngbTooltip]="tooltip" class="line-clamp line-clamp-1">
        {{ item?.positionName }}
        <ng-template #tooltip>
          <div>{{ item?.positionName }}</div>
        </ng-template>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #templateMonth1 let-item>
  <ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 1">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #templateMonth2 let-item>
  <ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 2">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #templateMonth3 let-item>
  <ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 3">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #templateMonth4 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 4">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container> </ng-container
></ng-template>
<ng-template #templateMonth5 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 5">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container> </ng-container
></ng-template>
<ng-template #templateMonth6 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 6">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container> </ng-container
></ng-template>
<ng-template #templateMonth7 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 7">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container> </ng-container
></ng-template>
<ng-template #templateMonth8 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 8">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container> </ng-container
></ng-template>
<ng-template #templateMonth9 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 9">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #templateMonth10 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 10">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #templateMonth11 let-item>
  <ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 11">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container>
  </ng-container>
</ng-template>
<ng-template #templateMonth12 let-item
  ><ng-container *ngIf="item?.tmpMonths != null && item?.tmpMonths?.length > 0">
    <ng-container *ngFor="let mo of item?.tmpMonths">
      <div *ngIf="item?.salespersonID === mo?.salespersonID && mo?.month == 12">
        <span
          [innerHTML]="
            targetToFixed(mo?.target)
              | formatvalue : view.formModel : 'Target'
              | async
          "
        ></span>
      </div>
    </ng-container>
  </ng-container>
</ng-template>

<!--end-->
