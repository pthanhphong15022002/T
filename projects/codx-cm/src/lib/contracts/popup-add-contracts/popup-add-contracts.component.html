<ng-container *ngIf="addFieldsControl == '1'">
  <codx-layout-add
    #formlayoutadd
    [title]="'Thêm hợp đồng'"
    [subHeader]="subHeader"
    [tabInfo]="tabInfo"
    [tabContent]="tabContent"
    [openMore]="true"
    [dialog]="dialog"
    [formModel]="formModel"
    [footer]="footer"
    [data]="deal"
    (setTitle)="setTitle($event)"
  ></codx-layout-add>

  <ng-template #tabGeneralInfoDetail>
    <ng-container
      [ngTemplateOutlet]="body"
      [ngTemplateOutletContext]="{ $implicit: formlayoutadd }"
    ></ng-container>
  </ng-template>
  <ng-template #tabCustomFieldDetail>
    <ng-container
    [ngTemplateOutlet]="body"
    [ngTemplateOutletContext]="{ $implicit: formlayoutadd }"
  ></ng-container>
  </ng-template>

  <ng-template #tabGeneralContactDetail>
    <ng-container
      [ngTemplateOutlet]="body"
      [ngTemplateOutletContext]="{ $implicit: formlayoutadd }"
    ></ng-container>
  </ng-template>
</ng-container>
<ng-template #subHeader let-form>
   <codx-tag
     field="tags"
     [entityName]="dialog.formModel.entityName"
     [isEdit]="true"
     [disabled]="false"
     [value]="deal?.tags"
     (valueChange)="valueTagChange($event)"
   ></codx-tag>
 </ng-template>
 <ng-template #body let-form>
   <div class="row">
     <div class="col-6">
       <div class="form-group">
        <codx-label
          [formModel]="dialog.formModel"
          fiedName="contractID"
          default="Mã hợp đồng"
        >
        </codx-label>
        <codx-input
              [formModel]="dialog.formModel"
              field="contractID"
              type="text"
              [crrValue]="contracts?.contractID"
              [placeholder]="
                planceHolderAutoNumber ?? grvSetup['ContractID'].headerText
              "
              [disabled]="disabledShowInput || action === 'edit'"
            >
            </codx-input>
       </div>
     </div>
 
     <div class="col-6">
       <div class="form-group">
         <codx-label
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           fiedName="BusinessLineID"
         >
         </codx-label>
         <div *ngIf="deal?.businessLineID && isViewAll; else viewAll">
           <codx-input
             [formModel]="form.formModel"
             field="businessLineID"
             [crrValue]="deal?.businessLineID"
             [disabled]="deal?.processID || action === actionEdit"
             [model]="{ ProcessID: deal?.processID }"
             (valueChange)="valueChangeBusinessLine($event)"
           >
           </codx-input>
         </div>
         <ng-template #viewAll>
           <codx-input
             [formModel]="form.formModel"
             field="businessLineID"
             [disabled]="action === actionEdit"
             [crrValue]="deal?.businessLineID"
             (valueChange)="valueChangeBusinessLine($event)"
           >
           </codx-input>
         </ng-template>
       </div>
     </div>
   </div>
   <div class="row">
     <div class="col-6">
       <div class="form-group">
         <codx-label
           fiedName="CustomerID"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
         >
         </codx-label>
         <codx-input
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           field="customerID"
           [refValue]="'CMCustomers'"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
 
     <div class="col-6">
       <div class="form-group">
         <codx-label
           [formModel]="form.formModel"
           fiedName="ChannelID"
           [Group]="form.formGroup"
         >
         </codx-label>
         <codx-input
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           field="channelID"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
   </div>
   <div class="row">
     <div class="col-12">
       <div class="form-group">
         <codx-label
           fiedName="DealName"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
         >
         </codx-label>
         <codx-input
           [formModel]="form.formModel"
           [crrValue]="deal.dealName"
           [placeholder]="gridViewSetup?.DealName?.description"
           field="dealName"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
   </div>
   <div class="row">
     <div class="col-6">
       <div class="form-group">
         <codx-label
           fiedName="DealValue"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
         >
         </codx-label>
             <codx-input
               type="number"
               field="dealValue"
               [min]="0"
               [crrValue]="deal?.dealValue"
               (valueChange)="valueChange($event)"
             >
             </codx-input>
       </div>
     </div>
 
     <div class="col-6">
       <div class="form-group">
         <codx-label
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           fiedName="ExpectedClosed"
         >
         </codx-label>
         <codx-input
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           field="expectedClosed"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
   </div>
   <div class="row">
     <div class="col-6">
       <div class="form-group">
         <codx-label
           fiedName="SalespersonID"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
         >
         </codx-label>
         <ejs-combobox
           [dataSource]="listParticipants"
           (valueChange)="valueChangeOwner($event)"
           [fields]="fieldCbxParticipants"
           [placeholder]="gridViewSetup?.SalespersonID?.description"
           [allowFiltering]="true"
           [filterType]="'Contains'"
           [value]="owner"
         ></ejs-combobox>
 
       </div>
     </div>
     <div class="col-6">
       <div class="form-group">
         <codx-label
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           fiedName="ConsultantID"
         >
         </codx-label>
         <codx-input
           field="consultantID"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
 
   </div>
   <div class="row">
     <div class="col-6">
       <div class="form-group">
         <codx-label
           fiedName="Industries"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
         >
         </codx-label>
         <codx-input
           [formModel]="form.formModel"
           [crrValue]="deal?.industries"
           field="industries"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
 
   </div>
 
   <div class="row">
     <div class="col-12">
       <div class="form-group">
         <codx-label
           fiedName="Note"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
         >
         </codx-label>
         <codx-input
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           field="note"
           [crrValue]="deal?.note"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
   </div>
   <div class="row">
     <div class="col-12">
       <div class="form-group">
         <codx-label
           fiedName="Memo"
           [formModel]="form.formModel"
           [Group]="form.formGroup"
         >
         </codx-label>
         <codx-input
           [formModel]="form.formModel"
           [Group]="form.formGroup"
           field="memo"
           [crrValue]="deal?.memo"
           (valueChange)="valueChange($event)"
         >
         </codx-input>
       </div>
     </div>
   </div>
 </ng-template>
 
 <ng-template #footer let-form>
   <div class="d-flex justify-content-between">
     <div></div>
     <button
       type="button"
       button
       class="btn btn-primary ms-1"
       (click)="saveOpportunity()"
     >
       <codx-label default="Lưu"></codx-label>
     </button>
   </div>
 </ng-template>
 
 <ng-template #fieldDetail let-form>
   <h1>Thuận</h1>
 </ng-template>
 
 <ng-template #dataIsEmpty>
   <codx-no-data> </codx-no-data>
 </ng-template>
 
 <ng-template #contact>
   <h1>Thuận 2</h1>
 </ng-template>
 