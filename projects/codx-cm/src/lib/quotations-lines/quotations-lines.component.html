<ng-container *ngIf="!isViewTemp">
  <div class="h-100 p-3">
    <codx-gridview-v2
      #gridQuationsLines
      service="CM"
      [formName]="fmQuotationLines.formName"
      [gridViewName]="fmQuotationLines.gridViewName"
      [entityName]="fmQuotationLines.entityName"
      [templateMore]="morefunction"
      [allowFiltering]="true"
      [allowSorting]="true"
      [dataSource]="listQuotationLines"
      [autoLoad]="false"
      rowHeight="50"
      predicates="TransID=@0"
      [dataValues]="transID"
      (cellChanged)="quotationsLineChanged($event)"
      (created)="gridCreated($event, gridQuationsLines)"
    ></codx-gridview-v2>
  </div>
  <div class="d-flex" *ngIf="showButtonAdd">
    <button
      type="button"
      class="btn btn-clean btn-sm btn-icon btn-icon-md p-5"
      (click)="addPopup()"
    >
      <i class="icon-add_box icon-24 text-primary"></i>
    </button>
    <button class="btn btn-light-primary" (click)="addRow()">
      <codx-label name="AddLines" default="Thêm dòng"></codx-label>
    </button>
  </div>
  <!-- //  [editSettings]="editSettings"  [columnsGrid]="columnsGrid" không dung de cho nó ok roi dung line-->
  <ng-template #morefunction let-data>
    <div class="" style="height: 30px">
      <codx-mfunc
        [dataItem]="data"
        [formModel]="fmQuotationLines"
        type="view"
        [isBookMark]="false"
        (clickMF)="clickMFQuotationLines($event, data)"
      ></codx-mfunc>
    </div>
  </ng-template>

  <!-- tem grid -->
  <ng-template #itemTemp let-data>
    <div class="d-flex align-items-center me-5 mb-1">
      <span
        class="fw-bold line-clamp line-clamp-2"
        #itemID
        [innerHTML]="
          data?.itemID
            | formatvalue
              : formModel
              : 'itemID'
              : itemID
              : fmQuotationLines.formName
              : fmQuotationLines.gridViewName
            | async
        "
      ></span>
    </div>
    <div class="d-flex flex-wrap text-nowrap">
      <div class="d-flex align-items-center mb-1 me-6">
        <!-- <span class="icon-i-dot icon-22"></span> -->
        <codx-label
          class="text-dark fw-bold label-colon"
          fiedName="IDIM0"
          [formName]="fmQuotationLines.formName"
          [gridViewName]="fmQuotationLines.gridViewName"
        >
        </codx-label>
        <span
          class="text-dark"
          #idiM0
          [innerHTML]="
            data?.idiM0
              | formatvalue
                : formModel
                : 'idiM0'
                : idiM0
                : fmQuotationLines.formName
                : fmQuotationLines.gridViewName
              | async
          "
        ></span>
      </div>

      <div class="d-flex align-items-center mb-1 me-6">
        <!-- <span class="icon-i-dot icon-22"></span> -->
        <codx-label
          class="text-dark fw-bold label-colon"
          fiedName="IDIM1"
          [formName]="fmQuotationLines.formName"
          [gridViewName]="fmQuotationLines.gridViewName"
        >
        </codx-label>
        <span
          class="text-dark"
          #idiM1
          [innerHTML]="
            data?.idiM1
              | formatvalue
                : formModel
                : 'idiM1'
                : idiM1
                : fmQuotationLines.formName
                : fmQuotationLines.gridViewName
              | async
          "
        ></span>
      </div>

      <div class="d-flex align-items-center mb-1 me-6">
        <!-- <span class="icon-i-dot icon-22"></span> -->
        <codx-label
          class="text-dark fw-bold label-colon"
          fiedName="IDIM2"
          [formName]="fmQuotationLines.formName"
          [gridViewName]="fmQuotationLines.gridViewName"
        >
        </codx-label>
        <span
          class="text-dark"
          #idiM2
          [innerHTML]="
            data?.idiM2
              | formatvalue
                : formModel
                : 'idiM2'
                : idiM2
                : fmQuotationLines.formName
                : fmQuotationLines.gridViewName
              | async
          "
        ></span>
      </div>

      <div class="d-flex align-items-center mb-1 me-6">
        <!-- <span class="icon-i-dot icon-22"></span> -->
        <codx-label
          class="text-dark fw-bold label-colon"
          fiedName="IDIM3"
          [formName]="fmQuotationLines.formName"
          [gridViewName]="fmQuotationLines.gridViewName"
        >
        </codx-label>
        <span
          class="text-dark"
          #idiM3
          [innerHTML]="
            data?.idiM3
              | formatvalue
                : formModel
                : 'idiM3'
                : idiM3
                : fmQuotationLines.formName
                : fmQuotationLines.gridViewName
              | async
          "
        ></span>
      </div>

      <div class="d-flex align-items-center mb-1 me-6">
        <!-- <span class="icon-i-dot icon-22"></span> -->
        <codx-label
          class="text-dark fw-bold label-colon"
          fiedName="IDIM4"
          [formName]="fmQuotationLines.formName"
          [gridViewName]="fmQuotationLines.gridViewName"
        >
        </codx-label>

        <span
          class="text-dark"
          #idiM4
          [innerHTML]="
            data?.idiM4
              | formatvalue
                : formModel
                : 'idiM4'
                : idiM4
                : fmQuotationLines.formName
                : fmQuotationLines.gridViewName
              | async
          "
        ></span>
      </div>
    </div>
  </ng-template>
</ng-container>

<ng-container *ngIf="isViewTemp">
  <div class="table-responsive mt-2">
    <table class="table table-hover table-row-bordered">
      <thead style="position: sticky; top: 0">
        <tr class="border-bottom">
          <th class="w-50 min-w-350px">
            <div class="d-flex">
              <!-- <i class="icon-i-box icon-16 me-2"></i> -->
              <codx-label
                class="fw-bold line-clamp line-clamp-1 text-dark codx-label"
                fiedName="ItemID"
                [formModel]="fmQuotationLines"
              >
              </codx-label>
            </div>
          </th>
          <th class="min-w-100px">
            <div class="d-flex">
              <!-- <i class="icon-i-bar-chart icon-16 me-2"></i> -->
              <codx-label
                class="fw-bold line-clamp line-clamp-1 text-dark codx-label"
                fiedName="umid"
                [formModel]="fmQuotationLines"
              >
              </codx-label>
            </div>
          </th>
          <th class="min-w-100px">
            <div class="d-flex">
              <!-- <i class="icon-i-bar-chart icon-16 me-2"></i> -->
              <codx-label
                class="fw-bold line-clamp line-clamp-1 text-dark codx-label"
                fiedName="Quantity"
                [formModel]="fmQuotationLines"
              >
              </codx-label>
            </div>
          </th>
          <th class="min-w-125px">
            <div class="d-flex">
              <!-- <i class="icon-payments icon-16 me-2"></i> -->
              <codx-label
                class="fw-bold line-clamp line-clamp-1 text-dark codx-label"
                fiedName="SalesPrice"
                [formModel]="fmQuotationLines"
              >
              </codx-label>
            </div>
          </th>
          <th class="min-w-125px">
            <div class="d-flex">
              <!-- <i class="icon-i-cash-stack icon-16 me-2"></i> -->
              <codx-label
                class="fw-bold line-clamp line-clamp-1 text-dark codx-label"
                fiedName="NetAmt"
                [formModel]="fmQuotationLines"
              >
              </codx-label>
            </div>
          </th>
          <th class="min-w-150px">
            <div class="d-flex">
              <!-- <i class="icon-analytics icon-16 me-2"></i> -->
              <codx-label
                class="fw-bold line-clamp line-clamp-1 text-dark codx-label"
                fiedName="VATID"
                [formModel]="fmQuotationLines"
              >
              </codx-label>
            </div>
          </th>
          <th class="min-w-125px">
            <div class="d-flex">
              <!-- <i class="icon-i-cash icon-16 me-2"></i> -->
              <codx-label
                class="fw-bold line-clamp line-clamp-1 text-dark codx-label"
                fiedName="VATAmt"
                [formModel]="fmQuotationLines"
              >
              </codx-label>
            </div>
          </th>
        </tr>
      </thead>
      <tbody *ngFor="let item of listQuotationLines">
        <!-- | slice : (page - 1) * pageSize : page * pageSize -->
        <tr>
          <td>
            <div class="d-flex align-items-center me-5 mb-1">
              <span
                class="fw-bold line-clamp line-clamp-2"
                [innerHTML]="
                  item.itemID
                    | formatvalue : fmQuotationLines : 'itemID'
                    | async
                "
              ></span>
            </div>
            <div class="d-flex flex-wrap text-nowrap">
              <div class="d-flex align-items-center mb-1 me-6">
                <!-- <span class="icon-i-dot icon-22"></span> -->
                <codx-label
                  class="text-dark fw-bold label-colon"
                  fiedName="IDIM0"
                  [formModel]="fmQuotationLines"
                >
                </codx-label>
                <span
                  class="text-dark"
                  [innerHTML]="
                    item.idiM0
                      | formatvalue : fmQuotationLines : 'idiM0'
                      | async
                  "
                ></span>
              </div>

              <div class="d-flex align-items-center mb-1 me-6">
                <!-- <span class="icon-i-dot icon-22"></span> -->
                <codx-label
                  class="text-dark fw-bold label-colon"
                  fiedName="IDIM1"
                  [formModel]="fmQuotationLines"
                >
                </codx-label>
                <span
                  class="text-dark"
                  [innerHTML]="
                    item.idiM1
                      | formatvalue : fmQuotationLines : 'idiM1'
                      | async
                  "
                ></span>
              </div>

              <div class="d-flex align-items-center mb-1 me-6">
                <!-- <span class="icon-i-dot icon-22"></span> -->
                <codx-label
                  class="text-dark fw-bold label-colon"
                  fiedName="IDIM2"
                  [formModel]="fmQuotationLines"
                >
                </codx-label>
                <span
                  class="text-dark"
                  [innerHTML]="
                    item.idiM2
                      | formatvalue : fmQuotationLines : 'idiM2'
                      | async
                  "
                ></span>
              </div>
              <div class="d-flex align-items-center mb-1 me-6">
                <!-- <span class="icon-i-dot icon-22"></span> -->
                <codx-label
                  class="text-dark fw-bold label-colon"
                  fiedName="IDIM3"
                  [formModel]="fmQuotationLines"
                >
                </codx-label>
                <span
                  class="text-dark"
                  [innerHTML]="
                    item.idiM3
                      | formatvalue : fmQuotationLines : 'idiM3'
                      | async
                  "
                ></span>
              </div>
              <div class="d-flex align-items-center mb-1 me-6">
                <!-- <span class="icon-i-dot icon-22"></span> -->
                <codx-label
                  class="text-dark fw-bold label-colon"
                  fiedName="IDIM4"
                  [formModel]="fmQuotationLines"
                >
                </codx-label>

                <span
                  #idiM4
                  class="text-dark"
                  [innerHTML]="
                    item.idiM4
                      | formatvalue : fmQuotationLines : 'idiM4' : idiM4
                      | async
                  "
                ></span>
              </div>
            </div>
            <div class="d-flex flex-wrap text-nowrap">
              <div class="d-flex align-items-center mb-1 me-6">
                <!-- <span class="icon-i-dot icon-22"></span> -->
                <codx-label
                  class="text-dark fw-bold label-colon"
                  fiedName="Onhand"
                  [formModel]="fmQuotationLines"
                >
                </codx-label>
                <span
                  class="text-dark"
                  [innerHTML]="
                    item.onhand
                      | formatvalue : fmQuotationLines : 'onhand'
                      | async
                  "
                ></span>
              </div>
              <div class="d-flex align-items-center mb-1 me-6">
                <codx-label
                  class="text-dark fw-bold label-colon"
                  fiedName="CostPrice"
                  [formModel]="fmQuotationLines"
                >
                </codx-label>
                <span
                  class="text-dark"
                  [innerHTML]="
                    item.costPrice
                      | formatvalue : fmQuotationLines : 'costPrice'
                      | async
                  "
                ></span>
              </div>
            </div>
          </td>
          <td>
            <span
              class="text-nowrap"
              [innerHTML]="
                item?.umid
                  | formatvalue : fmQuotationLines : 'umid'
                  | async
              "
            ></span>
          </td>
          <td>
            <span
              class="text-nowrap"
              [innerHTML]="
                item?.quantity
                  | formatvalue : fmQuotationLines : 'quantity'
                  | async
              "
            ></span>
          </td>
          <td>
            <span
              class="text-nowrap"
              [innerHTML]="
                item?.salesPrice
                  | formatvalue : fmQuotationLines : 'salesPrice'
                  | async
              "
            ></span>
          </td>
          <td>
            <span
              class="text-nowrap"
              [innerHTML]="
                item?.netAmt | formatvalue : fmQuotationLines : 'netAmt' | async
              "
            ></span>
          </td>
          <td>
            <span
              #vatid
              class="text-gray-600 text-italic"
              [innerHTML]="
                item?.vatid
                  | formatvalue : fmQuotationLines : 'vatid' : vatid
                  | async
              "
            ></span>
          </td>
          <td>
            <span
              class="text-nowrap"
              [innerHTML]="
                item?.vatAmt | formatvalue : fmQuotationLines : 'vatAmt' | async
              "
            ></span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</ng-container>
