<ng-container *ngIf="dataSelected?.recID">
  <codx-detail-tmp
    [header]="header"
    [formModel]="formModel"
    [body]="body"
    [dataItem]="dataSelected"
    [hideMF]="true"
    [footer]="tabs"
    (changeDataMF)="changeDataMF($event, dataSelected)"
    (clickMF)="clickMF($event, dataSelected)"
  >
    <ng-template #tooltipDealName>
      <div class="text-end text-sm-start">
        <strong>{{ gridViewSetup["DealName"]?.headerText }}</strong
        >: {{ dataSelected?.dealName }}
      </div>
    </ng-template>
    <ng-template #toolTipDealValue>
      <div class="text-end text-sm-start">
        <strong>{{ gridViewSetup["DealValue"]?.headerText }}</strong
        >: {{ dataSelected?.dealValue }}
      </div>
    </ng-template>
    <!-- <ng-template #toolTipProbability>
      <div class="text-end text-sm-start">
        <strong>{{ gridViewSetup["Probability"]?.headerText }}</strong
        >: {{ dataSelected?.probability }}
      </div>
    </ng-template> -->
    <ng-template #header let-data>
      <div class="d-flex align-items-center justify-content-between">
        <div
          class="d-flex align-items-center mb-2"
          [ngbTooltip]="gridViewSetup['BusinessLineID']?.headerText"
        >
          <i class="icon-add_shopping_cart icon-18 me-2 text-gray-700"></i>
          <span
            class="text-dark fs-6 fw-bold line-clamp line-clamp-1"
            #businessLineID
            [innerHTML]="
              dataSelected?.businessLineID
                | formatvalue
                  : formModel
                  : 'businessLineID'
                  : businessLineID
                  : 'CMDeals'
                  : 'grvCMDeals'
                | async
            "
          ></span>
        </div>
        <div class="toolbar-detail" *ngIf="asideMode != '2'">
          <codx-mfunc
            [hideMF]="false"
            [dataItem]="dataSelected"
            [formModel]="formModel"
            (changeDataMF)="changeDataMF($event, dataSelected)"
            (clickMF)="clickMF($event, dataSelected)"
            [isBookMark]="true"
            type="view"
          ></codx-mfunc>
        </div>
      </div>

      <div class="container_detail mt-1">
        <div class="d-flex justify-content-between mb-2">
          <div class="d-flex flex-column w-100">
            <div class="d-flex align-items-center">
              <div class="me-4">
                <codx-img
                  [objectId]="dataSelected?.customerID"
                  [objectName]="dataSelected?.customerName"
                  [imgOn]="dataSelected?.modifiedOn"
                  [objectType]="'CM_Customers'"
                  [referType]="'avt'"
                  [width]="40"
                >
                </codx-img>
              </div>
              <div class="d-flex flex-column">
                <div class="text-gray-600 d-flex cursor-pointer has-action-menu-od" >
                  <span [ngbTooltip]="gridViewSetup?.CustomerName?.headerText">
                    {{ dataSelected.customerName }}
                  </span>
                  <div
                      class="action-menu-od ms-1"
                      (click)="editCustomer(dataSelected)"
                    >
                      <i class="icon-edit text-danger icon-16"></i>
                    </div>
                </div>
                <div
                  class="fw-bold text-dark fs-5-sm"
                  [ngbTooltip]="tooltipDealName"
                  #dealName
                  [innerHTML]="
                    dataSelected?.dealName
                      | formatvalue : formModel : 'dealName' : dealName
                      | async
                  "
                ></div>
              </div>
            </div>
          </div>
          <div class="ms-3 d-flex justify-content-end w-175px">
            <div class="d-flex flex-column">
              <div class="d-flex justify-content-end">
                <div
                  class="d-flex align-items-center fs-5-sm"
                  [ngbTooltip]="toolTipDealValue"
                >
                  <span
                    class="icon-monetization_on pe-1 text-warning icon-18"
                  ></span>
                  <span
                    class="fw-bold pe-1"
                    *ngIf="dataSelected?.dealValue; else defaultNull"
                    #dealValue
                    [innerHTML]="
                      dataSelected?.dealValue
                        | formatvalue : formModel : 'dealValue' : dealValue
                        | async
                    "
                  ></span>
                  <span
                    *ngIf="dataSelected?.currencyID"
                    [ngClass]="dataSelected?.currencyID ? '' : 'fs-6'"
                    class="text-gray-500"
                    [ngbTooltip]="gridViewSetup['CurrencyID']?.headerText"
                    #currencyID
                    [innerHTML]="
                      dataSelected?.currencyID
                        | formatvalue : formModel : 'currencyID'
                        | async
                    "
                  ></span>
                </div>
              </div>
              <div class="d-flex align-items-center justify-content-end mt-1">
                <!-- <div
                  class="d-flex align-items-center"
                  [ngbTooltip]="gridViewSetup?.Probability?.headerText"
                >
                  <span
                    class="icon-check_circle text-green icon-14 me-1"
                  ></span>
                  <span
                    *ngIf="dataSelected?.probability; else defaultNull"
                    class="line-clamp line-clamp-1"
                    [ngbTooltip]="gridViewSetup?.Probability?.headerText"
                    #probability
                    [innerHTML]="
                      dataSelected?.probability
                        | formatvalue : formModel : 'probability' : probability
                        | async
                    "
                  ></span
                  >%
                </div> -->
                <span
                  [ngClass]="
                    dataSelected?.expectedClosed
                      ? 'text-gray-600 ms-3'
                      : 'text-gray-600 ms-3 line-clamp line-clamp-1'
                  "
                  #expectedClosed
                  [ngbTooltip]="gridViewSetup?.ExpectedClosed?.headerText"
                  [innerHTML]="
                    dataSelected?.expectedClosed
                      | formatvalue
                        : formModel
                        : 'expectedClosed'
                        : expectedClosed
                      | async
                  "
                ></span>
              </div>
            </div>
          </div>
        </div>

        <div class="d-flex align-items-top justify-content-between">
          <div class="w-100 d-flex flex-column">
            <div class="d-flex align-items-top justify-content-between">
              <div class="w-100 d-flex flex-column">
                <div class="d-flex align-items-top mb-1">
                  <codx-label
                    fiedName="Industries"
                    class="text-dark fw-bold me-2"
                    [setRequire]="false"
                    [formModel]="formModel"
                    default="Lĩnh vực hoạt động"
                  ></codx-label>
                  <span
                    class="text-gray-600"
                    #industries
                    [innerHTML]="
                      dataSelected?.industries
                        | formatvalue : formModel : 'industries' : industries
                        | async
                    "
                  ></span>
                </div>
                <div class="d-flex align-items-top justify-content-start">
                  <codx-label
                    fiedName="Note"
                    class="text-dark fw-bold me-2"
                    [setRequire]="false"
                    [formModel]="formModel"
                    class="text-dark fw-bold me-2 text-nowrap"
                  ></codx-label>

                  <!-- <span
                    class="text-gray-600"
                    #note
                    [innerHTML]="
                      dataSelected?.note
                        | formatvalue
                          : formModel
                          : 'note'
                          : note
                          : 'CMDeals'
                          : 'grvCMDeals'
                        | async
                    "
                  ></span> -->
                  <codx-show-more-less
                    [formModel]="formModel"
                    [value]="dataSelected?.note"
                    [text]="'note'"
                  >
                  </codx-show-more-less>
                </div>
                <div class="" *ngIf="viewTag && viewTag != ''">
                  <codx-tag
                    [entityName]="formModel.entityName"
                    [disabled]="true"
                    [isEdit]="false"
                    [value]="viewTag"
                  >
                  </codx-tag>
                </div>
                <div class="d-flex flex-wrap align-items-top mb-1 mt-2">
                  <div class="d-flex flex-column">
                    <div class="mb-1">
                      <codx-label
                        name="lblContact"
                        [formModel]="formModel"
                        class="text-dark fw-bold label-colon"
                        default="Liên hệ chính"
                      ></codx-label>
                    </div>
                    <div class="d-flex align-items-start">
                      <div class="me-3">
                        <codx-img
                          [objectId]="contactPerson?.recID"
                          [objectName]="contactPerson?.contactName"
                          [imgOn]="contactPerson?.modifiedOn"
                          [objectType]="'CM_Contacts'"
                          [width]="50"
                        >
                        </codx-img>
                      </div>
                      <div class="d-flex flex-column">
                        <div
                          *ngIf="contactPerson?.contactName"
                          class="fw-bold text-dark fs-6"
                          #contactName
                          [innerHTML]="
                            contactPerson?.contactName
                              | formatvalue
                                : formModelContact
                                : 'contactName'
                                : contactName
                              | async
                          "
                        ></div>
                        <div class="fs-7 text-gray-600">
                          <div
                            #role
                            *ngIf="contactPerson?.role"
                            [innerHTML]="
                              contactPerson?.role
                                | formatvalue : formModelContact : 'role' : role
                                | async
                            "
                          ></div>
                        </div>
                        <div class="d-flex align-items-start">
                          <div
                            class="d-flex align-items-center me-3"
                            *ngIf="contactPerson?.mobile"
                          >
                            <div
                              class="text-gray-600 fs-7"
                              #mobile
                              [innerHTML]="
                                contactPerson?.mobile
                                  | formatvalue
                                    : formModelContact
                                    : 'mobile'
                                    : mobile
                                  | async
                              "
                            ></div>
                          </div>
                          <div
                            class="d-flex align-items-center"
                            *ngIf="contactPerson?.personalEmail"
                          >
                            <div
                              class="text-gray-600 fs-7"
                              #personalEmail
                              [innerHTML]="
                                contactPerson?.personalEmail
                                  | formatvalue
                                    : formModelContact
                                    : 'personalEmail'
                                    : personalEmail
                                  | async
                              "
                            ></div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-auto min-w-200px d-flex flex-column">
                <div class="d-flex flex-column">
                  <div
                    class="mb-1 d-flex align-items-center justify-content-end"
                  >
                    <div
                      *ngIf="dataSelected?.statusCodeID"
                      class="badge badge-sm d-flex align-items-center me-0 color-theme me-1"
                    >
                      <!-- <span
                    class="text-ellipsis-1"
                    [ngbTooltip]="getStatusCode(dataSelected?.statusCodeID)"
                    > {{getStatusCode(dataSelected?.statusCodeID)}}</span
                  > -->
                      <!-- <span
                        class="text-ellipsis-1"
                        [ngbTooltip]="
                          dataSelected?.statusCodeID
                            | formatStatusCode : valueListStatusCode
                        "
                        [innerHTML]="
                          dataSelected?.statusCodeID
                            | formatStatusCode : valueListStatusCode
                        "
                      ></span> -->
                      <span
                      class="text-ellipsis-1"
                      #statusCodeID
                      [innerHTML]="dataSelected?.statusCodeID| formatvalue : formModel : 'statusCodeID'  | async "
                    >
                    </span>
                    </div>

                    <div
                      *ngIf="
                        dataSelected.status == '2' && stepCurrent;
                        else statusDefault
                      "
                      [ngStyle]="{
                        'background-color': stepCurrent?.backgroundColor
                      }"
                      class="badge badge-sm d-flex align-items-center me-0"
                    >
                      <span
                        [ngClass]="stepCurrent?.icon"
                        [ngStyle]="{
                          color: stepCurrent?.iconColor
                        }"
                        class="me-1"
                      ></span>
                      <span
                        class="text-ellipsis line-clamp line-clamp-2"
                        [ngbTooltip]="stepCurrent?.stepName"
                        [ngStyle]="{
                          color: stepCurrent.textColor
                        }"
                        >{{ stepCurrent?.stepName }}</span
                      >
                    </div>
                    <ng-template #statusDefault>
                      <codx-vll
                        [name]="gridViewSetup?.Status?.referedValue"
                        [field]="'Status'"
                        [value]="dataSelected?.status"
                        [showText]="true"
                        [showBgColor]="true"
                        class="badge badge-light badge-sm me-0"
                      >
                      </codx-vll>
                    </ng-template>
                    <ng-container
                      *ngIf="
                        dataSelected?.approveStatus &&
                        dataSelected?.approveStatus != '1'
                      "
                    >
                      <codx-vll
                        [name]="gridViewSetup?.ApproveStatus.referedValue"
                        [field]="'ApproveStatus'"
                        [value]="dataSelected?.approveStatus"
                        [showText]="true"
                        [showBgColor]="true"
                        class="badge badge-primary badge-sm cursor-pointer"
                        [ngbTooltip]="approve"
                        placement="top"
                      >
                      <ng-template #approve>
                        <codx-label
                          fiedName="approvedDate"
                          [formModel]="formModel"
                          [setRequire]="false"
                          default="Ngày duyệt"
                          class="label-colon me-1"
                        ></codx-label>
                        <span  [innerHTML]="dataSelected?.approvedDate
                          | formatvalue : formModel : 'approvedDate'
                          | async"
                        ></span>
                      </ng-template>
                      </codx-vll>
                    </ng-container>
                  </div>
                  <ng-template #tooltipSalesperson>
                    <div class="d-flex justify-content-center fw-bold fs-6">
                      <span
                        #salespersonID
                        [innerHTML]="
                          dataSelected?.salespersonID
                            | formatvalue
                              : formModel
                              : 'salespersonID'
                              : salespersonID
                            | async
                        "
                      ></span>
                    </div>
                    <div class="d-flex justify-content-center">
                      {{ gridViewSetup["SalespersonID"]?.headerText }}
                    </div>
                  </ng-template>
                  <ng-template #tooltipConsultant>
                    <div class="d-flex justify-content-center fw-bold fs-6">
                      <span
                        #consultantID
                        [innerHTML]="
                          dataSelected?.consultantID
                            | formatvalue
                              : formModel
                              : 'consultantID'
                              : consultantID
                            | async
                        "
                      ></span>
                    </div>
                    <div class="d-flex justify-content-center">
                      {{ gridViewSetup?.ConsultantID?.headerText }}
                    </div>
                  </ng-template>
                  <div
                    class="d-flex flex-column align-items-top"
                    style="margin-top: 1.5rem !important"
                  >
                    <div class="d-flex justify-content-end">
                      <codx-label
                        default="Bán hàng/Tư vấn"
                        class="text-dark fw-bold mb-2"
                      ></codx-label>
                    </div>
                    <div class="d-flex justify-content-end">
                      <div
                        style="position: relative"
                        [ngbTooltip]="tooltipSalesperson"
                        *ngIf="dataSelected?.salespersonID"
                      >
                        <codx-img
                          [width]="30"
                          [objectId]="dataSelected?.salespersonID"
                          objectType="AD_Users"
                          [referType]="'avt'"
                          [numberImages]="1"
                        >
                        </codx-img>
                        <div
                          style="position: absolute; right: 0px; bottom: 0px"
                        >
                          <span
                            ><img
                              src="/assets/themes/cm/default/img/{{
                                getIcon('3')
                              }}"
                              alt=""
                          /></span>
                        </div>
                      </div>
                      <div
                        style="position: relative"
                        [ngbTooltip]="tooltipConsultant"
                        *ngIf="dataSelected?.consultantID"
                      >
                        <codx-imgs
                          [width]="30"
                          [objectId]="dataSelected?.consultantID"
                          ojectType="AD_Users"
                          [numberImages]="1"
                          [isToolTip]="false"
                        >
                        </codx-imgs>
                        <div
                          style="position: absolute; right: 0px; bottom: 0px"
                        >
                          <span
                            ><img
                              src="/assets/themes/cm/default/img/{{
                                getIcon('5')
                              }}"
                              alt=""
                          /></span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-template>
  </codx-detail-tmp> </ng-container
><ng-template #body let-data>
  <div class="cm-scroll" [ngClass]="isShow ? 'cm-full' : ''">
    <div
      class="btn btn-white btn-icon tab-action"
      (click)="clickShowTab(!isShow)"
    >
      <span class="icon-unfold_more icon-20"></span>
    </div>
    <div class="instance-select">
      <ejs-tab #tabObj>
        <e-tabitems>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-top">
                <span class="icon-info icon-16 me-2"></span>
                <span>
                  <codx-label
                    class="fw-bold"
                    default="Thông tin chung"
                    [formModel]="formModel"
                    name="lblInformation"
                  ></codx-label>
                </span>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="mt-5 p-2" [ngClass]="isShow ? '': 'croll-m-5'" style="overflow-x: hidden !important;">
                <div class="text-dark text-primary fw-bold fs-6 mb-3">
                  <codx-label default="Thông tin chung"></codx-label>
                </div>
                <div class="mb-3">
                  <div class="row">
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label default="Mã cơ hội"></codx-label>:
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          {{ dataSelected?.dealID }}
                        </div>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            fiedName="ChannelID"
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #channelID
                            [innerHTML]="
                              dataSelected?.channelID
                                | formatvalue
                                  : formModel
                                  : 'channelID'
                                  : channelID
                                  : 'CMDeals'
                                  : 'grvCMDeals'
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            fiedName="DealValue"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #dealValue
                            *ngIf="dataSelected?.dealValue; else defaultNull"
                            [innerHTML]="
                              dataSelected?.dealValue
                                | formatvalue
                                  : formModel
                                  : 'dealValue'
                                  : dealValue
                                  : 'CMDeals'
                                  : 'grvCMDeals'
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div>
                    <!-- <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            fiedName="Category"
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            default="Loại cơ hội"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          {{ getNameCategory(dataSelected?.category) }}
                        </div>
                      </div>
                    </div> -->
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            fiedName="CampaignID"
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #campaignID
                            [innerHTML]="
                              dataSelected?.campaignID
                                | formatvalue
                                  : formModel
                                  : 'campaignID'
                                  : campaignID
                                  : 'CMDeals'
                                  : 'grvCMDeals'
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            fiedName="ExpectedClosed"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #expectedClosed
                            [innerHTML]="
                              dataSelected?.expectedClosed
                                | formatvalue
                                  : formModel
                                  : 'expectedClosed'
                                  : expectedClosed
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            fiedName="ConsultantID"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #consultantID
                            [innerHTML]="
                              dataSelected?.consultantID
                                | formatvalue
                                  : formModel
                                  : 'consultantID'
                                  : consultantID
                                  : 'CMDeals'
                                  : 'grvCMDeals'
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <!-- <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            fiedName="Probability"
                          ></codx-label>
                        </div>
                        <div
                          class="text-dark fw-bold codx-textcontent d-flex justify-content-start"
                        >
                          <span
                            #probability
                            *ngIf="dataSelected?.probability; else defaultNull"
                            [innerHTML]="
                              dataSelected?.probability
                                | formatvalue
                                  : formModel
                                  : 'probability'
                                  : probability
                                | async
                            "
                          ></span
                          >%
                        </div>
                      </div>
                    </div> -->
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            fiedName="SalespersonID"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #salespersonID
                            [innerHTML]="
                              dataSelected?.salespersonID
                                | formatvalue
                                  : formModel
                                  : 'salespersonID'
                                  : salespersonID
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            fiedName="CreatedOn"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #createdOn
                            [innerHTML]="
                              dataSelected?.createdOn
                                | formatvalue
                                  : formModel
                                  : 'createdOn'
                                  : createdOn
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <!-- <div class="col-6">
                      <div class="mb-1 d-flex align-items-top">
                        <div
                          class="w-150px min-w-150px text-gray-600 codx-textlabel"
                        >
                          <codx-label
                            class="me-2 label-colon"
                            [setRequire]="false"
                            [formModel]="formModel"
                            fiedName="ExpectedTo"
                          ></codx-label>
                        </div>
                        <div class="text-dark fw-bold codx-textcontent">
                          <span
                            #expectedTo
                            [innerHTML]="
                              dataSelected?.expectedTo
                                | formatvalue
                                  : formModel
                                  : 'expectedTo'
                                  : expectedTo
                                  : 'CMDeals'
                                  : 'grvCMDeals'
                                | async
                            "
                          ></span>
                        </div>
                      </div>
                    </div> -->
                  </div>
                </div>
                <!-- <div class="mt-5">
                  <div class="text-dark text-primary fw-bold fs-6 mb-3">
                    <codx-label
                      fiedName="Memo"
                      [setRequire]="false"
                      [formModel]="formModel"
                    ></codx-label>
                  </div>
                  <codx-show-more-less
                    [formModel]="formModel"
                    [value]="dataSelected?.memo"
                    [text]="'memo'"
                  >
                  </codx-show-more-less>
                </div> -->
                <div *ngIf="isHaveField">
                  <div class="d-flex flex-column mt-5">
                    <ng-container *ngFor="let item of listSteps">
                      <codx-fields-detail-temp
                        *ngIf="item?.fields?.length > 0"
                        [dataStep]="item"
                        [showColumnControl]="showColumnControl(item.stepID)"
                        [isUpdate]="
                          ['1', '2', '15'].includes(dataSelected.status) &&
                          !dataSelected.closed
                        "
                        [objectIdParent]="dataSelected.recID"
                        [customerID]="dataSelected.customerID"
                        (saveDataStep)="saveDataStep($event)"
                      >
                      </codx-fields-detail-temp>
                    </ng-container>
                  </div>
                </div>
              </div>
            </ng-template>
          </e-tabitem>
          <!-- <e-tabitem *ngIf="dataSelected?.steps?.isHaveField">
          <ng-template #headerText>
            <div class="d-flex align-items-top">
              <span class="icon-add_to_photos icon-16 me-1"></span>
              <codx-label
                class="fw-bold"
                default="Trường tùy chỉnh"
                [formModel]="formModel"
                name="lblField"
              ></codx-label>
            </div>
          </ng-template>
          <ng-template #content>y
            <div class="d-flex flex-column mt-4">
              <ng-container *ngFor="let item of listSteps">
                <codx-fields-detail-temp
                  *ngIf="item?.fields?.length > 0"
                  [dataStep]="item"
                  [showColumnControl]="showColumnControl(item.stepID)"
                  [isUpdate]=" ['1', '2'].includes(dataSelected.status) && dataSelected?.roles?.isOnwer"
                  (saveDataStep)="saveDataStep($event)"
                >
                </codx-fields-detail-temp>
              </ng-container>
            </div>
          </ng-template>
          </e-tabitem> -->
          <e-tabitem *ngIf="dataSelected.customerCategory == '1'">
            <ng-template #headerText>
              <div class="d-flex align-items-top">
                <span class="icon-add_to_photos icon-16 me-1"></span>
                <codx-label
                  class="fw-bold"
                  default="Liên hệ"
                  [formModel]="formModel"
                  name="lblContanct"
                ></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="mt-5 p-2" [ngClass]="isShow ? '': 'croll-m-5'" style="overflow-x: hidden !important;">
                <codx-list-contacts
                  #loadContactDeal
                  [selectAll]="false"
                  [funcID]="'CM0205'"
                  [objectID]="dataSelected?.recID"
                  [objectName]="dataSelected.dealName"
                  [customerID]="dataSelected?.customerID"
                  [objectType]="'4'"
                  [type]="'formDetail'"
                  [hidenMF]="!dataSelected?.write || dataSelected?.closed"
                  (contactEvent)="contactChange($event)"
                  (lstContactEmit)="lstContactEmit($event)"
                ></codx-list-contacts>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-top">
                <span class="icon-add_to_photos icon-16 me-1"></span>
                <codx-label
                  class="fw-bold"
                  default="Đối thủ"
                  [formModel]="formModel"
                  name="lblOpponent"
                ></codx-label>
              </div>
            </ng-template>
            <ng-template #content>
              <div class="mt-5 p-2" [ngClass]="isShow ? '': 'croll-m-5'" style="overflow-x: hidden !important;">
                <codx-tab-dealcompetitors
                  [dealID]="dataSelected.recID"
                  [hidenMF]="!dataSelected?.write || dataSelected.closed"
                ></codx-tab-dealcompetitors>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-top">
                <span class="icon-more icon-16 me-2"></span>
                <codx-label
                  class="fw-bold"
                  default="Công việc"
                  [formModel]="formModel"
                  name="lblProcess"
                ></codx-label>
              </div>
            </ng-template>
            <ng-template #content let-data="value">
              <div class="mt-5 p-2" [ngClass]="isShow ? '': 'croll-m-5'" style="overflow-x: hidden !important;">
                <step-task
                  [entityName]="'CM_Deals'"
                  [isDataLoading]="isDataLoading"
                  [dataCM]="dataSelected"
                  [listInstanceStep]="listSteps"
                  [formModel]="formModel"
                  [applyFor]="'1'"
                  (continueStep)="continueStep($event)"
                  (saveAssignTask)="saveAssignTask($event)"
                  (changeProgress)="autoStart($event)"
                  [isChangeOwner]="isChangeOwner"
                  [dealName]="dataSelected?.dealName"
                  [customerName]="customerName"
                  [ownerInstance]="dataSelected?.owner"
                  [taskAdd]="taskAdd"
                  (moveStage)="handelMoveStage($event)"
                  [isAdmin]="dataSelected?.isAdminAll"
                ></step-task>
              </div>

            </ng-template>
          </e-tabitem>
          <e-tabitem>
            <ng-template #headerText>
              <div class="d-flex align-items-top">
                <span class="icon-i-chat-right icon-16 me-2"></span>
                <codx-label
                  class="fw-bold"
                  default="Ghi chú"
                  [formModel]="formModel"
                  name="lblComment"
                ></codx-label>
              </div>
            </ng-template>
            <ng-template #content let-data>
              <div class="tab-comt mt-5 p-2" [ngClass]="isShow ? '': 'croll-m-5'" style="overflow-x: hidden !important;">
                <div class="tab_container">
                  <codx-tree-comment
                    [objectID]="dataSelected.recID"
                    [objectType]="formModel.entityName"
                    [actionType]="'C'"
                    [addNew]="true"
                    [funcID]="formModel.funcID"
                    (totalCommentChange)="changeCountFooter($event, 'comment')"
                  >
                  </codx-tree-comment>
                </div>
              </div>
            </ng-template>
          </e-tabitem>
        </e-tabitems>
      </ejs-tab>
    </div>
  </div>
</ng-template>
<ng-template #tabs let-data>
  <codx-tabs
    [entityName]="formModel.entityName"
    [formModel]="formModel"
    [TabControl]="tabControl"
    [objectID]="dataSelected.recID"
    [funcID]="formModel.funcID"
    [dataTree]="treeTask"
    [transID]="dataSelected?.recID"
    [approveStatus]="dataSelected.approveStatus"
    (tabChange)="changeFooter($event)"
  ></codx-tabs>
</ng-template>

<ng-template #referencesDeal>
  <div *ngIf="isViewLink; else noData">
    <div *ngIf=" listContracts && listContracts.length > 0 ">
      <div *ngFor="let item of listContracts" class="p-3">
        <div class="d-flex justify-content-start">
          <div>
            <i class="icon-sticky_note_2"></i>
          </div>
          <div class="d-flex align-items-stretch">
            <codx-label
              [default]="'Hợp đồng'"
              class="pe-2"
            ></codx-label>
          </div>
          <div
            class="ms-auto line-clamp line-clamp-1 d-flex"
            [ngbTooltip]="grvSetupContract['ContractAmt']?.headerText"
          >
            <span
              class="icon-monetization_on pe-1 text-warning icon-16 mt-1"
            ></span>
            <span
              class="text-gray-700  pe-2"
              #contractAmt
              [innerHTML]="
                item?.contractAmt
                  | formatvalue : formModelContact : 'contractAmt'
                  | async
              "
            ></span>
            <span
              class="text-gray-700 "
              #currencyID
              [innerHTML]="
                item?.currencyID
                  | formatvalue
                    : formModelContact
                    : 'currencyID'
                  | async
              "
            ></span>
          </div>
        </div>
        <div class="d-flex justify-content-start">
          <span [ngbTooltip]="grvSetupContract['ContractName']?.headerText">
            {{ item?.contractName }}
          </span>
        </div>
        <div class="d-flex justify-content-between">
          <div class="first-div d-flex align-items-start">
            <codx-vll
              [name]="vllStatusContract"
              [field]="'Status'"
              [value]="item?.status"
              [showText]="true"
              [showBgColor]="true"
              class="badge badge-light badge-sm me-0"
            >
            </codx-vll>
          <div
              class="d-flex align-items-center"
              [ngbTooltip]="grvSetupContract['ContractName']?.headerText"
            >
              <span class="icon-16 icon-av_timer me-1"></span>
              <span
                class="text-gray-700 line-clamp line-clamp-1"
                #createdOn
                [innerHTML]="
                  item?.createdOn
                    | formatvalue
                      : formModelContact
                      : 'createdOn'
                    | async
                "
              ></span>
            </div>
          </div>
          <div class="last-div h-20px">
            <codx-imgs
              [isToolTip]="true"
              [width]="20"
              [objectId]="item?.createdBy"
              objectType="AD_Users"
              [numberImages]="1"
            >
            </codx-imgs>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf=" listLeads && listLeads.length > 0 ">
      <div *ngFor="let item of listLeads" class="p-3">
        <div class="d-flex justify-content-start">
          <div>
            <i class="icon-sticky_note_2"></i>
          </div>
          <div class="d-flex align-items-stretch">
            <codx-label
              [default]="'Tiềm năng'"
              class="pe-2"
            ></codx-label>
          </div>
          <div
            class="ms-auto line-clamp line-clamp-1 d-flex"
            [ngbTooltip]="grvSetupLead['DealValue']?.headerText"
          >
            <span
              class="icon-monetization_on pe-1 text-warning icon-16 mt-1"
            ></span>
            <span
              class="text-gray-700  pe-2"
              #dealValue
              [innerHTML]="
                item?.dealValue
                  | formatvalue : formModelLead : 'dealValue'
                  | async
              "
            ></span>
            <span
              class="text-gray-700 "
              #currencyID
              [innerHTML]="
                item?.currencyID
                  | formatvalue
                    : formModelLead
                    : 'currencyID'
                  | async
              "
            ></span>
          </div>
        </div>
        <div class="d-flex justify-content-start">
          <span [ngbTooltip]="grvSetupLead['LeadName']?.headerText">
            {{ item?.leadName }}
          </span>
        </div>
        <div class="d-flex justify-content-between">
          <div class="first-div d-flex align-items-start">
            <codx-vll
              [name]="vllStatusLead"
              [field]="'Status'"
              [value]="item?.status"
              [showText]="true"
              [showBgColor]="true"
              class="badge badge-light badge-sm me-0"
            >
            </codx-vll>
          <div
              class="d-flex align-items-center"
              [ngbTooltip]="grvSetupLead['LeadName']?.headerText"
            >
              <span class="icon-16 icon-av_timer me-1"></span>
              <span
                class="text-gray-700 line-clamp line-clamp-1"
                #createdOn
                [innerHTML]="
                  item?.createdOn
                    | formatvalue
                      : formModelLead
                      : 'createdOn'
                    | async
                "
              ></span>
            </div>
          </div>
          <div class="last-div h-20px">
            <codx-imgs
              [isToolTip]="true"
              [width]="20"
              [objectId]="item?.createdBy"
              objectType="AD_Users"
              [numberImages]="1"
            >
            </codx-imgs>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf=" listQuotations && listQuotations.length > 0 ">
      <div *ngFor="let item of listQuotations" class="p-3">
        <div class="d-flex justify-content-start">
          <div>
            <i class="icon-sticky_note_2"></i>
          </div>
          <div class="d-flex align-items-stretch">
            <codx-label
              [default]="'Báo giá'"
              class="pe-2"
            ></codx-label>
          </div>
          <div
            class="ms-auto line-clamp line-clamp-1 d-flex"
            [ngbTooltip]="grvSetupQuotation['TotalAmt']?.headerText"
          >
            <span
              class="icon-monetization_on pe-1 text-warning icon-16 mt-1"
            ></span>
            <span
              class="text-gray-700  pe-2"
              #totalAmt
              [innerHTML]="
                item?.totalAmt
                  | formatvalue : formModelQuotations : 'totalAmt'
                  | async
              "
            ></span>
            <span
              class="text-gray-700 "
              #currencyID
              [innerHTML]="
                item?.currencyID
                  | formatvalue
                    : formModelQuotations
                    : 'currencyID'
                  | async
              "
            ></span>
          </div>
        </div>
        <div class="d-flex justify-content-start">
          <span [ngbTooltip]="grvSetupQuotation['QuotationName']?.headerText">
            {{ item?.quotationName }}
          </span>
        </div>
        <div class="d-flex justify-content-between">
          <div class="first-div d-flex align-items-start">
            <codx-vll
              [name]="vllStatusQuotation"
              [field]="'Status'"
              [value]="item?.status"
              [showText]="true"
              [showBgColor]="true"
              class="badge badge-light badge-sm me-0"
            >
            </codx-vll>
          <div
              class="d-flex align-items-center"
              [ngbTooltip]="grvSetupQuotation['QuotationName']?.headerText"
            >
              <span class="icon-16 icon-av_timer me-1"></span>
              <span
                class="text-gray-700 line-clamp line-clamp-1"
                #createdOn
                [innerHTML]="
                  item?.createdOn
                    | formatvalue
                      : formModelQuotations
                      : 'createdOn'
                    | async
                "
              ></span>
            </div>
          </div>
          <div class="last-div h-20px">
            <codx-imgs
              [isToolTip]="true"
              [width]="20"
              [objectId]="item?.createdBy"
              objectType="AD_Users"
              [numberImages]="1"
            >
            </codx-imgs>
          </div>
        </div>
      </div>
    </div>


  </div>
  <ng-template #noData>
    <codx-no-data> </codx-no-data>
  </ng-template>
</ng-template>
<ng-template #defaultNull> <span class="pe-1">0</span></ng-template>
