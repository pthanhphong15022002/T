<ng-container *ngIf="dataSelected?.recID">
  <codx-detail-tmp
    [header]="header"
    [formModel]="formModel"
    [body]="body"
    [dataItem]="dataSelected"
    [hideMF]="false"
    [footer]="tabs"
    (changeDataMF)="changeDataMF($event, dataSelected)"
    (clickMF)="clickMF($event, dataSelected)"
  >
    <ng-template #header let-data>
      <div class="container_detail mt-2">
        <div class="d-flex align-items-top justify-content-between">        
          <div class="w-100 d-flex flex-column">    
            <div class="fs-2 fw-bold mb-2">{{ dataSelected?.dealName }}</div>
            <div class=" d-flex align-items-top justify-content-start mb-2">
              <codx-label default="Khách hàng:" class="text-dark me-2"></codx-label>
              <i class="icon-business icon-16 me-2"></i>
              <div
                class="text-gray-600"
                #customerID
                [innerHTML]="
                dataSelected?.customerID
                    | formatvalue
                      : formModel
                      : 'customerID'
                      : customerID
                      : 'CMDeals'
                      : 'grvCMDeals'
                    | async
                "
              ></div>
            </div>
            <div class="d-flex align-items-top mb-2">
              <codx-label default="Dòng sản phẩm:" class="text-dark me-2"></codx-label>
              <div
                class="text-gray-600"
                #businessLineID
                [innerHTML]="
                data?.businessLineID
                    | formatvalue
                      : formModel
                      : 'businessLineID'
                      : businessLineID
                      : 'CMDeals'
                      : 'grvCMDeals'
                    | async
                "
              ></div>
            </div>
            <div class="d-flex align-items-top justify-content-start mb-2">
              <codx-label default="Quy trình:" class="text-dark me-2"></codx-label>
              <div class="text-gray-600">{{dataSelected?.processName}}</div>
            </div>
            <div class="mb-2">
              <codx-tag
                [entityName]="formModel.entityName"
                [disabled]="true"
                [isEdit]="false"
                [value]="dataSelected?.tags"
              >
              </codx-tag>
            </div>
            <div class="d-flex flex-wrap align-items-top mb-2">
              <div class="d-flex align-items-center me-6 mb-1">
                <codx-label default="Ngày tạo:" class="text-dark me-1"></codx-label>
                <span
                  class="text-gray-600"
                  #createdOn
                  [innerHTML]="
                  dataSelected?.createdOn
                      | formatvalue
                        : formModel
                        : 'createdOn'
                        : createdOn
                        : 'CMDeals'
                        : 'grvCMDeals'
                      | async
                  "
                ></span>
              </div>
              <div class="d-flex align-items-center me-6 mb-1">
                <codx-label default="Ngày bắt đầu:" class="text-dark me-1"></codx-label>
                <span
                  class="text-gray-600"
                  #startDate
                  [innerHTML]="
                  dataSelected?.startDate
                      | formatvalue
                        : formModel
                        : 'startDate'
                        : createdOn
                        : 'CMDeals'
                        : 'grvCMDeals'
                      | async
                  "
                ></span>
              </div>
              <div class="d-flex align-items-center me-3 mb-1">
                <codx-label default="Ngày đến hạn:" class="text-dark me-1"></codx-label>
                <span
                  class="text-gray-600"
                  #endDate
                  [innerHTML]="
                  dataSelected?.endDate
                      | formatvalue
                        : formModel
                        : 'endDate'
                        : createdOn
                        : 'CMDeals'
                        : 'grvCMDeals'
                      | async
                  "
                ></span>
              </div>
            </div>
          </div>
          <div class="w-150px min-w-150px d-flex flex-column">
            <div class="d-flex flex-column">
              <div class="d-flex align-items-center justify-content-end mb-2">
                <span class="icon-monetization_on pe-1 text-wraning"></span>
                <span class="fs-5 fw-bold">{{dataSelected?.dealValue}}</span>
              </div>
              <div class="mb-2 d-flex justify-content-end">
                % <span class="pe-2">{{dataSelected?.probability}}</span>
              </div>
              <div class="d-flex justify-content-end mb-2">
                <span class="badge badge-md badge-primary">
                    {{dataSelected?.currentStepName}}
                  </span>
              </div>
              <div class="d-flex flex-column align-items-top">
                <div class="d-flex justify-content-end">
                  <codx-label default="Nhân viên bán hàng:" class="text-dark mb-2"></codx-label>
                </div>
                <div class="d-flex justify-content-end">
                  <codx-imgs
                    [isToolTip]="true"
                    [width]="30"
                    [objectId]="dataSelected.owner"
                    ojectType="AD_Users"
                    [numberImages]="1"
                  >
                  </codx-imgs>
                </div>
              </div>
              
            </div>
          </div>
        </div>
        
        <div class="view-details-header bg-body scroll-y me-3 h-100">
          <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex tab-header">
              <codx-taskbar
                [listTab]="tabDetail"
                (tab)="changeTab($event)"
                size="18"
                class="mb-3"
              ></codx-taskbar>
            </div>
          </div>
        </div>
      </div>
    </ng-template>

  </codx-detail-tmp>
</ng-container>
<ng-template #body let-data>
  <codx-tab-deal-detail [tabClicked]="tabClicked"
  [dataSelected]="dataSelected"></codx-tab-deal-detail>
</ng-template>
<ng-template #tabs let-data>
  <codx-tabs
    [entityName]="formModel.entityName"
    [formModel]="formModel"
    [TabControl]="tabControl"
    [objectID]="dataSelected.recID"
    [funcID]="formModel.funcID"
    [dataTree]="treeTask"
    [funcIDQuotations]="'CM0202'"
    [refType]="formModel.entityName"
    [refID]="dataSelected.recID"
    [customerID]="dataSelected.customerID"
    [salespersonID]="dataSelected.salespersonID"
    [consultantID]="dataSelected.consultantID"
    (tabChange)="changeFooter($event)"
  ></codx-tabs>
</ng-template>

<ng-template #contract let-data>
  <list-contracts [projectID]="dataSelected?.recID" [customers]=""></list-contracts>
</ng-template>
<!-- <ng-template #quotations let-data>
 <lib-quotations [funcID]="'CM0202'" [customerID]="dataSelected.customerID" ></lib-quotations>
</ng-template> -->

