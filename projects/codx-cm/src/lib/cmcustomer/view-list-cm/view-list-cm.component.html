<div class="p-3 rounded-2" *ngIf="dataSelected; else noData">
  <ng-container
    [ngTemplateOutlet]="customers"
    [ngTemplateOutletContext]="{ $implicit: dataSelected }"
  ></ng-container>
</div>
<ng-template #noData>
  <div class="empty-data">
    <div class="container h-100">
      <div class="list-empty card card-flush h-100">
        <div class="d-flex flex-column flex-center justify-content-center">
          <img
            src="../assets/themes/sys/default/img/DataEmpty.svg"
            class="w-200px"
          />
          <div class="fs-5 text-dark fw-bold mt-2 text-center">
            {{ "SYS011" | mssg | async }}
          </div>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #customers let-data>
  <div class="d-flex justify-content-between" (dblclick)="dbClick(data)">
    <div class="w-100 pe-6">
      <codx-temp-full
        cardCss="card-template p-3 list-task"
        [imageId]="data.recID"
        [imageObjName]="getNameCrm(data)"
        [imageWidth]="40"
        imgCss="me-3"
        [imageObjType]="entityName"
        [titleTmp]="titleTmp"
        [titleCss]="'fs-6'"
        [descTmp]="descTmp"
        [formModel]="formModel"
        [dataItem]="data"
        [hideMF]="true"
      >
      </codx-temp-full>
      <ng-template #titleTmp let-data>
        <div class="d-flex align-items-center mb-1 min-w-350px">
          <div class="text-dark fw-bold fs-6 line-clamp line-clamp-1 me-2">
            {{
              funcID == "CM0101"
                ? data.customerName
                : funcID == "CM0102"
                ? data.contactName
                : funcID == "CM0103"
                ? data.partnerName
                : data.competitorName
            }}
          </div>
          <div class="d-flex align-items-center" *ngIf="data.isBlackList">
            <span class="icon-do_disturb_alt icon-16"></span>
          </div>
        </div>
      </ng-template>
      <ng-template #descTmp let-data>
        <div class="d-flex flex-column">
          <div class="mb-1" *ngIf="dataSelected.address">
            <span class="icon-location_on icon-16 me-1 text-gray-700"></span>
            <span class="text-gray-900">{{ dataSelected.address }}</span>
          </div>
          <div *ngIf="funcID != 'CM0102'">
            <codx-tag
              [entityName]="entityName"
              [disabled]="true"
              [isEdit]="false"
              [value]="data?.tags"
            >
            </codx-tag>
          </div>
        </div>
      </ng-template>
    </div>
    <div class="w-100 pe-6" *ngIf="funcID == 'CM0102'">
      <div class="col-6 d-flex align-items-center" *ngIf="data?.mobile">
        <span
          [ngClass]="
            data?.allowCall
              ? 'icon-phone_android text-primary'
              : 'icon-phonelink_erase'
          "
          class="icon-16 me-1"
        ></span>
        <span
          [ngClass]="data?.allowCall ? 'text-primary' : ''"
          class="text-gray-900"
          >{{ data?.mobile }}</span
        >
      </div>
      <div class="col-6 d-flex align-items-center" *ngIf="data?.personalEmail">
        <span
          [ngClass]="
            data?.allowEmail ? 'icon-email text-primary' : 'icon-print_disabled'
          "
          class="icon-16 me-1 text-gray-900"
        ></span>
        <span
          [ngClass]="data?.allowEmail ? 'text-primary' : ''"
          class="text-gray-900"
          >{{ data?.personalEmail }}</span
        >
      </div>
    </div>
    <div *ngIf="funcID != 'CM0102'" class="w-250px min-w-250px">
      <!-- <div
        class="d-flex justify-content-start col-5"
        *ngIf="
          (funcID == 'CM0101' || funcID == 'CM0103') && contactPerson != null
        "
      >
        <div class="d-flex">
          <div class="me-3">
            <codx-img
              [objectId]="contactPerson.recID"
              [objectName]="contactPerson.contactName"
              [objectType]="'CM_Contacts'"
              [width]="35"
            >
            </codx-img>
          </div>
          <div class="d-flex flex-column flex-grow-1">
            <div class="d-flex flex-column">
              <div class="fw-bold fs-6 text-dark codx-text-overflow-1line">
                {{ contactPerson?.contactName }}
              </div>
              <div class="d-flex align-items-start me-4 mb-1">
                <div class="me-3" *ngIf="contactPerson?.mobile">
                  <span
                    [ngClass]="
                      contactPerson?.allowCall
                        ? 'icon-phone_android text-primary'
                        : 'icon-phonelink_erase'
                    "
                    class="icon-16 me-1"
                  ></span>
                  <span
                    [ngClass]="contactPerson?.allowCall ? 'text-primary' : ''"
                    class="text-gray-900"
                    >{{ contactPerson?.mobile }}</span
                  >
                </div>
                <div *ngIf="contactPerson?.personalEmail">
                  <span
                    [ngClass]="
                      contactPerson?.allowEmail
                        ? 'icon-email text-primary'
                        : 'icon-print_disabled'
                    "
                    class="icon-16 me-1 text-gray-900"
                  ></span>
                  <span
                    [ngClass]="contactPerson?.allowEmail ? 'text-primary' : ''"
                    class="text-gray-900"
                    >{{ contactPerson?.personalEmail }}</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> -->
      <div class="me-3" *ngIf="data?.industries">
        <div class="d-flex ms-3">
          <span class="icon-work_outline icon-16 me-1 text-gray-500"></span>
          <div>
            <div
              *ngFor="let item of data?.industries.split(';'); index as i"
              class="d-inline"
            >
              <span
                [innerHTML]="
                  item | formatvalue : formModel : 'Industries' | async
                "
              ></span
              ><span
                class="me-1"
                *ngIf="i < data?.industries.split(';').length - 1"
                >,</span
              >
              <!-- {{ dataSelected?.segmentID }} -->
            </div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="funcID == 'CM0102'">
      <div class="d-flex flex-column">
        <div class="mb-1">
          <span class="icon-corporate_fare text-primary icon-16 me-1"></span>
          <span
            [innerHTML]="
              dataSelected?.objectName
                | formatvalue : formModel : 'ObjectName'
                | async
            "
          ></span>
        </div>
        <div *ngIf="dataSelected?.contactType">
          <ng-container
            *ngFor="
              let item of dataSelected?.contactType.split(';');
              index as i
            "
          >
            <span
              [innerHTML]="
                item | formatvalue : formModel : 'ContactType' | async
              "
            ></span
            ><span
              class="me-1"
              *ngIf="i < dataSelected?.contactType.split(';').length - 1"
              >,</span
            >
          </ng-container>
        </div>
      </div>
    </div>
    <div
      *ngIf="funcID != 'CM0102'"
      class="d-flex justify-content-end align-items-top w-150px min-w-150px"
    >
      <span
        *ngIf="funcID == 'CM0103'"
        class="icon-date_range icon-18 text-gray-700 me-2"
      ></span>
      <span
        *ngIf="funcID == 'CM0103'"
        class="me-5"
        [innerHTML]="
          dataSelected?.partnerFrom
            | formatvalue : formModel : 'PartnerFrom'
            | async
        "
      >
      </span>
      <span
        *ngIf="funcID == 'CM0101' || funcID == 'CM0103'"
        class="icon-contact_phone icon-18 text-gray-700 me-2"
      ></span>
      <span
        *ngIf="funcID == 'CM0101' || funcID == 'CM0103'"
        class="icon-18 text-gray-700"
        >{{ listContacts.length }}</span
      >
      <span
        *ngIf="funcID == 'CM0101'"
        class="icon-add_shopping_cart icon-18 text-gray-700 me-2"
        >{{ countDeal }}</span
      >
      <span
        *ngIf="funcID == 'CM0101'"
        class="icon-shopping_bag icon-18 text-gray-700 me-2"
        >0</span
      >
      <span
        *ngIf="funcID == 'CM0104'"
        class="icon-shopping_cart icon-18 text-gray-700 me-2"
        >{{countDealCompetitor}}</span
      >
    </div>
    <div class="w-10px min-w-10px">
      <codx-mfunc
        [formModel]="formModel"
        (clickMF)="clickMF($event, dataSelected)"
        (changeDataMF)="changeDataMF($event, dataSelected)"
        [isBookMark]="false"
        [dataItem]="data"
        type="hover"
      >
      </codx-mfunc>
    </div>
  </div>
</ng-template>

<ng-template #popDetail>
  <codx-form [body]="dbClickDetail" [dialog]="dialogDetail">
  </codx-form>
</ng-template>

<ng-template #dbClickDetail>
  <codx-cmcustomer-detail
    #customerDetail
    [formModel]="formModel"
    [recID]="dataSelected.recID"
    [dataSelected]="dataSelected"
    [funcID]="funcID"
    (clickMoreFunc)="clickMoreFuncDetail($event)"
    [entityName]="entityName"
    (changeMoreMF)="changeDataDetailMF($event)"
  >
  </codx-cmcustomer-detail>
</ng-template>
