<ng-container *ngIf="dataSelected?.recID">
  <codx-detail-tmp
    class="leads-detail"
    [header]="header"
    [formModel]="formModel"
    [body]="body"
    [dataItem]="dataSelected"
    [hideMF]="dataSelected?.status == '11'"
    [footer]="tabs"
    (changeDataMF)="changeDataMF($event, dataSelected)"
    (clickMF)="clickMF($event, dataSelected)"
  >
    <ng-template #header let-data>
      <div
        class="d-flex align-items-center justify-content-start text-info py-2"
      >
        <span class="icon-add_shopping_cart icon-18 me-2 text-gray-700"></span>
        <span
          class="text-dark fs-6 fw-bold"
          #businessLineID
          [ngbTooltip]="gridViewSetup['BusinessLineID']?.headerText"
          [innerHTML]="
            dataSelected?.businessLineID
              | formatvalue : formModel : 'businessLineID' : businessLineID
              | async
          "
        ></span>
      </div>

      <div class="container_detail mt-1">
        <div class="d-flex justify-content-between mb-2">
          <div class="d-flex flex-column w-100">
            <div class="d-flex align-items-start">
              <div class="me-4">
                <codx-img
                  [objectId]="dataSelected?.recID"
                  [objectName]="dataSelected?.leadName"
                  [imgOn]="dataSelected?.modifiedOn"
                  [objectType]="'CM_Leads'"
                  [referType]="'avt'"
                  [width]="40"
                >
                </codx-img>
              </div>
              <div class="d-flex flex-column">
                <span
                  class="fw-bold text-dark fs-5 mb-1"
                  #leadName
                  [innerHTML]="
                    dataSelected?.leadName
                      | formatvalue : formModel : 'leadName' : leadName
                      | async
                  "
                ></span>
              </div>
            </div>
          </div>
          <div class="ms-5 d-flex justify-content-between">
            <div class="d-flex flex-column">
              <div class="d-flex flex-row">
                <ng-template #tooltipDealValue>
                  <div class="text-end text-sm-start">
                    <strong>{{ gridViewSetup["DealValue"]?.headerText }}</strong
                    >: {{ dataSelected?.dealValue }}
                  </div>
                </ng-template>
                <div
                [ngbTooltip]="tooltipDealValue"
                  class="d-flex align-items-top justify-content-end ps-10 fs-3"
                >
                <span
                class="icon-monetization_on pe-1 text-warning icon-16 mt-1"
              ></span>
              <span
                class="fw-bold line-clamp-menu pe-1"

                #dealValue
                [innerHTML]="
                  dataSelected?.dealValue
                    | formatvalue : formModel : 'dealValue' : dealValue
                    | async
                "
              ></span>
              <span
                class="fw-bold line-clamp-menu"
                [ngbTooltip]="gridViewSetup['CurrencyID']?.headerText"
                #currencyID
                [innerHTML]="
                  dataSelected?.currencyID
                    | formatvalue : formModel : 'currencyID' : currencyID
                    | async
                "
              ></span>

                </div>
              </div>
              <div class="d-flex justify-content-end">
                <span
                class="text-gray-600 line-clamp-menu"
                #endDate
                [ngbTooltip]="gridViewSetup['EndDate']?.headerText"
                [innerHTML]="
                  dataSelected?.endDate
                    | formatvalue
                      : formModel
                      : 'endDate'
                      : endDate
                    | async
                "
              ></span>
              </div>
            </div>
          </div>
        </div>

        <div class="d-flex align-items-top justify-content-between">
          <div class="w-100 d-flex flex-column">
            <div class="d-flex align-items-top justify-content-between">
              <div class="w-100 d-flex flex-column">
                <div class="d-flex align-items-top mb-1">
                  <codx-label
                    fiedName="Industries"
                    class="text-dark fw-bold me-2 label-colon"
                    [setRequire]="false"
                    [formModel]="formModel"
                  ></codx-label>
                  <span
                    class="text-gray-700 line-clamp line-clamp-1"
                    #industries
                    [innerHTML]="
                      dataSelected?.industries
                        | formatvalue
                          : formModel
                          : 'industries'
                          : industries
                          : 'CMLeads'
                          : 'grvCMLeads'
                        | async
                    "
                  ></span>
                </div>
                <div class="d-flex align-items-top justify-content-start mb-1">
                  <codx-label
                    default="Nhu cầu:"
                    class="text-dark fw-bold me-2 text-nowrap"
                  ></codx-label>
                  <span
                  class="text-gray-700 line-clamp line-clamp-2"
                  #note
                  [ngbTooltip]="dataSelected?.note"
                  [innerHTML]="
                  dataSelected?.note
                      | formatvalue : formModel : 'note' : note
                      | async
                  "
                ></span>

                </div>
                <div class="mb-1">
                  <codx-tag
                    [entityName]="formModel.entityName"
                    [disabled]="true"
                    [isEdit]="false"
                    [value]="dataSelected?.tags"
                  >
                  </codx-tag>
                </div>
                <div class="d-flex flex-wrap align-items-top mb-1">
                  <div class="d-flex flex-column">
                    <div class="mb-2">
                      <codx-label
                        class="text-dark fw-bold"
                        default="Liên hệ chính:"
                      ></codx-label>
                    </div>
                    <div class="d-flex align-items-start">
                      <div class="me-3">
                        <codx-img
                        [objectId]="dataSelected?.contactID"
                        [objectName]="dataSelected?.contactName"
                        [imgOn]="dataSelected?.modifiedOn"
                        [objectType]="formModel?.entityName"
                        [width]="60"
                      >
                      </codx-img>
                      </div>
                      <div class="d-flex flex-column">
                        <div class="fw-bold text-dark fs-6 mb-1">
                          {{ dataSelected?.contactName }}
                        </div>
                        <div class="fs-7 text-gray-600 mb-1">
                          {{ dataSelected?.jobTitle }}
                        </div>
                        <div class="d-flex align-items-start">
                          <div class="d-flex align-items-center me-5" *ngIf="dataSelected?.phone">
                            <span class="icon-phone_android text-primary icon-16 me-2"></span>
                            <span class="text-gray-800 fs-7">{{ dataSelected?.phone }}</span>
                          </div>
                          <div class="d-flex align-items-center" *ngIf="dataSelected?.email">
                            <span class="icon-email icon-16 text-primary icon-16 me-2"></span>
                            <span class="text-gray-800 fs-7">{{ dataSelected?.email }}</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="w-175px min-w-175px d-flex flex-column">
                <div class="d-flex flex-column">
                  <div
                    class="mb-2 d-flex align-items-center justify-content-end"
                  >
                  <div
                  *ngIf="dataSelected.status == '5'; else statusDefault"
                  [ngStyle]="{
                    'background-color': dataSelected?.steps['backgroundColor']
                  }"
                  class="me-1 badge badge-sm d-flex align-items-center mw-125px"
                >
                  <span
                    [ngClass]="dataSelected?.steps['icon']"
                    [ngStyle]="{ color: dataSelected?.steps['iconColor'] }"
                    class="me-1"
                  ></span>
                  <span
                    class="text-ellipsis line-clamp line-clamp-1"
                    [ngbTooltip]="dataSelected?.currentStepName"
                    [ngStyle]="{ color: dataSelected?.steps['textColor'] }"
                    >{{ dataSelected?.currentStepName }}</span
                  >
                </div>
                <ng-template #statusDefault>
                  <div *ngIf="dataSelected?.status">
                    <codx-vll
                    [name]="gridViewSetup?.Status?.referedValue"
                    [field]="'Status'"
                    [value]="dataSelected?.status"
                    [showText]="true"
                    [showBgColor]="true"
                    class="badge badge-light badge-sm"
                  >
                  </codx-vll>
                  </div>

                </ng-template>
                  </div>

                  <ng-template #tooltipSalesperson>
                      <div class="d-flex justify-content-center fw-bold fs-6">
                        <span
                        #salespersonID
                        [innerHTML]="
                        dataSelected?.salespersonID
                            | formatvalue
                              : formModel
                              : 'salespersonID'
                              : salespersonID
                            | async
                        "
                      ></span>
                      </div>
                      <div class="d-flex justify-content-center" >
                        {{gridViewSetup['SalespersonID']?.headerText}}
                      </div>
                  </ng-template>
                  <ng-template #tooltipConsultant>
                    <div class="d-flex justify-content-center fw-bold fs-6">
                      <span
                      #consultantID
                      [innerHTML]="
                      dataSelected?.consultantID
                          | formatvalue
                            : formModel
                            : 'consultantID'
                            : consultantID
                          | async
                      "
                    ></span>
                    </div>
                    <div class="d-flex justify-content-center" >
                      {{gridViewSetup['ConsultantID']?.headerText}}
                    </div>
                </ng-template>


                <ng-template #tooltipOwner>
                  <div class="d-flex justify-content-center fw-bold fs-6">
                    <span
                    #owner
                    [innerHTML]="
                    dataSelected?.owner
                        | formatvalue
                          : formModel
                          : 'owner'
                          : owner
                        | async
                    "
                  ></span>
                  </div>
                  <div class="d-flex justify-content-center" >
                    {{gridViewSetup['Owner']?.headerText}}
                  </div>
              </ng-template>


                  <div class="d-flex flex-column align-items-top" style="margin-top: 2.25rem !important;">
                    <div class="d-flex justify-content-end">
                      <codx-label
                        default="Thông tin bán hàng"
                        class="text-dark fw-bold mb-2"
                      ></codx-label>
                    </div>
                    <div class="d-flex justify-content-end">
<!--
                      <codx-imgs
                      [width]="30"
                      [objectId]="dataSelected.salespersonID"
                      ojectType="AD_Users"
                      [numberImages]="1"
                      [ngbTooltip]="tooltipSalesperson"
                      [isToolTip]="false"
                    >
                    </codx-imgs> -->

                    <div style="position: relative">
                      <!-- <codx-imgs
                        [objectId]="item?.resourceID"
                        [objectName]="item?.resourceName"
                        objectType="AD_Users"
                        [numberImages]="1"
                      >
                      </codx-imgs> -->

                      <codx-img
                      [width]="30"
                      [objectId]="dataSelected.salespersonID"
                      objectType="AD_Users"
                      [referType]="'avt'"
                      [numberImages]="1"
                    >
                    </codx-img>
                      <div style="position: absolute; right: 0px; bottom: 0px">
                        <ng-container *ngFor="let role of listRoles">
                          <ng-container *ngIf="role.value == '1'">
                            <span
                              ><img
                                src="/assets/themes/tm/default/img/CM.svg"
                                alt=""
                            /></span>

                          </ng-container>
                        </ng-container>
                      </div>
                    </div>



                    <codx-imgs
                      [width]="30"
                      [objectId]="dataSelected?.consultantID"
                      ojectType="AD_Users"
                      [numberImages]="1"
                      [ngbTooltip]="tooltipConsultant"
                      [isToolTip]="false"
                    >
                    </codx-imgs>
                    <codx-imgs
                      [width]="30"
                      [objectId]="dataSelected?.owner"
                      ojectType="AD_Users"
                      [numberImages]="1"
                      [ngbTooltip]="tooltipOwner"
                      [isToolTip]="false"
                    >
                    </codx-imgs>
                    </div>
                  </div>
                </div>
              </div>
            </div>


            <div class="view-details-header bg-body scroll-y me-3 h-100">
              <div class="d-flex align-items-center justify-content-between">
                <div class="d-flex tab-header">
                  <codx-taskbar
                  [listTab]="tabDetail"
                  [change]="dataSelected"
                  (tab)="changeTab($event)"
                  size="18"
                  class="mb-3 fw-bold"
                ></codx-taskbar>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- <div class="container_detail mt-1">
        <div class="d-flex justify-content-between mb-2">
          <div class="d-flex flex-column w-100">

        <div class="d-flex align-items-start">
              <div class="me-4">
              </div>
              <div class="d-flex flex-column">
                  <span class="fw-bold text-dark fs-5 mb-1"
                  #leadName
                  [innerHTML]="
                  dataSelected?.leadName
                      | formatvalue
                        : formModel
                        : 'leadName'
                        : leadName
                      | async
                  "
                ></span>
              </div>
            </div>

          </div>
          <div class="ms-5">
            <span class="badge badge-light-primary"
              #status
              [innerHTML]="
              dataSelected?.status
                  | formatvalue
                    : formModel
                    : 'status'
                    : status
                    : 'CMLeads'
                    : 'grvCMLeads'
                  | async
              "
            ></span>
          </div>
        </div>
        <div class="d-flex justify-content-between mb-1">
          <div class="d-flex align-items-center">
            <codx-label default="Lĩnh vực hoạt động:" class="fw-bold me-2"></codx-label>
            <span
                class="text-gray-700 line-clamp line-clamp-1"
                #industries
                [innerHTML]="
                  dataSelected?.industries
                    | formatvalue
                      : formModel
                      : 'industries'
                      : industries
                      : 'CMLeads'
                      : 'grvCMLeads'
                    | async
                "
              ></span>
          </div>
        </div>
        <div class="d-flex align-items-top mb-2">
          <codx-label default="Nhu cầu:" class="fw-bold me-2 text-nowrap"></codx-label>
          <span class="text-gray-600 line-clamp line-clamp-2"
              #note
              [innerHTML]="
                dataSelected?.note
                  | formatvalue
                    : formModel
                    : 'note'
                  | async
              "
            ></span>
        </div>
        <div class="mb-2">
          <codx-tag
            [entityName]="formModel.entityName"
            [disabled]="true"
            [isEdit]="false"
            [value]="dataSelected?.tags"
          >
          </codx-tag>
        </div>

        <div class="d-flex justify-content-between mb-3">
          <div>
            <div class="d-flex flex-column" *ngIf="dataSelected?.contactID">
              <div class="mb-2">
                <codx-label class="text-dark fw-bold"
                  default="Liên hệ chính:"
                  ></codx-label>
              </div>
              <div class="d-flex align-items-start">
                <div class="me-3">
                  <codx-img
                    [objectId]="dataSelected?.contactID"
                    [objectName]="dataSelected?.contactName"
                    [imgOn]="dataSelected?.modifiedOn"
                    [objectType]="formModel?.entityName"
                    [width]="60"
                  >
                  </codx-img>
                </div>
                <div class="d-flex flex-column">
                  <div class="fw-bold text-dark fs-6 mb-1">
                    {{ dataSelected?.contactName }}
                  </div>
                  <div class="fs-7 text-gray-600 mb-1">
                    {{ dataSelected?.jobTitle }}
                  </div>
                  <div class="d-flex align-items-start">
                    <div class="d-flex align-items-center me-5" *ngIf="dataSelected?.phone">
                      <span class="icon-phone_android text-primary icon-16 me-2"></span>
                      <span class="text-gray-800 fs-7">{{ dataSelected?.phone }}</span>
                    </div>
                    <div class="d-flex align-items-center" *ngIf="dataSelected?.email">
                      <span class="icon-email icon-16 text-primary icon-16 me-2"></span>
                      <span class="text-gray-800 fs-7">{{ dataSelected?.email }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex flex-column justify-content-end">
            <div class="mb-2">
              <codx-label
                default="Thông tin bán hàng"
                class="text-dark fw-bold"
              ></codx-label>
            </div>
            <div class="d-flex flex-center">
              <codx-imgs
                [isToolTip]="true"
                [width]="30"
                [objectId]="dataSelected.salespersonID"
                ojectType="AD_Users"
                [numberImages]="1"
              >
              </codx-imgs>

              <codx-imgs
                [isToolTip]="true"
                [width]="30"
                [objectId]="dataSelected?.consultantID"
                ojectType="AD_Users"
                [numberImages]="1"
              >
              </codx-imgs>
              <codx-imgs
                [isToolTip]="true"
                [width]="30"
                [objectId]="dataSelected?.owner"
                ojectType="AD_Users"
                [numberImages]="1"
              >
              </codx-imgs>
            </div>
          </div>
        </div>

        <div class="view-details-header bg-body scroll-y me-3 h-100">
          <div class="d-flex align-items-center justify-content-between">
            <div class="d-flex tab-header">
              <codx-taskbar
                [listTab]="tabDetail"
                [change]="dataSelected"
                (tab)="changeTab($event)"
                size="18"
                class="mb-3 fw-bold"
              ></codx-taskbar>
            </div>
          </div>
        </div>
      </div> -->
    </ng-template>
  </codx-detail-tmp>
</ng-container>
<ng-template #body let-data>
  <codx-tab-lead-detail
    [tabClicked]="tabClicked"
    [dataSelected]="dataSelected"
    [formModel]="formModel"
  ></codx-tab-lead-detail>
</ng-template>
<ng-template #tabs let-data>
  <codx-tabs
    [entityName]="formModel.entityName"
    [formModel]="formModel"
    [TabControl]="tabControl"
    [objectID]="dataSelected.recID"
    [funcID]="formModel.funcID"
    [dataTree]="treeTask"
    [funcIDQuotations]="'CM0202'"
    [refType]="formModel.entityName"
    [refID]="dataSelected.recID"
    [customerID]="dataSelected.customerID"
    [salespersonID]="dataSelected.salespersonID"
    [consultantID]="dataSelected.consultantID"
    (tabChange)="changeFooter($event)"
  ></codx-tabs>
</ng-template>

<ng-template #contract let-data>
  <!-- <list-contracts [projectID]="dataSelected?.recID" [customers]=""></list-contracts> -->
</ng-template>
<!-- <ng-template #quotations let-data>
 <lib-quotations [funcID]="'CM0202'" [customerID]="dataSelected.customerID" ></lib-quotations>
</ng-template> -->

<ng-template #referencesDeal>
<div *ngIf="tmpDeal; else noData"
class="d-flex justify-content-between align-items-top p-3 border-bottom border-gray-150 user-nav-item"
>
<div class="d-flex flex-column">
  <div
    class="fw-bold fs-6 line-clamp line-clamp-1 mb-3"
    [innerHTML]="
    tmpDeal.dealName | formatvalue : formModelDeal : 'DealName' | async
    "
  ></div>
  <div class="d-flex flex-wrap align-items-top me-4 mb-1">
    <div class="me-3 d-flex justify-content-start me-6">
      <span class="icon-money icon-16 me-1" [ngbTooltip]="popupDealValue">
        <ng-template #popupDealValue>
          <codx-label
            fiedName="DealValue"
            [formModel]="formModelDeal"
          ></codx-label> </ng-template
      ></span>
      <codx-label
        class="label-colon text-gray-600"
        [formModel]="formModelDeal"
        fiedName="DealValue"
      ></codx-label>
      <span
        class="ms-1 text-dark fw-bold pe-1"
        [innerHTML]="
        tmpDeal.dealValue | formatvalue : formModelDeal : 'DealValue' | async
        "
      ></span>
      <span
      class="fw-bold line-clamp-menu"
      #currencyID
      [innerHTML]="
      tmpDeal?.currencyID
          | formatvalue : formModelDeal : 'currencyID' : currencyID
          | async
      "
    ></span>

    </div>
    <div class="d-flex align-items-center">
      <span
        class="icon-offline_pin icon-16 me-2"
        [ngbTooltip]="popupProbability"
      >
        <ng-template #popupProbability>
          <codx-label
            fiedName="Probability"
            [formModel]="formModelDeal"
          ></codx-label> </ng-template
      ></span>
      <codx-label
        class="label-colon text-gray-600 me-1"
        [formModel]="formModelDeal"
        fiedName="Probability"
      ></codx-label>
      <span
        class="me-1 text-dark fw-bold"
        [innerHTML]="
        tmpDeal.probability | formatvalue : formModelDeal : 'Probability' | async
        "
      ></span
      ><span class="text-dark fw-bold">%</span>
    </div>
  </div>
</div>
<div class="d-flex align-items-top ms-4">
  <div class="d-flex flex-column w-130px min-w-130px">
    <div class="d-flex align-items-center justify-content-end mb-1">
      <div
      *ngIf="tmpDeal.status == '5'; else statusDefault"
      [ngStyle]="{
        'background-color': tmpDeal?.steps['backgroundColor']
      }"
      class="me-1 badge badge-sm d-flex align-items-center mw-125px"
    >
      <span
        [ngClass]="tmpDeal?.steps['icon']"
        [ngStyle]="{ color: tmpDeal?.steps['iconColor'] }"
        class="me-1"
      ></span>
      <span
        class="text-ellipsis line-clamp line-clamp-1"
        [ngbTooltip]="tmpDeal?.currentStepName"
        [ngStyle]="{ color: tmpDeal?.steps['textColor'] }"
        >{{ tmpDeal?.currentStepName }}</span
      >
    </div>
    <ng-template #statusDefault>
      <codx-vll
        [name]="gridViewSetupDeal?.Status?.referedValue"
        [field]="'Status'"
        [value]="tmpDeal?.status"
        [showText]="true"
        [showBgColor]="true"
        class="badge badge-light badge-sm"
      >
      </codx-vll>
    </ng-template>
    </div>
    <div class="ms-1 d-flex justify-content-end align-items-center mt-1">
      <span
        class="icon-date_range icon-16 text-gray-800 me-1"
        [ngbTooltip]="popupEndDate"
        ><ng-template #popupEndDate>
          <codx-label
            fiedName="EndDate"
            [formModel]="formModelDeal"
          ></codx-label> </ng-template
      ></span>
      <span
        class="text-gray-700"
        [innerHTML]="
        tmpDeal.endDate | formatvalue : formModelDeal : 'EndDate' | async
        "
      ></span>
    </div>
  </div>

  <div class="ms-5" *ngIf="tmpDeal.owner">
    <codx-imgs
      [isToolTip]="true"
      [width]="30"
      [objectId]="tmpDeal.owner"
      ojectType="AD_Users"
      [numberImages]="1"
    >
    </codx-imgs>
  </div>
</div>
</div>


</ng-template>
<ng-template #noData>
  <codx-no-data>

  </codx-no-data>
</ng-template>

