<div class="card-body p-0 codx-card-custom">
  <div
    class="codx-stepper stepper stepper-pills d-flex flex-column justify-content-between"
  >
    <div class="stepper-header d-flex flex-wrap flex-stack ps-6">
      <div class="d-flex align-items-center">
        <h2 class="h2-title">
          <div [innerHTML]="data?.title"></div>
        </h2>
      </div>
      <div class="d-flex justify-content-end">
        <ng-container [ngTemplateOutlet]="confirmCheckbox"> </ng-container>
        <ng-container *ngFor="let item of lstMF">
          <button
            type="button"
            [style.background]="item?.color"
            class="btn btn-sm text-inverse-danger me-2 mb-2 min-w-60px rounded-4"
            [disabled]="
              !canOpenSubPopup ||
              !isConfirm ||
              (item?.functionID != 'SYS206' && isInteractPDF) ||
              (item?.functionID != 'SYS206' &&
                item?.functionID != 'SYS208' &&
                isEdited)
            "
            (click)="beforeOpenPopupADR(item)"
            *ngIf="item?.functionID != 'SYS208'"
          >
            {{ item?.text }}
          </button>
        </ng-container>
        <!-- <button
          type="button"
          class="btn btn-sm btn-bg-primary text-inverse-primary me-2 mb-2 min-w-60px rounded-4"
          [disabled]="!canOpenSubPopup || !isConfirm"
          (click)="clickOpenPopupADR(5)"
        >
          <codx-vll [name]="'ES002'" [value]="data?.stepType" [showText]="true">
          </codx-vll>
        </button>
        <button
          type="button"
          class="btn btn-sm btn-bg-danger text-inverse-danger me-2 mb-2 min-w-60px rounded-4"
          [disabled]="!canOpenSubPopup || !isConfirm"
          (click)="clickOpenPopupADR(4)"
        >
          <codx-label
            name="lblDeny"
            [formModel]="formModel"
            default="Từ chối"
          ></codx-label>
        </button>
        <button
          type="button"
          class="btn btn-sm btn-bg-warning text-inverse-warning me-2 mb-2 min-w-60px rounded-4"
          [disabled]="!canOpenSubPopup || !isConfirm"
          (click)="clickOpenPopupADR(2)"
        >
          <codx-label
            name="lblRedo"
            [formModel]="formModel"
            default="Làm lại"
          ></codx-label>
        </button> -->

        <!-- <button
          type="button"
          class="btn btn-sm btn-bg-danger text-inverse-danger me-2 mb-2 min-w-60px rounded-4"
          [disabled]="!canOpenSubPopup"
          (click)="clickUSB()"
        >
          <codx-label
            name="lblDeny"
            [formModel]="formModel"
            default="USB"
          ></codx-label>
        </button> -->

        <div class="btn btn-sm btn-bg-white text-inverse-white mb-2">
          <i class="icon-close icon-18" (click)="close()"></i>
        </div>
      </div>
    </div>
    <!-- [curSignerType]="oApprovalTrans?.approverType" -->

    <div class="stepper-body pt-2 w-100">
      <lib-pdf
        #pdfView
        (confirmChange)="changeConfirmState($event)"
        [isApprover]="oApprovalTrans?.status =='5' ? false : isApprover"
        [isConfirm]="oApprovalTrans.confirmControl == '1' ? true : false"
        [transRecID]="transRecID"
        [oApprovalTrans]="oApprovalTrans"
        [recID]="sfRecID"
        [stepNo]="stepNo"
        [isEditable]="canOpenSubPopup"
        [isSignMode]="true"
        (isActiveToSign)="changeActiveOpenPopup($event)"
        (changeSignerInfo)="changeSignerInfo($event)"
        (eventHighlightText)="eventHighlightText($event)"
      >
      </lib-pdf>
    </div>
  </div>
</div>

<ng-template #popupOTPPin let-dialogOTPPin>
  <div class="card card-flush h-100 p-4">
    <button
      type=" button"
      class="position-absolute top-0 end-0 m-2 btn btn-icon"
      data-bs-dismiss="alert"
      (click)="close(dialogOTPPin)"
    >
      <span class="icon-close"></span>
    </button>
    <div class="card-body px-2">
      <div class="d-flex align-items-center mb-4">
        <h2>
          <codx-label
            name="lblInsertCode"
            [formModel]="formModel"
            default="Nhập mã xác nhận"
          ></codx-label>
        </h2>
      </div>
      <div class="mw-100 mh-300px w-25 w-sm-50 mx-auto my-4">
        <img
          src="../assets/themes/es/default/img/amico.svg"
          alt=""
          class="img-fluid"
        />
      </div>
      <div class="w-100">
        <codx-input
          type="text"
          field="otpPin"
          [disabled]="false"
          class="test-textbox"
          [placeholder]="'Nhập mã otp'"
          (valueChange)="valueChange($event)"
        ></codx-input>
      </div>
    </div>
    <div class="card-footer px-2">
      <div class="d-flex justify-content-end mt-4">
        <button class="btn btn-primary" type="submit" (click)="confirmOTPPin()">
          <codx-label
            name="lblConfirm"
            [formModel]="formModel"
            default="Xác nhận"
          ></codx-label>
        </button>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #confirmCheckbox>
  <div
    class="pdf-check-add align-self-center me-3 btn-flex flex-center btn-white"
  >
    <codx-input
      type="checkbox"
      class="check-add me-2"
      name="select"
      (valueChange)="changeConfirmState($event)"
    >
    </codx-input>
    {{ "ES011" | mssg | async }}
    <!-- <codx-label
      name="lblConfirmSeen"
      [formModel]=""
      [default]="'Xác nhận đã xem văn bản'"
      class="text-header"
    ></codx-label> -->
  </div>
</ng-template>
