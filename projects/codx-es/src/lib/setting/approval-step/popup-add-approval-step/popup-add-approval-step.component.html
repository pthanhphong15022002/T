<codx-form [dialog]="dialog" [headerText]="header1" [subHeaderText]="subHeaderText" [body]="body" [footer]="footer"
  [formControl]="dialogApprovalStep" *ngIf="isAfterRender">
  <ng-template #body>
    <div class="tab-content">
      <ejs-tab id="tab_orientation" #orientationTab [showCloseButton]='false' heightAdjustMode='Auto'
        headerPlacement="Left">
        <e-tabitems>
          <e-tabitem [header]='headerText[0]'>
            <ng-template #content>
              <div id="rome" class="tabpanel p-5">
                <div class="tab-content">
                  <div class="d-flex flex-column mb-4">
                    <codx-label class="fw-bolder" default="Mô tả" fiedName="Memo" [formModel]="formModel">
                    </codx-label>
                    <codx-input type="text" name="text" ControlName="memo" [Group]="dialogApprovalStep" placeholder=""
                      class="form-control"></codx-input>
                  </div>
                  <div class="d-flex flex-column mb-4">
                    <div class=" row">
                      <div class="col-6">
                        <codx-label class="fw-bolder" default="Hành động" fiedName="StepType" [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['StepType']" field="stepType"
                          (valueChange)="valueChange($event)" [crrValue]="dialogApprovalStep.value.stepType">
                        </codx-input>
                      </div>
                      <div class="col-4">
                        <codx-label class="fw-bolder" default="Thời gian xử lí (giờ)" fiedName="Leadtime"
                          [formModel]="formModel">
                        </codx-label>
                        <codx-input type="text" ControlName="leadtime" placeholder="0" [Group]="dialogApprovalStep"
                          (valueChange)="valueChange($event)" [crrValue]="parseInt(dialogApprovalStep.value.leadtime)">
                        </codx-input>
                      </div>
                    </div>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-4 ">
                      <div class="fw-bolder d-block mb-2">
                        <codx-label class="text-primary" default="Người thực hiện" fiedName="Attendees"
                          [formModel]="formModel">
                        </codx-label>
                      </div>

                      <!-- <span class=" icon-group_add text-primary fs-1">

                      </span> -->
                      <codx-input [showInput]="false" [multiple]="true" type="share" refValue="ES014" field="popup"
                        (valueChange)="valueChange($event)">
                      </codx-input>

                    </div>
                    <ng-container *ngFor="let item of dialogApprovalStep.value.approvers">
                      <div class="d-flex align-items-center mb-4 min-w-300px mw-300px">
                        <codx-temp-full [imageId]="item.approver" [subTitle]="" [title]="item.approverName"
                          [subTitle]="item.positionName ?? 'Vị trí công việc'" [status]="lstStep.status" [statusVll]=""
                          cardCss="card-template border-bottom px-2 py-3" [imageObjType]="'AD_Users'" [modeImgs]="false"
                          [titleLine]="3" [formModel]="formModel" (clickMF)="MFClick($event, item)">
                        </codx-temp-full>
                      </div>
                    </ng-container>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <div class=" row">
                      <div class="col-4">
                        <div class="d-flex align-items-center">
                          <codx-input type="radio" [checked]="true" label="Duyệt đại diện"
                            [crrValue]="dialogApprovalStep.value.representative" name="radio" field="representative"
                            class="test-switch" (valueChange)="valueChange($event)">
                          </codx-input>
                          <!-- <span class="ml-2">
                            <codx-label fiedName="Representative" default="Duyệt đại diện" [formModel]="formModel"
                              class="ml-2"></codx-label>
                          </span> -->

                        </div>
                      </div>
                      <div class="col-4">
                        <div class="d-flex align-items-center">
                          <codx-input name="radio" type="radio" label="Duyêt tuần tự"
                            [crrValue]="dialogApprovalStep.value.sequential" field="sequential" class="test-switch"
                            (valueChange)="valueChange($event)"></codx-input>
                          <!-- <codx-label fiedName="Sequential" default="Duyệt tuần tự" [formModel]="formModel"
                            class="ms-2"></codx-label> -->
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <div class="fw-bolder d-block mb-2">
                      <codx-label class="text-primary" default="Đóng góp ý kiến" fiedName="Attendees"
                        [formModel]="formModel">
                      </codx-label>
                    </div>

                    <div class="row">
                      <div class="col-6">
                        <codx-label class="fw-bolder" default="Cho ý kiến khi duyệt" fiedName="ApproveControl"
                          [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['ApproveControl']"
                          field="approveControl" (valueChange)="valueChange($event)"
                          [crrValue]="dialogApprovalStep.value.approveControl">
                        </codx-input>
                      </div>
                      <div class="col-6">
                        <codx-label class="fw-bolder" default="Cho ý kiến khi từ chối" fiedName="RejectControl"
                          [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['RejectControl']"
                          field="rejectControl" (valueChange)="valueChange($event)"
                          [crrValue]="dialogApprovalStep.value.rejectControl">
                        </codx-input>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem [header]='headerText[1]'>
            <ng-template #content>

              <div id="rome" class="tabpanel p-5">
                <div class="tab-content">
                  <!--begin::Title-->
                  <div class="d-flex justify-content-between align-items-center mb-4 ">
                    <h4 class="fw-bolder text-gray-800 d-block mb-2">
                      <codx-label default="Người xét duyệt" fiedName="Approvers" [formModel]="formModel">
                      </codx-label>
                    </h4>
                    <!-- <span class=" icon-group_add text-primary fs-1">

                    </span> -->

                  </div>

                  <!-- <div class="d-flex align-items-center mb-4">
                    <div class="symbol symbol-35px symbol-circle me-4" data-bs-toggle="tooltip" title=""
                      data-bs-original-title="Trần Quốc Hoàn">
                      <img alt="Pic" src="../../../assets/themes/sys/default/light/img/avatar_default.svg">
                      <span
                        class="symbol-badge badge badge-circle bg-primary top-100 start-100 text-white fs-8">R</span>
                    </div>
                    <div class="d-flex flex-column flex-grow-1">
                      <div class="text-dark fw-bold fs-6 font-weight-bolder">Trần Quốc
                        Hoàn</div>
                      <span class="text-muted font-weight-bold">Chủ trì cuộc họp</span>
                    </div>

                  </div>
                  <div class="d-flex align-items-center mb-4">
                    <div class="symbol symbol-35px symbol-circle me-4" data-bs-toggle="tooltip" title=""
                      data-bs-original-title="Võ Văn Quang">
                      <img class="empImg" alt="Pic"
                        src="../../../assets/themes/sys/default/light/img/avatar_default.svg">
                      <span class="symbol-badge badge badge-circle bg-dark top-100 start-100 text-white fs-8">0</span>
                    </div>
                    <div class="d-flex flex-column flex-grow-1">
                      <div class="text-dark fw-bold fs-6 font-weight-bolder">Trần Quốc
                        Hoàn</div>
                      <span class="text-muted font-weight-bold">Thành viên</span>
                    </div>
                    <div class="d-flex flex-column justify-content-end">
                      <span class="badge badge-light-danger mb-1">Không tham gia</span>
                      <span class="text-muted font-weight-bold text-center"> 1 giờ trước </span>
                    </div>
                  </div>
                  <div class="text-center">
                    <div class="Participants d-flex align-items-center w-275px mx-auto">
                      <a href="#" class="d-flex align-items-center text-dark text-hover-primary me-5">
                        <span
                          class="badge badge-sm badge-circle btn-danger top-100 start-100 text-white fs-8 me-1">A</span>
                        Chủ trì
                      </a>
                      <a href="#" class="d-flex align-items-center text-dark text-hover-primary me-5">
                        <span
                          class="badge badge-sm badge-circle btn-success top-100 start-100 text-white fs-8 me-1">S</span>
                        Thư ký
                      </a>
                      <a href="#" class="d-flex align-items-center text-dark text-hover-primary me-5">
                        <span
                          class="badge badge-sm badge-circle btn-primary top-100 start-100 text-white fs-8 me-1">P</span>
                        Tham dự
                      </a>
                    </div>
                  </div> -->

                </div>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem [header]='headerText[2]'>
            <ng-template #content>
              <div id="rome" class="tabpanel p-5">
                <div class="tab-content">


                  <ng-container *ngFor="let item of dialogApprovalStep.value.emailTemplates">
                    <div class="d-flex justify-content-between align-items-center" *ngIf="item?.EmailType == '11'">
                      <div class="fw-bolder d-block mb-4">
                        <codx-label class="text-primary" default="Thiết lập mẫu email duyệt" [formModel]="formModel"
                          fiedName="lblEmailSubmit">
                        </codx-label>
                      </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center" *ngIf="item?.EmailType == '21'">
                      <div class="fw-bolder d-block mb-4 mt-5">
                        <codx-label class="text-primary" default="Email yêu cầu hủy kết quả duyệt/yêu cầu"
                          [formModel]="formModel" fiedName="lblEmailReject">
                        </codx-label>
                      </div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center" *ngIf="item?.EmailType == '31'">
                      <div class="fw-bolder d-block mb-4 mt-5">
                        <codx-label class="text-primary" default="Thiết email cảnh báo quá hạn duyệt"
                          [formModel]="formModel" fiedName="lblEmailAlert">
                        </codx-label>
                      </div>
                    </div>
                    <div class="d-flex flex-column mb-4">
                      <div class="row">
                        <div class="col-6">
                          <!-- <codx-label class=" fw-bold" default="Email gửi yêu cầu duyệt" fiedName="Category"
                            [formModel]="formModel">
                          </codx-label> -->
                          <div class="fw-bolder">{{item?.EmailType|vll:'ES012':'text'|async}}</div>
                        </div>
                        <div class="col-6">
                          <div class="row">
                            <div class="col-6">
                              <codx-input type="checkbox" label="Thông báo" labelPosition="after" field="IsAlert"
                                class="test-check" (valueChange)="valueEmailChange($event, item)"
                                [crrValue]="item?.IsAlert == '1' ?? item?.isAlert == '1'">
                              </codx-input>
                            </div>
                            <div class="col-4">
                              <codx-input type="checkbox" label="Email" labelPosition="after" field="IsEmail"
                                class="test-check" (valueChange)="valueEmailChange($event, item)"
                                [crrValue]="item?.IsEmail == '1' ?? item?.isEmail == '1'">
                              </codx-input>
                            </div>
                            <div class="col-2">
                              <div class="icon-email icon-24 ml-2" aria-disabled="true"
                                [ngClass]="item?.IsEmail == '1' || item?.isEmail == '1' ? 'text-hover-primary' : 'text-muted'"
                                (click)="openSetupEmail(item)">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-container>

                  <!-- <div class="d-flex flex-column mb-4">
                    <codx-label class=" fw-bold" default="Email đồng thuận/duyệt" fiedName="Category"
                      [formModel]="formModel">
                    </codx-label>
                    <div class="d-flex">
                      <div class="w-100 me-2">
                        <codx-input type="valuelist" name="valuelist" [crrValue]="dialogApprovalStep.value.category"
                          [refValue]="cbxName['Category']" field="category" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="icon-edit_file text-hover-primary icon-20 ml-2"></div>

                    </div>


                  </div>
                  <div class="d-flex flex-column mb-4">
                    <codx-label class=" fw-bold" default="Email từ chối" fiedName="Category" [formModel]="formModel">
                    </codx-label>
                    <div class="d-flex">
                      <div class="w-100 me-2">
                        <codx-input type="valuelist" name="valuelist" [crrValue]="dialogApprovalStep.value.category"
                          [refValue]="cbxName['Category']" field="category" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="icon-edit_file text-hover-primary icon-20 ml-2"></div>

                    </div>

                  </div>
                  <div class="d-flex flex-column mb-4">
                    <codx-label class=" fw-bold" default="Email trả làm lại" fiedName="Category"
                      [formModel]="formModel">
                    </codx-label>
                    <div class="d-flex">
                      <div class="w-100 me-2">
                        <codx-input type="valuelist" name="valuelist" [crrValue]="dialogApprovalStep.value.category"
                          [refValue]="cbxName['Category']" field="category" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="icon-edit_file text-hover-primary icon-20 ml-2"></div>

                    </div>


                  </div> -->

                  <!-- <div class="d-flex justify-content-between align-items-center mb-4 ">
                    <h4 class="fw-bolder text-gray-800 d-block mb-2">
                      <codx-label default="Thiết lập mẫu email yêu cầu hủy kết quả duyệt/thu hồi"
                        [formModel]="formModel" name="lblTitleEmail1">
                      </codx-label>
                    </h4>
                  </div>

                  <div class="d-flex flex-column mb-4">
                    <codx-label class=" fw-bold" default="Email yêu cầu hủy" name="lblEmail21" [formModel]="formModel">
                    </codx-label>
                    <div class="d-flex">
                      <div class="w-100 me-2">
                        <codx-input type="valuelist" name="valuelist" [crrValue]="dialogApprovalStep.value.category"
                          [refValue]="cbxName['Category']" field="category" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="icon-edit_file text-hover-primary icon-20 ml-2"></div>
                    </div>
                  </div>
                  <div class="d-flex flex-column mb-4">
                    <codx-label class=" fw-bold" default="Email chấp nhận yêu cầu hủy" fiedName="Category"
                      [formModel]="formModel">
                    </codx-label>
                    <div class="d-flex">
                      <div class="w-100 me-2">
                        <codx-input type="valuelist" name="valuelist" [crrValue]="dialogApprovalStep.value.category"
                          [refValue]="cbxName['Category']" field="category" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="icon-edit_file text-hover-primary icon-20 ml-2"></div>
                    </div>
                  </div>
                  <div class="d-flex flex-column mb-4">
                    <codx-label class=" fw-bold" default="Email từ chối yêu cầu hủy" fiedName="Category"
                      [formModel]="formModel">
                    </codx-label>
                    <div class="d-flex">
                      <div class="w-100 me-2">
                        <codx-input type="valuelist" name="valuelist" [crrValue]="dialogApprovalStep.value.category"
                          [refValue]="cbxName['Category']" field="category" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="icon-edit_file text-hover-primary icon-20 ml-2"></div>
                    </div>
                  </div>

                  <div class="d-flex justify-content-between align-items-center mb-4 ">
                    <h4 class="fw-bolder text-gray-800 d-block mb-2">
                      <codx-label default="Thiết lập mẫu email cảnh báo quá hạn duyệt" [formModel]="formModel"
                        fiedName="Attendees">
                      </codx-label>
                    </h4>
                  </div>
                  <div class="d-flex flex-column mb-4">
                    <codx-label class=" fw-bold" default="Email nhắc duyệt đến hạn" fiedName="Category"
                      [formModel]="formModel">
                    </codx-label>
                    <div class="d-flex">
                      <div class="w-100 me-2">
                        <codx-input type="valuelist" name="valuelist" [crrValue]="dialogApprovalStep.value.category"
                          [refValue]="cbxName['Category']" field="category" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="icon-edit_file text-hover-primary icon-20 ml-2"></div>
                    </div>
                  </div>

                  <div class="d-flex justify-content-between align-items-center mb-4 ">
                    <h4 class="fw-bolder text-gray-800 d-block mb-2">
                      <codx-label default="Thiết lập thời gian gửi email" [formModel]="formModel" name="lblTime">
                      </codx-label>
                    </h4>
                  </div> -->
                  <!-- <div class="d-flex align-items-center mb-4">
                    <span class="fw-bolder text-gray-800 d-block mb-2 text-primary">
                      <codx-label default="Thời gian gửi" [formModel]="formModel" name="lblTime">
                      </codx-label>
                    </span>
                  </div> -->
                  <!-- <div class="d-flex flex-column mb-4">
                    <div class=" row mt-1">
                      <div class="col-3">
                        <div class="d-flex align-items-center">
                          <codx-input #checkbox type="switch" [checked]="dialogApprovalStep.value.eSign"
                            labelPosition="After" field="eSign" [disabled]="false" class="test-switch"
                            (valueChange)="valueChange($event)"></codx-input>
                          <label class="ms-2 mt-1">
                            <codx-label default="Gửi ngay" [formModel]="formModel" fiedName="Attendees">
                            </codx-label>
                          </label>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="d-flex align-items-center">
                          <label class="ml-2 mt-1">
                            <codx-label default="Gửi vào lúc" [formModel]="formModel" fiedName="Attendees">
                            </codx-label>
                          </label>
                          <div class="col-6">
                            <codx-input class="test-datetime" type="datetime" format="t" field="endTime"
                              (valueChange)="valueChange($event)"></codx-input>

                          </div>

                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="separator my-5"></div> -->
                </div>
              </div>
            </ng-template>
          </e-tabitem>
          <e-tabitem [header]='headerText[3]'>
            <ng-template #content>
              <div id="rome" class="tabpanel p-5">
                <div class="tab-content">
                  <!-- <div class="d-flex justify-content-center mb-4">
                    <div class="d-flex align-items-center w-auto extend-title">
                      <span class="text-blue text-hover-primary_darker fw-bolder me-1">
                        <codx-label name="lblOverdue" default="Thiết lập xử lí quá hạn" [formModel]="formModel">
                        </codx-label>
                      </span>
                      <span *ngIf="showPlan"
                        class="icon-keyboard_arrow_down icon-16 text-primary text-hover-primary_darker"></span>
                      <span *ngIf="!showPlan"
                        class="icon-keyboard_arrow_up icon-16 text-primary text-hover-primary_darker"></span>
                    </div>
                  </div> -->
                  <div class="d-flex flex-column mb-4">
                    <div class="row">
                      <div class="col-6">
                        <codx-label class="fw-bolder" default="Cảnh báo đến hạn" fiedName="OverdueControl"
                          [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['OverdueControl']"
                          field="overdueControl" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="col-3">
                        <codx-label class="fw-bolder" default="Thời gian nhắc" fiedName="Reminder"
                          [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['Reminder']" field="reminder"
                          (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="col-3">
                        <codx-label class="fw-bolder" default="Số lần lặp" fiedName="Loops" [formModel]="formModel">
                        </codx-label>
                        <codx-input type="number" name="number" [min]="0" placeholder="0" field="loops"
                          (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                    </div>
                  </div>
                  <div class="d-flex flex-column mb-4">
                    <div class="row">
                      <div class="col-6">
                        <codx-label class="fw-bolder" default="Xử lí động khi quá hạn" fiedName="OverdueControl"
                          [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['OverdueControl']"
                          field="overdueControl" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="col-3">
                        <codx-label class="fw-bolder" class="fw-bolder" default="Thời gian nhắc" fiedName="Reminder"
                          [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['Reminder']" field="reminder"
                          (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                      <div class="col-3">
                        <codx-label class="fw-bolder" default="Số lần lặp" fiedName="Loops" [formModel]="formModel">
                        </codx-label>
                        <codx-input type="number" name="number" [min]="0" placeholder="0" field="loops"
                          (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                    </div>
                  </div>
                  <!-- <div class="d-flex justify-content-center mb-4" (click)="extendShowPlan1()">
                    <div class="d-flex align-items-center w-auto extend-title">
                      <span class="text-blue text-hover-primary_darker fw-bolder me-1">
                        <codx-label name="lblCancel" default="Thiết lập hủy/thu hồi" [formModel]="formModel">
                        </codx-label>
                      </span>
                      <span *ngIf="showPlan1"
                        class="icon-keyboard_arrow_down icon-16 text-primary text-hover-primary_darker"></span>
                      <span *ngIf="!showPlan1"
                        class="icon-keyboard_arrow_up icon-16 text-primary text-hover-primary_darker"></span>
                    </div>
                  </div> -->
                  <div class="d-flex flex-column mb-4">
                    <div class="row">
                      <div class="col-7">
                        <codx-label class="fw-bolder" default="Cho phép hủy yêu cầu khi đã duyệt"
                          fiedName="CancelControl" [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['CancelControl']"
                          field="cancelControl" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                    </div>
                  </div>
                  <div class="d-flex flex-column mb-4">
                    <div class="row">
                      <div class="col-7">
                        <codx-label class="fw-bolder" class="fw-bolder" default="Thay thế vị trí trống"
                          fiedName="CancelControl" [formModel]="formModel">
                        </codx-label>
                        <codx-input type="valuelist" name="valuelist" [refValue]="cbxName['CancelControl']"
                          field="cancelControl" (valueChange)="valueChange($event)">
                        </codx-input>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </e-tabitem>
        </e-tabitems>
      </ejs-tab>
    </div>
  </ng-template>
  <ng-template #footer>
    <div class="d-flex justify-content-end">
      <a class="btn btn-primary font-weight-bold" (click)="onSaveForm()">
        <codx-label name="lblSave" default="Lưu" [formModel]="formModel"></codx-label>
      </a>
    </div>
  </ng-template>

</codx-form>


<ng-template>
  <!-- <attachment #attachment type="right" objectType="ES_Signatures" [objectId]="" [functionID]="modelPage.functionID"
    (fileAdded)="fileAdded($event)"></attachment> -->
</ng-template>
