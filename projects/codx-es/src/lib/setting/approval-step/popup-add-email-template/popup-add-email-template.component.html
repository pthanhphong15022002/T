<codx-form [dialog]="dialog" [headerText]="headerText" [subHeaderText]="subHeaderText" [body]="body" [footer]="footer"
  [formControl]="dialogETemplate" *ngIf="isAfterRender">
  <ng-template #body>
    <div class="request-to">
      <div id="from">
        <div class="d-flex justify-content-between border-bottom mt-1">
          <div class="d-flex align-items-end flex-grow-1">
            <div class="w-50px fw-bold">
              <codx-label name="lblTitleFrom" default="Từ:" formName="EmailTemplates" gridViewName="grvEmailTemplates">
              </codx-label>
            </div>
            <div class="w-100 me-2">
              <div class="d-flex align-items-center">
                <ng-container *ngFor="let item of lstFrom">
                  <div class="d-flex justify-content-between user-mini-nav-custom align-items-center">
                    <div class="me-3">
                      <codx-img [objectId]="item.objetID" objectType="AD_Users" width="25"></codx-img>
                    </div>
                    <div class="text-gray-600 flex-grow-1 me-2">{{item.text}}</div><a
                      class="text-hover-danger d-flex align-items-center" (click)="deleteItem(item, 1)"><span
                        class="icon-close icon-16"></span></a>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
          <span>
            <codx-input [showInput]="false" [multiple]="true" type="share" refValue="ES014" field="from"
              (valueChange)="valueSentoChange($event, 1)" crrValue="HPHOA">
            </codx-input>
          </span>
        </div>
      </div>
      <div class="d-flex justify-content-between border-bottom mt-1">
        <div class="d-flex align-items-end flex-grow-1">
          <div class="w-50px fw-bold">
            <codx-label default="Đến:" name="lblTitleTo" formName="EmailTemplates" gridViewName="grvEmailTemplates">
            </codx-label>
          </div>
          <div class="w-100 me-2" (onblur)="focusOutFunction()">
            <div class="d-flex align-items-center">
              <ng-container *ngFor="let item of lstTo">
                <div class="d-flex justify-content-between user-mini-nav-custom align-items-center">
                  <div class="me-3">
                    <codx-img [objectId]="item.objetID" objectType="AD_Users" width="25"></codx-img>
                  </div>
                  <div class="text-gray-600 flex-grow-1 me-2">{{item.text}}</div><a
                    class="text-hover-danger d-flex align-items-center" (click)="deleteItem(item, 2)"><span
                      class="icon-close icon-16"></span></a>
                </div>
              </ng-container>
            </div>
          </div>
        </div>
        <div class="d-flex align-items-end">
          <span class="btn btn-sm fw-bold align-items-end" *ngIf="!showCC && !showBCC"
            (click)="changeSendType('cc')">Cc</span>
          <span class="btn btn-sm fw-bold" *ngIf="!showCC && !showBCC" (click)="changeSendType('bcc')">Bcc</span>
          <span>
            <codx-input [showInput]="false" [multiple]="true" type="share" refValue="ES014" field="to"
              (valueChange)="valueSentoChange($event, 2)">
            </codx-input>
          </span>
        </div>
      </div>
      <div id="box_cc" *ngIf="showCC || lstCc.length >0">
        <div class="d-flex justify-content-between border-bottom mt-1">
          <div class="d-flex align-items-end flex-grow-1">
            <div class="w-50px fw-bold">Cc:</div>
          </div>
          <div class="w-100 me-2">
            <div class="d-flex align-items-center">
              <ng-container *ngFor="let item of lstCc">
                <div class="d-flex justify-content-between user-mini-nav-custom align-items-center">
                  <div class="me-3">
                    <codx-img [objectId]="item.objetID" objectType="AD_Users" width="25"></codx-img>
                  </div>
                  <div class="text-gray-600 flex-grow-1 me-2">{{item.text}}</div><a
                    class="text-hover-danger d-flex align-items-center" (click)="deleteItem(item, 3)"><span
                      class="icon-close icon-16"></span></a>
                </div>
              </ng-container>
            </div>
          </div>
          <div class="d-flex align-items-end">
            <span class="btn btn-sm fw-bold" *ngIf="!showBCC" (click)="changeSendType('bcc')">Bcc</span>
            <span>
              <codx-input [showInput]="false" [multiple]="true" type="share" refValue="ES014" field="cc"
                (valueChange)="valueSentoChange($event, 3)">
              </codx-input>
            </span>
          </div>

          <!-- <span class="icon-person_add_alt_1 text-primary text-hover-dark icon-18"></span> -->
        </div>
      </div>
      <div id="box_bcc" *ngIf="showBCC || lstBcc.length >0">
        <div class="d-flex justify-content-between border-bottom mt-1">
          <div class="d-flex align-items-end flex-grow-1">
            <div class="w-50px fw-bold">Bcc:</div>
          </div>
          <div class="w-100 me-2">
            <div class="d-flex align-items-center">
              <ng-container *ngFor="let item of lstBcc">
                <div class="d-flex justify-content-between user-mini-nav-custom align-items-center">
                  <div class="me-3">
                    <codx-img [objectId]="item.objetID" objectType="AD_Users" width="25"></codx-img>
                  </div>
                  <div class="text-gray-600 flex-grow-1 me-2">{{item.text}}</div><a
                    class="text-hover-danger d-flex align-items-center" (click)="deleteItem(item, 4)"><span
                      class="icon-close icon-16"></span></a>
                </div>
              </ng-container>
            </div>
          </div>
          <div class="d-flex align-items-end">
            <span class="btn btn-sm fw-bold" *ngIf="!showCC" (click)="changeSendType('cc')">Cc</span>
            <span>
              <codx-input [showInput]="false" [multiple]="true" type="share" refValue="ES014" field="bcc"
                (valueChange)="valueSentoChange($event, 4)">
              </codx-input>
            </span>
          </div>
        </div>
      </div>
    </div>
    <div class="d-flex justify-content-between border-bottom mt-4">
      <div class="d-flex align-items-center flex-grow-1">
        <codx-input type="text" class="borderless" placeholder="Chủ đề" ControlName="subject" [Group]="dialogETemplate">
        </codx-input>
      </div>
      <div ngbDropdown class=" dropdown">
        <button ngbDropdownToggle class="btn btn-sm btn-light d-flex align-items-center" type="button"
          id="dropdownMenuButton1" aria-expanded="false">
          <span>Chọn mẫu</span>
          <span class="icon-keyboard_arrow_down icon-16 ms-2"></span>
        </button>
        <ul ngbDropdownMenu aria-labelledby="dropdownMenuButton1">
          <li>
            <div class="mb-1 mx-3">
              <codx-input type="text" [disabled]="false" placeholder="Tìm kiếm" (valueChange)="valueChange($event)">
              </codx-input>
            </div>
          </li>
          <li>
            <a ngbDropdownItem href="#">
              <div class="d-flex flex-column">
                <span class="text-dark">Cấp quyền xem tài liệu</span>
                <i class="fs-7 mt-1">Xin cấp quyền full xem tài liệu</i>
              </div>
            </a>
          </li>
          <li>
            <a ngbDropdownItem href="#">
              <div class="d-flex flex-column">
                <span class="text-dark">Cấp quyền full</span>
                <i class="fs-7 mt-1">Xin cấp quyền full control</i>
              </div>
            </a>
          </li>
          <div class="separator mt-3 opacity-75"></div>
          <li>
            <a ngbDropdownItem href="#">
              <span class="text-primary">Thêm mẫu mail</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="d-flex justify-content-between align-items-center mt-4">
      <div class="d-flex align-items-center">
        <span class="icon-attach_email icon-18 me-2 text-primary"></span>
        <span class="text-primary fw-bold">
          <codx-label default="Đính kèm file" name="lblAttachment" formName="EmailTemplates"
            gridViewName="grvEmailTemplates"></codx-label>
        </span>
      </div>
      <button class="btn btn-sm btn-light d-flex align-items-center" type="button">
        <span>
          <codx-label default="Chọn trường dữ liệu" name="lblChooseField" formName="EmailTemplates"
            gridViewName="grvEmailTemplates"></codx-label>
        </span>
        <span class="icon-keyboard_arrow_down icon-16 ms-2"></span>
      </button>
    </div>
    <div class="request-box mt-4">
      <!-- <textarea class="form-control" rows="12" placeholder="Nhập nội dung..."></textarea> -->
      <codx-input type="textarea" rows="12"></codx-input>
    </div>


    <div class="d-flex flex-column mb-4 mt-4">
      <div class="row mt-1">
        <div class="col-8 d-flex align-items-center">
          <div class="d-flex align-items-center me-3" *ngIf="showIsTemplate">
            <label class="ms-2 me-2">
              <codx-label default="Lưu thành template" fiedName="IsTemplate" formName="EmailTemplates"
                gridViewName="grvEmailTemplates">
              </codx-label>
            </label>
            <codx-input type="switch" [crrValue]="dialogETemplate.value.isTemplate" field="isTemplate"
              (valueChange)="valueChange($event)">
            </codx-input>
          </div>
          <div class="d-flex align-items-center me-3" *ngIf="showIsPublish">
            <label class="ms-2 me-2">
              <codx-label default="Dùng chung" formName="EmailTemplates" gridViewName="grvEmailTemplates"
                fiedName="IsPublish">
              </codx-label>
            </label>
            <codx-input type="switch" [crrValue]="dialogETemplate.value.isPublish" field="isPublish"
              (valueChange)="valueChange($event)">
            </codx-input>
          </div>
          <div class="d-flex align-items-center me-3" *ngIf="showSendLater">
            <label class="ms-2 me-2">
              <codx-label default="Gửi ngay" formName="EmailTemplates" gridViewName="grvEmailTemplates"
                fiedName="SendLater">
              </codx-label>
            </label>
            <codx-input type="switch" [crrValue]="!dialogETemplate.value.sendLater" field="sendLater"
              (valueChange)="valueChange($event)">
            </codx-input>
          </div>
        </div>
        <div class="col-4">
          <div class="d-flex align-items-center">
            <label class="mt-1 me-2">
              <codx-label default="Gửi vào lúc" formName="EmailTemplates" gridViewName="grvEmailTemplates"
                fiedName="SendTime">
              </codx-label>
            </label>
            <codx-input class="test-datetime ms-2" type="datetime" format="t" field="sendTime"
              [crrValue]="dialogETemplate.value.sendTime" (valueChange)="valueChange($event)"></codx-input>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
  <ng-template #footer>
    <div class="d-flex justify-content-end">
      <a class="btn btn-primary font-weight-bold" (click)="onSaveForm(null)">
        <codx-label name="lblSave" default="Lưu" formName="EmailTemplates" gridViewName="grvEmailTemplates">
        </codx-label>
      </a>
    </div>
  </ng-template>
</codx-form>

<ng-template #addTemplateName let-dialog1>
  <div class="card-header flex-column">
    <div class="d-flex flex-column flex-grow-1">
      <div class="d-flex justify-content-between align-items-center">
        <h3 id="modal-basic-title">
          <codx-label name="lblEquipment" default="Nhập tên" [formModel]="dialog.formModel"></codx-label>
        </h3>
        <button type="button" class="btn btn-xs btn-icon btn-light btn-hover-primary" aria-label="Close"
          (click)="close2(dialog1)">
          <span class="icon-close icon-20 text-dark text-hover-primary"></span>
        </button>
      </div>
    </div>
  </div>
  <div class="card-body" style="min-height: 150px;">
    <div class="d-flex align-items-center me-3 mt-10">
      <label class="ms-2 me-2">
        <codx-label default="Tên template mẫu" formName="EmailTemplates" gridViewName="grvEmailTemplates"
          fiedName="TemplateName">
        </codx-label>
      </label>
      <codx-input type="text" [crrValue]="dialogETemplate.value.templateName" field="templateName"
        (valueChange)="valueChange($event)">
      </codx-input>
    </div>

  </div>
  <div class="card-footer border-0">
    <div class="d-flex justify-content-end">
      <a class="btn btn-primary font-weight-bold" (click)="onSaveForm1(dialog1)">
        <codx-label name="lblSave" default="Lưu" formName="EmailTemplates" gridViewName="grvEmailTemplates">
        </codx-label>
      </a>
    </div>
  </div>

</ng-template>
