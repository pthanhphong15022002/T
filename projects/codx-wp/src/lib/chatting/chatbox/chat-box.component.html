<div class="modal-dialog modal-dialog-centered mw-400px">
  <!--begin::Modal content-->
  <div class="modal-content">
    <!--begin::Modal header-->
    <div class="modal-header py-0">
      <div class="d-flex flex-stack py-4">
        <!--begin::Details-->
        <div class="d-flex align-items-center">
          <!--begin::Avatar-->
          <div class="symbol symbol-40px symbol-circle">
            <codx-img [objectId]="receiverId" [objectName]="receiverName" objectType="AD_Users"
              class="symbol symbol-35px symbol-circle">
            </codx-img>
            <!-- <img
              alt="Pic"
              src="../../../assets/themes/wp/default/light/img/user_F1.svg"
            /> -->
            <div class="symbol-badge bg-success start-100 top-100 border-4 h-15px w-15px ms-n2 mt-n2"></div>
          </div>
          <!--end::Avatar-->
          <!--begin::Details-->
          <div class="ms-4">
            <!--begin::Name-->
            <a href="#" class="d-flex align-items-center fs-5 fw-bolder text-dark text-hover-primary">{{ receiverName }}
            </a>
            <!--end::Name-->
            <div class="badge badge-danger fs-8 fw-bold" *ngIf="tags">
              {{ tags }}
            </div>
          </div>
          <!--end::Details-->
        </div>
        <!--end::Details-->
      </div>
      <div class="card-toolbar">
        <span class="icon-open_in_new icon-24 text-dark-75 text-hover-primary ms-3"></span>
        <span class="icon-horizontal_rule icon-24 text-dark-75 text-hover-primary ms-3"
          (click)="onMinimize($event)"></span>
        <span class="icon-close icon-24 text-dark-75 text-hover-primary ms-3" (click)="onClose($event)"></span>
      </div>
    </div>
    <!--begin::Modal header-->

    <!--begin::Modal body-->
    <div class="modal-body">
      <!--begin::Scroll-->
      <div class="scroll-y me-n7 pe-7" id="kt_modal_new_address_scroll" data-kt-scroll="true"
        data-kt-scroll-activate="{default: false, lg: true}" data-kt-scroll-max-height="auto"
        data-kt-scroll-dependencies="#kt_modal_new_address_header"
        data-kt-scroll-wrappers="#kt_modal_new_address_scroll" data-kt-scroll-offset="300px"
        style="max-height: 400px; height: 400px" (scroll)="onScroll($event)">
        <!--begin::Messages-->
        <div class="messages">
          <ng-container *ngFor="let item of chatMessages; let i = index">
            <!--begin::Message Out-->
            <div class="d-flex flex-column mb-5 align-items-end"
              *ngIf="item.messageType == '1' && item.senderId == senderId">
              <div class="d-flex align-items-center flex-wrap gap-2">
                <div class="d-flex">
                  <!--begin::Star-->
                  <div class="dropdown">
                    <button class="btn btn-sm btn-icon btn-clear btn-active-light-primary me-3" type="button"
                      id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <span class="icon-more_vert icon-20 text-dark-25"></span>
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-attach icon-18"></span>
                          <span class="ms-3">Đính kèm</span>
                        </div>
                      </a>
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-share icon-18 text-warning"></span>
                          <span class="ms-3">Gửi mail</span>
                        </div>
                      </a>
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-share icon-18"></span>
                          <span class="ms-3">Chia sẻ</span>
                        </div>
                      </a>
                      <div class="dropdown-divider"></div>
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-list_alt icon-18"></span>
                          <span class="ms-3">Chức năng mở rộng</span>
                        </div>
                      </a>
                    </div>
                  </div>

                  <a href="#" class="btn btn-sm btn-icon btn-clear btn-active-light-primary me-3">
                    <span class="icon-tag_faces icon-18 text-dark-25 ms-3 me-2"></span>
                  </a>
                  <a href="#" class="btn btn-sm btn-icon btn-clear btn-active-light-primary me-3">
                    <span class="icon-redo icon-18 ms-3 me-2 text-dark-25"></span>
                  </a>
                </div>
              </div>
              <div class="mt-2 mess-rounded p-2 bg-primary text-white fw-bold font-size-lg text-right max-w-400px">
                {{item.message}}
              </div>
            </div>
            <!--end::Message Out-->

            <div class="separator separator-content my-15" *ngIf="item.messageType == '3'">
              14/10/2021 2:54 PM
            </div>

            <!--begin::Message In-->
            <div class="d-flex align-items-start user-card py-2"
              *ngIf="item.messageType == '1' && item.senderId != senderId">
              <div class="symbol symbol-35px symbol-circle me-4" *ngIf="item.showImage">
                <img alt="Pic" src="../../../assets/themes/wp/default/light/img/user_F3.svg" />
              </div>
              <div class="d-flex">
                <div class="mt-2 rounded bg-light-info p-2 bg-light-primary text-dark max-w-400px">
                  {{ item.message }}
                </div>
              </div>

              <div class="d-flex align-items-center flex-wrap gap-2">
                <div class="d-flex">
                  <!--begin::Star-->
                  <a href="#" class="btn btn-sm btn-icon btn-clear btn-active-light-primary me-3">
                    <span class="icon-redo icon-18 ms-3 me-2 text-dark-25"></span>
                  </a>
                  <a href="#" class="btn btn-sm btn-icon btn-clear btn-active-light-primary me-3">
                    <span class="icon-tag_faces icon-18 text-dark-25 ms-3 me-2"></span>
                  </a>
                  <!-- <div class="dropdown">
                    <button
                      class="btn btn-sm btn-icon btn-clear btn-active-light-primary me-3"
                      type="button"
                      id="dropdownMenuButton"
                      data-toggle="dropdown"
                      aria-haspopup="true"
                      aria-expanded="false"
                    >
                      <span class="icon-more_vert icon-20 text-dark-25"></span>
                    </button>
                    <div
                      class="dropdown-menu"
                      aria-labelledby="dropdownMenuButton"
                    >
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-attach icon-18"></span>
                          <span class="ms-3">Đính kèm</span>
                        </div>
                      </a>
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-share icon-18 text-warning"></span>
                          <span class="ms-3">Gửi mail</span>
                        </div>
                      </a>
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-share icon-18"></span>
                          <span class="ms-3">Chia sẻ</span>
                        </div>
                      </a>
                      <div class="dropdown-divider"></div>
                      <a class="dropdown-item">
                        <div class="d-flex align-items-center">
                          <span class="icon-list_alt icon-18"></span>
                          <span class="ms-3">Chức năng mở rộng</span>
                        </div>
                      </a>
                    </div>
                  </div> -->
                </div>
              </div>
            </div>
            <!--end::Message In-->
          </ng-container>
        </div>
        <!--end::Messages-->
      </div>
      <!--end::Scroll-->
    </div>
    <!--end::Modal body-->

    <!--begin::Modal footer-->
    <div class="modal-footer px-0" style="display: flexbox">
      <div class="d-flex flex-stack justify-content-between">
        <!--begin::Actions-->
        <div class="d-flex align-items-start justify-content-between">
          <button class="btn btn-sm btn-icon btn-active-light-primary me-1" type="button" data-bs-toggle="tooltip"
            title="" data-bs-original-title="Biểu cảm">
            <i class="icon-tag_faces icon-24 text-primary"></i>
          </button>
          <button class="btn btn-sm btn-icon btn-active-light-primary me-1" type="button" data-bs-toggle="tooltip"
            title="" data-bs-original-title="đính kèm">
            <i class="icon-broken_image icon-24 text-primary"></i>
          </button>
        </div>
        <input class="form-control form-control-flush form-message" data-kt-element="input" placeholder="Type a message"
          [(ngModel)]="message" (keydown.enter)="sendMessage()" />
        <!--end::Actions-->
        <!--begin::Send-->
        <div class="d-flex align-items-end justify-content-between">
          <button class="btn btn-sm btn-icon btn-active-light-primary me-1" type="button" data-bs-toggle="tooltip"
            title="" data-bs-original-title="send" data-kt-element="send" (click)="sendMessage()">
            <i class="icon-send icon-24 text-primary"></i>
          </button>
        </div>
        <!--end::Send-->
      </div>
    </div>
    <!--end::Modal footer-->
  </div>
</div>