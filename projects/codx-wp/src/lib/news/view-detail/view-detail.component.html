<codx-views #codxViews entityName="WP_News" [views]="views" [showToolBar]="false">
</codx-views>
<ng-template #panelLeftRef>
    <div class="news-main mt-6">
        <div class="row">
            <div class="col-8">
                <div class="news-detail">
                    <div class="fs-2 fw-bolder text-dark news-title mb-3" [innerHTML]="dataItem?.subject"></div>
                    <div class="text-info-date">
                        <!-- <span class="text-muted font-size-sm mr-2" data-toggle="tooltip"
                            title="{{dataItem.createdOn | date:'dd/MM/yyyy HH:mm'}}">{{dataItem.createdOn | timefrom}}
                        </span> -->
                        <span *ngIf="dataItem.shareControl == 'D' ||
                            dataItem.shareControl == 'P' || dataItem.shareControl == 'R' || dataItem.shareControl == 'G' ||
                            dataItem.shareControl == 'U'; else other_option" class="ml-1 cursor-pointer" placement="bottom"
                            [popoverTitle]="popTitleOfShare" [ngbPopover]="popContentOfShare" [autoClose]='"outside"'
                            (click)="getShareUser(dataItem.shareControl, dataItem.recID)">
                            <span class="mr-2 text-primary text-underline" (click)="dataItem.shared > 0 "
                                href="javascript:void(0)">
                                <ng-container *ngIf="dataItem.shareControl == 'U'; else notU">
                                    <ng-container *ngIf="dataItem.shared == 1;else multipleShared">
                                        <codx-label [formModel]="codxViews.formModel" name="lblShareWith" default="cùng với "></codx-label>
                                        <span class="ms-2 me-2">{{dataItem.shareName}}</span>
                                    </ng-container>
                                    
                                </ng-container>
                                <ng-template #notU>
                                    <ng-container *ngIf="dataItem.shared == 1;else multipleShared">
                                        <codx-label [formModel]="codxViews.formModel" name="lblShareWith" default="cùng với phòng ban "></codx-label>
                                        <span class="ms-2 me-2">{{dataItem.shareName}}</span>
                                    </ng-container>
                                </ng-template>
                                <ng-template #multipleShared>
                                    <span class="ms-2 me-2">{{dataItem.shareName}}</span>
                                </ng-template>
                            </span>
                        </span>
                        <ng-template #other_option></ng-template>
                    </div>
                    <div class="d-flex flex-center justify-content-between news-header border-bottom px-2 py-1">
                        <div class="d-flex flex-center">
                            <div class="d-flex flex-center bagde-light me-6">
                                <span class="fs-6 text-gray-600 me-1" [ngClass]="dataItem?.shareControl | vll:'L1901':'icon' | async"></span>
                                <span class="fs-7 text-gray-600">{{dataItem?.shareControl | vll:'L1901':'text' | async}}</span>
                            </div>
                            <div class="d-flex flex-center me-6">
                                <span class="icon-account_circle me-1 fs-6 text-gray-600"></span>
                                <span class="fs-7 text-gray-600">{{dataItem?.createdByName}}</span>
                            </div>
                            <div class="d-flex flex-center me-6">
                                <span class="icon-calendar_customize me-1 fs-6 text-gray-600"></span>
                                <span class="fs-7 text-gray-600">{{dataItem?.createdOn | fmDT}}</span>
                            </div>
                            <div class="d-flex flex-center me-6">
                                <span class="icon-visibility me-1 fs-6 text-gray-600"></span>
                                <span class="fs-7 text-gray-600">{{dataItem?.views}}</span>
                            </div>
                        </div>
                        <button class="btn btn-icon btn-sm btn-light-primary"><span class="icon-share"></span></button>
                    </div>
                    <ng-contianer *ngIf="dataItem?.newsType == NEW_TYPE.video;else news">
                        <div class="py-3 news-cont">
                            <!-- <video controls width="100%" height="450" allowfullscreen>
                                <source type="video/mp4" [src]="dataItem?.image" title="YouTube video player"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" />
                            </video> -->
                            <iframe width="100%" height="450" src="https://www.youtube.com/embed/gUDVVodgXDQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        </div>
                    </ng-contianer>
                    <ng-template #news>
                        <div class="py-3 news-cont" [innerHTML]="dataItem?.subContent"></div>
                        <div class="py-3 news-cont" [innerHTML]="dataItem?.contents"></div>
                    </ng-template>
                    <div class="fw-bolder fs-3 erer text-primary mt-6">
                        <codx-label fromName="News" name="lblViewmore" default="Xem thêm" ></codx-label>
                    </div>
                    <div class="news-more">
                        <ul>
                            <li (click)="clickViewDeital(item)" *ngFor="let item of listNews"
                                class="fs-6 er mt-2 news-title ">
                                <a href="javascript:void(0)">
                                    <span class="fs-6 text-dark fw-bolder">{{item.subject}}</span> 
                                <span class="fs-7 ms-2 text-muted">{{item.createdOn | fmDT}}</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-4 ps-9">
                <div class="fw-bolder er text-primary fs-3 mb-5 border-bottom border-gray pb-2">
                    <codx-label fromName="News" name="lblTopview" default="Xem nhiều nhất"></codx-label>
                </div>
                <div class="news-items" *ngFor="let item of listViews" (click)="clickViewDeital(item)">
                    <div class="row">
                        <div class="col-3">
                            <codx-img width="90" imageType="square" [objectId]="item.recID" [objectType]="'WP_News'">
                            </codx-img>
                        </div>
                        <div class="col-9">
                            <div class="fs-6 fw-bolder news-title">
                                {{item.subContent | maxlenght:50}}
                            </div>
                            <div class="d-flex justify-content-between mt-2">
                                <div class="fs-7 d-flex flex-center">
                                    <span class="icon-visibility icon-18 text-gray-500"></span>
                                    <span class="text-gray-500 ms-1">{{item.views}}</span>
                                </div>
                                <div class="fs-7 text-gray-500">{{item.createdOn | fmDT}}</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="fw-bolder text-primary fs-3 mt-9 mb-5 border-bottom border-gray">
                    <codx-label formName="News" name="lblTags" default="Tag #"></codx-label>
                </div>
                <!-- <div class="badge-group">
                    <span *ngFor="let tag of listTag" class="badge badge-danger" [style.background]="tag.color"
                        (click)="clickTag(tag)">{{tag.text}}
                    </span>
                </div> -->
            </div>
            <div class="more-function">
                <div class="d-flex flex-column">
                    <a (click)="clickShowPopupSearch()" class="btn btn-icon btn-primary"><i
                            class="icon-search fs-1"></i></a>
                    <span class="postnews mt-3">
                        <a class="btn btn-icon btn-primary"><i class="icon-add fs-1"></i></a>
                        <div class="d-flex btn-postnews">

                            <a (click)="clickShowPopupCreate()" class="btn btn-icon btn-primary me-3"><i
                                    class="icon-video_call fs-1"></i></a>
                            <a (click)="clickShowPopupCreate()" class="btn btn-icon btn-primary"><i
                                    class="icon-post_add fs-1"></i></a>
                        </div>
                    </span>


                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #popTitleOfShare>
    <div class="text-dark mb-2" style="font-size: 14px;">
        <codx-label formName="Comments" name="lblShare" default="Danh sách người được chia sẻ"></codx-label>
    </div>
</ng-template>

<ng-template #popContentOfShare style="width: fit-content; height: fit-content;">
    <div *ngIf="show()">
        <div *ngFor="let tagUser of tagUsers | filter: searchField:'objectName'">
            <div *ngIf="tagUser.orgUnitName == undefined">
                <div class="row" style="margin-top: 10px;margin-bottom: 10px;margin-left: -10px;">
                    <div class="col-md-2">
                        <codx-img class="symbol symbol-40px symbol-circle me-3" [objectId]="tagUser.userID"
                            objectType=" HR_Employees">
                        </codx-img>
                    </div>
                    <div class="col-md-8">
                        <div class="text-dark pb-1" style="font-weight: BOLD;">{{ tagUser.objectName }}</div>
                        <div class="row" style="margin-left: -10px;">
                            <div class="text-gray-600 col-md-12">{{ tagUser?.positionName}}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</ng-template>