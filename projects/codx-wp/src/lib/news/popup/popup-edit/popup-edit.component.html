<div class="pt-5 px-7 pb-0">
    <!-- header -->
    <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
            <div class="fw-bolder">
                <span class="fs-2">{{headerText}}</span>
            </div>
            <div class="ms-5" (click)="openFormShare(controlShare)">
                <codx-vll
                    [classList]="'bg-gray-200 rounded-1 p-2'" 
                    [name]="'WP001'" 
                    [formModel]="dialogRef.formModel"
                    [value]="data.shareControl" 
                    [showText]="true" 
                    [showIcon]="true"
                    [showBgColor]="true">
                </codx-vll>
            </div>
            <ng-container *ngIf="shareWith">
                <div class="ms-2">
                    <span class="fs-6" [innerHTML]="shareWith"></span>
                </div>
            </ng-container>
        </div>
        <div class="">
            <button class="btn btn-icon btn-white" (click)="clickClosePopup()">
                <i class="icon-close"></i>
            </button>
        </div>
    </div>
    <!-- body -->
    <div class="row">
        <div class="mt-2 mb-4">
            <codx-tag 
                entityName="WP_News" 
                [isEdit]="false" 
                field="Tags" 
                [value]="data.tags"
                (valueChange)="valueChange($event)">
            </codx-tag>
        </div>
        <div class="col-5 h-100 news-edit-left">
            <div class="card w-100 rounded-0 border-0">
                <div class="">
                    <div class="mb-2">
                        <codx-label 
                            class="fw-bolder" 
                            [formModel]="dialogRef.formModel" 
                            [fiedName]="'Category'">
                        </codx-label>
                    </div>
                    <codx-input 
                        type="valuelist" 
                        name="valuelist" 
                        refValue="L1492" 
                        field="Category"
                        [crrValue]="data.category" 
                        (valueChange)="valueChange($event)">
                    </codx-input>
                </div>
                <div class="row">
                    <div class="col-6">
                        <div class="my-2">
                            <codx-label 
                                class="fw-bolder" 
                                [formModel]="dialogRef.formModel" 
                                [fiedName]="'StartDate'">
                            </codx-label>
                        </div>
                        <codx-input 
                            type="datetime" 
                            class="test-datetime" 
                            field="StartDate"
                            [crrValue]="data.startDate" 
                            format="F"
                            (valueChange)="valueChange($event)">
                        </codx-input>
                    </div>
                    <div class="col-6">
                        <div class="my-2">
                            <codx-label class="fw-bolder" 
                                [formModel]="dialogRef.formModel" 
                                [fiedName]="'EndDate'">
                            </codx-label>
                        </div>
                        <codx-input 
                            type="datetime" 
                            class="test-datetime" 
                            field="EndDate"
                            [crrValue]="data.endDate" 
                            format="F"
                            (valueChange)="valueChange($event)">
                        </codx-input>
                    </div>
                </div>
                <div class="">
                    <div class="my-2">
                        <codx-label 
                            class="fw-bolder" 
                            [formModel]="dialogRef.formModel" 
                            [fieldName]="'Subject'">
                        </codx-label>
                    </div>
                    <codx-input 
                        type="text" 
                        class="form-control" 
                        field="Subject"
                        [crrValue]="data.subject" 
                        (valueChange)="valueChange($event)">
                    </codx-input>
                </div>
                <div class="">
                    <div class="my-2">
                        <codx-label 
                            class="fw-bolder" 
                            [formModel]="dialogRef.formModel" 
                            [fiedName]="'SubContent'">
                        </codx-label>
                    </div>
                    <codx-input 
                        class="form-control" 
                        type="textarea" 
                        format="ed2" 
                        [rows]="'4'"
                        field="SubContent" 
                        [crrValue]="data.subContent"
                        (valueChange)="valueChange($event)" ngDefaultControl>
                    </codx-input>
                </div>

                <div class="row">
                    <div class="w-100 my-2">
                        <codx-label 
                            class="fw-bolder" 
                            [formModel]="dialogRef.formModel" 
                            [fiedName]="'Image'">
                        </codx-label>
                    </div>
                    <div class="w-100" (click)="clickUploadFile('image')">
                        <img class="w-100 h-200px" [src]="fileImage?.source || fileImage?.avatar || null" alt="">
                    </div>
                </div>
                <div class="d-flex align-items-center mb-2 mt-3">
                    <div class="me-3">
                        <codx-label 
                            class="fw-bolder" 
                            [formModel]="dialogRef.formModel" 
                            [fiedName]="'AllowShare'"
                            [default]="'Cho phép chia sẻ MXH nội bộ'">
                        </codx-label>
                    </div>
                    <codx-input 
                        type="switch" 
                        [checked]="false" 
                        [disabled]="false"
                        labelPosition="Before" 
                        field="AllowShare" 
                        [crrValue]="data.allowShare"
                        class="test-switch" 
                        (valueChange)="valueChange($event)">
                    </codx-input>
                </div>
                <div class="d-flex align-items-center mb-2">
                    <div class="me-3">
                        <codx-label 
                            class="fw-bolder" 
                            [formModel]="dialogRef.formModel" 
                            [fiedName]="'CreatePost'"
                            default="Tạo bài viết MXH nội bộ tự động">
                        </codx-label>
                    </div>
                    <codx-input 
                        type="switch" 
                        [checked]="false" 
                        [disabled]="false" 
                        id="switchCreated"
                        labelPosition="Before" 
                        field="CreatePost" 
                        [crrValue]="data.createPost"
                        class="test-switch" 
                        (valueChange)="valueChange($event)">
                    </codx-input>
                </div>
            </div>
        </div>
        <div class="col-7 news-edit-right">
            <ng-container *ngIf="data.newsType == NEWSTYPE.POST; else templateVideo">
                <div class="mb-2">
                    <codx-label 
                        class="fw-bolder" 
                        [formModel]="dialogRef.formModel" 
                        [fiedName]="'Contents'"
                        default="Nội dung">
                    </codx-label>
                </div>
                <codx-input 
                    [height]="'600'" 
                    type="textarea" 
                    class="test-textarea" 
                    field="Contents"
                    [crrValue]="data.contents"
                    (valueChange)="valueChange($event)">
                </codx-input>
            </ng-container>
            <ng-template #templateVideo>
                <div class="w-100 h-100 p-2 border">
                    <!-- <wp-view-video #video
                        [ObjectID]="data.recID" 
                        [ObjectType]="'WP_News'" 
                        [funcID]="dialogRef.formModel.funcID" >
                    </wp-view-video> -->
                    <div class="d-flex align-items-end w-100 h-100" >
                        <video [src]="fileVideo?.source || fileVideo?.data || null" controls class="w-100" (click)="clickUploadFile('video')">
                        </video>
                    </div>
                </div>
            </ng-template>
            <div class="d-none">
                <codx-attachment #codxATM 
                    [functionID]="dialogRef.formModel.funcID" 
                    [objectId]="data.recID"
                    [objectType]="'WP_News'" 
                    [allowMultiFile]="0" 
                    [showMessage]="0"
                    [allowExtensions]="'.png,.mp4'"
                    [hideImageUpload]="'1'" 
                    [hideUploadBtn]="'1'" 
                    (fileCount)="addFile($event)">
                </codx-attachment>
            </div>
        </div>
    </div>
    <!-- footer -->
    <ng-container *ngIf="data.createdBy == user.userID ">
        <div class="card-footer px-0">
            <div class="d-flex align-items-center justify-content-end">
                <div *ngIf="data.approveStatus != APPROVE_STATUS.APPROVETED">
                    <button  (click)="clickUpdatePost()" type="button" class="btn btn-primary">
                        <codx-label [formModel]="dialogRef.formModel" name="lblUpdate" default="Cập nhật"></codx-label>
                    </button>
                </div>
                <ng-container *ngIf="data.approveStatus == APPROVE_STATUS.NEW">
                    <div class="ms-3">
                        <button (click)="clickReleasePost()" type="button" class="btn btn-primary">
                            <codx-label [formModel]="dialogRef.formModel" name="lblRelease" default="Phát hành"></codx-label>
                        </button>
                    </div>
                </ng-container>
            </div>
        </div>
    </ng-container>
    
</div>
<!-- templateshare -->
<ng-template #controlShare let-dialog>
    <codx-share 
        [dialog]="dialog" 
        [multiple]="false" 
        listName="WP001" 
        (eventApply)="eventApply($event)">
    </codx-share>
</ng-template>