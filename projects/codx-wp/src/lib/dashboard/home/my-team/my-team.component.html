
<div class="card my-team">
    <div class="card-header border-0">
        <div class="card-title mt-5">
            <codx-label class="mb-1" name="lblTeam" formName="HR_Employees" default="Thành viên nhóm"></codx-label>
        </div>
    </div>
    <div class="card-body pt-0 pb-2">
        <div class="team-group pb-3">
            <ngx-skeleton-loader *ngIf="!employeeMyTeam" count="5" animation="progress"></ngx-skeleton-loader>
            <div class="user-teams">
                <div *ngIf="employeeMyTeam">
                    <ng-container *ngFor="let item of employeeMyTeam; index as idx">
                        <ng-container *ngIf="item.employeeID && idx < 10">
                            <ng-container *ngIf="idx < 9">
                                <ng-container 
                                    [ngTemplateOutlet]="item?.isOnline ? tmpOnline : tmpOffline" 
                                    [ngTemplateOutletContext]="{item}">
                                </ng-container>
                            </ng-container>
                            <ng-container *ngIf="idx == 9">
                                <div (mouseenter)="PopoverEmpList(empPopoverList,employeeMyTeam)"
                                    [ngbPopover]="popContent" 
                                    popoverClass="empPopoverClass" 
                                    [popoverTitle]="popTitle"
                                    #empPopoverList="ngbPopover" placement="bottom" container="body" autoClose="outside"
                                    triggers="manual" class="symbol symbol-45px symbol-circle user-info ut-item ut-more"
                                    aria-describedby="ngb-popover-35">
                                    <span class="symbol-label fs-4">+{{employeeMyTeam.length-9}}</span>
                                </div>
                            </ng-container>
                        </ng-container>
                    </ng-container>
                </div>
            </div>
            
        </div>
    </div>
</div>
<ng-template #tmpOnline let-item="item">
    <div class="ut-item user-online">
        <codx-img 
            popoverClass="userPopoverClass" 
            [ngbPopover]="popEmpTitle" 
            placement="bottom"
            #empPopover="ngbPopover" 
            [width]="40" 
            [style.border-color]="online?.color"
            [openDelay]="500" 
            (mouseenter)="PopoverEmp(empPopover, item)"
            (mouseleave)="PopoverEmp(empPopover, null)" 
            [objectId]="item.employeeID"
            [objectName]="item.employeeName" 
            objectType="HR_Employees">
        </codx-img>
        <span class="value" [style.background-color]="online?.color"></span>
    </div>
</ng-template>
<ng-template #tmpOffline let-item="item">
    <div class="ut-item user-offline">
        <codx-img popoverClass="userPopoverClass" 
            [ngbPopover]="popEmpTitle" 
            placement="bottom"
            #empPopover="ngbPopover" [width]="40" 
            [openDelay]="500"
            (mouseenter)="PopoverEmp(empPopover, item)"
            (mouseleave)="PopoverEmp(empPopover, null)" 
            [objectId]="item.employeeID"
            [objectName]="item.employeeName" 
            objectType="HR_Employees"
            [style.border-color]="offline?.color">
            <span class="value" [style.background-color]="offline?.color"></span>
        </codx-img>
    </div>
</ng-template> 
<ng-template #popContent>
    <div *ngFor="let emp of listEmpInfo | filter : searchText : 'employeeName': '' :''" class="pb-2 full">
        <div class="d-flex flex-column org-card w-100 cursor-pointer" [ngbPopover]="popEmpTitle" placement="left"
            #pemp="ngbPopover" container="body" triggers="manual" (click)="PopoverEmpOfList(pemp,emp)">
            <div class="d-flex align-items-start">
                <codx-img class="me-3" [objectId]="emp?.employeeID" [objectName]="emp?.employeeName"
                    objectType="HR_Employees" [width]="30">
                </codx-img>
                <div class="d-flex flex-column w-100">
                    <div class="text-dark fw-bold">{{emp?.employeeName}}</div>
                    <div class="text-gray-500 fs-7">{{emp?.positionName}}</div>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template #popTitle>
    <div class="d-flex align-items-center justify-content-between">
        <div class="flex">
            <codx-label name="lblListEmployee" formName="HR_Employees" default="Danh sách nhân viên">
            </codx-label>
            <div class="left-5">({{employeeMyTeam?.length}})</div>
        </div>
    </div>
    <div class="mt-1">
        <codx-input type="text" class="form-control" [crrValue]="searchText" (valueChange)="valueChange($event)" placeholder="Tìm kiếm"></codx-input>
    </div>
</ng-template>

<ng-template #popEmpTitle>
    <div class="d-flex align-items-start user-card">
        <div class="me-4">
            <codx-img [width]="40" class="m-0" [objectId]="imployeeInfo?.employeeID"
                [objectName]="imployeeInfo?.employeeName" objectType="HR_Employees">
            </codx-img>
        </div>
        <div class="d-flex flex-column w-100">
            <div class="text-dark fw-bold">{{imployeeInfo?.employeeName}}</div>
            <div class="text-gray-700">{{imployeeInfo?.positionName}}</div>
            <div class="text-gray-500 fs-7">{{imployeeInfo?.organizationName}}</div>
        </div>
    </div>
    <div class="d-flex flex-column employee-add w-200px">
        <div class="d-flex align-items-center mt-1">
            <span class="icon-email icon-16 me-2"></span>
            <div class="text-dark-50" *ngIf="imployeeInfo?.email != ''">{{imployeeInfo?.email}}</div>
            <div class="text-50 text-muted" *ngIf="imployeeInfo?.email == ''">
                <codx-label name="lblEmail" formName="HR_Employees" default="Email"></codx-label>
            </div>
        </div>
        <div class="d-flex align-items-center mt-1">
            <span class="icon-phone_android icon-16 me-2"></span>
            <div class="text-dark-50" *ngIf="imployeeInfo?.phone != ''">{{imployeeInfo?.phone}}</div>
            <div class="text-50 text-muted" *ngIf="imployeeInfo?.phone == ''">
                <codx-label name="lblPhone" formName="HR_Employees" default="Số điện thoại"></codx-label>
            </div>
        </div>
        <div class="d-flex align-items-top mt-1">
            <span class="icon-place icon-16 me-2"></span>
            <div class="text-dark-50" *ngIf="imployeeInfo?.street!=''">{{imployeeInfo?.street}}</div>
            <div class="text-50 text-muted" *ngIf=" imployeeInfo?.street==''">
                <codx-label name="lblAddress" formName="HR_Employees" default="Địa chỉ thường trú"></codx-label>
            </div>
        </div>
    </div>
</ng-template>