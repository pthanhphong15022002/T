<div class="d-flex flex-column flex-root">
  <div class="page d-flex flex-row flex-column-fluid">
    <codx-aside *ngIf="asideDisplay" id="kt_aside" data-kt-drawer="true" data-kt-drawer-name="aside"
      data-kt-drawer-activate="{default: true, lg: false}" data-kt-drawer-overlay="true"
      data-kt-drawer-width="{default:'200px', '300px': '250px'}" data-kt-drawer-direction="start"
      data-kt-drawer-toggle="#kt_aside_mobile_toggle" class="aside" [ngClass]="asideCSSClasses" [asideMenu]="asideMenu">
    </codx-aside>
    <div class="wrapper d-flex flex-column flex-row-fluid">
      <codx-header [ngClass]="headerCSSClasses" [headerBar]="" class="header align-items-stretch"
        [headerRightBar]="headerRightBar" #codxHeader>
      </codx-header>
      <codx-wrapper class="d-flex flex-column flex-column-fluid" (resizedEvent)="contentResized($event)">
      </codx-wrapper>
    </div>
  </div>
</div>

<codx-scripts-init></codx-scripts-init>
<codx-scroll-top></codx-scroll-top>

<!-- begin:: Drawers -->
<codx-messenger-drawer></codx-messenger-drawer>
<codx-notify-drawer></codx-notify-drawer>
<!-- <codx-user-drawer></codx-user-drawer> -->
<!-- end:: Drawers -->

<!-- begin:: TOPBAR -->
<ng-template #headerRightBar>
  <!-- CHAT -->
  <div class="d-flex align-items-center" [ngClass]="toolbarButtonMarginClass">
    <codx-chat-list></codx-chat-list>
  </div>
  <!-- NOTIFICATIONS -->
  <div class="d-flex align-items-center" [ngClass]="toolbarButtonMarginClass">
    <!-- begin::Menu wrapper -->
    <div class="btn btn-icon btn-active-light-primary position-relative" [ngClass]="toolbarButtonHeightClass"
      id="kt_drawer_notify_toggle">
      <span [inlineSVG]="'./assets/media/icons/duotune/general/gen007.svg'" class="svg-icon"
        [ngClass]="toolbarButtonIconSizeClass"></span>
      <span
        class="bullet bullet-dot bg-success h-6px w-6px position-absolute translate-middle top-0 start-50 animation-blink"></span>
    </div>
    <!-- end::Menu wrapper -->
  </div>

  <!-- Quick links -->
  <div class="d-flex align-items-center" [ngClass]="toolbarButtonMarginClass">
    <div class="btn btn-icon btn-active-light-primary" [ngClass]="toolbarButtonHeightClass" data-kt-menu-trigger="click"
      data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end" data-kt-menu-flip="bottom">
      <span [inlineSVG]="'./assets/media/icons/duotune/general/gen025.svg'" class="svg-icon"
        [ngClass]="toolbarButtonIconSizeClass"></span>
    </div>
    <erm-quick-links-inner></erm-quick-links-inner>
  </div>

  <!-- begin::User -->
  <div class="d-flex align-items-center" [ngClass]="toolbarButtonMarginClass">
    <!-- begin::Toggle -->
    <codx-img #imageViewer *ngIf="user" [ngClass]="toolbarUserAvatarHeightClass" class="cursor-pointer symbol"
      funcId="AD006" [objectId]="user.userID" [objectName]="user.userName" objectType="AD_Users" [width]="40"
      data-kt-menu-trigger="click" data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end"
      data-kt-menu-flip="bottom">
    </codx-img>
    <!-- end::Toggle  -->
    <codx-user-inner (onAvatarChanged)="reloadAvatar($event)"></codx-user-inner>
  </div>
  <!-- end::User -->

  <ng-container *ngIf="headerLeft === 'menu'">
    <div class="d-flex align-items-center d-lg-none ms-2 me-n3" title="Show header menu">
      <div class="btn btn-icon btn-active-light-primary w-30px h-30px" id="kt_header_menu_mobile_toggle">
        <span [inlineSVG]="'./assets/media/icons/duotune/text/txt001.svg'" class="svg-icon svg-icon-1"></span>
      </div>
    </div>
  </ng-container>
</ng-template>
<!-- end::TOPBAR -->

<!--begin:: ASIDE-->
<ng-template #asideMenu>
  <ng-container *ngFor="let f of funcs$ | async">
    <div class="menu-item" *ngIf="!f.separator && (!f.childs || f.childs.length==0)">
      <a class="menu-link without-sub" href="javascript:;" (click)="codxService.navigate(f.functionID)"
        [ngbTooltip]="f.comingSoon?'Coming soon':''" routerLinkActive="active">
        <span class="menu-icon">
          <span class="{{f.smallIcon}} icon-20"></span>
        </span>
        <span class="menu-title">{{f.customName}}</span>
      </a>
    </div>
    <div class="menu-item menu-accordion" *ngIf="!f.separator && f.childs?.length>0" data-kt-menu-trigger='click'
      routerLinkActive='here show'>
      <span class="menu-link">
        <span class="menu-icon">
          2
        </span>
        <span class="menu-title">{{f.customName}}</span>
        <span class="menu-arrow"></span>
      </span>
      <div class="menu-sub menu-sub-accordion" routerLinkActive="menu-active-bg">
        <div class="menu-item" *ngFor="let fc of f.childs">
          <a class="menu-link without-sub" href="javascript:;" (click)="codxService.navigate(fc.functionID)"
            routerLinkActive="active">
            <span class="menu-icon">
              3
            </span>
            <span class="menu-title">{{fc.customName}}</span>
          </a>
        </div>
      </div>
    </div>
    <div class="menu-item" *ngIf='f.separator'>
      <div class="menu-content pt-8 pb-2">
        <span class="menu-section text-muted text-uppercase fs-8 ls-1">{{f.customName}}</span>
      </div>
    </div>
  </ng-container>

  <!-- <ng-container *ngFor="let f of codxService.modulesOb$ | async">
    <div class="menu-item">
      <a class="menu-link without-sub" href="javascript:;" (click)="codxService.navigate(f.functionID)"
        routerLinkActive="active">
        <span class="menu-icon">
          <img class="w-25px" src="../../../{{f.smallIcon}}" />
        </span>
        <span class="menu-title">{{f.customName}}</span>
      </a>
    </div>
  </ng-container> -->
</ng-template>
<!--end:: ASIDE-->

<codx-list-chat-box></codx-list-chat-box>