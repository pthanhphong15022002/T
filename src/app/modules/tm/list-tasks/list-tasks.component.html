<codx-listview #listview [itemTemplate]="templateTask" [selectFirst]="true" funcId="" [pageSize]="10" service="TM"
  assemblyName="ERM.Business.TM" className="TaskBusiness" method="GetListDetailTasksAsync" [predicate]="" [dataValue]=""
  type="listView" [gridViewName]="'grvTasks'" autoLoad="false" entityName="TM_Tasks" [data]="data" groupBy="createdOn">
</codx-listview>

<ng-template #templateTask let-item>
  <div class="d-flex p-3 flex-grow-1 border-bottom task-active item-active">
    <!-- <more-funtion [data]="item" (clickAction)="onChangeStatusTask($event)">
    </more-funtion> -->
    <div class="symbol symbol-40 symbol-circle mr-3">
      <lv-image-viewer class="symbol symbol-30 symbol-circle w-30px" [objectId]="item?.createdBy" objectType="AD_Users"
        width="40">
      </lv-image-viewer>
    </div>
    <div class="d-flex flex-column flex-grow-1">
      <div class="d-flex align-items-center justify-content-between">
        <div class="text-dark text-hover-primary font-weight-bold">
          {{ item.userNameCreate }}
        </div>

        <span class="icon-15 mr-2">
          <span [class]="item?.priority | vll: 'L0186':'icon' | async"
            [style.color]="item?.priority | vll: 'L0186':'color' | async"></span>
        </span>
      </div>
      <span class="text-muted">{{ item.positionNameCreate }}</span>
      <div class="task-name mb-1 max-h-36px">{{ item?.taskName }}</div>
      <div class="d-flex align-items-center justify-content-between">
        <div class="task-status d-flex">
          <div class="label label-xxs label-pill label-inline label-light-danger mr-2 label-status"
            [style.border-color]="
          (item?.status | vll: 'L0614':'color' | async) + '30'
        " [style.background-color]="
          (item?.status | vll: 'L0614':'color' | async) + '30'
        " [style.color]="item?.status | vll: 'L0614':'color' | async" style="border: none">
            {{ item?.status | vll: "L0614":"text" | async }}
          </div>
          <span class="text-dark-50 font-size-md">
            {{ item?.createdOn | fmDT: "dmy" }}</span>
        </div>
        <div class="symbol-group symbol-hover justify-content-end"
          *ngIf="item?.category == '3' || item?.category == '4'">
          <lv-imageviewers class="symbol symbol-30 symbol-circle ml-1" [objectId]="item?.assignTo" objectName="AD_Users"
            [numberImages]="2">
          </lv-imageviewers>
        </div>
      </div>
    </div>
  </div>
</ng-template>
<ng-template #popContent>
  <div>
    <ng-container>
      <div class="result-title text-dark font-size-h5 mb-5 mt-3">Phân công cho</div>
      <div *ngFor="let item of lstTaskbyParent" class="task-list p10 full">
        <div class="d-flex align-items-start user-card p-3">
          <div class="symbol symbol-30px symbol-circle me-3">
            <codx-imgs [objectId]="item?.owner" objectType="AD_Users"></codx-imgs>
          </div>
          <div class="d-flex flex-column flex-grow-1">
            <div class="text-dark font-weight-bold">{{item?.ownerName}}</div>
            <div class="text-dark-50 font-size-sm">{{item?.position}}</div>
            <div class="text-dark">
              {{item?.memo2}}
            </div>
            <div class="d-flex align-items-center">
              <div class="d-flex align-items-center me-2">
                <span class="icon-access_time icon-16 text-muted"></span>
                <span class="text-muted">{{item?.dueDate | date:'dd/MM/yyyy'}}</span>
              </div>
              <div class="label label-xxs label-pill label-inline label-light-danger me-2 label-status"
                [style.border-color]="(item?.status | vll: 'L0614':'color' | async) + '30'"
                [style.background-color]="(item?.status | vll: 'L0614':'color' | async) + '30'"
                [style.color]="item?.status | vll: 'L0614':'color' | async" style="border: none">{{
                item?.status | vll: "L0614":"text" | async }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

</ng-template>
<ng-template #popDetail>
  <div>
    <ng-container>
      <div class="d-flex flex-column flex-grow-1">
        <div class="result-title text-dark font-size-h5 mb-2">Mô tả chi tiết</div>
        <div class="text-dark-75 font-size-md">
          {{popoverDetail?.memo}}
          <div class="d-flex align-items-center mt-2">
            <div class="d-flex align-items-center me-2">
              <span class="icon-create icon-18 text-dark-50"></span>
              <span class="text-dark-50 text-italic"> {{popoverDetail?.memo2}}
              </span>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
  </div>

</ng-template>
