<codx-form [headerText]="title" [body]="body" [footer]="footer" [dialog]="dialogRef">
    <ng-template #body>
        <div class="body body-addpost">
            <div class="addpost-scroll">
                <div class="py-3 d-flex">
                    <div class="body-user-img me-3">
                        <codx-img [objectId]="user.userID" objectType="AD_Users" [width]="40">
                        </codx-img>
                    </div>
                    <div class="ms-2 ">
                        <div class="d-flex flex-column">
                            <div class="user-name fw-bold">{{user.userName}}</div>
                            <div class="ms-2">
                                <ng-container *ngIf="lstRecevier.length > 0">
                                    <ng-container *ngIf="shareControl == 'U';else notUser">
                                        <ng-container *ngIf="lstRecevier.length == 1; else shareWith">
                                            <div class="fw-bold fs-6">
                                                <codx-label [formName]="dialogRef.formModel.formName"
                                                    name="lblShareWith" default="cùng với "></codx-label>
                                                <span class="me-2 fw-bold">{{recevierName}}</span>
                                            </div>
                                        </ng-container>
                                        <ng-template #shareWith>
                                            <div class="fw-bold fs-6">
                                                <codx-label [formName]="dialogRef.formModel.formName"
                                                    name="lblShareWith" default="cùng với "></codx-label>
                                                <span class="ms-2 me-2">{{lstRecevier.length}}</span>
                                                <codx-label [formName]="dialogRef.formModel.formName"
                                                    name="lblShareWith" default=" người khác "></codx-label>
                                            </div>
                                        </ng-template>
                                    </ng-container>
                                    <ng-template #notUser>
                                        <div class="fw-bold fs-6">
                                            <codx-label [formName]="dialogRef.formModel.formName" name="lblShareWith"
                                                default="cùng với "></codx-label>
                                            <span class="me-2 fw-bold">{{recevierName}}</span>
                                        </div>
                                    </ng-template>
                                </ng-container>
                            </div>
                        </div>
                        <div class="d-flex align-items-center justify-content-start "
                            (click)="openFormShare(controlShare)">
                            <div class="bg-gray-200 rounded-1 px-1 d-flex align-items-center">
                                <span class="symbol symbol-12px symbol-circle">
                                    <img
                                        src="assets/themes/sys/default/img/{{(objectType | vll:'L1901' : 'icon' | async)}}" />
                                </span>
                                <span class="text-gray-700 fs-6 ms-1">
                                    {{objectType | vll:'L1901' : 'text' | async}}
                                </span>
                                <i class="icon-arrow_drop_down icon-18 text-dark"></i>
                            </div>
                            <ng-template #controlShare let-dialog>
                                <codx-share [dialog]="dialog" [multiple]="false" (eventApply)="eventApply($event)">
                                </codx-share>
                            </ng-template>
                        </div>
                    </div>
                </div>
                <ng-container [ngSwitch]="status">
                    <ng-container *ngSwitchCase="'edit'">
                        <ng-container *ngTemplateOutlet="edit"></ng-container>
                    </ng-container>
                    <ng-container *ngSwitchCase="'share'">
                        <ng-container *ngTemplateOutlet="share"></ng-container>
                    </ng-container>
                    <ng-container *ngSwitchDefault>
                        <ng-container *ngTemplateOutlet="create"></ng-container>
                    </ng-container>
                </ng-container>
            </div>
            <div class="d-flex justify-content-between align-items-center body-function">
                <div class="text-gray-500 fw-bold">
                    <codx-label formName="" name="lblInsertPost" default="Thêm vào bài viết"></codx-label>
                </div>
                <div class="d-flex justify-content-between align-items-center">
                    <div class="btn-emoji">
                        <button (click)="toggleEmojiPicker()" type="button" data-toggle="tooltip" title="Icon"
                            class="btn btn-icon btn-md ms-2 btn-emoji">
                            <i class="icon-tag_faces icon-24 text-warning"></i>
                        </button>
                        <ng-container *ngIf="showEmojiPicker">
                            <div class="emoji">
                                <emoji-mart [showSingleCategory]="true" [showPreview]="false" [set]="set" [perLine]="7"
                                    (emojiSelect)="addEmoji($event)"></emoji-mart>
                            </div>
                        </ng-container>
                    </div>
                    <div>
                        <button type="button" data-toggle="tooltip" class="btn btn-icon btn-md ms-2">
                            <i class="icon-local_offer icon-24 text-primary"></i>
                        </button>
                    </div>
                    <div class="btn-upload">
                        <button (click)="openFile()" type="button" data-toggle="tooltip"
                            class="btn btn-icon btn-md ms-2 ng-star-inserted">
                            <i class="icon-photo icon-24 text-success"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
    <ng-template #footer>
        <div class="d-flex justify-content-between">
            <button type="button" class="btn btn-primary btn-post" (click)="Submit()">
                <codx-label formName="WP_Comments" name="lblSubmit" default="Đăng"></codx-label>
            </button>
        </div>
    </ng-template>
</codx-form>
<ng-template #create>
    <div class="my-3">
        <div>
            <codx-input format="ed2" [class]="'border-0'" type="textarea" class="test-textarea" [crrValue]="message"
                placeholder="{{user.userName + ' bạn đang nghĩ gì?'}}" (valueChange)="valueChange($event)">
            </codx-input>
       </div>
        <div>
            <codx-file [lstFile]="listFileUpload" [showBtnRemove]='true'></codx-file>
        </div>
        <div class="d-none">
            <codx-attachment #atmCreate 
                objectType="WP_Comments" 
                hideFolder="1" hideUploadBtn="1"
                hideDes="1" type="inline" 
                allowExtensions=".jpg,.png" allowMultiFile="1"
                (fileCount)="getfileCount($event)"
                idBrowse="atmCreate"
                [functionID]="dialogRef.formModel.funcID">
            </codx-attachment>
        </div>
    </div>                  
</ng-template>

<ng-template #edit>
    <ng-container *ngIf="dataEdit">
        <div class="my-3">
            <div>
                <codx-input format="ed2" [class]="'border-0'" type="textarea" class="test-textarea" [crrValue]="message"
                    placeholder="{{user.userName + ' bạn đang nghĩ gì?'}}" (valueChange)="valueChange($event)">
                </codx-input>
            </div>
            <div *ngIf="dataEdit.isUploadImg">
                <codx-file [objectID]="dataEdit.recID" [showBtnRemove]='true'></codx-file>
            </div>
            <div *ngIf="dataEdit.isUploadFile">
                <codx-attachment #atmCreate objectType="WP_Comments" [objectId]="dataEdit.recID" hideFolder="1"
                    hideUploadBtn="1" hideDes="1" type="inline" allowExtensions=".jpg,.png" allowMultiFile="1"
                    (fileCount)="getfileCount($event)" idBrowse="atmCreate" [functionID]="dialogRef.formModel.funcID">
                </codx-attachment>
            </div>
        </div>
    </ng-container>
</ng-template>

<ng-template #share>
    <div class="my-3">
        <div>
            <codx-input format="ed2" [class]="'border-0'" type="textarea" class="test-textarea" [crrValue]="message"
                placeholder="{{user.userName + ' bạn đang nghĩ gì?'}}" (valueChange)="valueChange($event)">
            </codx-input>
        </div>
        <div>
            <codx-file [lstFile]="listFileUpload"></codx-file>
        </div>
        <div>
            <codx-attachment #atmCreate objectType="WP_Comments" [objectId]="dataEdit?.recID" hideFolder="1"
                hideUploadBtn="1" hideDes="1" type="inline" allowExtensions=".jpg,.png" allowMultiFile="1"
                (fileCount)="getfileCount($event)" idBrowse="atmCreate" [functionID]="dialogRef.formModel.funcID">
            </codx-attachment>
        </div>
        <div class="border ndchiase p-4 mt-3">
            <div class="d-flex mb-3 card-border">
                <codx-img [width]="30" [objectId]="dataShare?.createdBy" bjectType="AD_Users">
                </codx-img>
                <div class="d-flex flex-column flex-grow-1 ms-2">
                    <div class="d-flex align-items-center">
                        <span class="text-gray-800 fw-bold">{{dataShare?.createdName}}</span>
                    </div>
                    <div class="text-info-date">
                        <span class="text-gray-500 me-2">{{dataShare?.createdOn | timefrom}}</span>
                    </div>
                </div>
            </div>
            <div>
                <ng-container *ngIf="!dataShare?.isPortal;else category2">
                    <div class="text-dark text-feed">
                        <read-more #readmore [content]="dataShare?.content" [limit]="800" [completeWords]="true">
                        </read-more>
                    </div>

                    <ng-container *ngIf="dataShare.isUpload">
                        <div class="pic-feed">
                            <ng-container *ngIf="dataShare.isUploadImg">
                                <div class="pic-feed-img">
                                    <codx-file [objectID]="dataShare.recID"></codx-file>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="dataShare.isUploadVideo">
                                <video src="#"></video>
                            </ng-container>
                            <ng-container *ngIf="dataShare.isUploadFile">
                                <codx-attachment [objectId]="dataShare.recID"   idBrowse="atmView"
                                    objectType="WP_Comments" hideFolder="1" hideUploadBtn="1" hideDes="1" type="inline"
                                    allowExtensions=".jpg,.png">
                                </codx-attachment>
                            </ng-container>
                        </div>
                    </ng-container>
                </ng-container>
                <ng-template #category2>
                    <div class="p-0 m-0">
                        <span class="ion-text-wrap ion-text-justify" [innerHTML]="dataShare?.content"></span>
                    </div>
                    <div class="card-custom-img bgi-no-repeat"
                        [style.background]="dataShare?.card?.background| backgroundImage:dataShare?.card?.backgroundColor"
                        style="background-size: 100% auto;">
                        <div class="card-body card-custom-img-body ">
                            <div color="bg-transparent" class="ion-margin-vertical padding-start-0">
                                <h2 class="fw-bolder mb-6 mt-3"
                                    [ngStyle]="{'color':dataShare?.card?.pattern?.headerColor}">
                                    {{dataShare?.card?.cardType | vll:'L1422':'text' | async}}
                                </h2>
                            </div>
                            <div class="d-flex align-items-center ion-wrap mar-auto">
                                <div *ngIf="dataShare?.card.senderID">
                                    <codx-img [width]="40" [objectId]=" dataShare?.card?.senderID"
                                        objectType="AD_Users">
                                    </codx-img>
                                </div>
                                <div style="width: 50px;" class="mar-auto text-center ion-justify-content-between">
                                    <img src="../../../../assets/img/mail.png" class="icon-mail ion-margin-top-8" />
                                </div>
                                <div *ngIf="dataShare?.card?.receiverID">
                                    <codx-img [width]="40" [objectId]="dataShare?.card?.receiverID"
                                        objectType="AD_Users">
                                    </codx-img>
                                </div>
                            </div>
                            <div class="text-dark text-feed mt-6">
                                <read-more #readmore2 [content]="dataShare?.card?.situation" [limit]="800"
                                    [completeWords]="true">
                                </read-more>
                            </div>


                            <div class="d-flex align-items-center group-hasGift mt-6">

                                <div class="d-flex align-items-center ion-wrap me-2"
                                    *ngIf="dataShare?.card?.cardType=='2' || dataShare?.card?.cardType =='3'">
                                    <div class="me-2">
                                        <img class="w-30px h-30px" src="../../../../assets/demos/card/rating/{{ dataShare?.card?.rating | vll:dataShare?.card?.cardType=='2' ?'L1419':'L1424':'icon'
                    |async}}" />
                                    </div>
                                </div>
                                <div class="d-flex align-items-center ion-wrap mar-auto"
                                    *ngIf="dataShare?.card?.hasGift || dataShare?.card?.hasPoint">
                                    <img src="../../../../assets/img/feedback/gift 1.png"
                                        *ngIf="dataShare?.card?.hasGift"
                                        class="symbol-image icon-surface1 h-30px me-1" />
                                    <img src="../../../../assets/img/feedback/money-1.png"
                                        *ngIf="dataShare?.card?.hasPoint" class="symbol-image icon-money-1 h-30px" />
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </div>
        </div>
    </div>

</ng-template>

<ng-template #containTemplate let-item>
    <ng-container *ngIf="!item?.isPortal;else category2">
        <div class="text-dark text-feed">
            <read-more #readmore [content]="item?.content" [limit]="800" [completeWords]="true">
            </read-more>
        </div>

        <ng-container *ngIf="item.isUpload">
            <div class="pic-feed">
                <div class="pic-feed-img">
                    <codx-file [objectID]="item.recID"></codx-file>
                </div>
                <!-- <ng-container *ngIf="item.isUploadVideo">
                    <video src="#"></video>
                </ng-container>
                <ng-container *ngIf="item.isUploadFile">
                    <codx-attachment [objectId]="item.recID"   idBrowse="atmView" objectType="WP_Comments"
                        hideFolder="1" hideUploadBtn="1" hideDes="1" type="inline" allowExtensions=".jpg,.png">
                    </codx-attachment>
                </ng-container> -->
            </div>
        </ng-container>
    </ng-container>
    <ng-template #category2>
        <div class="p-0 m-0">
            <span class="ion-text-wrap ion-text-justify" [innerHTML]="item?.content"></span>
        </div>
        <div class="card-custom-img bgi-no-repeat"
            [style.background]="item?.card?.background| backgroundImage:item?.card?.backgroundColor"
            style="background-size: 100% auto;">
            <div class="card-body card-custom-img-body ">
                <div color="bg-transparent" class="ion-margin-vertical padding-start-0">
                    <h2 class="fw-bolder mb-6 mt-3" [ngStyle]="{'color':item?.card?.pattern?.headerColor}">
                        {{item?.card?.cardType | vll:'L1422':'text' | async}}
                    </h2>
                </div>
                <div class="d-flex align-items-center ion-wrap mar-auto">
                    <div *ngIf="item?.card.senderID">
                        <codx-img [width]="40" [objectId]=" item?.card?.senderID" objectType="AD_Users">
                        </codx-img>
                    </div>
                    <div style="width: 50px;" class="mar-auto text-center ion-justify-content-between">
                        <img src="../../../../assets/img/mail.png" class="icon-mail ion-margin-top-8" />
                    </div>
                    <div *ngIf="item?.card?.receiverID">
                        <codx-img [width]="40" [objectId]="item?.card?.receiverID" objectType="AD_Users">
                        </codx-img>
                    </div>
                </div>
                <div class="text-dark text-feed mt-6">
                    <read-more #readmore2 [content]="item?.card?.situation" [limit]="800" [completeWords]="true">
                    </read-more>
                </div>


                <div class="d-flex align-items-center group-hasGift mt-6">

                    <div class="d-flex align-items-center ion-wrap me-2"
                        *ngIf="item?.card?.cardType=='2' || item?.card?.cardType =='3'">
                        <div class="me-2">
                            <img class="w-30px h-30px" src="../../../../assets/demos/card/rating/{{ item?.card?.rating | vll:item?.card?.cardType=='2' ?'L1419':'L1424':'icon'
        |async}}" />
                        </div>
                    </div>
                    <div class="d-flex align-items-center ion-wrap mar-auto"
                        *ngIf="item?.card?.hasGift || item?.card?.hasPoint">
                        <img src="../../../../assets/img/feedback/gift 1.png" *ngIf="item?.card?.hasGift"
                            class="symbol-image icon-surface1 h-30px me-1" />
                        <img src="../../../../assets/img/feedback/money-1.png" *ngIf="item?.card?.hasPoint"
                            class="symbol-image icon-money-1 h-30px" />
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
</ng-template>